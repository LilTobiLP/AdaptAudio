require(["bowser","libraries/mediaelement-and-player","libraries/rangeslider","handlebars","libraries/SCORM_API_wrapper","underscore"],function(Bowser,mediaelementAndPlayer,rangeslider,Handlebars$1,pipwerks,_$1){'use strict';(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){'use strict';var keys=require("object-keys").shim();delete keys.shim;var assign=require("./");module.exports=assign.shim();delete assign.shim},{"./":3,"object-keys":9}],2:[function(require,module,exports){'use strict';var keys=require("object-keys");var bind=require("function-bind");var canBeObject=function(obj){return typeof obj!=="undefined"&&obj!==null};var hasSymbols=require("has-symbols/shams")();var toObject=Object;var push=bind.call(Function.call,Array.prototype.push);var propIsEnumerable=bind.call(Function.call,Object.prototype.propertyIsEnumerable);var originalGetSymbols=hasSymbols?Object.getOwnPropertySymbols:null;module.exports=function assign(target,source1){if(!canBeObject(target)){throw new TypeError("target must be an object")}var objTarget=toObject(target);var s,source,i,props,syms,value,key;for(s=1;s<arguments.length;++s){source=toObject(arguments[s]);props=keys(source);var getSymbols=hasSymbols&&(Object.getOwnPropertySymbols||originalGetSymbols);if(getSymbols){syms=getSymbols(source);for(i=0;i<syms.length;++i){key=syms[i];if(propIsEnumerable(source,key)){push(props,key)}}}for(i=0;i<props.length;++i){key=props[i];value=source[key];if(propIsEnumerable(source,key)){objTarget[key]=value}}}return objTarget}},{"function-bind":7,"has-symbols/shams":8,"object-keys":9}],3:[function(require,module,exports){'use strict';var defineProperties=require("define-properties");var implementation=require("./implementation");var getPolyfill=require("./polyfill");var shim=require("./shim");var polyfill=getPolyfill();defineProperties(polyfill,{getPolyfill:getPolyfill,implementation:implementation,shim:shim});module.exports=polyfill},{"./implementation":2,"./polyfill":11,"./shim":12,"define-properties":4}],4:[function(require,module,exports){'use strict';var keys=require("object-keys");var foreach=require("foreach");var hasSymbols=typeof Symbol==="function"&&typeof Symbol()==="symbol";var toStr=Object.prototype.toString;var isFunction=function(fn){return typeof fn==="function"&&toStr.call(fn)==="[object Function]"};var arePropertyDescriptorsSupported=function(){var obj={};try{Object.defineProperty(obj,"x",{enumerable:false,value:obj});for(var _ in obj){return false}return obj.x===obj}catch(e){return false}};var supportsDescriptors=Object.defineProperty&&arePropertyDescriptorsSupported();var defineProperty=function(object,name,value,predicate){if(name in object&&(!isFunction(predicate)||!predicate())){return}if(supportsDescriptors){Object.defineProperty(object,name,{configurable:true,enumerable:false,value:value,writable:true})}else{object[name]=value}};var defineProperties=function(object,map){var predicates=arguments.length>2?arguments[2]:{};var props=keys(map);if(hasSymbols){props=props.concat(Object.getOwnPropertySymbols(map))}foreach(props,function(name){defineProperty(object,name,map[name],predicates[name])})};defineProperties.supportsDescriptors=!!supportsDescriptors;module.exports=defineProperties},{"foreach":5,"object-keys":9}],5:[function(require,module,exports){var hasOwn=Object.prototype.hasOwnProperty;var toString=Object.prototype.toString;module.exports=function forEach(obj,fn,ctx){if(toString.call(fn)!=="[object Function]"){throw new TypeError("iterator must be a function")}var l=obj.length;if(l===+l){for(var i=0;i<l;i++){fn.call(ctx,obj[i],i,obj)}}else{for(var k in obj){if(hasOwn.call(obj,k)){fn.call(ctx,obj[k],k,obj)}}}}},{}],6:[function(require,module,exports){'use strict';var ERROR_MESSAGE="Function.prototype.bind called on incompatible ";var slice=Array.prototype.slice;var toStr=Object.prototype.toString;var funcType="[object Function]";module.exports=function bind(that){var target=this;if(typeof target!=="function"||toStr.call(target)!==funcType){throw new TypeError(ERROR_MESSAGE+target)}var args=slice.call(arguments,1);var bound;var binder=function(){if(this instanceof bound){var result=target.apply(this,args.concat(slice.call(arguments)));if(Object(result)===result){return result}return this}else{return target.apply(that,args.concat(slice.call(arguments)))}};var boundLength=Math.max(0,target.length-args.length);var boundArgs=[];for(var i=0;i<boundLength;i++){boundArgs.push("$"+i)}bound=Function("binder","return function ("+boundArgs.join(",")+"){ return binder.apply(this,arguments); }")(binder);if(target.prototype){var Empty=function Empty(){};Empty.prototype=target.prototype;bound.prototype=new Empty;Empty.prototype=null}return bound}},{}],7:[function(require,module,exports){'use strict';var implementation=require("./implementation");module.exports=Function.prototype.bind||implementation},{"./implementation":6}],8:[function(require,module,exports){'use strict';module.exports=function hasSymbols(){if(typeof Symbol!=="function"||typeof Object.getOwnPropertySymbols!=="function"){return false}if(typeof Symbol.iterator==="symbol"){return true}var obj={};var sym=Symbol("test");var symObj=Object(sym);if(typeof sym==="string"){return false}if(Object.prototype.toString.call(sym)!=="[object Symbol]"){return false}if(Object.prototype.toString.call(symObj)!=="[object Symbol]"){return false}var symVal=42;obj[sym]=symVal;for(sym in obj){return false}if(typeof Object.keys==="function"&&Object.keys(obj).length!==0){return false}if(typeof Object.getOwnPropertyNames==="function"&&Object.getOwnPropertyNames(obj).length!==0){return false}var syms=Object.getOwnPropertySymbols(obj);if(syms.length!==1||syms[0]!==sym){return false}if(!Object.prototype.propertyIsEnumerable.call(obj,sym)){return false}if(typeof Object.getOwnPropertyDescriptor==="function"){var descriptor=Object.getOwnPropertyDescriptor(obj,sym);if(descriptor.value!==symVal||descriptor.enumerable!==true){return false}}return true}},{}],9:[function(require,module,exports){'use strict';var has=Object.prototype.hasOwnProperty;var toStr=Object.prototype.toString;var slice=Array.prototype.slice;var isArgs=require("./isArguments");var isEnumerable=Object.prototype.propertyIsEnumerable;var hasDontEnumBug=!isEnumerable.call({toString:null},"toString");var hasProtoEnumBug=isEnumerable.call(function(){},"prototype");var dontEnums=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];var equalsConstructorPrototype=function(o){var ctor=o.constructor;return ctor&&ctor.prototype===o};var excludedKeys={$console:true,$external:true,$frame:true,$frameElement:true,$frames:true,$innerHeight:true,$innerWidth:true,$outerHeight:true,$outerWidth:true,$pageXOffset:true,$pageYOffset:true,$parent:true,$scrollLeft:true,$scrollTop:true,$scrollX:true,$scrollY:true,$self:true,$webkitIndexedDB:true,$webkitStorageInfo:true,$window:true};var hasAutomationEqualityBug=function(){if(typeof window==="undefined"){return false}for(var k in window){try{if(!excludedKeys["$"+k]&&has.call(window,k)&&window[k]!==null&&typeof window[k]==="object"){try{equalsConstructorPrototype(window[k])}catch(e){return true}}}catch(e){return true}}return false}();var equalsConstructorPrototypeIfNotBuggy=function(o){if(typeof window==="undefined"||!hasAutomationEqualityBug){return equalsConstructorPrototype(o)}try{return equalsConstructorPrototype(o)}catch(e){return false}};var keysShim=function keys(object){var isObject=object!==null&&typeof object==="object";var isFunction=toStr.call(object)==="[object Function]";var isArguments=isArgs(object);var isString=isObject&&toStr.call(object)==="[object String]";var theKeys=[];if(!isObject&&!isFunction&&!isArguments){throw new TypeError("Object.keys called on a non-object")}var skipProto=hasProtoEnumBug&&isFunction;if(isString&&object.length>0&&!has.call(object,0)){for(var i=0;i<object.length;++i){theKeys.push(String(i))}}if(isArguments&&object.length>0){for(var j=0;j<object.length;++j){theKeys.push(String(j))}}else{for(var name in object){if(!(skipProto&&name==="prototype")&&has.call(object,name)){theKeys.push(String(name))}}}if(hasDontEnumBug){var skipConstructor=equalsConstructorPrototypeIfNotBuggy(object);for(var k=0;k<dontEnums.length;++k){if(!(skipConstructor&&dontEnums[k]==="constructor")&&has.call(object,dontEnums[k])){theKeys.push(dontEnums[k])}}}return theKeys};keysShim.shim=function shimObjectKeys(){if(Object.keys){var keysWorksWithArguments=function(){return(Object.keys(arguments)||"").length===2}(1,2);if(!keysWorksWithArguments){var originalKeys=Object.keys;Object.keys=function keys(object){if(isArgs(object)){return originalKeys(slice.call(object))}else{return originalKeys(object)}}}}else{Object.keys=keysShim}return Object.keys||keysShim};module.exports=keysShim},{"./isArguments":10}],10:[function(require,module,exports){'use strict';var toStr=Object.prototype.toString;module.exports=function isArguments(value){var str=toStr.call(value);var isArgs=str==="[object Arguments]";if(!isArgs){isArgs=str!=="[object Array]"&&value!==null&&typeof value==="object"&&typeof value.length==="number"&&value.length>=0&&toStr.call(value.callee)==="[object Function]"}return isArgs}},{}],11:[function(require,module,exports){'use strict';var implementation=require("./implementation");var lacksProperEnumerationOrder=function(){if(!Object.assign){return false}var str="abcdefghijklmnopqrst";var letters=str.split("");var map={};for(var i=0;i<letters.length;++i){map[letters[i]]=letters[i]}var obj=Object.assign({},map);var actual="";for(var k in obj){actual+=k}return str!==actual};var assignHasPendingExceptions=function(){if(!Object.assign||!Object.preventExtensions){return false}var thrower=Object.preventExtensions({1:2});try{Object.assign(thrower,"xy")}catch(e){return thrower[1]==="y"}return false};module.exports=function getPolyfill(){if(!Object.assign){return implementation}if(lacksProperEnumerationOrder()){return implementation}if(assignHasPendingExceptions()){return implementation}return Object.assign}},{"./implementation":2}],12:[function(require,module,exports){'use strict';var define=require("define-properties");var getPolyfill=require("./polyfill");module.exports=function shimAssign(){var polyfill=getPolyfill();define(Object,{assign:polyfill},{assign:function(){return Object.assign!==polyfill}});return polyfill}},{"./polyfill":11,"define-properties":4}]},{},[1]);"use strict";(function(d,r){"object"===typeof exports&&"undefined"!==typeof module?r(exports):"function"===typeof define&&define.noop?define(["exports"],r):(d=d||self,r(d.React={}))})(this,function(d){function r(a){for(var b="https://reactjs.org/docs/error-decoder.html?invariant="+a,c=1;c<arguments.length;c++)b+="&args[]="+encodeURIComponent(arguments[c]);return"Minified React error #"+a+"; visit "+b+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function w(a,b,c){this.props=a;this.context=b;this.refs=ba;this.updater=c||ca}function da(){}function L(a,b,c){this.props=a;this.context=b;this.refs=ba;this.updater=c||ca}function ea(a,b,c){var g,e={},fa=null,d=null;if(null!=b)for(g in void 0!==b.ref&&(d=b.ref),void 0!==b.key&&(fa=""+b.key),b)ha.call(b,g)&&!ia.hasOwnProperty(g)&&(e[g]=b[g]);var h=arguments.length-2;if(1===h)e.children=c;else if(1<h){for(var k=Array(h),f=0;f<h;f++)k[f]=arguments[f+2];e.children=k}if(a&&a.defaultProps)for(g in h=a.defaultProps,h)void 0===e[g]&&(e[g]=h[g]);return{$$typeof:x,type:a,key:fa,ref:d,props:e,_owner:M.current}}function va(a,b){return{$$typeof:x,type:a.type,key:b,ref:a.ref,props:a.props,_owner:a._owner}}function N(a){return"object"===typeof a&&null!==a&&a.$$typeof===x}function wa(a){var b={"=":"=0",":":"=2"};return"$"+(""+a).replace(/[=:]/g,function(a){return b[a]})}function ja(a,b,c,g){if(C.length){var e=C.pop();e.result=a;e.keyPrefix=b;e.func=c;e.context=g;e.count=0;return e}return{result:a,keyPrefix:b,func:c,context:g,count:0}}function ka(a){a.result=null;a.keyPrefix=null;a.func=null;a.context=null;a.count=0;10>C.length&&C.push(a)}function O(a,b,c,g){var e=typeof a;if("undefined"===e||"boolean"===e)a=null;var d=!1;if(null===a)d=!0;else switch(e){case"string":case"number":d=!0;break;case"object":switch(a.$$typeof){case x:case xa:d=!0;}}if(d)return c(g,a,""===b?"."+P(a,0):b),1;d=0;b=""===b?".":b+":";if(Array.isArray(a))for(var f=0;f<a.length;f++){e=a[f];var h=b+P(e,f);d+=O(e,h,c,g)}else if(null===a||"object"!==typeof a?h=null:(h=la&&a[la]||a["@@iterator"],h="function"===typeof h?h:null),"function"===typeof h)for(a=h.call(a),f=0;!(e=a.next()).done;)e=e.value,h=b+P(e,f++),d+=O(e,h,c,g);else if("object"===e)throw c=""+a,Error(r(31,"[object Object]"===c?"object with keys {"+Object.keys(a).join(", ")+"}":c,""));return d}function Q(a,b,c){return null==a?0:O(a,"",b,c)}function P(a,b){return"object"===typeof a&&null!==a&&null!=a.key?wa(a.key):b.toString(36)}function ya(a,b,c){a.func.call(a.context,b,a.count++)}function za(a,b,c){var g=a.result,e=a.keyPrefix;a=a.func.call(a.context,b,a.count++);Array.isArray(a)?R(a,g,c,function(a){return a}):null!=a&&(N(a)&&(a=va(a,e+(!a.key||b&&b.key===a.key?"":(""+a.key).replace(ma,"$&/")+"/")+c)),g.push(a))}function R(a,b,c,g,e){var d="";null!=c&&(d=(""+c).replace(ma,"$&/")+"/");b=ja(b,d,g,e);Q(a,za,b);ka(b)}function t(){var a=na.current;if(null===a)throw Error(r(321));return a}function S(a,b){var c=a.length;a.push(b);a:for(;;){var g=c-1>>>1,e=a[g];if(void 0!==e&&0<D(e,b))a[g]=b,a[c]=e,c=g;else break a}}function n(a){a=a[0];return void 0===a?null:a}function E(a){var b=a[0];if(void 0!==b){var c=a.pop();if(c!==b){a[0]=c;a:for(var g=0,e=a.length;g<e;){var d=2*(g+1)-1,f=a[d],h=d+1,k=a[h];if(void 0!==f&&0>D(f,c))void 0!==k&&0>D(k,f)?(a[g]=k,a[h]=c,g=h):(a[g]=f,a[d]=c,g=d);else if(void 0!==k&&0>D(k,c))a[g]=k,a[h]=c,g=h;else break a}}return b}return null}function D(a,b){var c=a.sortIndex-b.sortIndex;return 0!==c?c:a.id-b.id}function F(a){for(var b=n(u);null!==b;){if(null===b.callback)E(u);else if(b.startTime<=a)E(u),b.sortIndex=b.expirationTime,S(p,b);else break;b=n(u)}}function T(a){y=!1;F(a);if(!v)if(null!==n(p))v=!0,z(U);else{var b=n(u);null!==b&&G(T,b.startTime-a)}}function U(a,b){v=!1;y&&(y=!1,V());H=!0;var c=m;try{F(b);for(l=n(p);null!==l&&(!(l.expirationTime>b)||a&&!W());){var g=l.callback;if(null!==g){l.callback=null;m=l.priorityLevel;var e=g(l.expirationTime<=b);b=q();"function"===typeof e?l.callback=e:l===n(p)&&E(p);F(b)}else E(p);l=n(p)}if(null!==l)var d=!0;else{var f=n(u);null!==f&&G(T,f.startTime-b);d=!1}return d}finally{l=null,m=c,H=!1}}function oa(a){switch(a){case 1:return-1;case 2:return 250;case 5:return 1073741823;case 4:return 1E4;default:return 5E3;}}var f="function"===typeof Symbol&&Symbol.for,x=f?Symbol.for("react.element"):60103,xa=f?Symbol.for("react.portal"):60106,Aa=f?Symbol.for("react.fragment"):60107,Ba=f?Symbol.for("react.strict_mode"):60108,Ca=f?Symbol.for("react.profiler"):60114,Da=f?Symbol.for("react.provider"):60109,Ea=f?Symbol.for("react.context"):60110,Fa=f?Symbol.for("react.forward_ref"):60112,Ga=f?Symbol.for("react.suspense"):60113,Ha=f?Symbol.for("react.memo"):60115,Ia=f?Symbol.for("react.lazy"):60116,la="function"===typeof Symbol&&Symbol.iterator,pa=Object.getOwnPropertySymbols,Ja=Object.prototype.hasOwnProperty,Ka=Object.prototype.propertyIsEnumerable,I=function(){try{if(!Object.assign)return!1;var a=new String("abc");a[5]="de";if("5"===Object.getOwnPropertyNames(a)[0])return!1;var b={};for(a=0;10>a;a++)b["_"+String.fromCharCode(a)]=a;if("0123456789"!==Object.getOwnPropertyNames(b).map(function(a){return b[a]}).join(""))return!1;var c={};"abcdefghijklmnopqrst".split("").forEach(function(a){c[a]=a});return"abcdefghijklmnopqrst"!==Object.keys(Object.assign({},c)).join("")?!1:!0}catch(g){return!1}}()?Object.assign:function(a,b){if(null===a||void 0===a)throw new TypeError("Object.assign cannot be called with null or undefined");var c=Object(a);for(var g,e=1;e<arguments.length;e++){var d=Object(arguments[e]);for(var f in d)Ja.call(d,f)&&(c[f]=d[f]);if(pa){g=pa(d);for(var h=0;h<g.length;h++)Ka.call(d,g[h])&&(c[g[h]]=d[g[h]])}}return c},ca={isMounted:function(a){return!1},enqueueForceUpdate:function(a,b,c){},enqueueReplaceState:function(a,b,c,d){},enqueueSetState:function(a,b,c,d){}},ba={};w.prototype.isReactComponent={};w.prototype.setState=function(a,b){if("object"!==typeof a&&"function"!==typeof a&&null!=a)throw Error(r(85));this.updater.enqueueSetState(this,a,b,"setState")};w.prototype.forceUpdate=function(a){this.updater.enqueueForceUpdate(this,a,"forceUpdate")};da.prototype=w.prototype;f=L.prototype=new da;f.constructor=L;I(f,w.prototype);f.isPureReactComponent=!0;var M={current:null},ha=Object.prototype.hasOwnProperty,ia={key:!0,ref:!0,__self:!0,__source:!0},ma=/\/+/g,C=[],na={current:null},X;if("undefined"===typeof window||"function"!==typeof MessageChannel){var A=null,qa=null,ra=function(){if(null!==A)try{var a=q();A(!0,a);A=null}catch(b){throw setTimeout(ra,0),b}},La=Date.now();var q=function(){return Date.now()-La};var z=function(a){null!==A?setTimeout(z,0,a):(A=a,setTimeout(ra,0))};var G=function(a,b){qa=setTimeout(a,b)};var V=function(){clearTimeout(qa)};var W=function(){return!1};f=X=function(){}}else{var Y=window.performance,sa=window.Date,Ma=window.setTimeout,Na=window.clearTimeout;"undefined"!==typeof console&&(f=window.cancelAnimationFrame,"function"!==typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills"),"function"!==typeof f&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills"));if("object"===typeof Y&&"function"===typeof Y.now)q=function(){return Y.now()};else{var Oa=sa.now();q=function(){return sa.now()-Oa}}var J=!1,K=null,Z=-1,ta=5,ua=0;W=function(){return q()>=ua};f=function(){};X=function(a){0>a||125<a?console.error("forceFrameRate takes a positive int between 0 and 125, forcing framerates higher than 125 fps is not unsupported"):ta=0<a?Math.floor(1E3/a):5};var B=new MessageChannel,aa=B.port2;B.port1.onmessage=function(){if(null!==K){var a=q();ua=a+ta;try{K(!0,a)?aa.postMessage(null):(J=!1,K=null)}catch(b){throw aa.postMessage(null),b}}else J=!1};z=function(a){K=a;J||(J=!0,aa.postMessage(null))};G=function(a,b){Z=Ma(function(){a(q())},b)};V=function(){Na(Z);Z=-1}}var p=[],u=[],Pa=1,l=null,m=3,H=!1,v=!1,y=!1,Qa=0;B={ReactCurrentDispatcher:na,ReactCurrentOwner:M,IsSomeRendererActing:{current:!1},assign:I};I(B,{Scheduler:{__proto__:null,unstable_ImmediatePriority:1,unstable_UserBlockingPriority:2,unstable_NormalPriority:3,unstable_IdlePriority:5,unstable_LowPriority:4,unstable_runWithPriority:function(a,b){switch(a){case 1:case 2:case 3:case 4:case 5:break;default:a=3;}var c=m;m=a;try{return b()}finally{m=c}},unstable_next:function(a){switch(m){case 1:case 2:case 3:var b=3;break;default:b=m;}var c=m;m=b;try{return a()}finally{m=c}},unstable_scheduleCallback:function(a,b,c){var d=q();if("object"===typeof c&&null!==c){var e=c.delay;e="number"===typeof e&&0<e?d+e:d;c="number"===typeof c.timeout?c.timeout:oa(a)}else c=oa(a),e=d;c=e+c;a={id:Pa++,callback:b,priorityLevel:a,startTime:e,expirationTime:c,sortIndex:-1};e>d?(a.sortIndex=e,S(u,a),null===n(p)&&a===n(u)&&(y?V():y=!0,G(T,e-d))):(a.sortIndex=c,S(p,a),v||H||(v=!0,z(U)));return a},unstable_cancelCallback:function(a){a.callback=null},unstable_wrapCallback:function(a){var b=m;return function(){var c=m;m=b;try{return a.apply(this,arguments)}finally{m=c}}},unstable_getCurrentPriorityLevel:function(){return m},unstable_shouldYield:function(){var a=q();F(a);var b=n(p);return b!==l&&null!==l&&null!==b&&null!==b.callback&&b.startTime<=a&&b.expirationTime<l.expirationTime||W()},unstable_requestPaint:f,unstable_continueExecution:function(){v||H||(v=!0,z(U))},unstable_pauseExecution:function(){},unstable_getFirstCallbackNode:function(){return n(p)},get unstable_now(){return q},get unstable_forceFrameRate(){return X},unstable_Profiling:null},SchedulerTracing:{__proto__:null,__interactionsRef:null,__subscriberRef:null,unstable_clear:function(a){return a()},unstable_getCurrent:function(){return null},unstable_getThreadID:function(){return++Qa},unstable_trace:function(a,b,c){return c()},unstable_wrap:function(a){return a},unstable_subscribe:function(a){},unstable_unsubscribe:function(a){}}});d.Children={map:function(a,b,c){if(null==a)return a;var d=[];R(a,d,null,b,c);return d},forEach:function(a,b,c){if(null==a)return a;b=ja(null,null,b,c);Q(a,ya,b);ka(b)},count:function(a){return Q(a,function(){return null},null)},toArray:function(a){var b=[];R(a,b,null,function(a){return a});return b},only:function(a){if(!N(a))throw Error(r(143));return a}};d.Component=w;d.Fragment=Aa;d.Profiler=Ca;d.PureComponent=L;d.StrictMode=Ba;d.Suspense=Ga;d.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=B;d.cloneElement=function(a,b,c){if(null===a||void 0===a)throw Error(r(267,a));var d=I({},a.props),e=a.key,f=a.ref,m=a._owner;if(null!=b){void 0!==b.ref&&(f=b.ref,m=M.current);void 0!==b.key&&(e=""+b.key);if(a.type&&a.type.defaultProps)var h=a.type.defaultProps;for(k in b)ha.call(b,k)&&!ia.hasOwnProperty(k)&&(d[k]=void 0===b[k]&&void 0!==h?h[k]:b[k])}var k=arguments.length-2;if(1===k)d.children=c;else if(1<k){h=Array(k);for(var l=0;l<k;l++)h[l]=arguments[l+2];d.children=h}return{$$typeof:x,type:a.type,key:e,ref:f,props:d,_owner:m}};d.createContext=function(a,b){void 0===b&&(b=null);a={$$typeof:Ea,_calculateChangedBits:b,_currentValue:a,_currentValue2:a,_threadCount:0,Provider:null,Consumer:null};a.Provider={$$typeof:Da,_context:a};return a.Consumer=a};d.createElement=ea;d.createFactory=function(a){var b=ea.bind(null,a);b.type=a;return b};d.createRef=function(){return{current:null}};d.forwardRef=function(a){return{$$typeof:Fa,render:a}};d.isValidElement=N;d.lazy=function(a){return{$$typeof:Ia,_ctor:a,_status:-1,_result:null}};d.memo=function(a,b){return{$$typeof:Ha,type:a,compare:void 0===b?null:b}};d.useCallback=function(a,b){return t().useCallback(a,b)};d.useContext=function(a,b){return t().useContext(a,b)};d.useDebugValue=function(a,b){};d.useEffect=function(a,b){return t().useEffect(a,b)};d.useImperativeHandle=function(a,b,c){return t().useImperativeHandle(a,b,c)};d.useLayoutEffect=function(a,b){return t().useLayoutEffect(a,b)};d.useMemo=function(a,b){return t().useMemo(a,b)};d.useReducer=function(a,b,c){return t().useReducer(a,b,c)};d.useRef=function(a){return t().useRef(a)};d.useState=function(a){return t().useState(a)};d.version="16.14.0"});"use strict";(function(I,ea){"object"===typeof exports&&"undefined"!==typeof module?ea(exports,require("react")):"function"===typeof define&&define.noop?define(["exports","react"],ea):(I=I||self,ea(I.ReactDOM={},I.React))})(this,function(I,ea){function k(a){for(var b="https://reactjs.org/docs/error-decoder.html?invariant="+a,c=1;c<arguments.length;c++)b+="&args[]="+encodeURIComponent(arguments[c]);return"Minified React error #"+a+"; visit "+b+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function ji(a,b,c,d,e,f,g,h,m){yb=!1;gc=null;ki.apply(li,arguments)}function mi(a,b,c,d,e,f,g,h,m){ji.apply(this,arguments);if(yb){if(yb){var n=gc;yb=!1;gc=null}else throw Error(k(198));hc||(hc=!0,pd=n)}}function lf(a,b,c){var d=a.type||"unknown-event";a.currentTarget=mf(c);mi(d,b,void 0,a);a.currentTarget=null}function nf(){if(ic)for(var a in cb){var b=cb[a],c=ic.indexOf(a);if(!(-1<c))throw Error(k(96,a));if(!jc[c]){if(!b.extractEvents)throw Error(k(97,a));jc[c]=b;c=b.eventTypes;for(var d in c){var e=void 0;var f=c[d],g=b,h=d;if(qd.hasOwnProperty(h))throw Error(k(99,h));qd[h]=f;var m=f.phasedRegistrationNames;if(m){for(e in m)m.hasOwnProperty(e)&&of(m[e],g,h);e=!0}else f.registrationName?(of(f.registrationName,g,h),e=!0):e=!1;if(!e)throw Error(k(98,d,a))}}}}function of(a,b,c){if(db[a])throw Error(k(100,a));db[a]=b;rd[a]=b.eventTypes[c].dependencies}function pf(a){var b=!1,c;for(c in a)if(a.hasOwnProperty(c)){var d=a[c];if(!cb.hasOwnProperty(c)||cb[c]!==d){if(cb[c])throw Error(k(102,c));cb[c]=d;b=!0}}b&&nf()}function qf(a){if(a=rf(a)){if("function"!==typeof sd)throw Error(k(280));var b=a.stateNode;b&&(b=td(b),sd(a.stateNode,a.type,b))}}function sf(a){eb?fb?fb.push(a):fb=[a]:eb=a}function tf(){if(eb){var a=eb,b=fb;fb=eb=null;qf(a);if(b)for(a=0;a<b.length;a++)qf(b[a])}}function ud(){if(null!==eb||null!==fb)vd(),tf()}function uf(a,b,c){if(wd)return a(b,c);wd=!0;try{return vf(a,b,c)}finally{wd=!1,ud()}}function ni(a){if(wf.call(xf,a))return!0;if(wf.call(yf,a))return!1;if(oi.test(a))return xf[a]=!0;yf[a]=!0;return!1}function pi(a,b,c,d){if(null!==c&&0===c.type)return!1;switch(typeof b){case"function":case"symbol":return!0;case"boolean":if(d)return!1;if(null!==c)return!c.acceptsBooleans;a=a.toLowerCase().slice(0,5);return"data-"!==a&&"aria-"!==a;default:return!1;}}function qi(a,b,c,d){if(null===b||"undefined"===typeof b||pi(a,b,c,d))return!0;if(d)return!1;if(null!==c)switch(c.type){case 3:return!b;case 4:return!1===b;case 5:return isNaN(b);case 6:return isNaN(b)||1>b;}return!1}function L(a,b,c,d,e,f){this.acceptsBooleans=2===b||3===b||4===b;this.attributeName=d;this.attributeNamespace=e;this.mustUseProperty=c;this.propertyName=a;this.type=b;this.sanitizeURL=f}function xd(a,b,c,d){var e=E.hasOwnProperty(b)?E[b]:null;var f=null!==e?0===e.type:d?!1:!(2<b.length)||"o"!==b[0]&&"O"!==b[0]||"n"!==b[1]&&"N"!==b[1]?!1:!0;f||(qi(b,c,e,d)&&(c=null),d||null===e?ni(b)&&(null===c?a.removeAttribute(b):a.setAttribute(b,""+c)):e.mustUseProperty?a[e.propertyName]=null===c?3===e.type?!1:"":c:(b=e.attributeName,d=e.attributeNamespace,null===c?a.removeAttribute(b):(e=e.type,c=3===e||4===e&&!0===c?"":""+c,d?a.setAttributeNS(d,b,c):a.setAttribute(b,c))))}function zb(a){if(null===a||"object"!==typeof a)return null;a=zf&&a[zf]||a["@@iterator"];return"function"===typeof a?a:null}function ri(a){if(-1===a._status){a._status=0;var b=a._ctor;b=b();a._result=b;b.then(function(b){0===a._status&&(b=b.default,a._status=1,a._result=b)},function(b){0===a._status&&(a._status=2,a._result=b)})}}function na(a){if(null==a)return null;if("function"===typeof a)return a.displayName||a.name||null;if("string"===typeof a)return a;switch(a){case Ma:return"Fragment";case gb:return"Portal";case kc:return"Profiler";case Af:return"StrictMode";case lc:return"Suspense";case yd:return"SuspenseList";}if("object"===typeof a)switch(a.$$typeof){case Bf:return"Context.Consumer";case Cf:return"Context.Provider";case zd:var b=a.render;b=b.displayName||b.name||"";return a.displayName||(""!==b?"ForwardRef("+b+")":"ForwardRef");case Ad:return na(a.type);case Df:return na(a.render);case Ef:if(a=1===a._status?a._result:null)return na(a);}return null}function Bd(a){var b="";do{a:switch(a.tag){case 3:case 4:case 6:case 7:case 10:case 9:var c="";break a;default:var d=a._debugOwner,e=a._debugSource,f=na(a.type);c=null;d&&(c=na(d.type));d=f;f="";e?f=" (at "+e.fileName.replace(si,"")+":"+e.lineNumber+")":c&&(f=" (created by "+c+")");c="\n    in "+(d||"Unknown")+f;}b+=c;a=a.return}while(a);return b}function va(a){switch(typeof a){case"boolean":case"number":case"object":case"string":case"undefined":return a;default:return"";}}function Ff(a){var b=a.type;return(a=a.nodeName)&&"input"===a.toLowerCase()&&("checkbox"===b||"radio"===b)}function ti(a){var b=Ff(a)?"checked":"value",c=Object.getOwnPropertyDescriptor(a.constructor.prototype,b),d=""+a[b];if(!a.hasOwnProperty(b)&&"undefined"!==typeof c&&"function"===typeof c.get&&"function"===typeof c.set){var e=c.get,f=c.set;Object.defineProperty(a,b,{configurable:!0,get:function(){return e.call(this)},set:function(a){d=""+a;f.call(this,a)}});Object.defineProperty(a,b,{enumerable:c.enumerable});return{getValue:function(){return d},setValue:function(a){d=""+a},stopTracking:function(){a._valueTracker=null;delete a[b]}}}}function mc(a){a._valueTracker||(a._valueTracker=ti(a))}function Gf(a){if(!a)return!1;var b=a._valueTracker;if(!b)return!0;var c=b.getValue();var d="";a&&(d=Ff(a)?a.checked?"true":"false":a.value);a=d;return a!==c?(b.setValue(a),!0):!1}function Cd(a,b){var c=b.checked;return M({},b,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=c?c:a._wrapperState.initialChecked})}function Hf(a,b){var c=null==b.defaultValue?"":b.defaultValue,d=null!=b.checked?b.checked:b.defaultChecked;c=va(null!=b.value?b.value:c);a._wrapperState={initialChecked:d,initialValue:c,controlled:"checkbox"===b.type||"radio"===b.type?null!=b.checked:null!=b.value}}function If(a,b){b=b.checked;null!=b&&xd(a,"checked",b,!1)}function Dd(a,b){If(a,b);var c=va(b.value),d=b.type;if(null!=c){if("number"===d){if(0===c&&""===a.value||a.value!=c)a.value=""+c}else a.value!==""+c&&(a.value=""+c);}else if("submit"===d||"reset"===d){a.removeAttribute("value");return}b.hasOwnProperty("value")?Ed(a,b.type,c):b.hasOwnProperty("defaultValue")&&Ed(a,b.type,va(b.defaultValue));null==b.checked&&null!=b.defaultChecked&&(a.defaultChecked=!!b.defaultChecked)}function Jf(a,b,c){if(b.hasOwnProperty("value")||b.hasOwnProperty("defaultValue")){var d=b.type;if(!("submit"!==d&&"reset"!==d||void 0!==b.value&&null!==b.value))return;b=""+a._wrapperState.initialValue;c||b===a.value||(a.value=b);a.defaultValue=b}c=a.name;""!==c&&(a.name="");a.defaultChecked=!!a._wrapperState.initialChecked;""!==c&&(a.name=c)}function Ed(a,b,c){if("number"!==b||a.ownerDocument.activeElement!==a)null==c?a.defaultValue=""+a._wrapperState.initialValue:a.defaultValue!==""+c&&(a.defaultValue=""+c)}function ui(a){var b="";ea.Children.forEach(a,function(a){null!=a&&(b+=a)});return b}function Fd(a,b){a=M({children:void 0},b);if(b=ui(b.children))a.children=b;return a}function hb(a,b,c,d){a=a.options;if(b){b={};for(var e=0;e<c.length;e++)b["$"+c[e]]=!0;for(c=0;c<a.length;c++)e=b.hasOwnProperty("$"+a[c].value),a[c].selected!==e&&(a[c].selected=e),e&&d&&(a[c].defaultSelected=!0)}else{c=""+va(c);b=null;for(e=0;e<a.length;e++){if(a[e].value===c){a[e].selected=!0;d&&(a[e].defaultSelected=!0);return}null!==b||a[e].disabled||(b=a[e])}null!==b&&(b.selected=!0)}}function Gd(a,b){if(null!=b.dangerouslySetInnerHTML)throw Error(k(91));return M({},b,{value:void 0,defaultValue:void 0,children:""+a._wrapperState.initialValue})}function Kf(a,b){var c=b.value;if(null==c){c=b.children;b=b.defaultValue;if(null!=c){if(null!=b)throw Error(k(92));if(Array.isArray(c)){if(!(1>=c.length))throw Error(k(93));c=c[0]}b=c}null==b&&(b="");c=b}a._wrapperState={initialValue:va(c)}}function Lf(a,b){var c=va(b.value),d=va(b.defaultValue);null!=c&&(c=""+c,c!==a.value&&(a.value=c),null==b.defaultValue&&a.defaultValue!==c&&(a.defaultValue=c));null!=d&&(a.defaultValue=""+d)}function Mf(a,b){b=a.textContent;b===a._wrapperState.initialValue&&""!==b&&null!==b&&(a.value=b)}function Nf(a){switch(a){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml";}}function Hd(a,b){return null==a||"http://www.w3.org/1999/xhtml"===a?Nf(b):"http://www.w3.org/2000/svg"===a&&"foreignObject"===b?"http://www.w3.org/1999/xhtml":a}function nc(a,b){var c={};c[a.toLowerCase()]=b.toLowerCase();c["Webkit"+a]="webkit"+b;c["Moz"+a]="moz"+b;return c}function oc(a){if(Id[a])return Id[a];if(!ib[a])return a;var b=ib[a],c;for(c in b)if(b.hasOwnProperty(c)&&c in Of)return Id[a]=b[c];return a}function Jd(a){var b=Pf.get(a);void 0===b&&(b=new Map,Pf.set(a,b));return b}function Na(a){var b=a,c=a;if(a.alternate)for(;b.return;)b=b.return;else{a=b;do b=a,0!==(b.effectTag&1026)&&(c=b.return),a=b.return;while(a)}return 3===b.tag?c:null}function Qf(a){if(13===a.tag){var b=a.memoizedState;null===b&&(a=a.alternate,null!==a&&(b=a.memoizedState));if(null!==b)return b.dehydrated}return null}function Rf(a){if(Na(a)!==a)throw Error(k(188))}function vi(a){var b=a.alternate;if(!b){b=Na(a);if(null===b)throw Error(k(188));return b!==a?null:a}for(var c=a,d=b;;){var e=c.return;if(null===e)break;var f=e.alternate;if(null===f){d=e.return;if(null!==d){c=d;continue}break}if(e.child===f.child){for(f=e.child;f;){if(f===c)return Rf(e),a;if(f===d)return Rf(e),b;f=f.sibling}throw Error(k(188))}if(c.return!==d.return)c=e,d=f;else{for(var g=!1,h=e.child;h;){if(h===c){g=!0;c=e;d=f;break}if(h===d){g=!0;d=e;c=f;break}h=h.sibling}if(!g){for(h=f.child;h;){if(h===c){g=!0;c=f;d=e;break}if(h===d){g=!0;d=f;c=e;break}h=h.sibling}if(!g)throw Error(k(189))}}if(c.alternate!==d)throw Error(k(190))}if(3!==c.tag)throw Error(k(188));return c.stateNode.current===c?a:b}function Sf(a){a=vi(a);if(!a)return null;for(var b=a;;){if(5===b.tag||6===b.tag)return b;if(b.child)b.child.return=b,b=b.child;else{if(b===a)break;for(;!b.sibling;){if(!b.return||b.return===a)return null;b=b.return}b.sibling.return=b.return;b=b.sibling}}return null}function jb(a,b){if(null==b)throw Error(k(30));if(null==a)return b;if(Array.isArray(a)){if(Array.isArray(b))return a.push.apply(a,b),a;a.push(b);return a}return Array.isArray(b)?[a].concat(b):[a,b]}function Kd(a,b,c){Array.isArray(a)?a.forEach(b,c):a&&b.call(c,a)}function pc(a){null!==a&&(Ab=jb(Ab,a));a=Ab;Ab=null;if(a){Kd(a,wi);if(Ab)throw Error(k(95));if(hc)throw a=pd,hc=!1,pd=null,a}}function Ld(a){a=a.target||a.srcElement||window;a.correspondingUseElement&&(a=a.correspondingUseElement);return 3===a.nodeType?a.parentNode:a}function Tf(a){if(!wa)return!1;a="on"+a;var b=(a in document);b||(b=document.createElement("div"),b.setAttribute(a,"return;"),b="function"===typeof b[a]);return b}function Uf(a){a.topLevelType=null;a.nativeEvent=null;a.targetInst=null;a.ancestors.length=0;10>qc.length&&qc.push(a)}function Vf(a,b,c,d){if(qc.length){var e=qc.pop();e.topLevelType=a;e.eventSystemFlags=d;e.nativeEvent=b;e.targetInst=c;return e}return{topLevelType:a,eventSystemFlags:d,nativeEvent:b,targetInst:c,ancestors:[]}}function Wf(a){var b=a.targetInst,c=b;do{if(!c){a.ancestors.push(c);break}var d=c;if(3===d.tag)d=d.stateNode.containerInfo;else{for(;d.return;)d=d.return;d=3!==d.tag?null:d.stateNode.containerInfo}if(!d)break;b=c.tag;5!==b&&6!==b||a.ancestors.push(c);c=Bb(d)}while(c);for(c=0;c<a.ancestors.length;c++){b=a.ancestors[c];var e=Ld(a.nativeEvent);d=a.topLevelType;var f=a.nativeEvent,g=a.eventSystemFlags;0===c&&(g|=64);for(var h=null,m=0;m<jc.length;m++){var n=jc[m];n&&(n=n.extractEvents(d,b,f,e,g))&&(h=jb(h,n))}pc(h)}}function Md(a,b,c){if(!c.has(a)){switch(a){case"scroll":Cb(b,"scroll",!0);break;case"focus":case"blur":Cb(b,"focus",!0);Cb(b,"blur",!0);c.set("blur",null);c.set("focus",null);break;case"cancel":case"close":Tf(a)&&Cb(b,a,!0);break;case"invalid":case"submit":case"reset":break;default:-1===Db.indexOf(a)&&w(a,b);}c.set(a,null)}}function xi(a,b){var c=Jd(b);Nd.forEach(function(a){Md(a,b,c)});yi.forEach(function(a){Md(a,b,c)})}function Od(a,b,c,d,e){return{blockedOn:a,topLevelType:b,eventSystemFlags:c|32,nativeEvent:e,container:d}}function Xf(a,b){switch(a){case"focus":case"blur":xa=null;break;case"dragenter":case"dragleave":ya=null;break;case"mouseover":case"mouseout":za=null;break;case"pointerover":case"pointerout":Eb.delete(b.pointerId);break;case"gotpointercapture":case"lostpointercapture":Fb.delete(b.pointerId);}}function Gb(a,b,c,d,e,f){if(null===a||a.nativeEvent!==f)return a=Od(b,c,d,e,f),null!==b&&(b=Hb(b),null!==b&&Yf(b)),a;a.eventSystemFlags|=d;return a}function zi(a,b,c,d,e){switch(b){case"focus":return xa=Gb(xa,a,b,c,d,e),!0;case"dragenter":return ya=Gb(ya,a,b,c,d,e),!0;case"mouseover":return za=Gb(za,a,b,c,d,e),!0;case"pointerover":var f=e.pointerId;Eb.set(f,Gb(Eb.get(f)||null,a,b,c,d,e));return!0;case"gotpointercapture":return f=e.pointerId,Fb.set(f,Gb(Fb.get(f)||null,a,b,c,d,e)),!0;}return!1}function Ai(a){var b=Bb(a.target);if(null!==b){var c=Na(b);if(null!==c)if(b=c.tag,13===b){if(b=Qf(c),null!==b){a.blockedOn=b;Pd(a.priority,function(){Bi(c)});return}}else if(3===b&&c.stateNode.hydrate){a.blockedOn=3===c.tag?c.stateNode.containerInfo:null;return}}a.blockedOn=null}function rc(a){if(null!==a.blockedOn)return!1;var b=Qd(a.topLevelType,a.eventSystemFlags,a.container,a.nativeEvent);if(null!==b){var c=Hb(b);null!==c&&Yf(c);a.blockedOn=b;return!1}return!0}function Zf(a,b,c){rc(a)&&c.delete(b)}function Ci(){for(Rd=!1;0<fa.length;){var a=fa[0];if(null!==a.blockedOn){a=Hb(a.blockedOn);null!==a&&Di(a);break}var b=Qd(a.topLevelType,a.eventSystemFlags,a.container,a.nativeEvent);null!==b?a.blockedOn=b:fa.shift()}null!==xa&&rc(xa)&&(xa=null);null!==ya&&rc(ya)&&(ya=null);null!==za&&rc(za)&&(za=null);Eb.forEach(Zf);Fb.forEach(Zf)}function Ib(a,b){a.blockedOn===b&&(a.blockedOn=null,Rd||(Rd=!0,$f(ag,Ci)))}function bg(a){if(0<fa.length){Ib(fa[0],a);for(var b=1;b<fa.length;b++){var c=fa[b];c.blockedOn===a&&(c.blockedOn=null)}}null!==xa&&Ib(xa,a);null!==ya&&Ib(ya,a);null!==za&&Ib(za,a);b=function(b){return Ib(b,a)};Eb.forEach(b);Fb.forEach(b);for(b=0;b<Jb.length;b++)c=Jb[b],c.blockedOn===a&&(c.blockedOn=null);for(;0<Jb.length&&(b=Jb[0],null===b.blockedOn);)Ai(b),null===b.blockedOn&&Jb.shift()}function Sd(a,b){for(var c=0;c<a.length;c+=2){var d=a[c],e=a[c+1],f="on"+(e[0].toUpperCase()+e.slice(1));f={phasedRegistrationNames:{bubbled:f,captured:f+"Capture"},dependencies:[d],eventPriority:b};Td.set(d,b);cg.set(d,f);dg[e]=f}}function w(a,b){Cb(b,a,!1)}function Cb(a,b,c){var d=Td.get(b);switch(void 0===d?2:d){case 0:d=Ei.bind(null,b,1,a);break;case 1:d=Fi.bind(null,b,1,a);break;default:d=sc.bind(null,b,1,a);}c?a.addEventListener(b,d,!0):a.addEventListener(b,d,!1)}function Ei(a,b,c,d){Oa||vd();var e=sc,f=Oa;Oa=!0;try{eg(e,a,b,c,d)}finally{(Oa=f)||ud()}}function Fi(a,b,c,d){Gi(Hi,sc.bind(null,a,b,c,d))}function sc(a,b,c,d){if(tc)if(0<fa.length&&-1<Nd.indexOf(a))a=Od(null,a,b,c,d),fa.push(a);else{var e=Qd(a,b,c,d);if(null===e)Xf(a,d);else if(-1<Nd.indexOf(a))a=Od(e,a,b,c,d),fa.push(a);else if(!zi(e,a,b,c,d)){Xf(a,d);a=Vf(a,d,null,b);try{uf(Wf,a)}finally{Uf(a)}}}}function Qd(a,b,c,d){c=Ld(d);c=Bb(c);if(null!==c){var e=Na(c);if(null===e)c=null;else{var f=e.tag;if(13===f){c=Qf(e);if(null!==c)return c;c=null}else if(3===f){if(e.stateNode.hydrate)return 3===e.tag?e.stateNode.containerInfo:null;c=null}else e!==c&&(c=null)}}a=Vf(a,d,c,b);try{uf(Wf,a)}finally{Uf(a)}return null}function fg(a,b,c){return null==b||"boolean"===typeof b||""===b?"":c||"number"!==typeof b||0===b||Kb.hasOwnProperty(a)&&Kb[a]?(""+b).trim():b+"px"}function gg(a,b){a=a.style;for(var c in b)if(b.hasOwnProperty(c)){var d=0===c.indexOf("--"),e=fg(c,b[c],d);"float"===c&&(c="cssFloat");d?a.setProperty(c,e):a[c]=e}}function Ud(a,b){if(b){if(Ii[a]&&(null!=b.children||null!=b.dangerouslySetInnerHTML))throw Error(k(137,a,""));if(null!=b.dangerouslySetInnerHTML){if(null!=b.children)throw Error(k(60));if(!("object"===typeof b.dangerouslySetInnerHTML&&"__html"in b.dangerouslySetInnerHTML))throw Error(k(61))}if(null!=b.style&&"object"!==typeof b.style)throw Error(k(62,""))}}function Vd(a,b){if(-1===a.indexOf("-"))return"string"===typeof b.is;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0;}}function oa(a,b){a=9===a.nodeType||11===a.nodeType?a:a.ownerDocument;var c=Jd(a);b=rd[b];for(var d=0;d<b.length;d++)Md(b[d],a,c)}function uc(){}function Wd(a){a=a||("undefined"!==typeof document?document:void 0);if("undefined"===typeof a)return null;try{return a.activeElement||a.body}catch(b){return a.body}}function hg(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function ig(a,b){var c=hg(a);a=0;for(var d;c;){if(3===c.nodeType){d=a+c.textContent.length;if(a<=b&&d>=b)return{node:c,offset:b-a};a=d}a:{for(;c;){if(c.nextSibling){c=c.nextSibling;break a}c=c.parentNode}c=void 0}c=hg(c)}}function jg(a,b){return a&&b?a===b?!0:a&&3===a.nodeType?!1:b&&3===b.nodeType?jg(a,b.parentNode):"contains"in a?a.contains(b):a.compareDocumentPosition?!!(a.compareDocumentPosition(b)&16):!1:!1}function kg(){for(var a=window,b=Wd();b instanceof a.HTMLIFrameElement;){try{var c="string"===typeof b.contentWindow.location.href}catch(d){c=!1}if(c)a=b.contentWindow;else break;b=Wd(a.document)}return b}function Xd(a){var b=a&&a.nodeName&&a.nodeName.toLowerCase();return b&&("input"===b&&("text"===a.type||"search"===a.type||"tel"===a.type||"url"===a.type||"password"===a.type)||"textarea"===b||"true"===a.contentEditable)}function lg(a,b){switch(a){case"button":case"input":case"select":case"textarea":return!!b.autoFocus;}return!1}function Yd(a,b){return"textarea"===a||"option"===a||"noscript"===a||"string"===typeof b.children||"number"===typeof b.children||"object"===typeof b.dangerouslySetInnerHTML&&null!==b.dangerouslySetInnerHTML&&null!=b.dangerouslySetInnerHTML.__html}function kb(a){for(;null!=a;a=a.nextSibling){var b=a.nodeType;if(1===b||3===b)break}return a}function mg(a){a=a.previousSibling;for(var b=0;a;){if(8===a.nodeType){var c=a.data;if(c===ng||c===Zd||c===$d){if(0===b)return a;b--}else c===og&&b++}a=a.previousSibling}return null}function Bb(a){var b=a[Aa];if(b)return b;for(var c=a.parentNode;c;){if(b=c[Lb]||c[Aa]){c=b.alternate;if(null!==b.child||null!==c&&null!==c.child)for(a=mg(a);null!==a;){if(c=a[Aa])return c;a=mg(a)}return b}a=c;c=a.parentNode}return null}function Hb(a){a=a[Aa]||a[Lb];return!a||5!==a.tag&&6!==a.tag&&13!==a.tag&&3!==a.tag?null:a}function Pa(a){if(5===a.tag||6===a.tag)return a.stateNode;throw Error(k(33))}function ae(a){return a[vc]||null}function pa(a){do a=a.return;while(a&&5!==a.tag);return a?a:null}function pg(a,b){var c=a.stateNode;if(!c)return null;var d=td(c);if(!d)return null;c=d[b];a:switch(b){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(a=a.type,d=!("button"===a||"input"===a||"select"===a||"textarea"===a));a=!d;break a;default:a=!1;}if(a)return null;if(c&&"function"!==typeof c)throw Error(k(231,b,typeof c));return c}function qg(a,b,c){if(b=pg(a,c.dispatchConfig.phasedRegistrationNames[b]))c._dispatchListeners=jb(c._dispatchListeners,b),c._dispatchInstances=jb(c._dispatchInstances,a)}function Ji(a){if(a&&a.dispatchConfig.phasedRegistrationNames){for(var b=a._targetInst,c=[];b;)c.push(b),b=pa(b);for(b=c.length;0<b--;)qg(c[b],"captured",a);for(b=0;b<c.length;b++)qg(c[b],"bubbled",a)}}function be(a,b,c){a&&c&&c.dispatchConfig.registrationName&&(b=pg(a,c.dispatchConfig.registrationName))&&(c._dispatchListeners=jb(c._dispatchListeners,b),c._dispatchInstances=jb(c._dispatchInstances,a))}function Ki(a){a&&a.dispatchConfig.registrationName&&be(a._targetInst,null,a)}function lb(a){Kd(a,Ji)}function rg(){if(wc)return wc;var a,b=ce,c=b.length,d,e="value"in Ba?Ba.value:Ba.textContent,f=e.length;for(a=0;a<c&&b[a]===e[a];a++);var g=c-a;for(d=1;d<=g&&b[c-d]===e[f-d];d++);return wc=e.slice(a,1<d?1-d:void 0)}function xc(){return!0}function yc(){return!1}function R(a,b,c,d){this.dispatchConfig=a;this._targetInst=b;this.nativeEvent=c;a=this.constructor.Interface;for(var e in a)a.hasOwnProperty(e)&&((b=a[e])?this[e]=b(c):"target"===e?this.target=d:this[e]=c[e]);this.isDefaultPrevented=(null!=c.defaultPrevented?c.defaultPrevented:!1===c.returnValue)?xc:yc;this.isPropagationStopped=yc;return this}function Li(a,b,c,d){if(this.eventPool.length){var e=this.eventPool.pop();this.call(e,a,b,c,d);return e}return new this(a,b,c,d)}function Mi(a){if(!(a instanceof this))throw Error(k(279));a.destructor();10>this.eventPool.length&&this.eventPool.push(a)}function sg(a){a.eventPool=[];a.getPooled=Li;a.release=Mi}function tg(a,b){switch(a){case"keyup":return-1!==Ni.indexOf(b.keyCode);case"keydown":return 229!==b.keyCode;case"keypress":case"mousedown":case"blur":return!0;default:return!1;}}function ug(a){a=a.detail;return"object"===typeof a&&"data"in a?a.data:null}function Oi(a,b){switch(a){case"compositionend":return ug(b);case"keypress":if(32!==b.which)return null;vg=!0;return wg;case"textInput":return a=b.data,a===wg&&vg?null:a;default:return null;}}function Pi(a,b){if(mb)return"compositionend"===a||!de&&tg(a,b)?(a=rg(),wc=ce=Ba=null,mb=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(b.ctrlKey||b.altKey||b.metaKey)||b.ctrlKey&&b.altKey){if(b.char&&1<b.char.length)return b.char;if(b.which)return String.fromCharCode(b.which)}return null;case"compositionend":return xg&&"ko"!==b.locale?null:b.data;default:return null;}}function yg(a){var b=a&&a.nodeName&&a.nodeName.toLowerCase();return"input"===b?!!Qi[a.type]:"textarea"===b?!0:!1}function zg(a,b,c){a=R.getPooled(Ag.change,a,b,c);a.type="change";sf(c);lb(a);return a}function Ri(a){pc(a)}function zc(a){var b=Pa(a);if(Gf(b))return a}function Si(a,b){if("change"===a)return b}function Bg(){Mb&&(Mb.detachEvent("onpropertychange",Cg),Nb=Mb=null)}function Cg(a){if("value"===a.propertyName&&zc(Nb))if(a=zg(Nb,a,Ld(a)),Oa)pc(a);else{Oa=!0;try{ee(Ri,a)}finally{Oa=!1,ud()}}}function Ti(a,b,c){"focus"===a?(Bg(),Mb=b,Nb=c,Mb.attachEvent("onpropertychange",Cg)):"blur"===a&&Bg()}function Ui(a,b){if("selectionchange"===a||"keyup"===a||"keydown"===a)return zc(Nb)}function Vi(a,b){if("click"===a)return zc(b)}function Wi(a,b){if("input"===a||"change"===a)return zc(b)}function Xi(a){var b=this.nativeEvent;return b.getModifierState?b.getModifierState(a):(a=Yi[a])?!!b[a]:!1}function fe(a){return Xi}function Zi(a,b){return a===b&&(0!==a||1/a===1/b)||a!==a&&b!==b}function Ob(a,b){if(Qa(a,b))return!0;if("object"!==typeof a||null===a||"object"!==typeof b||null===b)return!1;var c=Object.keys(a),d=Object.keys(b);if(c.length!==d.length)return!1;for(d=0;d<c.length;d++)if(!$i.call(b,c[d])||!Qa(a[c[d]],b[c[d]]))return!1;return!0}function Dg(a,b){var c=b.window===b?b.document:9===b.nodeType?b:b.ownerDocument;if(ge||null==nb||nb!==Wd(c))return null;c=nb;"selectionStart"in c&&Xd(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset});return Pb&&Ob(Pb,c)?null:(Pb=c,a=R.getPooled(Eg.select,he,a,b),a.type="select",a.target=nb,lb(a),a)}function Ac(a){var b=a.keyCode;"charCode"in a?(a=a.charCode,0===a&&13===b&&(a=13)):a=b;10===a&&(a=13);return 32<=a||13===a?a:0}function q(a,b){0>ob||(a.current=ie[ob],ie[ob]=null,ob--)}function y(a,b,c){ob++;ie[ob]=a.current;a.current=b}function pb(a,b){var c=a.type.contextTypes;if(!c)return Ca;var d=a.stateNode;if(d&&d.__reactInternalMemoizedUnmaskedChildContext===b)return d.__reactInternalMemoizedMaskedChildContext;var e={},f;for(f in c)e[f]=b[f];d&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=b,a.__reactInternalMemoizedMaskedChildContext=e);return e}function N(a){a=a.childContextTypes;return null!==a&&void 0!==a}function Fg(a,b,c){if(B.current!==Ca)throw Error(k(168));y(B,b);y(G,c)}function Gg(a,b,c){var d=a.stateNode;a=b.childContextTypes;if("function"!==typeof d.getChildContext)return c;d=d.getChildContext();for(var e in d)if(!(e in a))throw Error(k(108,na(b)||"Unknown",e));return M({},c,{},d)}function Bc(a){a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||Ca;Ra=B.current;y(B,a);y(G,G.current);return!0}function Hg(a,b,c){var d=a.stateNode;if(!d)throw Error(k(169));c?(a=Gg(a,b,Ra),d.__reactInternalMemoizedMergedChildContext=a,q(G),q(B),y(B,a)):q(G);y(G,c)}function Cc(){switch(aj()){case Dc:return 99;case Ig:return 98;case Jg:return 97;case Kg:return 96;case Lg:return 95;default:throw Error(k(332));}}function Mg(a){switch(a){case 99:return Dc;case 98:return Ig;case 97:return Jg;case 96:return Kg;case 95:return Lg;default:throw Error(k(332));}}function Da(a,b){a=Mg(a);return bj(a,b)}function Ng(a,b,c){a=Mg(a);return je(a,b,c)}function Og(a){null===qa?(qa=[a],Ec=je(Dc,Pg)):qa.push(a);return Qg}function ha(){if(null!==Ec){var a=Ec;Ec=null;Rg(a)}Pg()}function Pg(){if(!ke&&null!==qa){ke=!0;var a=0;try{var b=qa;Da(99,function(){for(;a<b.length;a++){var c=b[a];do c=c(!0);while(null!==c)}});qa=null}catch(c){throw null!==qa&&(qa=qa.slice(a+1)),je(Dc,ha),c}finally{ke=!1}}}function Fc(a,b,c){c/=10;return 1073741821-(((1073741821-a+b/10)/c|0)+1)*c}function aa(a,b){if(a&&a.defaultProps){b=M({},b);a=a.defaultProps;for(var c in a)void 0===b[c]&&(b[c]=a[c])}return b}function le(){Gc=qb=Hc=null}function me(a){var b=Ic.current;q(Ic);a.type._context._currentValue=b}function Sg(a,b){for(;null!==a;){var c=a.alternate;if(a.childExpirationTime<b)a.childExpirationTime=b,null!==c&&c.childExpirationTime<b&&(c.childExpirationTime=b);else if(null!==c&&c.childExpirationTime<b)c.childExpirationTime=b;else break;a=a.return}}function rb(a,b){Hc=a;Gc=qb=null;a=a.dependencies;null!==a&&null!==a.firstContext&&(a.expirationTime>=b&&(ia=!0),a.firstContext=null)}function W(a,b){if(Gc!==a&&!1!==b&&0!==b){if("number"!==typeof b||1073741823===b)Gc=a,b=1073741823;b={context:a,observedBits:b,next:null};if(null===qb){if(null===Hc)throw Error(k(308));qb=b;Hc.dependencies={expirationTime:0,firstContext:b,responders:null}}else qb=qb.next=b}return a._currentValue}function ne(a){a.updateQueue={baseState:a.memoizedState,baseQueue:null,shared:{pending:null},effects:null}}function oe(a,b){a=a.updateQueue;b.updateQueue===a&&(b.updateQueue={baseState:a.baseState,baseQueue:a.baseQueue,shared:a.shared,effects:a.effects})}function Ea(a,b){a={expirationTime:a,suspenseConfig:b,tag:Tg,payload:null,callback:null,next:null};return a.next=a}function Fa(a,b){a=a.updateQueue;if(null!==a){a=a.shared;var c=a.pending;null===c?b.next=b:(b.next=c.next,c.next=b);a.pending=b}}function Ug(a,b){var c=a.alternate;null!==c&&oe(c,a);a=a.updateQueue;c=a.baseQueue;null===c?(a.baseQueue=b.next=b,b.next=b):(b.next=c.next,c.next=b)}function Qb(a,b,c,d){var e=a.updateQueue;Ga=!1;var f=e.baseQueue,g=e.shared.pending;if(null!==g){if(null!==f){var h=f.next;f.next=g.next;g.next=h}f=g;e.shared.pending=null;h=a.alternate;null!==h&&(h=h.updateQueue,null!==h&&(h.baseQueue=g))}if(null!==f){h=f.next;var m=e.baseState,n=0,k=null,ba=null,l=null;if(null!==h){var p=h;do{g=p.expirationTime;if(g<d){var t={expirationTime:p.expirationTime,suspenseConfig:p.suspenseConfig,tag:p.tag,payload:p.payload,callback:p.callback,next:null};null===l?(ba=l=t,k=m):l=l.next=t;g>n&&(n=g)}else{null!==l&&(l=l.next={expirationTime:1073741823,suspenseConfig:p.suspenseConfig,tag:p.tag,payload:p.payload,callback:p.callback,next:null});Vg(g,p.suspenseConfig);a:{var q=a,r=p;g=b;t=c;switch(r.tag){case 1:q=r.payload;if("function"===typeof q){m=q.call(t,m,g);break a}m=q;break a;case 3:q.effectTag=q.effectTag&-4097|64;case Tg:q=r.payload;g="function"===typeof q?q.call(t,m,g):q;if(null===g||void 0===g)break a;m=M({},m,g);break a;case Jc:Ga=!0;}}null!==p.callback&&(a.effectTag|=32,g=e.effects,null===g?e.effects=[p]:g.push(p))}p=p.next;if(null===p||p===h)if(g=e.shared.pending,null===g)break;else p=f.next=g.next,g.next=h,e.baseQueue=f=g,e.shared.pending=null}while(1)}null===l?k=m:l.next=ba;e.baseState=k;e.baseQueue=l;Kc(n);a.expirationTime=n;a.memoizedState=m}}function Wg(a,b,c){a=b.effects;b.effects=null;if(null!==a)for(b=0;b<a.length;b++){var d=a[b],e=d.callback;if(null!==e){d.callback=null;d=e;e=c;if("function"!==typeof d)throw Error(k(191,d));d.call(e)}}}function Lc(a,b,c,d){b=a.memoizedState;c=c(d,b);c=null===c||void 0===c?b:M({},b,c);a.memoizedState=c;0===a.expirationTime&&(a.updateQueue.baseState=c)}function Xg(a,b,c,d,e,f,g){a=a.stateNode;return"function"===typeof a.shouldComponentUpdate?a.shouldComponentUpdate(d,f,g):b.prototype&&b.prototype.isPureReactComponent?!Ob(c,d)||!Ob(e,f):!0}function Yg(a,b,c){var d=!1,e=Ca;var f=b.contextType;"object"===typeof f&&null!==f?f=W(f):(e=N(b)?Ra:B.current,d=b.contextTypes,f=(d=null!==d&&void 0!==d)?pb(a,e):Ca);b=new b(c,f);a.memoizedState=null!==b.state&&void 0!==b.state?b.state:null;b.updater=Mc;a.stateNode=b;b._reactInternalFiber=a;d&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=e,a.__reactInternalMemoizedMaskedChildContext=f);return b}function Zg(a,b,c,d){a=b.state;"function"===typeof b.componentWillReceiveProps&&b.componentWillReceiveProps(c,d);"function"===typeof b.UNSAFE_componentWillReceiveProps&&b.UNSAFE_componentWillReceiveProps(c,d);b.state!==a&&Mc.enqueueReplaceState(b,b.state,null)}function pe(a,b,c,d){var e=a.stateNode;e.props=c;e.state=a.memoizedState;e.refs=$g;ne(a);var f=b.contextType;"object"===typeof f&&null!==f?e.context=W(f):(f=N(b)?Ra:B.current,e.context=pb(a,f));Qb(a,c,e,d);e.state=a.memoizedState;f=b.getDerivedStateFromProps;"function"===typeof f&&(Lc(a,b,f,c),e.state=a.memoizedState);"function"===typeof b.getDerivedStateFromProps||"function"===typeof e.getSnapshotBeforeUpdate||"function"!==typeof e.UNSAFE_componentWillMount&&"function"!==typeof e.componentWillMount||(b=e.state,"function"===typeof e.componentWillMount&&e.componentWillMount(),"function"===typeof e.UNSAFE_componentWillMount&&e.UNSAFE_componentWillMount(),b!==e.state&&Mc.enqueueReplaceState(e,e.state,null),Qb(a,c,e,d),e.state=a.memoizedState);"function"===typeof e.componentDidMount&&(a.effectTag|=4)}function Rb(a,b,c){a=c.ref;if(null!==a&&"function"!==typeof a&&"object"!==typeof a){if(c._owner){c=c._owner;if(c){if(1!==c.tag)throw Error(k(309));var d=c.stateNode}if(!d)throw Error(k(147,a));var e=""+a;if(null!==b&&null!==b.ref&&"function"===typeof b.ref&&b.ref._stringRef===e)return b.ref;b=function(a){var b=d.refs;b===$g&&(b=d.refs={});null===a?delete b[e]:b[e]=a};b._stringRef=e;return b}if("string"!==typeof a)throw Error(k(284));if(!c._owner)throw Error(k(290,a))}return a}function Nc(a,b){if("textarea"!==a.type)throw Error(k(31,"[object Object]"===Object.prototype.toString.call(b)?"object with keys {"+Object.keys(b).join(", ")+"}":b,""))}function ah(a){function b(b,c){if(a){var d=b.lastEffect;null!==d?(d.nextEffect=c,b.lastEffect=c):b.firstEffect=b.lastEffect=c;c.nextEffect=null;c.effectTag=8}}function c(c,d){if(!a)return null;for(;null!==d;)b(c,d),d=d.sibling;return null}function d(a,b){for(a=new Map;null!==b;)null!==b.key?a.set(b.key,b):a.set(b.index,b),b=b.sibling;return a}function e(a,b){a=Sa(a,b);a.index=0;a.sibling=null;return a}function f(b,c,d){b.index=d;if(!a)return c;d=b.alternate;if(null!==d)return d=d.index,d<c?(b.effectTag=2,c):d;b.effectTag=2;return c}function g(b){a&&null===b.alternate&&(b.effectTag=2);return b}function h(a,b,c,d){if(null===b||6!==b.tag)return b=qe(c,a.mode,d),b.return=a,b;b=e(b,c);b.return=a;return b}function m(a,b,c,d){if(null!==b&&b.elementType===c.type)return d=e(b,c.props),d.ref=Rb(a,b,c),d.return=a,d;d=Oc(c.type,c.key,c.props,null,a.mode,d);d.ref=Rb(a,b,c);d.return=a;return d}function n(a,b,c,d){if(null===b||4!==b.tag||b.stateNode.containerInfo!==c.containerInfo||b.stateNode.implementation!==c.implementation)return b=re(c,a.mode,d),b.return=a,b;b=e(b,c.children||[]);b.return=a;return b}function l(a,b,c,d,f){if(null===b||7!==b.tag)return b=Ha(c,a.mode,d,f),b.return=a,b;b=e(b,c);b.return=a;return b}function ba(a,b,c){if("string"===typeof b||"number"===typeof b)return b=qe(""+b,a.mode,c),b.return=a,b;if("object"===typeof b&&null!==b){switch(b.$$typeof){case Pc:return c=Oc(b.type,b.key,b.props,null,a.mode,c),c.ref=Rb(a,null,b),c.return=a,c;case gb:return b=re(b,a.mode,c),b.return=a,b;}if(Qc(b)||zb(b))return b=Ha(b,a.mode,c,null),b.return=a,b;Nc(a,b)}return null}function p(a,b,c,d){var e=null!==b?b.key:null;if("string"===typeof c||"number"===typeof c)return null!==e?null:h(a,b,""+c,d);if("object"===typeof c&&null!==c){switch(c.$$typeof){case Pc:return c.key===e?c.type===Ma?l(a,b,c.props.children,d,e):m(a,b,c,d):null;case gb:return c.key===e?n(a,b,c,d):null;}if(Qc(c)||zb(c))return null!==e?null:l(a,b,c,d,null);Nc(a,c)}return null}function t(a,b,c,d,e){if("string"===typeof d||"number"===typeof d)return a=a.get(c)||null,h(b,a,""+d,e);if("object"===typeof d&&null!==d){switch(d.$$typeof){case Pc:return a=a.get(null===d.key?c:d.key)||null,d.type===Ma?l(b,a,d.props.children,e,d.key):m(b,a,d,e);case gb:return a=a.get(null===d.key?c:d.key)||null,n(b,a,d,e);}if(Qc(d)||zb(d))return a=a.get(c)||null,l(b,a,d,e,null);Nc(b,d)}return null}function q(e,g,h,m){for(var n=null,k=null,l=g,r=g=0,C=null;null!==l&&r<h.length;r++){l.index>r?(C=l,l=null):C=l.sibling;var O=p(e,l,h[r],m);if(null===O){null===l&&(l=C);break}a&&l&&null===O.alternate&&b(e,l);g=f(O,g,r);null===k?n=O:k.sibling=O;k=O;l=C}if(r===h.length)return c(e,l),n;if(null===l){for(;r<h.length;r++)l=ba(e,h[r],m),null!==l&&(g=f(l,g,r),null===k?n=l:k.sibling=l,k=l);return n}for(l=d(e,l);r<h.length;r++)C=t(l,e,r,h[r],m),null!==C&&(a&&null!==C.alternate&&l.delete(null===C.key?r:C.key),g=f(C,g,r),null===k?n=C:k.sibling=C,k=C);a&&l.forEach(function(a){return b(e,a)});return n}function w(e,g,h,n){var m=zb(h);if("function"!==typeof m)throw Error(k(150));h=m.call(h);if(null==h)throw Error(k(151));for(var l=m=null,r=g,C=g=0,O=null,v=h.next();null!==r&&!v.done;C++,v=h.next()){r.index>C?(O=r,r=null):O=r.sibling;var q=p(e,r,v.value,n);if(null===q){null===r&&(r=O);break}a&&r&&null===q.alternate&&b(e,r);g=f(q,g,C);null===l?m=q:l.sibling=q;l=q;r=O}if(v.done)return c(e,r),m;if(null===r){for(;!v.done;C++,v=h.next())v=ba(e,v.value,n),null!==v&&(g=f(v,g,C),null===l?m=v:l.sibling=v,l=v);return m}for(r=d(e,r);!v.done;C++,v=h.next())v=t(r,e,C,v.value,n),null!==v&&(a&&null!==v.alternate&&r.delete(null===v.key?C:v.key),g=f(v,g,C),null===l?m=v:l.sibling=v,l=v);a&&r.forEach(function(a){return b(e,a)});return m}return function(a,d,f,h){var m="object"===typeof f&&null!==f&&f.type===Ma&&null===f.key;m&&(f=f.props.children);var n="object"===typeof f&&null!==f;if(n)switch(f.$$typeof){case Pc:a:{n=f.key;for(m=d;null!==m;){if(m.key===n){switch(m.tag){case 7:if(f.type===Ma){c(a,m.sibling);d=e(m,f.props.children);d.return=a;a=d;break a}break;default:if(m.elementType===f.type){c(a,m.sibling);d=e(m,f.props);d.ref=Rb(a,m,f);d.return=a;a=d;break a}}c(a,m);break}else b(a,m);m=m.sibling}f.type===Ma?(d=Ha(f.props.children,a.mode,h,f.key),d.return=a,a=d):(h=Oc(f.type,f.key,f.props,null,a.mode,h),h.ref=Rb(a,d,f),h.return=a,a=h)}return g(a);case gb:a:{for(m=f.key;null!==d;){if(d.key===m){if(4===d.tag&&d.stateNode.containerInfo===f.containerInfo&&d.stateNode.implementation===f.implementation){c(a,d.sibling);d=e(d,f.children||[]);d.return=a;a=d;break a}else{c(a,d);break}}else b(a,d);d=d.sibling}d=re(f,a.mode,h);d.return=a;a=d}return g(a);}if("string"===typeof f||"number"===typeof f)return f=""+f,null!==d&&6===d.tag?(c(a,d.sibling),d=e(d,f),d.return=a,a=d):(c(a,d),d=qe(f,a.mode,h),d.return=a,a=d),g(a);if(Qc(f))return q(a,d,f,h);if(zb(f))return w(a,d,f,h);n&&Nc(a,f);if("undefined"===typeof f&&!m)switch(a.tag){case 1:case 0:throw a=a.type,Error(k(152,a.displayName||a.name||"Component"));}return c(a,d)}}function Ta(a){if(a===Sb)throw Error(k(174));return a}function se(a,b){y(Tb,b);y(Ub,a);y(ja,Sb);a=b.nodeType;switch(a){case 9:case 11:b=(b=b.documentElement)?b.namespaceURI:Hd(null,"");break;default:a=8===a?b.parentNode:b,b=a.namespaceURI||null,a=a.tagName,b=Hd(b,a);}q(ja);y(ja,b)}function tb(a){q(ja);q(Ub);q(Tb)}function bh(a){Ta(Tb.current);var b=Ta(ja.current);var c=Hd(b,a.type);b!==c&&(y(Ub,a),y(ja,c))}function te(a){Ub.current===a&&(q(ja),q(Ub))}function Rc(a){for(var b=a;null!==b;){if(13===b.tag){var c=b.memoizedState;if(null!==c&&(c=c.dehydrated,null===c||c.data===$d||c.data===Zd))return b}else if(19===b.tag&&void 0!==b.memoizedProps.revealOrder){if(0!==(b.effectTag&64))return b}else if(null!==b.child){b.child.return=b;b=b.child;continue}if(b===a)break;for(;null===b.sibling;){if(null===b.return||b.return===a)return null;b=b.return}b.sibling.return=b.return;b=b.sibling}return null}function ue(a,b){return{responder:a,props:b}}function S(){throw Error(k(321))}function ve(a,b){if(null===b)return!1;for(var c=0;c<b.length&&c<a.length;c++)if(!Qa(a[c],b[c]))return!1;return!0}function we(a,b,c,d,e,f){Ia=f;z=b;b.memoizedState=null;b.updateQueue=null;b.expirationTime=0;Sc.current=null===a||null===a.memoizedState?dj:ej;a=c(d,e);if(b.expirationTime===Ia){f=0;do{b.expirationTime=0;if(!(25>f))throw Error(k(301));f+=1;J=K=null;b.updateQueue=null;Sc.current=fj;a=c(d,e)}while(b.expirationTime===Ia)}Sc.current=Tc;b=null!==K&&null!==K.next;Ia=0;J=K=z=null;Uc=!1;if(b)throw Error(k(300));return a}function ub(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};null===J?z.memoizedState=J=a:J=J.next=a;return J}function vb(){if(null===K){var a=z.alternate;a=null!==a?a.memoizedState:null}else a=K.next;var b=null===J?z.memoizedState:J.next;if(null!==b)J=b,K=a;else{if(null===a)throw Error(k(310));K=a;a={memoizedState:K.memoizedState,baseState:K.baseState,baseQueue:K.baseQueue,queue:K.queue,next:null};null===J?z.memoizedState=J=a:J=J.next=a}return J}function Ua(a,b){return"function"===typeof b?b(a):b}function Vc(a,b,c){b=vb();c=b.queue;if(null===c)throw Error(k(311));c.lastRenderedReducer=a;var d=K,e=d.baseQueue,f=c.pending;if(null!==f){if(null!==e){var g=e.next;e.next=f.next;f.next=g}d.baseQueue=e=f;c.pending=null}if(null!==e){e=e.next;d=d.baseState;var h=g=f=null,m=e;do{var n=m.expirationTime;if(n<Ia){var l={expirationTime:m.expirationTime,suspenseConfig:m.suspenseConfig,action:m.action,eagerReducer:m.eagerReducer,eagerState:m.eagerState,next:null};null===h?(g=h=l,f=d):h=h.next=l;n>z.expirationTime&&(z.expirationTime=n,Kc(n))}else null!==h&&(h=h.next={expirationTime:1073741823,suspenseConfig:m.suspenseConfig,action:m.action,eagerReducer:m.eagerReducer,eagerState:m.eagerState,next:null}),Vg(n,m.suspenseConfig),d=m.eagerReducer===a?m.eagerState:a(d,m.action);m=m.next}while(null!==m&&m!==e);null===h?f=d:h.next=g;Qa(d,b.memoizedState)||(ia=!0);b.memoizedState=d;b.baseState=f;b.baseQueue=h;c.lastRenderedState=d}return[b.memoizedState,c.dispatch]}function Wc(a,b,c){b=vb();c=b.queue;if(null===c)throw Error(k(311));c.lastRenderedReducer=a;var d=c.dispatch,e=c.pending,f=b.memoizedState;if(null!==e){c.pending=null;var g=e=e.next;do f=a(f,g.action),g=g.next;while(g!==e);Qa(f,b.memoizedState)||(ia=!0);b.memoizedState=f;null===b.baseQueue&&(b.baseState=f);c.lastRenderedState=f}return[f,d]}function xe(a){var b=ub();"function"===typeof a&&(a=a());b.memoizedState=b.baseState=a;a=b.queue={pending:null,dispatch:null,lastRenderedReducer:Ua,lastRenderedState:a};a=a.dispatch=ch.bind(null,z,a);return[b.memoizedState,a]}function ye(a,b,c,d){a={tag:a,create:b,destroy:c,deps:d,next:null};b=z.updateQueue;null===b?(b={lastEffect:null},z.updateQueue=b,b.lastEffect=a.next=a):(c=b.lastEffect,null===c?b.lastEffect=a.next=a:(d=c.next,c.next=a,a.next=d,b.lastEffect=a));return a}function dh(a){return vb().memoizedState}function ze(a,b,c,d){var e=ub();z.effectTag|=a;e.memoizedState=ye(1|b,c,void 0,void 0===d?null:d)}function Ae(a,b,c,d){var e=vb();d=void 0===d?null:d;var f=void 0;if(null!==K){var g=K.memoizedState;f=g.destroy;if(null!==d&&ve(d,g.deps)){ye(b,c,f,d);return}}z.effectTag|=a;e.memoizedState=ye(1|b,c,f,d)}function eh(a,b){return ze(516,4,a,b)}function Xc(a,b){return Ae(516,4,a,b)}function fh(a,b){return Ae(4,2,a,b)}function gh(a,b){if("function"===typeof b)return a=a(),b(a),function(){b(null)};if(null!==b&&void 0!==b)return a=a(),b.current=a,function(){b.current=null}}function hh(a,b,c){c=null!==c&&void 0!==c?c.concat([a]):null;return Ae(4,2,gh.bind(null,b,a),c)}function Be(a,b){}function ih(a,b){ub().memoizedState=[a,void 0===b?null:b];return a}function Yc(a,b){var c=vb();b=void 0===b?null:b;var d=c.memoizedState;if(null!==d&&null!==b&&ve(b,d[1]))return d[0];c.memoizedState=[a,b];return a}function jh(a,b){var c=vb();b=void 0===b?null:b;var d=c.memoizedState;if(null!==d&&null!==b&&ve(b,d[1]))return d[0];a=a();c.memoizedState=[a,b];return a}function Ce(a,b,c){var d=Cc();Da(98>d?98:d,function(){a(!0)});Da(97<d?97:d,function(){var d=X.suspense;X.suspense=void 0===b?null:b;try{a(!1),c()}finally{X.suspense=d}})}function ch(a,b,c){var d=ka(),e=Vb.suspense;d=Va(d,a,e);e={expirationTime:d,suspenseConfig:e,action:c,eagerReducer:null,eagerState:null,next:null};var f=b.pending;null===f?e.next=e:(e.next=f.next,f.next=e);b.pending=e;f=a.alternate;if(a===z||null!==f&&f===z)Uc=!0,e.expirationTime=Ia,z.expirationTime=Ia;else{if(0===a.expirationTime&&(null===f||0===f.expirationTime)&&(f=b.lastRenderedReducer,null!==f))try{var g=b.lastRenderedState,h=f(g,c);e.eagerReducer=f;e.eagerState=h;if(Qa(h,g))return}catch(m){}finally{}Ja(a,d)}}function kh(a,b){var c=la(5,null,null,0);c.elementType="DELETED";c.type="DELETED";c.stateNode=b;c.return=a;c.effectTag=8;null!==a.lastEffect?(a.lastEffect.nextEffect=c,a.lastEffect=c):a.firstEffect=a.lastEffect=c}function lh(a,b){switch(a.tag){case 5:var c=a.type;b=1!==b.nodeType||c.toLowerCase()!==b.nodeName.toLowerCase()?null:b;return null!==b?(a.stateNode=b,!0):!1;case 6:return b=""===a.pendingProps||3!==b.nodeType?null:b,null!==b?(a.stateNode=b,!0):!1;case 13:return!1;default:return!1;}}function De(a){if(Wa){var b=Ka;if(b){var c=b;if(!lh(a,b)){b=kb(c.nextSibling);if(!b||!lh(a,b)){a.effectTag=a.effectTag&-1025|2;Wa=!1;ra=a;return}kh(ra,c)}ra=a;Ka=kb(b.firstChild)}else a.effectTag=a.effectTag&-1025|2,Wa=!1,ra=a}}function mh(a){for(a=a.return;null!==a&&5!==a.tag&&3!==a.tag&&13!==a.tag;)a=a.return;ra=a}function Zc(a){if(a!==ra)return!1;if(!Wa)return mh(a),Wa=!0,!1;var b=a.type;if(5!==a.tag||"head"!==b&&"body"!==b&&!Yd(b,a.memoizedProps))for(b=Ka;b;)kh(a,b),b=kb(b.nextSibling);mh(a);if(13===a.tag){a=a.memoizedState;a=null!==a?a.dehydrated:null;if(!a)throw Error(k(317));a:{a=a.nextSibling;for(b=0;a;){if(8===a.nodeType){var c=a.data;if(c===og){if(0===b){Ka=kb(a.nextSibling);break a}b--}else c!==ng&&c!==Zd&&c!==$d||b++}a=a.nextSibling}Ka=null}}else Ka=ra?kb(a.stateNode.nextSibling):null;return!0}function Ee(){Ka=ra=null;Wa=!1}function T(a,b,c,d){b.child=null===a?Fe(b,null,c,d):wb(b,a.child,c,d)}function nh(a,b,c,d,e){c=c.render;var f=b.ref;rb(b,e);d=we(a,b,c,d,f,e);if(null!==a&&!ia)return b.updateQueue=a.updateQueue,b.effectTag&=-517,a.expirationTime<=e&&(a.expirationTime=0),sa(a,b,e);b.effectTag|=1;T(a,b,d,e);return b.child}function oh(a,b,c,d,e,f){if(null===a){var g=c.type;if("function"===typeof g&&!Ge(g)&&void 0===g.defaultProps&&null===c.compare&&void 0===c.defaultProps)return b.tag=15,b.type=g,ph(a,b,g,d,e,f);a=Oc(c.type,null,d,null,b.mode,f);a.ref=b.ref;a.return=b;return b.child=a}g=a.child;if(e<f&&(e=g.memoizedProps,c=c.compare,c=null!==c?c:Ob,c(e,d)&&a.ref===b.ref))return sa(a,b,f);b.effectTag|=1;a=Sa(g,d);a.ref=b.ref;a.return=b;return b.child=a}function ph(a,b,c,d,e,f){return null!==a&&Ob(a.memoizedProps,d)&&a.ref===b.ref&&(ia=!1,e<f)?(b.expirationTime=a.expirationTime,sa(a,b,f)):He(a,b,c,d,f)}function qh(a,b){var c=b.ref;if(null===a&&null!==c||null!==a&&a.ref!==c)b.effectTag|=128}function He(a,b,c,d,e){var f=N(c)?Ra:B.current;f=pb(b,f);rb(b,e);c=we(a,b,c,d,f,e);if(null!==a&&!ia)return b.updateQueue=a.updateQueue,b.effectTag&=-517,a.expirationTime<=e&&(a.expirationTime=0),sa(a,b,e);b.effectTag|=1;T(a,b,c,e);return b.child}function rh(a,b,c,d,e){if(N(c)){var f=!0;Bc(b)}else f=!1;rb(b,e);if(null===b.stateNode)null!==a&&(a.alternate=null,b.alternate=null,b.effectTag|=2),Yg(b,c,d),pe(b,c,d,e),d=!0;else if(null===a){var g=b.stateNode,h=b.memoizedProps;g.props=h;var m=g.context,n=c.contextType;"object"===typeof n&&null!==n?n=W(n):(n=N(c)?Ra:B.current,n=pb(b,n));var l=c.getDerivedStateFromProps,k="function"===typeof l||"function"===typeof g.getSnapshotBeforeUpdate;k||"function"!==typeof g.UNSAFE_componentWillReceiveProps&&"function"!==typeof g.componentWillReceiveProps||(h!==d||m!==n)&&Zg(b,g,d,n);Ga=!1;var p=b.memoizedState;g.state=p;Qb(b,d,g,e);m=b.memoizedState;h!==d||p!==m||G.current||Ga?("function"===typeof l&&(Lc(b,c,l,d),m=b.memoizedState),(h=Ga||Xg(b,c,h,d,p,m,n))?(k||"function"!==typeof g.UNSAFE_componentWillMount&&"function"!==typeof g.componentWillMount||("function"===typeof g.componentWillMount&&g.componentWillMount(),"function"===typeof g.UNSAFE_componentWillMount&&g.UNSAFE_componentWillMount()),"function"===typeof g.componentDidMount&&(b.effectTag|=4)):("function"===typeof g.componentDidMount&&(b.effectTag|=4),b.memoizedProps=d,b.memoizedState=m),g.props=d,g.state=m,g.context=n,d=h):("function"===typeof g.componentDidMount&&(b.effectTag|=4),d=!1)}else g=b.stateNode,oe(a,b),h=b.memoizedProps,g.props=b.type===b.elementType?h:aa(b.type,h),m=g.context,n=c.contextType,"object"===typeof n&&null!==n?n=W(n):(n=N(c)?Ra:B.current,n=pb(b,n)),l=c.getDerivedStateFromProps,(k="function"===typeof l||"function"===typeof g.getSnapshotBeforeUpdate)||"function"!==typeof g.UNSAFE_componentWillReceiveProps&&"function"!==typeof g.componentWillReceiveProps||(h!==d||m!==n)&&Zg(b,g,d,n),Ga=!1,m=b.memoizedState,g.state=m,Qb(b,d,g,e),p=b.memoizedState,h!==d||m!==p||G.current||Ga?("function"===typeof l&&(Lc(b,c,l,d),p=b.memoizedState),(l=Ga||Xg(b,c,h,d,m,p,n))?(k||"function"!==typeof g.UNSAFE_componentWillUpdate&&"function"!==typeof g.componentWillUpdate||("function"===typeof g.componentWillUpdate&&g.componentWillUpdate(d,p,n),"function"===typeof g.UNSAFE_componentWillUpdate&&g.UNSAFE_componentWillUpdate(d,p,n)),"function"===typeof g.componentDidUpdate&&(b.effectTag|=4),"function"===typeof g.getSnapshotBeforeUpdate&&(b.effectTag|=256)):("function"!==typeof g.componentDidUpdate||h===a.memoizedProps&&m===a.memoizedState||(b.effectTag|=4),"function"!==typeof g.getSnapshotBeforeUpdate||h===a.memoizedProps&&m===a.memoizedState||(b.effectTag|=256),b.memoizedProps=d,b.memoizedState=p),g.props=d,g.state=p,g.context=n,d=l):("function"!==typeof g.componentDidUpdate||h===a.memoizedProps&&m===a.memoizedState||(b.effectTag|=4),"function"!==typeof g.getSnapshotBeforeUpdate||h===a.memoizedProps&&m===a.memoizedState||(b.effectTag|=256),d=!1);return Ie(a,b,c,d,f,e)}function Ie(a,b,c,d,e,f){qh(a,b);var g=0!==(b.effectTag&64);if(!d&&!g)return e&&Hg(b,c,!1),sa(a,b,f);d=b.stateNode;gj.current=b;var h=g&&"function"!==typeof c.getDerivedStateFromError?null:d.render();b.effectTag|=1;null!==a&&g?(b.child=wb(b,a.child,null,f),b.child=wb(b,null,h,f)):T(a,b,h,f);b.memoizedState=d.state;e&&Hg(b,c,!0);return b.child}function sh(a){var b=a.stateNode;b.pendingContext?Fg(a,b.pendingContext,b.pendingContext!==b.context):b.context&&Fg(a,b.context,!1);se(a,b.containerInfo)}function th(a,b,c){var d=b.mode,e=b.pendingProps,f=D.current,g=!1,h;(h=0!==(b.effectTag&64))||(h=0!==(f&2)&&(null===a||null!==a.memoizedState));h?(g=!0,b.effectTag&=-65):null!==a&&null===a.memoizedState||void 0===e.fallback||!0===e.unstable_avoidThisFallback||(f|=1);y(D,f&1);if(null===a){void 0!==e.fallback&&De(b);if(g){g=e.fallback;e=Ha(null,d,0,null);e.return=b;if(0===(b.mode&2))for(a=null!==b.memoizedState?b.child.child:b.child,e.child=a;null!==a;)a.return=e,a=a.sibling;c=Ha(g,d,c,null);c.return=b;e.sibling=c;b.memoizedState=Je;b.child=e;return c}d=e.children;b.memoizedState=null;return b.child=Fe(b,null,d,c)}if(null!==a.memoizedState){a=a.child;d=a.sibling;if(g){e=e.fallback;c=Sa(a,a.pendingProps);c.return=b;if(0===(b.mode&2)&&(g=null!==b.memoizedState?b.child.child:b.child,g!==a.child))for(c.child=g;null!==g;)g.return=c,g=g.sibling;d=Sa(d,e);d.return=b;c.sibling=d;c.childExpirationTime=0;b.memoizedState=Je;b.child=c;return d}c=wb(b,a.child,e.children,c);b.memoizedState=null;return b.child=c}a=a.child;if(g){g=e.fallback;e=Ha(null,d,0,null);e.return=b;e.child=a;null!==a&&(a.return=e);if(0===(b.mode&2))for(a=null!==b.memoizedState?b.child.child:b.child,e.child=a;null!==a;)a.return=e,a=a.sibling;c=Ha(g,d,c,null);c.return=b;e.sibling=c;c.effectTag|=2;e.childExpirationTime=0;b.memoizedState=Je;b.child=e;return c}b.memoizedState=null;return b.child=wb(b,a,e.children,c)}function uh(a,b){a.expirationTime<b&&(a.expirationTime=b);var c=a.alternate;null!==c&&c.expirationTime<b&&(c.expirationTime=b);Sg(a.return,b)}function Ke(a,b,c,d,e,f){var g=a.memoizedState;null===g?a.memoizedState={isBackwards:b,rendering:null,renderingStartTime:0,last:d,tail:c,tailExpiration:0,tailMode:e,lastEffect:f}:(g.isBackwards=b,g.rendering=null,g.renderingStartTime=0,g.last=d,g.tail=c,g.tailExpiration=0,g.tailMode=e,g.lastEffect=f)}function vh(a,b,c){var d=b.pendingProps,e=d.revealOrder,f=d.tail;T(a,b,d.children,c);d=D.current;if(0!==(d&2))d=d&1|2,b.effectTag|=64;else{if(null!==a&&0!==(a.effectTag&64))a:for(a=b.child;null!==a;){if(13===a.tag)null!==a.memoizedState&&uh(a,c);else if(19===a.tag)uh(a,c);else if(null!==a.child){a.child.return=a;a=a.child;continue}if(a===b)break a;for(;null===a.sibling;){if(null===a.return||a.return===b)break a;a=a.return}a.sibling.return=a.return;a=a.sibling}d&=1}y(D,d);if(0===(b.mode&2))b.memoizedState=null;else switch(e){case"forwards":c=b.child;for(e=null;null!==c;)a=c.alternate,null!==a&&null===Rc(a)&&(e=c),c=c.sibling;c=e;null===c?(e=b.child,b.child=null):(e=c.sibling,c.sibling=null);Ke(b,!1,e,c,f,b.lastEffect);break;case"backwards":c=null;e=b.child;for(b.child=null;null!==e;){a=e.alternate;if(null!==a&&null===Rc(a)){b.child=e;break}a=e.sibling;e.sibling=c;c=e;e=a}Ke(b,!0,c,null,f,b.lastEffect);break;case"together":Ke(b,!1,null,null,void 0,b.lastEffect);break;default:b.memoizedState=null;}return b.child}function sa(a,b,c){null!==a&&(b.dependencies=a.dependencies);var d=b.expirationTime;0!==d&&Kc(d);if(b.childExpirationTime<c)return null;if(null!==a&&b.child!==a.child)throw Error(k(153));if(null!==b.child){a=b.child;c=Sa(a,a.pendingProps);b.child=c;for(c.return=b;null!==a.sibling;)a=a.sibling,c=c.sibling=Sa(a,a.pendingProps),c.return=b;c.sibling=null}return b.child}function $c(a,b){switch(a.tailMode){case"hidden":b=a.tail;for(var c=null;null!==b;)null!==b.alternate&&(c=b),b=b.sibling;null===c?a.tail=null:c.sibling=null;break;case"collapsed":c=a.tail;for(var d=null;null!==c;)null!==c.alternate&&(d=c),c=c.sibling;null===d?b||null===a.tail?a.tail=null:a.tail.sibling=null:d.sibling=null;}}function hj(a,b,c){var d=b.pendingProps;switch(b.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:return N(b.type)&&(q(G),q(B)),null;case 3:return tb(),q(G),q(B),c=b.stateNode,c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),null!==a&&null!==a.child||!Zc(b)||(b.effectTag|=4),wh(b),null;case 5:te(b);c=Ta(Tb.current);var e=b.type;if(null!==a&&null!=b.stateNode)ij(a,b,e,d,c),a.ref!==b.ref&&(b.effectTag|=128);else{if(!d){if(null===b.stateNode)throw Error(k(166));return null}a=Ta(ja.current);if(Zc(b)){d=b.stateNode;e=b.type;var f=b.memoizedProps;d[Aa]=b;d[vc]=f;switch(e){case"iframe":case"object":case"embed":w("load",d);break;case"video":case"audio":for(a=0;a<Db.length;a++)w(Db[a],d);break;case"source":w("error",d);break;case"img":case"image":case"link":w("error",d);w("load",d);break;case"form":w("reset",d);w("submit",d);break;case"details":w("toggle",d);break;case"input":Hf(d,f);w("invalid",d);oa(c,"onChange");break;case"select":d._wrapperState={wasMultiple:!!f.multiple};w("invalid",d);oa(c,"onChange");break;case"textarea":Kf(d,f),w("invalid",d),oa(c,"onChange");}Ud(e,f);a=null;for(var g in f)if(f.hasOwnProperty(g)){var h=f[g];"children"===g?"string"===typeof h?d.textContent!==h&&(a=["children",h]):"number"===typeof h&&d.textContent!==""+h&&(a=["children",""+h]):db.hasOwnProperty(g)&&null!=h&&oa(c,g)}switch(e){case"input":mc(d);Jf(d,f,!0);break;case"textarea":mc(d);Mf(d);break;case"select":case"option":break;default:"function"===typeof f.onClick&&(d.onclick=uc);}c=a;b.updateQueue=c;null!==c&&(b.effectTag|=4)}else{g=9===c.nodeType?c:c.ownerDocument;"http://www.w3.org/1999/xhtml"===a&&(a=Nf(e));"http://www.w3.org/1999/xhtml"===a?"script"===e?(a=g.createElement("div"),a.innerHTML="<script></script>",a=a.removeChild(a.firstChild)):"string"===typeof d.is?a=g.createElement(e,{is:d.is}):(a=g.createElement(e),"select"===e&&(g=a,d.multiple?g.multiple=!0:d.size&&(g.size=d.size))):a=g.createElementNS(a,e);a[Aa]=b;a[vc]=d;jj(a,b,!1,!1);b.stateNode=a;g=Vd(e,d);switch(e){case"iframe":case"object":case"embed":w("load",a);h=d;break;case"video":case"audio":for(h=0;h<Db.length;h++)w(Db[h],a);h=d;break;case"source":w("error",a);h=d;break;case"img":case"image":case"link":w("error",a);w("load",a);h=d;break;case"form":w("reset",a);w("submit",a);h=d;break;case"details":w("toggle",a);h=d;break;case"input":Hf(a,d);h=Cd(a,d);w("invalid",a);oa(c,"onChange");break;case"option":h=Fd(a,d);break;case"select":a._wrapperState={wasMultiple:!!d.multiple};h=M({},d,{value:void 0});w("invalid",a);oa(c,"onChange");break;case"textarea":Kf(a,d);h=Gd(a,d);w("invalid",a);oa(c,"onChange");break;default:h=d;}Ud(e,h);var m=h;for(f in m)if(m.hasOwnProperty(f)){var n=m[f];"style"===f?gg(a,n):"dangerouslySetInnerHTML"===f?(n=n?n.__html:void 0,null!=n&&xh(a,n)):"children"===f?"string"===typeof n?("textarea"!==e||""!==n)&&Wb(a,n):"number"===typeof n&&Wb(a,""+n):"suppressContentEditableWarning"!==f&&"suppressHydrationWarning"!==f&&"autoFocus"!==f&&(db.hasOwnProperty(f)?null!=n&&oa(c,f):null!=n&&xd(a,f,n,g))}switch(e){case"input":mc(a);Jf(a,d,!1);break;case"textarea":mc(a);Mf(a);break;case"option":null!=d.value&&a.setAttribute("value",""+va(d.value));break;case"select":a.multiple=!!d.multiple;c=d.value;null!=c?hb(a,!!d.multiple,c,!1):null!=d.defaultValue&&hb(a,!!d.multiple,d.defaultValue,!0);break;default:"function"===typeof h.onClick&&(a.onclick=uc);}lg(e,d)&&(b.effectTag|=4)}null!==b.ref&&(b.effectTag|=128)}return null;case 6:if(a&&null!=b.stateNode)kj(a,b,a.memoizedProps,d);else{if("string"!==typeof d&&null===b.stateNode)throw Error(k(166));c=Ta(Tb.current);Ta(ja.current);Zc(b)?(c=b.stateNode,d=b.memoizedProps,c[Aa]=b,c.nodeValue!==d&&(b.effectTag|=4)):(c=(9===c.nodeType?c:c.ownerDocument).createTextNode(d),c[Aa]=b,b.stateNode=c)}return null;case 13:q(D);d=b.memoizedState;if(0!==(b.effectTag&64))return b.expirationTime=c,b;c=null!==d;d=!1;null===a?void 0!==b.memoizedProps.fallback&&Zc(b):(e=a.memoizedState,d=null!==e,c||null===e||(e=a.child.sibling,null!==e&&(f=b.firstEffect,null!==f?(b.firstEffect=e,e.nextEffect=f):(b.firstEffect=b.lastEffect=e,e.nextEffect=null),e.effectTag=8)));if(c&&!d&&0!==(b.mode&2))if(null===a&&!0!==b.memoizedProps.unstable_avoidThisFallback||0!==(D.current&1))F===Xa&&(F=ad);else{if(F===Xa||F===ad)F=bd;0!==Xb&&null!==U&&(Ya(U,P),yh(U,Xb))}if(c||d)b.effectTag|=4;return null;case 4:return tb(),wh(b),null;case 10:return me(b),null;case 17:return N(b.type)&&(q(G),q(B)),null;case 19:q(D);d=b.memoizedState;if(null===d)return null;e=0!==(b.effectTag&64);f=d.rendering;if(null===f){if(e)$c(d,!1);else{if(F!==Xa||null!==a&&0!==(a.effectTag&64))for(f=b.child;null!==f;){a=Rc(f);if(null!==a){b.effectTag|=64;$c(d,!1);e=a.updateQueue;null!==e&&(b.updateQueue=e,b.effectTag|=4);null===d.lastEffect&&(b.firstEffect=null);b.lastEffect=d.lastEffect;for(d=b.child;null!==d;)e=d,f=c,e.effectTag&=2,e.nextEffect=null,e.firstEffect=null,e.lastEffect=null,a=e.alternate,null===a?(e.childExpirationTime=0,e.expirationTime=f,e.child=null,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null):(e.childExpirationTime=a.childExpirationTime,e.expirationTime=a.expirationTime,e.child=a.child,e.memoizedProps=a.memoizedProps,e.memoizedState=a.memoizedState,e.updateQueue=a.updateQueue,f=a.dependencies,e.dependencies=null===f?null:{expirationTime:f.expirationTime,firstContext:f.firstContext,responders:f.responders}),d=d.sibling;y(D,D.current&1|2);return b.child}f=f.sibling}}}else{if(!e)if(a=Rc(f),null!==a){if(b.effectTag|=64,e=!0,c=a.updateQueue,null!==c&&(b.updateQueue=c,b.effectTag|=4),$c(d,!0),null===d.tail&&"hidden"===d.tailMode&&!f.alternate)return b=b.lastEffect=d.lastEffect,null!==b&&(b.nextEffect=null),null}else 2*Y()-d.renderingStartTime>d.tailExpiration&&1<c&&(b.effectTag|=64,e=!0,$c(d,!1),b.expirationTime=b.childExpirationTime=c-1);d.isBackwards?(f.sibling=b.child,b.child=f):(c=d.last,null!==c?c.sibling=f:b.child=f,d.last=f)}return null!==d.tail?(0===d.tailExpiration&&(d.tailExpiration=Y()+500),c=d.tail,d.rendering=c,d.tail=c.sibling,d.lastEffect=b.lastEffect,d.renderingStartTime=Y(),c.sibling=null,b=D.current,y(D,e?b&1|2:b&1),c):null;}throw Error(k(156,b.tag))}function lj(a,b){switch(a.tag){case 1:return N(a.type)&&(q(G),q(B)),b=a.effectTag,b&4096?(a.effectTag=b&-4097|64,a):null;case 3:tb();q(G);q(B);b=a.effectTag;if(0!==(b&64))throw Error(k(285));a.effectTag=b&-4097|64;return a;case 5:return te(a),null;case 13:return q(D),b=a.effectTag,b&4096?(a.effectTag=b&-4097|64,a):null;case 19:return q(D),null;case 4:return tb(),null;case 10:return me(a),null;default:return null;}}function Le(a,b){return{value:a,source:b,stack:Bd(b)}}function Me(a,b){var c=b.source,d=b.stack;null===d&&null!==c&&(d=Bd(c));null!==c&&na(c.type);b=b.value;null!==a&&1===a.tag&&na(a.type);try{console.error(b)}catch(e){setTimeout(function(){throw e})}}function mj(a,b){try{b.props=a.memoizedProps,b.state=a.memoizedState,b.componentWillUnmount()}catch(c){Za(a,c)}}function zh(a){var b=a.ref;if(null!==b)if("function"===typeof b)try{b(null)}catch(c){Za(a,c)}else b.current=null}function nj(a,b){switch(b.tag){case 0:case 11:case 15:case 22:return;case 1:if(b.effectTag&256&&null!==a){var c=a.memoizedProps,d=a.memoizedState;a=b.stateNode;b=a.getSnapshotBeforeUpdate(b.elementType===b.type?c:aa(b.type,c),d);a.__reactInternalSnapshotBeforeUpdate=b}return;case 3:case 5:case 6:case 4:case 17:return;}throw Error(k(163))}function Ah(a,b){b=b.updateQueue;b=null!==b?b.lastEffect:null;if(null!==b){var c=b=b.next;do{if((c.tag&a)===a){var d=c.destroy;c.destroy=void 0;void 0!==d&&d()}c=c.next}while(c!==b)}}function Bh(a,b){b=b.updateQueue;b=null!==b?b.lastEffect:null;if(null!==b){var c=b=b.next;do{if((c.tag&a)===a){var d=c.create;c.destroy=d()}c=c.next}while(c!==b)}}function oj(a,b,c,d){switch(c.tag){case 0:case 11:case 15:case 22:Bh(3,c);return;case 1:a=c.stateNode;c.effectTag&4&&(null===b?a.componentDidMount():(d=c.elementType===c.type?b.memoizedProps:aa(c.type,b.memoizedProps),a.componentDidUpdate(d,b.memoizedState,a.__reactInternalSnapshotBeforeUpdate)));b=c.updateQueue;null!==b&&Wg(c,b,a);return;case 3:b=c.updateQueue;if(null!==b){a=null;if(null!==c.child)switch(c.child.tag){case 5:a=c.child.stateNode;break;case 1:a=c.child.stateNode;}Wg(c,b,a)}return;case 5:a=c.stateNode;null===b&&c.effectTag&4&&lg(c.type,c.memoizedProps)&&a.focus();return;case 6:return;case 4:return;case 12:return;case 13:null===c.memoizedState&&(c=c.alternate,null!==c&&(c=c.memoizedState,null!==c&&(c=c.dehydrated,null!==c&&bg(c))));return;case 19:case 17:case 20:case 21:return;}throw Error(k(163))}function Ch(a,b,c){"function"===typeof Ne&&Ne(b);switch(b.tag){case 0:case 11:case 14:case 15:case 22:a=b.updateQueue;if(null!==a&&(a=a.lastEffect,null!==a)){var d=a.next;Da(97<c?97:c,function(){var a=d;do{var c=a.destroy;if(void 0!==c){var g=b;try{c()}catch(h){Za(g,h)}}a=a.next}while(a!==d)})}break;case 1:zh(b);c=b.stateNode;"function"===typeof c.componentWillUnmount&&mj(b,c);break;case 5:zh(b);break;case 4:Dh(a,b,c);}}function Eh(a){var b=a.alternate;a.return=null;a.child=null;a.memoizedState=null;a.updateQueue=null;a.dependencies=null;a.alternate=null;a.firstEffect=null;a.lastEffect=null;a.pendingProps=null;a.memoizedProps=null;a.stateNode=null;null!==b&&Eh(b)}function Fh(a){return 5===a.tag||3===a.tag||4===a.tag}function Gh(a){a:{for(var b=a.return;null!==b;){if(Fh(b)){var c=b;break a}b=b.return}throw Error(k(160))}b=c.stateNode;switch(c.tag){case 5:var d=!1;break;case 3:b=b.containerInfo;d=!0;break;case 4:b=b.containerInfo;d=!0;break;default:throw Error(k(161));}c.effectTag&16&&(Wb(b,""),c.effectTag&=-17);a:b:for(c=a;;){for(;null===c.sibling;){if(null===c.return||Fh(c.return)){c=null;break a}c=c.return}c.sibling.return=c.return;for(c=c.sibling;5!==c.tag&&6!==c.tag&&18!==c.tag;){if(c.effectTag&2)continue b;if(null===c.child||4===c.tag)continue b;else c.child.return=c,c=c.child}if(!(c.effectTag&2)){c=c.stateNode;break a}}d?Oe(a,c,b):Pe(a,c,b)}function Oe(a,b,c){var d=a.tag,e=5===d||6===d;if(e)a=e?a.stateNode:a.stateNode.instance,b?8===c.nodeType?c.parentNode.insertBefore(a,b):c.insertBefore(a,b):(8===c.nodeType?(b=c.parentNode,b.insertBefore(a,c)):(b=c,b.appendChild(a)),c=c._reactRootContainer,null!==c&&void 0!==c||null!==b.onclick||(b.onclick=uc));else if(4!==d&&(a=a.child,null!==a))for(Oe(a,b,c),a=a.sibling;null!==a;)Oe(a,b,c),a=a.sibling}function Pe(a,b,c){var d=a.tag,e=5===d||6===d;if(e)a=e?a.stateNode:a.stateNode.instance,b?c.insertBefore(a,b):c.appendChild(a);else if(4!==d&&(a=a.child,null!==a))for(Pe(a,b,c),a=a.sibling;null!==a;)Pe(a,b,c),a=a.sibling}function Dh(a,b,c){for(var d=b,e=!1,f,g;;){if(!e){e=d.return;a:for(;;){if(null===e)throw Error(k(160));f=e.stateNode;switch(e.tag){case 5:g=!1;break a;case 3:f=f.containerInfo;g=!0;break a;case 4:f=f.containerInfo;g=!0;break a;}e=e.return}e=!0}if(5===d.tag||6===d.tag){a:for(var h=a,m=d,n=c,l=m;;)if(Ch(h,l,n),null!==l.child&&4!==l.tag)l.child.return=l,l=l.child;else{if(l===m)break a;for(;null===l.sibling;){if(null===l.return||l.return===m)break a;l=l.return}l.sibling.return=l.return;l=l.sibling}g?(h=f,m=d.stateNode,8===h.nodeType?h.parentNode.removeChild(m):h.removeChild(m)):f.removeChild(d.stateNode)}else if(4===d.tag){if(null!==d.child){f=d.stateNode.containerInfo;g=!0;d.child.return=d;d=d.child;continue}}else if(Ch(a,d,c),null!==d.child){d.child.return=d;d=d.child;continue}if(d===b)break;for(;null===d.sibling;){if(null===d.return||d.return===b)return;d=d.return;4===d.tag&&(e=!1)}d.sibling.return=d.return;d=d.sibling}}function Qe(a,b){switch(b.tag){case 0:case 11:case 14:case 15:case 22:Ah(3,b);return;case 1:return;case 5:var c=b.stateNode;if(null!=c){var d=b.memoizedProps,e=null!==a?a.memoizedProps:d;a=b.type;var f=b.updateQueue;b.updateQueue=null;if(null!==f){c[vc]=d;"input"===a&&"radio"===d.type&&null!=d.name&&If(c,d);Vd(a,e);b=Vd(a,d);for(e=0;e<f.length;e+=2){var g=f[e],h=f[e+1];"style"===g?gg(c,h):"dangerouslySetInnerHTML"===g?xh(c,h):"children"===g?Wb(c,h):xd(c,g,h,b)}switch(a){case"input":Dd(c,d);break;case"textarea":Lf(c,d);break;case"select":b=c._wrapperState.wasMultiple,c._wrapperState.wasMultiple=!!d.multiple,a=d.value,null!=a?hb(c,!!d.multiple,a,!1):b!==!!d.multiple&&(null!=d.defaultValue?hb(c,!!d.multiple,d.defaultValue,!0):hb(c,!!d.multiple,d.multiple?[]:"",!1));}}}return;case 6:if(null===b.stateNode)throw Error(k(162));b.stateNode.nodeValue=b.memoizedProps;return;case 3:b=b.stateNode;b.hydrate&&(b.hydrate=!1,bg(b.containerInfo));return;case 12:return;case 13:c=b;null===b.memoizedState?d=!1:(d=!0,c=b.child,Re=Y());if(null!==c)a:for(a=c;;){if(5===a.tag)f=a.stateNode,d?(f=f.style,"function"===typeof f.setProperty?f.setProperty("display","none","important"):f.display="none"):(f=a.stateNode,e=a.memoizedProps.style,e=void 0!==e&&null!==e&&e.hasOwnProperty("display")?e.display:null,f.style.display=fg("display",e));else if(6===a.tag)a.stateNode.nodeValue=d?"":a.memoizedProps;else if(13===a.tag&&null!==a.memoizedState&&null===a.memoizedState.dehydrated){f=a.child.sibling;f.return=a;a=f;continue}else if(null!==a.child){a.child.return=a;a=a.child;continue}if(a===c)break;for(;null===a.sibling;){if(null===a.return||a.return===c)break a;a=a.return}a.sibling.return=a.return;a=a.sibling}Hh(b);return;case 19:Hh(b);return;case 17:return;}throw Error(k(163))}function Hh(a){var b=a.updateQueue;if(null!==b){a.updateQueue=null;var c=a.stateNode;null===c&&(c=a.stateNode=new pj);b.forEach(function(b){var d=qj.bind(null,a,b);c.has(b)||(c.add(b),b.then(d,d))})}}function Ih(a,b,c){c=Ea(c,null);c.tag=3;c.payload={element:null};var d=b.value;c.callback=function(){cd||(cd=!0,Se=d);Me(a,b)};return c}function Jh(a,b,c){c=Ea(c,null);c.tag=3;var d=a.type.getDerivedStateFromError;if("function"===typeof d){var e=b.value;c.payload=function(){Me(a,b);return d(e)}}var f=a.stateNode;null!==f&&"function"===typeof f.componentDidCatch&&(c.callback=function(){"function"!==typeof d&&(null===La?La=new Set([this]):La.add(this),Me(a,b));var c=b.stack;this.componentDidCatch(b.value,{componentStack:null!==c?c:""})});return c}function ka(){return(p&(ca|ma))!==H?1073741821-(Y()/10|0):0!==dd?dd:dd=1073741821-(Y()/10|0)}function Va(a,b,c){b=b.mode;if(0===(b&2))return 1073741823;var d=Cc();if(0===(b&4))return 99===d?1073741823:1073741822;if((p&ca)!==H)return P;if(null!==c)a=Fc(a,c.timeoutMs|0||5E3,250);else switch(d){case 99:a=1073741823;break;case 98:a=Fc(a,150,100);break;case 97:case 96:a=Fc(a,5E3,250);break;case 95:a=2;break;default:throw Error(k(326));}null!==U&&a===P&&--a;return a}function ed(a,b){a.expirationTime<b&&(a.expirationTime=b);var c=a.alternate;null!==c&&c.expirationTime<b&&(c.expirationTime=b);var d=a.return,e=null;if(null===d&&3===a.tag)e=a.stateNode;else for(;null!==d;){c=d.alternate;d.childExpirationTime<b&&(d.childExpirationTime=b);null!==c&&c.childExpirationTime<b&&(c.childExpirationTime=b);if(null===d.return&&3===d.tag){e=d.stateNode;break}d=d.return}null!==e&&(U===e&&(Kc(b),F===bd&&Ya(e,P)),yh(e,b));return e}function fd(a){var b=a.lastExpiredTime;if(0!==b)return b;b=a.firstPendingTime;if(!Kh(a,b))return b;var c=a.lastPingedTime;a=a.nextKnownPendingLevel;a=c>a?c:a;return 2>=a&&b!==a?0:a}function V(a){if(0!==a.lastExpiredTime)a.callbackExpirationTime=1073741823,a.callbackPriority=99,a.callbackNode=Og(Te.bind(null,a));else{var b=fd(a),c=a.callbackNode;if(0===b)null!==c&&(a.callbackNode=null,a.callbackExpirationTime=0,a.callbackPriority=90);else{var d=ka();1073741823===b?d=99:1===b||2===b?d=95:(d=10*(1073741821-b)-10*(1073741821-d),d=0>=d?99:250>=d?98:5250>=d?97:95);if(null!==c){var e=a.callbackPriority;if(a.callbackExpirationTime===b&&e>=d)return;c!==Qg&&Rg(c)}a.callbackExpirationTime=b;a.callbackPriority=d;b=1073741823===b?Og(Te.bind(null,a)):Ng(d,Lh.bind(null,a),{timeout:10*(1073741821-b)-Y()});a.callbackNode=b}}}function Lh(a,b){dd=0;if(b)return b=ka(),Ue(a,b),V(a),null;var c=fd(a);if(0!==c){b=a.callbackNode;if((p&(ca|ma))!==H)throw Error(k(327));xb();a===U&&c===P||$a(a,c);if(null!==t){var d=p;p|=ca;var e=Mh();do try{rj();break}catch(h){Nh(a,h)}while(1);le();p=d;gd.current=e;if(F===hd)throw b=id,$a(a,c),Ya(a,c),V(a),b;if(null===t)switch(e=a.finishedWork=a.current.alternate,a.finishedExpirationTime=c,d=F,U=null,d){case Xa:case hd:throw Error(k(345));case Oh:Ue(a,2<c?2:c);break;case ad:Ya(a,c);d=a.lastSuspendedTime;c===d&&(a.nextKnownPendingLevel=Ve(e));if(1073741823===ta&&(e=Re+Ph-Y(),10<e)){if(jd){var f=a.lastPingedTime;if(0===f||f>=c){a.lastPingedTime=c;$a(a,c);break}}f=fd(a);if(0!==f&&f!==c)break;if(0!==d&&d!==c){a.lastPingedTime=d;break}a.timeoutHandle=We(ab.bind(null,a),e);break}ab(a);break;case bd:Ya(a,c);d=a.lastSuspendedTime;c===d&&(a.nextKnownPendingLevel=Ve(e));if(jd&&(e=a.lastPingedTime,0===e||e>=c)){a.lastPingedTime=c;$a(a,c);break}e=fd(a);if(0!==e&&e!==c)break;if(0!==d&&d!==c){a.lastPingedTime=d;break}1073741823!==Yb?d=10*(1073741821-Yb)-Y():1073741823===ta?d=0:(d=10*(1073741821-ta)-5E3,e=Y(),c=10*(1073741821-c)-e,d=e-d,0>d&&(d=0),d=(120>d?120:480>d?480:1080>d?1080:1920>d?1920:3E3>d?3E3:4320>d?4320:1960*sj(d/1960))-d,c<d&&(d=c));if(10<d){a.timeoutHandle=We(ab.bind(null,a),d);break}ab(a);break;case Xe:if(1073741823!==ta&&null!==kd){f=ta;var g=kd;d=g.busyMinDurationMs|0;0>=d?d=0:(e=g.busyDelayMs|0,f=Y()-(10*(1073741821-f)-(g.timeoutMs|0||5E3)),d=f<=e?0:e+d-f);if(10<d){Ya(a,c);a.timeoutHandle=We(ab.bind(null,a),d);break}}ab(a);break;default:throw Error(k(329));}V(a);if(a.callbackNode===b)return Lh.bind(null,a)}}return null}function Te(a){var b=a.lastExpiredTime;b=0!==b?b:1073741823;if((p&(ca|ma))!==H)throw Error(k(327));xb();a===U&&b===P||$a(a,b);if(null!==t){var c=p;p|=ca;var d=Mh();do try{tj();break}catch(e){Nh(a,e)}while(1);le();p=c;gd.current=d;if(F===hd)throw c=id,$a(a,b),Ya(a,b),V(a),c;if(null!==t)throw Error(k(261));a.finishedWork=a.current.alternate;a.finishedExpirationTime=b;U=null;ab(a);V(a)}return null}function uj(){if(null!==bb){var a=bb;bb=null;a.forEach(function(a,c){Ue(c,a);V(c)});ha()}}function Qh(a,b){var c=p;p|=1;try{return a(b)}finally{p=c,p===H&&ha()}}function Rh(a,b){var c=p;p&=-2;p|=Ye;try{return a(b)}finally{p=c,p===H&&ha()}}function $a(a,b){a.finishedWork=null;a.finishedExpirationTime=0;var c=a.timeoutHandle;-1!==c&&(a.timeoutHandle=-1,vj(c));if(null!==t)for(c=t.return;null!==c;){var d=c;switch(d.tag){case 1:d=d.type.childContextTypes;null!==d&&void 0!==d&&(q(G),q(B));break;case 3:tb();q(G);q(B);break;case 5:te(d);break;case 4:tb();break;case 13:q(D);break;case 19:q(D);break;case 10:me(d);}c=c.return}U=a;t=Sa(a.current,null);P=b;F=Xa;id=null;Yb=ta=1073741823;kd=null;Xb=0;jd=!1}function Nh(a,b){do{try{le();Sc.current=Tc;if(Uc)for(var c=z.memoizedState;null!==c;){var d=c.queue;null!==d&&(d.pending=null);c=c.next}Ia=0;J=K=z=null;Uc=!1;if(null===t||null===t.return)return F=hd,id=b,t=null;a:{var e=a,f=t.return,g=t,h=b;b=P;g.effectTag|=2048;g.firstEffect=g.lastEffect=null;if(null!==h&&"object"===typeof h&&"function"===typeof h.then){var m=h;if(0===(g.mode&2)){var n=g.alternate;n?(g.updateQueue=n.updateQueue,g.memoizedState=n.memoizedState,g.expirationTime=n.expirationTime):(g.updateQueue=null,g.memoizedState=null)}var l=0!==(D.current&1),k=f;do{var p;if(p=13===k.tag){var q=k.memoizedState;if(null!==q)p=null!==q.dehydrated?!0:!1;else{var w=k.memoizedProps;p=void 0===w.fallback?!1:!0!==w.unstable_avoidThisFallback?!0:l?!1:!0}}if(p){var y=k.updateQueue;if(null===y){var r=new Set;r.add(m);k.updateQueue=r}else y.add(m);if(0===(k.mode&2)){k.effectTag|=64;g.effectTag&=-2981;if(1===g.tag)if(null===g.alternate)g.tag=17;else{var O=Ea(1073741823,null);O.tag=Jc;Fa(g,O)}g.expirationTime=1073741823;break a}h=void 0;g=b;var v=e.pingCache;null===v?(v=e.pingCache=new wj,h=new Set,v.set(m,h)):(h=v.get(m),void 0===h&&(h=new Set,v.set(m,h)));if(!h.has(g)){h.add(g);var x=xj.bind(null,e,m,g);m.then(x,x)}k.effectTag|=4096;k.expirationTime=b;break a}k=k.return}while(null!==k);h=Error((na(g.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display."+Bd(g))}F!==Xe&&(F=Oh);h=Le(h,g);k=f;do{switch(k.tag){case 3:m=h;k.effectTag|=4096;k.expirationTime=b;var A=Ih(k,m,b);Ug(k,A);break a;case 1:m=h;var u=k.type,B=k.stateNode;if(0===(k.effectTag&64)&&("function"===typeof u.getDerivedStateFromError||null!==B&&"function"===typeof B.componentDidCatch&&(null===La||!La.has(B)))){k.effectTag|=4096;k.expirationTime=b;var H=Jh(k,m,b);Ug(k,H);break a}}k=k.return}while(null!==k)}t=Sh(t)}catch(cj){b=cj;continue}break}while(1)}function Mh(a){a=gd.current;gd.current=Tc;return null===a?Tc:a}function Vg(a,b){a<ta&&2<a&&(ta=a);null!==b&&a<Yb&&2<a&&(Yb=a,kd=b)}function Kc(a){a>Xb&&(Xb=a)}function tj(){for(;null!==t;)t=Th(t)}function rj(){for(;null!==t&&!yj();)t=Th(t)}function Th(a){var b=zj(a.alternate,a,P);a.memoizedProps=a.pendingProps;null===b&&(b=Sh(a));Uh.current=null;return b}function Sh(a){t=a;do{var b=t.alternate;a=t.return;if(0===(t.effectTag&2048)){b=hj(b,t,P);if(1===P||1!==t.childExpirationTime){for(var c=0,d=t.child;null!==d;){var e=d.expirationTime,f=d.childExpirationTime;e>c&&(c=e);f>c&&(c=f);d=d.sibling}t.childExpirationTime=c}if(null!==b)return b;null!==a&&0===(a.effectTag&2048)&&(null===a.firstEffect&&(a.firstEffect=t.firstEffect),null!==t.lastEffect&&(null!==a.lastEffect&&(a.lastEffect.nextEffect=t.firstEffect),a.lastEffect=t.lastEffect),1<t.effectTag&&(null!==a.lastEffect?a.lastEffect.nextEffect=t:a.firstEffect=t,a.lastEffect=t))}else{b=lj(t);if(null!==b)return b.effectTag&=2047,b;null!==a&&(a.firstEffect=a.lastEffect=null,a.effectTag|=2048)}b=t.sibling;if(null!==b)return b;t=a}while(null!==t);F===Xa&&(F=Xe);return null}function Ve(a){var b=a.expirationTime;a=a.childExpirationTime;return b>a?b:a}function ab(a){var b=Cc();Da(99,Aj.bind(null,a,b));return null}function Aj(a,b){do xb();while(null!==Zb);if((p&(ca|ma))!==H)throw Error(k(327));var c=a.finishedWork,d=a.finishedExpirationTime;if(null===c)return null;a.finishedWork=null;a.finishedExpirationTime=0;if(c===a.current)throw Error(k(177));a.callbackNode=null;a.callbackExpirationTime=0;a.callbackPriority=90;a.nextKnownPendingLevel=0;var e=Ve(c);a.firstPendingTime=e;d<=a.lastSuspendedTime?a.firstSuspendedTime=a.lastSuspendedTime=a.nextKnownPendingLevel=0:d<=a.firstSuspendedTime&&(a.firstSuspendedTime=d-1);d<=a.lastPingedTime&&(a.lastPingedTime=0);d<=a.lastExpiredTime&&(a.lastExpiredTime=0);a===U&&(t=U=null,P=0);1<c.effectTag?null!==c.lastEffect?(c.lastEffect.nextEffect=c,e=c.firstEffect):e=c:e=c.firstEffect;if(null!==e){var f=p;p|=ma;Uh.current=null;Ze=tc;var g=kg();if(Xd(g)){if("selectionStart"in g)var h={start:g.selectionStart,end:g.selectionEnd};else a:{h=(h=g.ownerDocument)&&h.defaultView||window;var m=h.getSelection&&h.getSelection();if(m&&0!==m.rangeCount){h=m.anchorNode;var n=m.anchorOffset,q=m.focusNode;m=m.focusOffset;try{h.nodeType,q.nodeType}catch(sb){h=null;break a}var ba=0,w=-1,y=-1,B=0,D=0,r=g,z=null;b:for(;;){for(var v;;){r!==h||0!==n&&3!==r.nodeType||(w=ba+n);r!==q||0!==m&&3!==r.nodeType||(y=ba+m);3===r.nodeType&&(ba+=r.nodeValue.length);if(null===(v=r.firstChild))break;z=r;r=v}for(;;){if(r===g)break b;z===h&&++B===n&&(w=ba);z===q&&++D===m&&(y=ba);if(null!==(v=r.nextSibling))break;r=z;z=r.parentNode}r=v}h=-1===w||-1===y?null:{start:w,end:y}}else h=null}h=h||{start:0,end:0}}else h=null;$e={activeElementDetached:null,focusedElem:g,selectionRange:h};tc=!1;l=e;do try{Bj()}catch(sb){if(null===l)throw Error(k(330));Za(l,sb);l=l.nextEffect}while(null!==l);l=e;do try{for(g=a,h=b;null!==l;){var x=l.effectTag;x&16&&Wb(l.stateNode,"");if(x&128){var A=l.alternate;if(null!==A){var u=A.ref;null!==u&&("function"===typeof u?u(null):u.current=null)}}switch(x&1038){case 2:Gh(l);l.effectTag&=-3;break;case 6:Gh(l);l.effectTag&=-3;Qe(l.alternate,l);break;case 1024:l.effectTag&=-1025;break;case 1028:l.effectTag&=-1025;Qe(l.alternate,l);break;case 4:Qe(l.alternate,l);break;case 8:n=l,Dh(g,n,h),Eh(n);}l=l.nextEffect}}catch(sb){if(null===l)throw Error(k(330));Za(l,sb);l=l.nextEffect}while(null!==l);u=$e;A=kg();x=u.focusedElem;h=u.selectionRange;if(A!==x&&x&&x.ownerDocument&&jg(x.ownerDocument.documentElement,x)){null!==h&&Xd(x)&&(A=h.start,u=h.end,void 0===u&&(u=A),"selectionStart"in x?(x.selectionStart=A,x.selectionEnd=Math.min(u,x.value.length)):(u=(A=x.ownerDocument||document)&&A.defaultView||window,u.getSelection&&(u=u.getSelection(),n=x.textContent.length,g=Math.min(h.start,n),h=void 0===h.end?g:Math.min(h.end,n),!u.extend&&g>h&&(n=h,h=g,g=n),n=ig(x,g),q=ig(x,h),n&&q&&(1!==u.rangeCount||u.anchorNode!==n.node||u.anchorOffset!==n.offset||u.focusNode!==q.node||u.focusOffset!==q.offset)&&(A=A.createRange(),A.setStart(n.node,n.offset),u.removeAllRanges(),g>h?(u.addRange(A),u.extend(q.node,q.offset)):(A.setEnd(q.node,q.offset),u.addRange(A))))));A=[];for(u=x;u=u.parentNode;)1===u.nodeType&&A.push({element:u,left:u.scrollLeft,top:u.scrollTop});"function"===typeof x.focus&&x.focus();for(x=0;x<A.length;x++)u=A[x],u.element.scrollLeft=u.left,u.element.scrollTop=u.top}tc=!!Ze;$e=Ze=null;a.current=c;l=e;do try{for(x=a;null!==l;){var F=l.effectTag;F&36&&oj(x,l.alternate,l);if(F&128){A=void 0;var E=l.ref;if(null!==E){var G=l.stateNode;switch(l.tag){case 5:A=G;break;default:A=G;}"function"===typeof E?E(A):E.current=A}}l=l.nextEffect}}catch(sb){if(null===l)throw Error(k(330));Za(l,sb);l=l.nextEffect}while(null!==l);l=null;Cj();p=f}else a.current=c;if(ld)ld=!1,Zb=a,$b=b;else for(l=e;null!==l;)b=l.nextEffect,l.nextEffect=null,l=b;b=a.firstPendingTime;0===b&&(La=null);1073741823===b?a===af?ac++:(ac=0,af=a):ac=0;"function"===typeof bf&&bf(c.stateNode,d);V(a);if(cd)throw cd=!1,a=Se,Se=null,a;if((p&Ye)!==H)return null;ha();return null}function Bj(){for(;null!==l;){var a=l.effectTag;0!==(a&256)&&nj(l.alternate,l);0===(a&512)||ld||(ld=!0,Ng(97,function(){xb();return null}));l=l.nextEffect}}function xb(){if(90!==$b){var a=97<$b?97:$b;$b=90;return Da(a,Dj)}}function Dj(){if(null===Zb)return!1;var a=Zb;Zb=null;if((p&(ca|ma))!==H)throw Error(k(331));var b=p;p|=ma;for(a=a.current.firstEffect;null!==a;){try{var c=a;if(0!==(c.effectTag&512))switch(c.tag){case 0:case 11:case 15:case 22:Ah(5,c),Bh(5,c);}}catch(d){if(null===a)throw Error(k(330));Za(a,d)}c=a.nextEffect;a.nextEffect=null;a=c}p=b;ha();return!0}function Vh(a,b,c){b=Le(c,b);b=Ih(a,b,1073741823);Fa(a,b);a=ed(a,1073741823);null!==a&&V(a)}function Za(a,b){if(3===a.tag)Vh(a,a,b);else for(var c=a.return;null!==c;){if(3===c.tag){Vh(c,a,b);break}else if(1===c.tag){var d=c.stateNode;if("function"===typeof c.type.getDerivedStateFromError||"function"===typeof d.componentDidCatch&&(null===La||!La.has(d))){a=Le(b,a);a=Jh(c,a,1073741823);Fa(c,a);c=ed(c,1073741823);null!==c&&V(c);break}}c=c.return}}function xj(a,b,c){var d=a.pingCache;null!==d&&d.delete(b);U===a&&P===c?F===bd||F===ad&&1073741823===ta&&Y()-Re<Ph?$a(a,P):jd=!0:Kh(a,c)&&(b=a.lastPingedTime,0!==b&&b<c||(a.lastPingedTime=c,V(a)))}function qj(a,b){var c=a.stateNode;null!==c&&c.delete(b);b=0;0===b&&(b=ka(),b=Va(b,a,null));a=ed(a,b);null!==a&&V(a)}function Ej(a){if("undefined"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)return!1;var b=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(b.isDisabled||!b.supportsFiber)return!0;try{var c=b.inject(a);bf=function(a,e){try{b.onCommitFiberRoot(c,a,void 0,64===(a.current.effectTag&64))}catch(f){}};Ne=function(a){try{b.onCommitFiberUnmount(c,a)}catch(e){}}}catch(d){}return!0}function Fj(a,b,c,d){this.tag=a;this.key=c;this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null;this.index=0;this.ref=null;this.pendingProps=b;this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null;this.mode=d;this.effectTag=0;this.lastEffect=this.firstEffect=this.nextEffect=null;this.childExpirationTime=this.expirationTime=0;this.alternate=null}function Ge(a){a=a.prototype;return!(!a||!a.isReactComponent)}function Gj(a){if("function"===typeof a)return Ge(a)?1:0;if(void 0!==a&&null!==a){a=a.$$typeof;if(a===zd)return 11;if(a===Ad)return 14}return 2}function Sa(a,b){var c=a.alternate;null===c?(c=la(a.tag,b,a.key,a.mode),c.elementType=a.elementType,c.type=a.type,c.stateNode=a.stateNode,c.alternate=a,a.alternate=c):(c.pendingProps=b,c.effectTag=0,c.nextEffect=null,c.firstEffect=null,c.lastEffect=null);c.childExpirationTime=a.childExpirationTime;c.expirationTime=a.expirationTime;c.child=a.child;c.memoizedProps=a.memoizedProps;c.memoizedState=a.memoizedState;c.updateQueue=a.updateQueue;b=a.dependencies;c.dependencies=null===b?null:{expirationTime:b.expirationTime,firstContext:b.firstContext,responders:b.responders};c.sibling=a.sibling;c.index=a.index;c.ref=a.ref;return c}function Oc(a,b,c,d,e,f){var g=2;d=a;if("function"===typeof a)Ge(a)&&(g=1);else if("string"===typeof a)g=5;else a:switch(a){case Ma:return Ha(c.children,e,f,b);case Hj:g=8;e|=7;break;case Af:g=8;e|=1;break;case kc:return a=la(12,c,b,e|8),a.elementType=kc,a.type=kc,a.expirationTime=f,a;case lc:return a=la(13,c,b,e),a.type=lc,a.elementType=lc,a.expirationTime=f,a;case yd:return a=la(19,c,b,e),a.elementType=yd,a.expirationTime=f,a;default:if("object"===typeof a&&null!==a)switch(a.$$typeof){case Cf:g=10;break a;case Bf:g=9;break a;case zd:g=11;break a;case Ad:g=14;break a;case Ef:g=16;d=null;break a;case Df:g=22;break a;}throw Error(k(130,null==a?a:typeof a,""));}b=la(g,c,b,e);b.elementType=a;b.type=d;b.expirationTime=f;return b}function Ha(a,b,c,d){a=la(7,a,d,b);a.expirationTime=c;return a}function qe(a,b,c){a=la(6,a,null,b);a.expirationTime=c;return a}function re(a,b,c){b=la(4,null!==a.children?a.children:[],a.key,b);b.expirationTime=c;b.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation};return b}function Ij(a,b,c){this.tag=b;this.current=null;this.containerInfo=a;this.pingCache=this.pendingChildren=null;this.finishedExpirationTime=0;this.finishedWork=null;this.timeoutHandle=-1;this.pendingContext=this.context=null;this.hydrate=c;this.callbackNode=null;this.callbackPriority=90;this.lastExpiredTime=this.lastPingedTime=this.nextKnownPendingLevel=this.lastSuspendedTime=this.firstSuspendedTime=this.firstPendingTime=0}function Kh(a,b){var c=a.firstSuspendedTime;a=a.lastSuspendedTime;return 0!==c&&c>=b&&a<=b}function Ya(a,b){var c=a.firstSuspendedTime,d=a.lastSuspendedTime;c<b&&(a.firstSuspendedTime=b);if(d>b||0===c)a.lastSuspendedTime=b;b<=a.lastPingedTime&&(a.lastPingedTime=0);b<=a.lastExpiredTime&&(a.lastExpiredTime=0)}function yh(a,b){b>a.firstPendingTime&&(a.firstPendingTime=b);var c=a.firstSuspendedTime;0!==c&&(b>=c?a.firstSuspendedTime=a.lastSuspendedTime=a.nextKnownPendingLevel=0:b>=a.lastSuspendedTime&&(a.lastSuspendedTime=b+1),b>a.nextKnownPendingLevel&&(a.nextKnownPendingLevel=b))}function Ue(a,b){var c=a.lastExpiredTime;if(0===c||c>b)a.lastExpiredTime=b}function md(a,b,c,d){var e=b.current,f=ka(),g=Vb.suspense;f=Va(f,e,g);a:if(c){c=c._reactInternalFiber;b:{if(Na(c)!==c||1!==c.tag)throw Error(k(170));var h=c;do{switch(h.tag){case 3:h=h.stateNode.context;break b;case 1:if(N(h.type)){h=h.stateNode.__reactInternalMemoizedMergedChildContext;break b}}h=h.return}while(null!==h);throw Error(k(171))}if(1===c.tag){var m=c.type;if(N(m)){c=Gg(c,m,h);break a}}c=h}else c=Ca;null===b.context?b.context=c:b.pendingContext=c;b=Ea(f,g);b.payload={element:a};d=void 0===d?null:d;null!==d&&(b.callback=d);Fa(e,b);Ja(e,f);return f}function cf(a){a=a.current;if(!a.child)return null;switch(a.child.tag){case 5:return a.child.stateNode;default:return a.child.stateNode;}}function Wh(a,b){a=a.memoizedState;null!==a&&null!==a.dehydrated&&a.retryTime<b&&(a.retryTime=b)}function df(a,b){Wh(a,b);(a=a.alternate)&&Wh(a,b)}function ef(a,b,c){c=null!=c&&!0===c.hydrate;var d=new Ij(a,b,c),e=la(3,null,null,2===b?7:1===b?3:0);d.current=e;e.stateNode=d;ne(e);a[Lb]=d.current;c&&0!==b&&xi(a,9===a.nodeType?a:a.ownerDocument);this._internalRoot=d}function bc(a){return!(!a||1!==a.nodeType&&9!==a.nodeType&&11!==a.nodeType&&(8!==a.nodeType||" react-mount-point-unstable "!==a.nodeValue))}function Jj(a,b){b||(b=a?9===a.nodeType?a.documentElement:a.firstChild:null,b=!(!b||1!==b.nodeType||!b.hasAttribute("data-reactroot")));if(!b)for(var c;c=a.lastChild;)a.removeChild(c);return new ef(a,0,b?{hydrate:!0}:void 0)}function nd(a,b,c,d,e){var f=c._reactRootContainer;if(f){var g=f._internalRoot;if("function"===typeof e){var h=e;e=function(){var a=cf(g);h.call(a)}}md(b,g,a,e)}else{f=c._reactRootContainer=Jj(c,d);g=f._internalRoot;if("function"===typeof e){var m=e;e=function(){var a=cf(g);m.call(a)}}Rh(function(){md(b,g,a,e)})}return cf(g)}function Kj(a,b,c){var d=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:gb,key:null==d?null:""+d,children:a,containerInfo:b,implementation:c}}function Xh(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!bc(b))throw Error(k(200));return Kj(a,b,null,c)}if(!ea)throw Error(k(227));var ki=function(a,b,c,d,e,f,g,h,m){var n=Array.prototype.slice.call(arguments,3);try{b.apply(c,n)}catch(C){this.onError(C)}},yb=!1,gc=null,hc=!1,pd=null,li={onError:function(a){yb=!0;gc=a}},td=null,rf=null,mf=null,ic=null,cb={},jc=[],qd={},db={},rd={},wa=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),M=ea.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.assign,sd=null,eb=null,fb=null,ee=function(a,b){return a(b)},eg=function(a,b,c,d,e){return a(b,c,d,e)},vd=function(){},vf=ee,Oa=!1,wd=!1,Z=ea.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.Scheduler,Lj=Z.unstable_cancelCallback,ff=Z.unstable_now,$f=Z.unstable_scheduleCallback,Mj=Z.unstable_shouldYield,Yh=Z.unstable_requestPaint,Pd=Z.unstable_runWithPriority,Nj=Z.unstable_getCurrentPriorityLevel,Oj=Z.unstable_ImmediatePriority,Zh=Z.unstable_UserBlockingPriority,ag=Z.unstable_NormalPriority,Pj=Z.unstable_LowPriority,Qj=Z.unstable_IdlePriority,oi=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,wf=Object.prototype.hasOwnProperty,yf={},xf={},E={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(a){E[a]=new L(a,0,!1,a,null,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(a){var b=a[0];E[b]=new L(b,1,!1,a[1],null,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(a){E[a]=new L(a,2,!1,a.toLowerCase(),null,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(a){E[a]=new L(a,2,!1,a,null,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(a){E[a]=new L(a,3,!1,a.toLowerCase(),null,!1)});["checked","multiple","muted","selected"].forEach(function(a){E[a]=new L(a,3,!0,a,null,!1)});["capture","download"].forEach(function(a){E[a]=new L(a,4,!1,a,null,!1)});["cols","rows","size","span"].forEach(function(a){E[a]=new L(a,6,!1,a,null,!1)});["rowSpan","start"].forEach(function(a){E[a]=new L(a,5,!1,a.toLowerCase(),null,!1)});var gf=/[\-:]([a-z])/g,hf=function(a){return a[1].toUpperCase()};"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(a){var b=a.replace(gf,hf);E[b]=new L(b,1,!1,a,null,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(a){var b=a.replace(gf,hf);E[b]=new L(b,1,!1,a,"http://www.w3.org/1999/xlink",!1)});["xml:base","xml:lang","xml:space"].forEach(function(a){var b=a.replace(gf,hf);E[b]=new L(b,1,!1,a,"http://www.w3.org/XML/1998/namespace",!1)});["tabIndex","crossOrigin"].forEach(function(a){E[a]=new L(a,1,!1,a.toLowerCase(),null,!1)});E.xlinkHref=new L("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0);["src","href","action","formAction"].forEach(function(a){E[a]=new L(a,1,!1,a.toLowerCase(),null,!0)});var da=ea.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;da.hasOwnProperty("ReactCurrentDispatcher")||(da.ReactCurrentDispatcher={current:null});da.hasOwnProperty("ReactCurrentBatchConfig")||(da.ReactCurrentBatchConfig={suspense:null});var si=/^(.*)[\\\/]/,Q="function"===typeof Symbol&&Symbol.for,Pc=Q?Symbol.for("react.element"):60103,gb=Q?Symbol.for("react.portal"):60106,Ma=Q?Symbol.for("react.fragment"):60107,Af=Q?Symbol.for("react.strict_mode"):60108,kc=Q?Symbol.for("react.profiler"):60114,Cf=Q?Symbol.for("react.provider"):60109,Bf=Q?Symbol.for("react.context"):60110,Hj=Q?Symbol.for("react.concurrent_mode"):60111,zd=Q?Symbol.for("react.forward_ref"):60112,lc=Q?Symbol.for("react.suspense"):60113,yd=Q?Symbol.for("react.suspense_list"):60120,Ad=Q?Symbol.for("react.memo"):60115,Ef=Q?Symbol.for("react.lazy"):60116,Df=Q?Symbol.for("react.block"):60121,zf="function"===typeof Symbol&&Symbol.iterator,od,xh=function(a){return"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(b,c,d,e){MSApp.execUnsafeLocalFunction(function(){return a(b,c,d,e)})}:a}(function(a,b){if("http://www.w3.org/2000/svg"!==a.namespaceURI||"innerHTML"in a)a.innerHTML=b;else{od=od||document.createElement("div");od.innerHTML="<svg>"+b.valueOf().toString()+"</svg>";for(b=od.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;b.firstChild;)a.appendChild(b.firstChild)}}),Wb=function(a,b){if(b){var c=a.firstChild;if(c&&c===a.lastChild&&3===c.nodeType){c.nodeValue=b;return}}a.textContent=b},ib={animationend:nc("Animation","AnimationEnd"),animationiteration:nc("Animation","AnimationIteration"),animationstart:nc("Animation","AnimationStart"),transitionend:nc("Transition","TransitionEnd")},Id={},Of={};wa&&(Of=document.createElement("div").style,"AnimationEvent"in window||(delete ib.animationend.animation,delete ib.animationiteration.animation,delete ib.animationstart.animation),"TransitionEvent"in window||delete ib.transitionend.transition);var $h=oc("animationend"),ai=oc("animationiteration"),bi=oc("animationstart"),ci=oc("transitionend"),Db="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Pf=new("function"===typeof WeakMap?WeakMap:Map),Ab=null,wi=function(a){if(a){var b=a._dispatchListeners,c=a._dispatchInstances;if(Array.isArray(b))for(var d=0;d<b.length&&!a.isPropagationStopped();d++)lf(a,b[d],c[d]);else b&&lf(a,b,c);a._dispatchListeners=null;a._dispatchInstances=null;a.isPersistent()||a.constructor.release(a)}},qc=[],Rd=!1,fa=[],xa=null,ya=null,za=null,Eb=new Map,Fb=new Map,Jb=[],Nd="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput close cancel copy cut paste click change contextmenu reset submit".split(" "),yi="focus blur dragenter dragleave mouseover mouseout pointerover pointerout gotpointercapture lostpointercapture".split(" "),dg={},cg=new Map,Td=new Map,Rj=["abort","abort",$h,"animationEnd",ai,"animationIteration",bi,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",ci,"transitionEnd","waiting","waiting"];Sd("blur blur cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focus focus input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0);Sd("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1);Sd(Rj,2);(function(a,b){for(var c=0;c<a.length;c++)Td.set(a[c],b)})("change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),0);var Hi=Zh,Gi=Pd,tc=!0,Kb={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Sj=["Webkit","ms","Moz","O"];Object.keys(Kb).forEach(function(a){Sj.forEach(function(b){b=b+a.charAt(0).toUpperCase()+a.substring(1);Kb[b]=Kb[a]})});var Ii=M({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0}),ng="$",og="/$",$d="$?",Zd="$!",Ze=null,$e=null,We="function"===typeof setTimeout?setTimeout:void 0,vj="function"===typeof clearTimeout?clearTimeout:void 0,jf=Math.random().toString(36).slice(2),Aa="__reactInternalInstance$"+jf,vc="__reactEventHandlers$"+jf,Lb="__reactContainere$"+jf,Ba=null,ce=null,wc=null;M(R.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():"unknown"!==typeof a.returnValue&&(a.returnValue=!1),this.isDefaultPrevented=xc)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():"unknown"!==typeof a.cancelBubble&&(a.cancelBubble=!0),this.isPropagationStopped=xc)},persist:function(){this.isPersistent=xc},isPersistent:yc,destructor:function(){var a=this.constructor.Interface,b;for(b in a)this[b]=null;this.nativeEvent=this._targetInst=this.dispatchConfig=null;this.isPropagationStopped=this.isDefaultPrevented=yc;this._dispatchInstances=this._dispatchListeners=null}});R.Interface={type:null,target:null,currentTarget:function(){return null},eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null};R.extend=function(a){function b(){return c.apply(this,arguments)}var c=this,d=function(){};d.prototype=c.prototype;d=new d;M(d,b.prototype);b.prototype=d;b.prototype.constructor=b;b.Interface=M({},c.Interface,a);b.extend=c.extend;sg(b);return b};sg(R);var Tj=R.extend({data:null}),Uj=R.extend({data:null}),Ni=[9,13,27,32],de=wa&&"CompositionEvent"in window,cc=null;wa&&"documentMode"in document&&(cc=document.documentMode);var Vj=wa&&"TextEvent"in window&&!cc,xg=wa&&(!de||cc&&8<cc&&11>=cc),wg=String.fromCharCode(32),ua={beforeInput:{phasedRegistrationNames:{bubbled:"onBeforeInput",captured:"onBeforeInputCapture"},dependencies:["compositionend","keypress","textInput","paste"]},compositionEnd:{phasedRegistrationNames:{bubbled:"onCompositionEnd",captured:"onCompositionEndCapture"},dependencies:"blur compositionend keydown keypress keyup mousedown".split(" ")},compositionStart:{phasedRegistrationNames:{bubbled:"onCompositionStart",captured:"onCompositionStartCapture"},dependencies:"blur compositionstart keydown keypress keyup mousedown".split(" ")},compositionUpdate:{phasedRegistrationNames:{bubbled:"onCompositionUpdate",captured:"onCompositionUpdateCapture"},dependencies:"blur compositionupdate keydown keypress keyup mousedown".split(" ")}},vg=!1,mb=!1,Wj={eventTypes:ua,extractEvents:function(a,b,c,d,e){var f;if(de)b:{switch(a){case"compositionstart":var g=ua.compositionStart;break b;case"compositionend":g=ua.compositionEnd;break b;case"compositionupdate":g=ua.compositionUpdate;break b;}g=void 0}else mb?tg(a,c)&&(g=ua.compositionEnd):"keydown"===a&&229===c.keyCode&&(g=ua.compositionStart);g?(xg&&"ko"!==c.locale&&(mb||g!==ua.compositionStart?g===ua.compositionEnd&&mb&&(f=rg()):(Ba=d,ce="value"in Ba?Ba.value:Ba.textContent,mb=!0)),e=Tj.getPooled(g,b,c,d),f?e.data=f:(f=ug(c),null!==f&&(e.data=f)),lb(e),f=e):f=null;(a=Vj?Oi(a,c):Pi(a,c))?(b=Uj.getPooled(ua.beforeInput,b,c,d),b.data=a,lb(b)):b=null;return null===f?b:null===b?f:[f,b]}},Qi={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0},Ag={change:{phasedRegistrationNames:{bubbled:"onChange",captured:"onChangeCapture"},dependencies:"blur change click focus input keydown keyup selectionchange".split(" ")}},Mb=null,Nb=null,kf=!1;wa&&(kf=Tf("input")&&(!document.documentMode||9<document.documentMode));var Xj={eventTypes:Ag,_isInputEventSupported:kf,extractEvents:function(a,b,c,d,e){e=b?Pa(b):window;var f=e.nodeName&&e.nodeName.toLowerCase();if("select"===f||"input"===f&&"file"===e.type)var g=Si;else if(yg(e)){if(kf)g=Wi;else{g=Ui;var h=Ti}}else(f=e.nodeName)&&"input"===f.toLowerCase()&&("checkbox"===e.type||"radio"===e.type)&&(g=Vi);if(g&&(g=g(a,b)))return zg(g,c,d);h&&h(a,e,b);"blur"===a&&(a=e._wrapperState)&&a.controlled&&"number"===e.type&&Ed(e,"number",e.value)}},dc=R.extend({view:null,detail:null}),Yi={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"},di=0,ei=0,fi=!1,gi=!1,ec=dc.extend({screenX:null,screenY:null,clientX:null,clientY:null,pageX:null,pageY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getModifierState:fe,button:null,buttons:null,relatedTarget:function(a){return a.relatedTarget||(a.fromElement===a.srcElement?a.toElement:a.fromElement)},movementX:function(a){if("movementX"in a)return a.movementX;var b=di;di=a.screenX;return fi?"mousemove"===a.type?a.screenX-b:0:(fi=!0,0)},movementY:function(a){if("movementY"in a)return a.movementY;var b=ei;ei=a.screenY;return gi?"mousemove"===a.type?a.screenY-b:0:(gi=!0,0)}}),hi=ec.extend({pointerId:null,width:null,height:null,pressure:null,tangentialPressure:null,tiltX:null,tiltY:null,twist:null,pointerType:null,isPrimary:null}),fc={mouseEnter:{registrationName:"onMouseEnter",dependencies:["mouseout","mouseover"]},mouseLeave:{registrationName:"onMouseLeave",dependencies:["mouseout","mouseover"]},pointerEnter:{registrationName:"onPointerEnter",dependencies:["pointerout","pointerover"]},pointerLeave:{registrationName:"onPointerLeave",dependencies:["pointerout","pointerover"]}},Yj={eventTypes:fc,extractEvents:function(a,b,c,d,e){var f="mouseover"===a||"pointerover"===a,g="mouseout"===a||"pointerout"===a;if(f&&0===(e&32)&&(c.relatedTarget||c.fromElement)||!g&&!f)return null;f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window;if(g){if(g=b,b=(b=c.relatedTarget||c.toElement)?Bb(b):null,null!==b){var h=Na(b);if(b!==h||5!==b.tag&&6!==b.tag)b=null}}else g=null;if(g===b)return null;if("mouseout"===a||"mouseover"===a){var m=ec;var n=fc.mouseLeave;var l=fc.mouseEnter;var k="mouse"}else if("pointerout"===a||"pointerover"===a)m=hi,n=fc.pointerLeave,l=fc.pointerEnter,k="pointer";a=null==g?f:Pa(g);f=null==b?f:Pa(b);n=m.getPooled(n,g,c,d);n.type=k+"leave";n.target=a;n.relatedTarget=f;c=m.getPooled(l,b,c,d);c.type=k+"enter";c.target=f;c.relatedTarget=a;d=g;k=b;if(d&&k)a:{m=d;l=k;g=0;for(a=m;a;a=pa(a))g++;a=0;for(b=l;b;b=pa(b))a++;for(;0<g-a;)m=pa(m),g--;for(;0<a-g;)l=pa(l),a--;for(;g--;){if(m===l||m===l.alternate)break a;m=pa(m);l=pa(l)}m=null}else m=null;l=m;for(m=[];d&&d!==l;){g=d.alternate;if(null!==g&&g===l)break;m.push(d);d=pa(d)}for(d=[];k&&k!==l;){g=k.alternate;if(null!==g&&g===l)break;d.push(k);k=pa(k)}for(k=0;k<m.length;k++)be(m[k],"bubbled",n);for(k=d.length;0<k--;)be(d[k],"captured",c);return 0===(e&64)?[n]:[n,c]}},Qa="function"===typeof Object.is?Object.is:Zi,$i=Object.prototype.hasOwnProperty,Zj=wa&&"documentMode"in document&&11>=document.documentMode,Eg={select:{phasedRegistrationNames:{bubbled:"onSelect",captured:"onSelectCapture"},dependencies:"blur contextmenu dragend focus keydown keyup mousedown mouseup selectionchange".split(" ")}},nb=null,he=null,Pb=null,ge=!1,ak={eventTypes:Eg,extractEvents:function(a,b,c,d,e,f){e=f||(d.window===d?d.document:9===d.nodeType?d:d.ownerDocument);if(!(f=!e)){a:{e=Jd(e);f=rd.onSelect;for(var g=0;g<f.length;g++)if(!e.has(f[g])){e=!1;break a}e=!0}f=!e}if(f)return null;e=b?Pa(b):window;switch(a){case"focus":if(yg(e)||"true"===e.contentEditable)nb=e,he=b,Pb=null;break;case"blur":Pb=he=nb=null;break;case"mousedown":ge=!0;break;case"contextmenu":case"mouseup":case"dragend":return ge=!1,Dg(c,d);case"selectionchange":if(Zj)break;case"keydown":case"keyup":return Dg(c,d);}return null}},bk=R.extend({animationName:null,elapsedTime:null,pseudoElement:null}),ck=R.extend({clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),dk=dc.extend({relatedTarget:null}),ek={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fk={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},gk=dc.extend({key:function(a){if(a.key){var b=ek[a.key]||a.key;if("Unidentified"!==b)return b}return"keypress"===a.type?(a=Ac(a),13===a?"Enter":String.fromCharCode(a)):"keydown"===a.type||"keyup"===a.type?fk[a.keyCode]||"Unidentified":""},location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:fe,charCode:function(a){return"keypress"===a.type?Ac(a):0},keyCode:function(a){return"keydown"===a.type||"keyup"===a.type?a.keyCode:0},which:function(a){return"keypress"===a.type?Ac(a):"keydown"===a.type||"keyup"===a.type?a.keyCode:0}}),hk=ec.extend({dataTransfer:null}),ik=dc.extend({touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:fe}),jk=R.extend({propertyName:null,elapsedTime:null,pseudoElement:null}),kk=ec.extend({deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:null,deltaMode:null}),lk={eventTypes:dg,extractEvents:function(a,b,c,d,e){e=cg.get(a);if(!e)return null;switch(a){case"keypress":if(0===Ac(c))return null;case"keydown":case"keyup":a=gk;break;case"blur":case"focus":a=dk;break;case"click":if(2===c.button)return null;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":a=ec;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":a=hk;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":a=ik;break;case $h:case ai:case bi:a=bk;break;case ci:a=jk;break;case"scroll":a=dc;break;case"wheel":a=kk;break;case"copy":case"cut":case"paste":a=ck;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":a=hi;break;default:a=R;}b=a.getPooled(e,b,c,d);lb(b);return b}};(function(a){if(ic)throw Error(k(101));ic=Array.prototype.slice.call(a);nf()})("ResponderEventPlugin SimpleEventPlugin EnterLeaveEventPlugin ChangeEventPlugin SelectEventPlugin BeforeInputEventPlugin".split(" "));(function(a,b,c){td=a;rf=b;mf=c})(ae,Hb,Pa);pf({SimpleEventPlugin:lk,EnterLeaveEventPlugin:Yj,ChangeEventPlugin:Xj,SelectEventPlugin:ak,BeforeInputEventPlugin:Wj});var ie=[],ob=-1,Ca={},B={current:Ca},G={current:!1},Ra=Ca,bj=Pd,je=$f,Rg=Lj,aj=Nj,Dc=Oj,Ig=Zh,Jg=ag,Kg=Pj,Lg=Qj,Qg={},yj=Mj,Cj=void 0!==Yh?Yh:function(){},qa=null,Ec=null,ke=!1,ii=ff(),Y=1E4>ii?ff:function(){return ff()-ii},Ic={current:null},Hc=null,qb=null,Gc=null,Tg=0,Jc=2,Ga=!1,Vb=da.ReactCurrentBatchConfig,$g=new ea.Component().refs,Mc={isMounted:function(a){return(a=a._reactInternalFiber)?Na(a)===a:!1},enqueueSetState:function(a,b,c){a=a._reactInternalFiber;var d=ka(),e=Vb.suspense;d=Va(d,a,e);e=Ea(d,e);e.payload=b;void 0!==c&&null!==c&&(e.callback=c);Fa(a,e);Ja(a,d)},enqueueReplaceState:function(a,b,c){a=a._reactInternalFiber;var d=ka(),e=Vb.suspense;d=Va(d,a,e);e=Ea(d,e);e.tag=1;e.payload=b;void 0!==c&&null!==c&&(e.callback=c);Fa(a,e);Ja(a,d)},enqueueForceUpdate:function(a,b){a=a._reactInternalFiber;var c=ka(),d=Vb.suspense;c=Va(c,a,d);d=Ea(c,d);d.tag=Jc;void 0!==b&&null!==b&&(d.callback=b);Fa(a,d);Ja(a,c)}},Qc=Array.isArray,wb=ah(!0),Fe=ah(!1),Sb={},ja={current:Sb},Ub={current:Sb},Tb={current:Sb},D={current:0},Sc=da.ReactCurrentDispatcher,X=da.ReactCurrentBatchConfig,Ia=0,z=null,K=null,J=null,Uc=!1,Tc={readContext:W,useCallback:S,useContext:S,useEffect:S,useImperativeHandle:S,useLayoutEffect:S,useMemo:S,useReducer:S,useRef:S,useState:S,useDebugValue:S,useResponder:S,useDeferredValue:S,useTransition:S},dj={readContext:W,useCallback:ih,useContext:W,useEffect:eh,useImperativeHandle:function(a,b,c){c=null!==c&&void 0!==c?c.concat([a]):null;return ze(4,2,gh.bind(null,b,a),c)},useLayoutEffect:function(a,b){return ze(4,2,a,b)},useMemo:function(a,b){var c=ub();b=void 0===b?null:b;a=a();c.memoizedState=[a,b];return a},useReducer:function(a,b,c){var d=ub();b=void 0!==c?c(b):b;d.memoizedState=d.baseState=b;a=d.queue={pending:null,dispatch:null,lastRenderedReducer:a,lastRenderedState:b};a=a.dispatch=ch.bind(null,z,a);return[d.memoizedState,a]},useRef:function(a){var b=ub();a={current:a};return b.memoizedState=a},useState:xe,useDebugValue:Be,useResponder:ue,useDeferredValue:function(a,b){var c=xe(a),d=c[0],e=c[1];eh(function(){var c=X.suspense;X.suspense=void 0===b?null:b;try{e(a)}finally{X.suspense=c}},[a,b]);return d},useTransition:function(a){var b=xe(!1),c=b[0];b=b[1];return[ih(Ce.bind(null,b,a),[b,a]),c]}},ej={readContext:W,useCallback:Yc,useContext:W,useEffect:Xc,useImperativeHandle:hh,useLayoutEffect:fh,useMemo:jh,useReducer:Vc,useRef:dh,useState:function(a){return Vc(Ua)},useDebugValue:Be,useResponder:ue,useDeferredValue:function(a,b){var c=Vc(Ua),d=c[0],e=c[1];Xc(function(){var c=X.suspense;X.suspense=void 0===b?null:b;try{e(a)}finally{X.suspense=c}},[a,b]);return d},useTransition:function(a){var b=Vc(Ua),c=b[0];b=b[1];return[Yc(Ce.bind(null,b,a),[b,a]),c]}},fj={readContext:W,useCallback:Yc,useContext:W,useEffect:Xc,useImperativeHandle:hh,useLayoutEffect:fh,useMemo:jh,useReducer:Wc,useRef:dh,useState:function(a){return Wc(Ua)},useDebugValue:Be,useResponder:ue,useDeferredValue:function(a,b){var c=Wc(Ua),d=c[0],e=c[1];Xc(function(){var c=X.suspense;X.suspense=void 0===b?null:b;try{e(a)}finally{X.suspense=c}},[a,b]);return d},useTransition:function(a){var b=Wc(Ua),c=b[0];b=b[1];return[Yc(Ce.bind(null,b,a),[b,a]),c]}},ra=null,Ka=null,Wa=!1,gj=da.ReactCurrentOwner,ia=!1,Je={dehydrated:null,retryTime:0};var jj=function(a,b,c,d){for(c=b.child;null!==c;){if(5===c.tag||6===c.tag)a.appendChild(c.stateNode);else if(4!==c.tag&&null!==c.child){c.child.return=c;c=c.child;continue}if(c===b)break;for(;null===c.sibling;){if(null===c.return||c.return===b)return;c=c.return}c.sibling.return=c.return;c=c.sibling}};var wh=function(a){};var ij=function(a,b,c,d,e){var f=a.memoizedProps;if(f!==d){var g=b.stateNode;Ta(ja.current);a=null;switch(c){case"input":f=Cd(g,f);d=Cd(g,d);a=[];break;case"option":f=Fd(g,f);d=Fd(g,d);a=[];break;case"select":f=M({},f,{value:void 0});d=M({},d,{value:void 0});a=[];break;case"textarea":f=Gd(g,f);d=Gd(g,d);a=[];break;default:"function"!==typeof f.onClick&&"function"===typeof d.onClick&&(g.onclick=uc);}Ud(c,d);var h,m;c=null;for(h in f)if(!d.hasOwnProperty(h)&&f.hasOwnProperty(h)&&null!=f[h])if("style"===h)for(m in g=f[h],g)g.hasOwnProperty(m)&&(c||(c={}),c[m]="");else"dangerouslySetInnerHTML"!==h&&"children"!==h&&"suppressContentEditableWarning"!==h&&"suppressHydrationWarning"!==h&&"autoFocus"!==h&&(db.hasOwnProperty(h)?a||(a=[]):(a=a||[]).push(h,null));for(h in d){var k=d[h];g=null!=f?f[h]:void 0;if(d.hasOwnProperty(h)&&k!==g&&(null!=k||null!=g))if("style"===h){if(g){for(m in g)!g.hasOwnProperty(m)||k&&k.hasOwnProperty(m)||(c||(c={}),c[m]="");for(m in k)k.hasOwnProperty(m)&&g[m]!==k[m]&&(c||(c={}),c[m]=k[m])}else c||(a||(a=[]),a.push(h,c)),c=k;}else"dangerouslySetInnerHTML"===h?(k=k?k.__html:void 0,g=g?g.__html:void 0,null!=k&&g!==k&&(a=a||[]).push(h,k)):"children"===h?g===k||"string"!==typeof k&&"number"!==typeof k||(a=a||[]).push(h,""+k):"suppressContentEditableWarning"!==h&&"suppressHydrationWarning"!==h&&(db.hasOwnProperty(h)?(null!=k&&oa(e,h),a||g===k||(a=[])):(a=a||[]).push(h,k))}c&&(a=a||[]).push("style",c);e=a;if(b.updateQueue=e)b.effectTag|=4}};var kj=function(a,b,c,d){c!==d&&(b.effectTag|=4)};var pj="function"===typeof WeakSet?WeakSet:Set,wj="function"===typeof WeakMap?WeakMap:Map,sj=Math.ceil,gd=da.ReactCurrentDispatcher,Uh=da.ReactCurrentOwner,H=0,Ye=8,ca=16,ma=32,Xa=0,hd=1,Oh=2,ad=3,bd=4,Xe=5,p=H,U=null,t=null,P=0,F=Xa,id=null,ta=1073741823,Yb=1073741823,kd=null,Xb=0,jd=!1,Re=0,Ph=500,l=null,cd=!1,Se=null,La=null,ld=!1,Zb=null,$b=90,bb=null,ac=0,af=null,dd=0,Ja=function(a,b){if(50<ac)throw ac=0,af=null,Error(k(185));a=ed(a,b);if(null!==a){var c=Cc();1073741823===b?(p&Ye)!==H&&(p&(ca|ma))===H?Te(a):(V(a),p===H&&ha()):V(a);(p&4)===H||98!==c&&99!==c||(null===bb?bb=new Map([[a,b]]):(c=bb.get(a),(void 0===c||c>b)&&bb.set(a,b)))}};var zj=function(a,b,c){var d=b.expirationTime;if(null!==a){var e=b.pendingProps;if(a.memoizedProps!==e||G.current)ia=!0;else{if(d<c){ia=!1;switch(b.tag){case 3:sh(b);Ee();break;case 5:bh(b);if(b.mode&4&&1!==c&&e.hidden)return b.expirationTime=b.childExpirationTime=1,null;break;case 1:N(b.type)&&Bc(b);break;case 4:se(b,b.stateNode.containerInfo);break;case 10:d=b.memoizedProps.value;e=b.type._context;y(Ic,e._currentValue);e._currentValue=d;break;case 13:if(null!==b.memoizedState){d=b.child.childExpirationTime;if(0!==d&&d>=c)return th(a,b,c);y(D,D.current&1);b=sa(a,b,c);return null!==b?b.sibling:null}y(D,D.current&1);break;case 19:d=b.childExpirationTime>=c;if(0!==(a.effectTag&64)){if(d)return vh(a,b,c);b.effectTag|=64}e=b.memoizedState;null!==e&&(e.rendering=null,e.tail=null);y(D,D.current);if(!d)return null;}return sa(a,b,c)}ia=!1}}else ia=!1;b.expirationTime=0;switch(b.tag){case 2:d=b.type;null!==a&&(a.alternate=null,b.alternate=null,b.effectTag|=2);a=b.pendingProps;e=pb(b,B.current);rb(b,c);e=we(null,b,d,a,e,c);b.effectTag|=1;if("object"===typeof e&&null!==e&&"function"===typeof e.render&&void 0===e.$$typeof){b.tag=1;b.memoizedState=null;b.updateQueue=null;if(N(d)){var f=!0;Bc(b)}else f=!1;b.memoizedState=null!==e.state&&void 0!==e.state?e.state:null;ne(b);var g=d.getDerivedStateFromProps;"function"===typeof g&&Lc(b,d,g,a);e.updater=Mc;b.stateNode=e;e._reactInternalFiber=b;pe(b,d,a,c);b=Ie(null,b,d,!0,f,c)}else b.tag=0,T(null,b,e,c),b=b.child;return b;case 16:a:{e=b.elementType;null!==a&&(a.alternate=null,b.alternate=null,b.effectTag|=2);a=b.pendingProps;ri(e);if(1!==e._status)throw e._result;e=e._result;b.type=e;f=b.tag=Gj(e);a=aa(e,a);switch(f){case 0:b=He(null,b,e,a,c);break a;case 1:b=rh(null,b,e,a,c);break a;case 11:b=nh(null,b,e,a,c);break a;case 14:b=oh(null,b,e,aa(e.type,a),d,c);break a;}throw Error(k(306,e,""))}return b;case 0:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:aa(d,e),He(a,b,d,e,c);case 1:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:aa(d,e),rh(a,b,d,e,c);case 3:sh(b);d=b.updateQueue;if(null===a||null===d)throw Error(k(282));d=b.pendingProps;e=b.memoizedState;e=null!==e?e.element:null;oe(a,b);Qb(b,d,null,c);d=b.memoizedState.element;if(d===e)Ee(),b=sa(a,b,c);else{if(e=b.stateNode.hydrate)Ka=kb(b.stateNode.containerInfo.firstChild),ra=b,e=Wa=!0;if(e)for(c=Fe(b,null,d,c),b.child=c;c;)c.effectTag=c.effectTag&-3|1024,c=c.sibling;else T(a,b,d,c),Ee();b=b.child}return b;case 5:return bh(b),null===a&&De(b),d=b.type,e=b.pendingProps,f=null!==a?a.memoizedProps:null,g=e.children,Yd(d,e)?g=null:null!==f&&Yd(d,f)&&(b.effectTag|=16),qh(a,b),b.mode&4&&1!==c&&e.hidden?(b.expirationTime=b.childExpirationTime=1,b=null):(T(a,b,g,c),b=b.child),b;case 6:return null===a&&De(b),null;case 13:return th(a,b,c);case 4:return se(b,b.stateNode.containerInfo),d=b.pendingProps,null===a?b.child=wb(b,null,d,c):T(a,b,d,c),b.child;case 11:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:aa(d,e),nh(a,b,d,e,c);case 7:return T(a,b,b.pendingProps,c),b.child;case 8:return T(a,b,b.pendingProps.children,c),b.child;case 12:return T(a,b,b.pendingProps.children,c),b.child;case 10:a:{d=b.type._context;e=b.pendingProps;g=b.memoizedProps;f=e.value;var h=b.type._context;y(Ic,h._currentValue);h._currentValue=f;if(null!==g)if(h=g.value,f=Qa(h,f)?0:("function"===typeof d._calculateChangedBits?d._calculateChangedBits(h,f):1073741823)|0,0===f){if(g.children===e.children&&!G.current){b=sa(a,b,c);break a}}else for(h=b.child,null!==h&&(h.return=b);null!==h;){var m=h.dependencies;if(null!==m){g=h.child;for(var l=m.firstContext;null!==l;){if(l.context===d&&0!==(l.observedBits&f)){1===h.tag&&(l=Ea(c,null),l.tag=Jc,Fa(h,l));h.expirationTime<c&&(h.expirationTime=c);l=h.alternate;null!==l&&l.expirationTime<c&&(l.expirationTime=c);Sg(h.return,c);m.expirationTime<c&&(m.expirationTime=c);break}l=l.next}}else g=10===h.tag?h.type===b.type?null:h.child:h.child;if(null!==g)g.return=h;else for(g=h;null!==g;){if(g===b){g=null;break}h=g.sibling;if(null!==h){h.return=g.return;g=h;break}g=g.return}h=g}T(a,b,e.children,c);b=b.child}return b;case 9:return e=b.type,f=b.pendingProps,d=f.children,rb(b,c),e=W(e,f.unstable_observedBits),d=d(e),b.effectTag|=1,T(a,b,d,c),b.child;case 14:return e=b.type,f=aa(e,b.pendingProps),f=aa(e.type,f),oh(a,b,e,f,d,c);case 15:return ph(a,b,b.type,b.pendingProps,d,c);case 17:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:aa(d,e),null!==a&&(a.alternate=null,b.alternate=null,b.effectTag|=2),b.tag=1,N(d)?(a=!0,Bc(b)):a=!1,rb(b,c),Yg(b,d,e),pe(b,d,e,c),Ie(null,b,d,!0,a,c);case 19:return vh(a,b,c);}throw Error(k(156,b.tag))};var bf=null,Ne=null,la=function(a,b,c,d){return new Fj(a,b,c,d)};ef.prototype.render=function(a){md(a,this._internalRoot,null,null)};ef.prototype.unmount=function(){var a=this._internalRoot,b=a.containerInfo;md(null,a,null,function(){b[Lb]=null})};var Di=function(a){if(13===a.tag){var b=Fc(ka(),150,100);Ja(a,b);df(a,b)}};var Yf=function(a){13===a.tag&&(Ja(a,3),df(a,3))};var Bi=function(a){if(13===a.tag){var b=ka();b=Va(b,a,null);Ja(a,b);df(a,b)}};sd=function(a,b,c){switch(b){case"input":Dd(a,c);b=c.name;if("radio"===c.type&&null!=b){for(c=a;c.parentNode;)c=c.parentNode;c=c.querySelectorAll("input[name="+JSON.stringify(""+b)+"][type=\"radio\"]");for(b=0;b<c.length;b++){var d=c[b];if(d!==a&&d.form===a.form){var e=ae(d);if(!e)throw Error(k(90));Gf(d);Dd(d,e)}}}break;case"textarea":Lf(a,c);break;case"select":b=c.value,null!=b&&hb(a,!!c.multiple,b,!1);}};(function(a,b,c,d){ee=a;eg=b;vd=c;vf=d})(Qh,function(a,b,c,d,e){var f=p;p|=4;try{return Da(98,a.bind(null,b,c,d,e))}finally{p=f,p===H&&ha()}},function(){(p&(1|ca|ma))===H&&(uj(),xb())},function(a,b){var c=p;p|=2;try{return a(b)}finally{p=c,p===H&&ha()}});var mk={Events:[Hb,Pa,ae,pf,qd,lb,function(a){Kd(a,Ki)},sf,tf,sc,pc,xb,{current:!1}]};(function(a){var b=a.findFiberByHostInstance;return Ej(M({},a,{overrideHookState:null,overrideProps:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:da.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){a=Sf(a);return null===a?null:a.stateNode},findFiberByHostInstance:function(a){return b?b(a):null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null}))})({findFiberByHostInstance:Bb,bundleType:0,version:"16.14.0",rendererPackageName:"react-dom"});I.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=mk;I.createPortal=Xh;I.findDOMNode=function(a){if(null==a)return null;if(1===a.nodeType)return a;var b=a._reactInternalFiber;if(void 0===b){if("function"===typeof a.render)throw Error(k(188));throw Error(k(268,Object.keys(a)))}a=Sf(b);a=null===a?null:a.stateNode;return a};I.flushSync=function(a,b){if((p&(ca|ma))!==H)throw Error(k(187));var c=p;p|=1;try{return Da(99,a.bind(null,b))}finally{p=c,ha()}};I.hydrate=function(a,b,c){if(!bc(b))throw Error(k(200));return nd(null,a,b,!0,c)};I.render=function(a,b,c){if(!bc(b))throw Error(k(200));return nd(null,a,b,!1,c)};I.unmountComponentAtNode=function(a){if(!bc(a))throw Error(k(40));return a._reactRootContainer?(Rh(function(){nd(null,null,a,!1,function(){a._reactRootContainer=null;a[Lb]=null})}),!0):!1};I.unstable_batchedUpdates=Qh;I.unstable_createPortal=function(a,b){return Xh(a,b,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)};I.unstable_renderSubtreeIntoContainer=function(a,b,c,d){if(!bc(c))throw Error(k(200));if(null==a||void 0===a._reactInternalFiber)throw Error(k(38));return nd(a,b,c,!1,d)};I.version="16.14.0"});!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("react")):"function"==typeof define&&define.noop?define(["react"],t):(e=e||self).HTMLReactParser=t(e.React)}(this,function(y){"use strict";y=y&&Object.prototype.hasOwnProperty.call(y,"default")?y.default:y;var e={Properties:{autoFocus:4,accept:0,acceptCharset:0,accessKey:0,action:0,allowFullScreen:4,allowTransparency:0,alt:0,as:0,async:4,autoComplete:0,autoPlay:4,capture:4,cellPadding:0,cellSpacing:0,charSet:0,challenge:0,checked:5,cite:0,classID:0,className:0,cols:24,colSpan:0,content:0,contentEditable:0,contextMenu:0,controls:4,controlsList:0,coords:0,crossOrigin:0,data:0,dateTime:0,default:4,defer:4,dir:0,disabled:4,download:32,draggable:0,encType:0,form:0,formAction:0,formEncType:0,formMethod:0,formNoValidate:4,formTarget:0,frameBorder:0,headers:0,height:0,hidden:4,high:0,href:0,hrefLang:0,htmlFor:0,httpEquiv:0,icon:0,id:0,inputMode:0,integrity:0,is:0,keyParams:0,keyType:0,kind:0,label:0,lang:0,list:0,loop:4,low:0,manifest:0,marginHeight:0,marginWidth:0,max:0,maxLength:0,media:0,mediaGroup:0,method:0,min:0,minLength:0,multiple:5,muted:5,name:0,nonce:0,noValidate:4,open:4,optimum:0,pattern:0,placeholder:0,playsInline:4,poster:0,preload:0,profile:0,radioGroup:0,readOnly:4,referrerPolicy:0,rel:0,required:4,reversed:4,role:0,rows:24,rowSpan:8,sandbox:0,scope:0,scoped:4,scrolling:0,seamless:4,selected:5,shape:0,size:24,sizes:0,span:24,spellCheck:0,src:0,srcDoc:0,srcLang:0,srcSet:0,start:8,step:0,style:0,summary:0,tabIndex:0,target:0,title:0,type:0,useMap:0,value:0,width:0,wmode:0,wrap:0,about:0,datatype:0,inlist:0,prefix:0,property:0,resource:0,typeof:0,vocab:0,autoCapitalize:0,autoCorrect:0,autoSave:0,color:0,itemProp:0,itemScope:4,itemType:0,itemID:0,itemRef:0,results:0,security:0,unselectable:0},DOMAttributeNames:{acceptCharset:"accept-charset",className:"class",htmlFor:"for",httpEquiv:"http-equiv"}},t={Properties:{accentHeight:0,accumulate:0,additive:0,alignmentBaseline:0,allowReorder:0,alphabetic:0,amplitude:0,arabicForm:0,ascent:0,attributeName:0,attributeType:0,autoReverse:0,azimuth:0,baseFrequency:0,baseProfile:0,baselineShift:0,bbox:0,begin:0,bias:0,by:0,calcMode:0,capHeight:0,clip:0,clipPath:0,clipRule:0,clipPathUnits:0,colorInterpolation:0,colorInterpolationFilters:0,colorProfile:0,colorRendering:0,contentScriptType:0,contentStyleType:0,cursor:0,cx:0,cy:0,d:0,decelerate:0,descent:0,diffuseConstant:0,direction:0,display:0,divisor:0,dominantBaseline:0,dur:0,dx:0,dy:0,edgeMode:0,elevation:0,enableBackground:0,end:0,exponent:0,externalResourcesRequired:0,fill:0,fillOpacity:0,fillRule:0,filter:0,filterRes:0,filterUnits:0,floodColor:0,floodOpacity:0,focusable:0,fontFamily:0,fontSize:0,fontSizeAdjust:0,fontStretch:0,fontStyle:0,fontVariant:0,fontWeight:0,format:0,from:0,fx:0,fy:0,g1:0,g2:0,glyphName:0,glyphOrientationHorizontal:0,glyphOrientationVertical:0,glyphRef:0,gradientTransform:0,gradientUnits:0,hanging:0,horizAdvX:0,horizOriginX:0,ideographic:0,imageRendering:0,in:0,in2:0,intercept:0,k:0,k1:0,k2:0,k3:0,k4:0,kernelMatrix:0,kernelUnitLength:0,kerning:0,keyPoints:0,keySplines:0,keyTimes:0,lengthAdjust:0,letterSpacing:0,lightingColor:0,limitingConeAngle:0,local:0,markerEnd:0,markerMid:0,markerStart:0,markerHeight:0,markerUnits:0,markerWidth:0,mask:0,maskContentUnits:0,maskUnits:0,mathematical:0,mode:0,numOctaves:0,offset:0,opacity:0,operator:0,order:0,orient:0,orientation:0,origin:0,overflow:0,overlinePosition:0,overlineThickness:0,paintOrder:0,panose1:0,pathLength:0,patternContentUnits:0,patternTransform:0,patternUnits:0,pointerEvents:0,points:0,pointsAtX:0,pointsAtY:0,pointsAtZ:0,preserveAlpha:0,preserveAspectRatio:0,primitiveUnits:0,r:0,radius:0,refX:0,refY:0,renderingIntent:0,repeatCount:0,repeatDur:0,requiredExtensions:0,requiredFeatures:0,restart:0,result:0,rotate:0,rx:0,ry:0,scale:0,seed:0,shapeRendering:0,slope:0,spacing:0,specularConstant:0,specularExponent:0,speed:0,spreadMethod:0,startOffset:0,stdDeviation:0,stemh:0,stemv:0,stitchTiles:0,stopColor:0,stopOpacity:0,strikethroughPosition:0,strikethroughThickness:0,string:0,stroke:0,strokeDasharray:0,strokeDashoffset:0,strokeLinecap:0,strokeLinejoin:0,strokeMiterlimit:0,strokeOpacity:0,strokeWidth:0,surfaceScale:0,systemLanguage:0,tableValues:0,targetX:0,targetY:0,textAnchor:0,textDecoration:0,textRendering:0,textLength:0,to:0,transform:0,u1:0,u2:0,underlinePosition:0,underlineThickness:0,unicode:0,unicodeBidi:0,unicodeRange:0,unitsPerEm:0,vAlphabetic:0,vHanging:0,vIdeographic:0,vMathematical:0,values:0,vectorEffect:0,version:0,vertAdvY:0,vertOriginX:0,vertOriginY:0,viewBox:0,viewTarget:0,visibility:0,widths:0,wordSpacing:0,writingMode:0,x:0,xHeight:0,x1:0,x2:0,xChannelSelector:0,xlinkActuate:0,xlinkArcrole:0,xlinkHref:0,xlinkRole:0,xlinkShow:0,xlinkTitle:0,xlinkType:0,xmlBase:0,xmlns:0,xmlnsXlink:0,xmlLang:0,xmlSpace:0,y:0,y1:0,y2:0,yChannelSelector:0,z:0,zoomAndPan:0},DOMAttributeNames:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDasharray:"stroke-dasharray",strokeDashoffset:"stroke-dashoffset",strokeLinecap:"stroke-linecap",strokeLinejoin:"stroke-linejoin",strokeMiterlimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",xlinkActuate:"xlink:actuate",xlinkArcrole:"xlink:arcrole",xlinkHref:"xlink:href",xlinkRole:"xlink:role",xlinkShow:"xlink:show",xlinkTitle:"xlink:title",xlinkType:"xlink:type",xmlBase:"xml:base",xmlnsXlink:"xmlns:xlink",xmlLang:"xml:lang",xmlSpace:"xml:space"}},l=1,c=4,u=8,p=24,f=32;function d(e,t){return(e&t)===t}function r(e,t,r){var n,i,o,a=e.Properties,s=e.DOMAttributeNames;for(i in a)n=s[i]||(r?i:i.toLowerCase()),o=a[i],t[n]={attributeName:n,propertyName:i,mustUseProperty:d(o,l),hasBooleanValue:d(o,c),hasNumericValue:d(o,u),hasPositiveNumericValue:d(o,p),hasOverloadedBooleanValue:d(o,f)}}var n={};r(e,n);var i={};r(t,i,!0);var o={};r(e,o),r(t,o,!0);function m(n,r){if("string"!=typeof n)throw new TypeError("First argument must be a string");if(!n)return[];r=r||{};var i=1,o=1;function a(e){var t=e.match(g);t&&(i+=t.length);var r=e.lastIndexOf("\n");o=~r?e.length-r:o+e.length}function s(){var t={line:i,column:o};return function(e){return e.position=new l(t),p(),e}}function l(e){this.start=e,this.end={line:i,column:o},this.source=r.source}function c(e){var t=new Error(r.source+":"+i+":"+o+": "+e);if(t.reason=e,t.filename=r.source,t.line=i,t.column=o,t.source=n,!r.silent)throw t}function u(e){var t=e.exec(n);if(t){var r=t[0];return a(r),n=n.slice(r.length),t}}function p(){u(v)}function f(e){var t;for(e=e||[];t=d();)!1!==t&&e.push(t);return e}function d(){var e=s();if("/"==n.charAt(0)&&"*"==n.charAt(1)){for(var t=2;T!=n.charAt(t)&&("*"!=n.charAt(t)||"/"!=n.charAt(t+1));)++t;if(t+=2,T===n.charAt(t-1))return c("End of comment missing");var r=n.slice(2,t-2);return o+=2,a(r),n=n.slice(t),o+=2,e({type:"comment",comment:r})}}function m(){var e=s(),t=u(k);if(t){if(d(),!u(x))return c("property missing ':'");var r=u(b),n=e({type:"declaration",property:E(t[0].replace(h,T)),value:r?E(r[0].replace(h,T)):T});return u(w),n}}return l.prototype.content=n,p(),function(){var e,t=[];for(f(t);e=m();)!1!==e&&(t.push(e),f(t));return t}()}var a={html:n,svg:i,properties:o,isCustomAttribute:RegExp.prototype.test.bind(new RegExp("^(data|aria)-[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"))},h=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,g=/\n/g,v=/^\s*/,k=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,x=/^:\s*/,b=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,w=/^[;\s]*/,s=/^\s+|\s+$/g,T="";function E(e){return e?e.replace(s,T):T}var C=function(e,t){var r,n=null;if(!e||"string"!=typeof e)return n;for(var i,o,a=m(e),s="function"==typeof t,l=0,c=a.length;l<c;l++)i=(r=a[l]).property,o=r.value,s?t(i,o,r):o&&((n=n||{})[i]=o);return n},S=/-([a-z])/g,O=/^--[a-zA-Z0-9-]+$|^[^-]+$/;var F={PRESERVE_CUSTOM_ATTRIBUTES:16<=y.version.split(".")[0],camelCase:function(e){if("string"!=typeof e)throw new TypeError("First argument must be a string");return O.test(e)?e:e.toLowerCase().replace(S,function(e,t){return t.toUpperCase()})},invertObject:function(e,t){if(!e||"object"!=typeof e)throw new TypeError("First argument must be an object");var r,n,i="function"==typeof t,o={},a={};for(r in e)n=e[r],i&&(o=t(r,n))&&2===o.length?a[o[0]]=o[1]:"string"==typeof n&&(a[n]=r);return a},isCustomComponent:function(e,t){if(-1===e.indexOf("-"))return t&&"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0;}}},A=F.camelCase,M=a.html,R=a.svg,P=a.isCustomAttribute,D=Object.prototype.hasOwnProperty;var L=function(e){var t,r,n,i;e=e||{};var o={};for(t in e)n=e[t],P(t)?o[t]=n:(r=t.toLowerCase(),D.call(M,r)?o[(i=M[r]).propertyName]=!!(i.hasBooleanValue||i.hasOverloadedBooleanValue&&!n)||n:D.call(R,t)?o[(i=R[t]).propertyName]=n:F.PRESERVE_CUSTOM_ATTRIBUTES&&(o[t]=n));return null!=e.style&&(o.style=function(e){var r={};e&&C(e,function(e,t){e&&t&&(r[A(e)]=t)});return r}(e.style)),o};for(var N,B=function e(t,r){for(var n,i,o,a,s,l=(r=r||{}).library||y,c=l.cloneElement,u=l.createElement,p=l.isValidElement,f=[],d="function"==typeof r.replace,m=r.trim,h=0,g=t.length;h<g;h++)if(n=t[h],d&&p(i=r.replace(n)))1<g&&(i=c(i,{key:i.key||h})),f.push(i);else if("text"!==n.type){switch(o=n.attribs,s=n,F.PRESERVE_CUSTOM_ATTRIBUTES&&"tag"===s.type&&F.isCustomComponent(s.name,s.attribs)||(o=L(n.attribs)),a=null,n.type){case"script":case"style":n.children[0]&&(o.dangerouslySetInnerHTML={__html:n.children[0].data});break;case"tag":"textarea"===n.name&&n.children[0]?o.defaultValue=n.children[0].data:n.children&&n.children.length&&(a=e(n.children,r));break;default:continue;}1<g&&(o.key=h),f.push(u(n.name,o,a))}else m&&!n.data.trim()||f.push(n.data);return 1===f.length?f[0]:f},z=["animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussainBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","linearGradient","radialGradient","textPath"],I={},H=0,V=z.length;H<V;H++)I[(N=z[H]).toLowerCase()]=N;function U(e){for(var t,r={},n=0,i=e.length;n<i;n++)r[(t=e[n]).name]=t.value;return r}function j(e){e=e.toLowerCase();var t=I[e];return t||e}var X={formatAttributes:U,formatDOM:function e(t,r,n){r=r||null;for(var i,o,a,s=[],l=0,c=t.length;l<c;l++){switch(i=t[l],a={next:null,prev:s[l-1]||null,parent:r},(o=s[l-1])&&(o.next=a),"#"!==i.nodeName[0]&&(a.name=j(i.nodeName),a.attribs={},i.attributes&&i.attributes.length&&(a.attribs=U(i.attributes))),i.nodeType){case 1:"script"===a.name||"style"===a.name?a.type=a.name:a.type="tag",a.children=e(i.childNodes,a);break;case 3:a.type="text",a.data=i.nodeValue;break;case 8:a.type="comment",a.data=i.nodeValue;}s.push(a)}return n&&(s.unshift({name:n.substring(0,n.indexOf(" ")).toLowerCase(),data:n,type:"directive",next:s[0]?s[0]:null,prev:null,parent:r}),s[1]&&(s[1].prev=s[0])),s},isIE:function(e){return e?document.documentMode===e:/(MSIE |Trident\/|Edge\/)/.test(navigator.userAgent)}},_="body",q=/<([a-zA-Z]+[0-9]?)/,Y=/<head.*>/i,$=/<body.*>/i,G=/<(area|base|br|col|embed|hr|img|input|keygen|link|menuitem|meta|param|source|track|wbr)(.*?)\/?>/gi,W=X.isIE(9),Z=W||X.isIE(),K=function(){throw new Error("This browser does not support `document.implementation.createHTMLDocument`")},J=function(){throw new Error("This browser does not support `DOMParser.prototype.parseFromString`")};if("function"==typeof window.DOMParser){var Q=new window.DOMParser,ee=W?"text/xml":"text/html";K=J=function(e,t){return t&&(e="<"+t+">"+e+"</"+t+">"),W&&(e=e.replace(G,"<$1$2$3/>")),Q.parseFromString(e,ee)}}if(document.implementation){var te=document.implementation.createHTMLDocument(Z?"html-dom-parser":void 0);K=function(t,e){if(e)return te.documentElement.getElementsByTagName(e)[0].innerHTML=t,te;try{return te.documentElement.innerHTML=t,te}catch(e){if(J)return J(t)}}}var re,ne=document.createElement("template");ne.content&&(re=function(e){return ne.innerHTML=e,ne.content.childNodes});var ie=function(e){var t,r,n,i,o=e.match(q);switch(o&&o[1]&&(t=o[1].toLowerCase()),t){case"html":return r=J(e),Y.test(e)||(n=r.getElementsByTagName("head")[0])&&n.parentNode.removeChild(n),$.test(e)||(n=r.getElementsByTagName(_)[0])&&n.parentNode.removeChild(n),r.getElementsByTagName("html");case"head":case _:return i=K(e).getElementsByTagName(t),$.test(e)&&Y.test(e)?i[0].parentNode.childNodes:i;default:return re?re(e):K(e,_).getElementsByTagName(_)[0].childNodes;}},oe=X.formatDOM,ae=X.isIE(9),se=/<(![a-zA-Z\s]+)>/;var le=function(e){if("string"!=typeof e)throw new TypeError("First argument must be a string");if(!e)return[];var t,r=e.match(se);return r&&r[1]&&(t=r[1],ae&&(e=e.replace(r[0],""))),oe(ie(e),null,t)},ce={decodeEntities:!0,lowerCaseAttributeNames:!1};function ue(e,t){if("string"!=typeof e)throw new TypeError("First argument must be a string");return""===e?[]:B(le(e,(t=t||{}).htmlparser2||ce),t)}ue.domToReact=B,ue.htmlToDOM=le;var pe=ue,fe=ue;return pe.default=fe,pe});function _interopDefaultLegacy(e){return e&&typeof e==="object"&&"default"in e?e:{"default":e}}var Bowser__default=_interopDefaultLegacy(Bowser);var Handlebars__default=_interopDefaultLegacy(Handlebars$1);var pipwerks__default=_interopDefaultLegacy(pipwerks);var ___default=_interopDefaultLegacy(_$1);function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function(obj){return typeof obj}}else{_typeof=function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise(function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)})}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable});keys.push.apply(keys,symbols)}return keys}function _objectSpread2(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){_defineProperty(target,key,source[key])})}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}}return target}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true}catch(e){return false}}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _possibleConstructorReturn(self,call){if(call&&(typeof call==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _superPropBase(object,property){while(!Object.prototype.hasOwnProperty.call(object,property)){object=_getPrototypeOf(object);if(object===null)break}return object}function _get(target,property,receiver){if(typeof Reflect!=="undefined"&&Reflect.get){_get=Reflect.get}else{_get=function _get(target,property,receiver){var base=_superPropBase(target,property);if(!base)return;var desc=Object.getOwnPropertyDescriptor(base,property);if(desc.get){return desc.get.call(receiver)}return desc.value}}return _get(target,property,receiver||target)}function _readOnlyError(name){throw new Error("\""+name+"\" is read-only")}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread()}function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _iterableToArray(iter){if(typeof Symbol!=="undefined"&&Symbol.iterator in Object(iter))return Array.from(iter)}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var Wait=__AMD("core/js/wait",function(_Backbone$Controller){_inherits(Wait,_Backbone$Controller);var _super=_createSuper(Wait);function Wait(){_classCallCheck(this,Wait);return _super.apply(this,arguments)}_createClass(Wait,[{key:"initialize",value:function initialize(){this._waitCount=0;this._callbackHandle=null;this.being=this.begin.bind(this);this.end=this.end.bind(this)}},{key:"isWaiting",value:function isWaiting(){return this._waitCount!==0}},{key:"begin",value:function begin(){if(!this.isWaiting())this.trigger("wait");this._waitCount++;if(this._callbackHandle){clearTimeout(this._callbackHandle);this._callbackHandle=null}return this}},{key:"end",value:function end(){if(!this.isWaiting())return this;this._waitCount--;if(this.isWaiting()||this._callbackHandle)return this;this._callbackHandle=setTimeout(function(){this._callbackHandle=null;this.trigger("ready")}.bind(this),0);return this}},{key:"queue",value:function queue(callback){var _this=this;if(!callback){this.begin();return new Promise(function(resolve){_this.once("ready",resolve);_this.end()})}this.begin();this.once("ready",callback);this.end();return this}},{key:"for",value:function _for(callback){var _this2=this;this.begin();_.defer(function(){return callback(_.once(_this2.end))});return this}}]);return Wait}(Backbone.Controller));var LockingModel=__AMD("core/js/models/lockingModel",function(_Backbone$Model){_inherits(LockingModel,_Backbone$Model);var _super=_createSuper(LockingModel);function LockingModel(){_classCallCheck(this,LockingModel);return _super.apply(this,arguments)}_createClass(LockingModel,[{key:"set",value:function set(attrName,attrVal){var options=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var stopProcessing=_typeof(attrName)==="object"||typeof attrVal!=="boolean"||!this.isLocking(attrName);if(stopProcessing)return _get(_getPrototypeOf(LockingModel.prototype),"set",this).apply(this,arguments);var isSettingValueForSpecificPlugin=options===null||options===void 0?void 0:options.pluginName;if(!isSettingValueForSpecificPlugin){console.error("Must supply a pluginName to change a locked attribute");options.pluginName="compatibility"}var pluginName=options.pluginName;if(this.defaults[attrName]!==undefined){this._lockedAttributes[attrName]=!this.defaults[attrName]}var lockingValue=this._lockedAttributes[attrName];var isAttemptingToLock=lockingValue===attrVal;if(isAttemptingToLock){this.setLockState(attrName,true,{pluginName:pluginName,skipcheck:true});return _get(_getPrototypeOf(LockingModel.prototype),"set",this).call(this,attrName,lockingValue)}this.setLockState(attrName,false,{pluginName:pluginName,skipcheck:true});var totalLockValue=this.getLockCount(attrName,{skipcheck:true});if(totalLockValue===0){return _get(_getPrototypeOf(LockingModel.prototype),"set",this).call(this,attrName,!lockingValue)}return this}},{key:"setLocking",value:function setLocking(attrName,defaultLockValue){if(this.isLocking(attrName))return;if(!this._lockedAttributes)this._lockedAttributes={};this._lockedAttributes[attrName]=defaultLockValue}},{key:"unsetLocking",value:function unsetLocking(attrName){if(!this.isLocking(attrName))return;if(!this._lockedAttributes)return;delete this._lockedAttributes[attrName];delete this._lockedAttributesValues[attrName];if(Object.keys(this._lockedAttributes).length===0){delete this._lockedAttributes;delete this._lockedAttributesValues}}},{key:"isLocking",value:function isLocking(attrName){var isCheckingGeneralLockingState=attrName===undefined;var isUsingLockedAttributes=Boolean(this.lockedAttributes||this._lockedAttributes);if(isCheckingGeneralLockingState){return isUsingLockedAttributes}if(!isUsingLockedAttributes)return false;if(!this._lockedAttributes){this._lockedAttributes=_.result(this,"lockedAttributes")}var isAttributeALockingAttribute=this._lockedAttributes.hasOwnProperty(attrName);if(!isAttributeALockingAttribute)return false;if(!this._lockedAttributesValues){this._lockedAttributesValues={}}if(!this._lockedAttributesValues[attrName]){this._lockedAttributesValues[attrName]={}}return true}},{key:"isLocked",value:function isLocked(attrName,options){var shouldSkipCheck=options===null||options===void 0?void 0:options.skipcheck;if(!shouldSkipCheck){var stopProcessing=!this.isLocking(attrName);if(stopProcessing)return}return this.getLockCount(attrName)>0}},{key:"getLockCount",value:function getLockCount(attrName,options){var shouldSkipCheck=options===null||options===void 0?void 0:options.skipcheck;if(!shouldSkipCheck){var stopProcessing=!this.isLocking(attrName);if(stopProcessing)return}var isGettingValueForSpecificPlugin=options===null||options===void 0?void 0:options.pluginName;if(isGettingValueForSpecificPlugin){return this._lockedAttributesValues[attrName][options.pluginName]?1:0}var lockingAttributeValues=Object.values(this._lockedAttributesValues[attrName]);var lockingAttributeValuesSum=lockingAttributeValues.reduce(function(sum,value){return sum+(value?1:0)},0);return lockingAttributeValuesSum}},{key:"setLockState",value:function setLockState(attrName,value,options){var shouldSkipCheck=options===null||options===void 0?void 0:options.skipcheck;if(!shouldSkipCheck){var stopProcessing=!this.isLocking(attrName);if(stopProcessing)return this}var isSettingValueForSpecificPlugin=options===null||options===void 0?void 0:options.pluginName;if(!isSettingValueForSpecificPlugin){console.error("Must supply a pluginName to set a locked attribute lock value");options.pluginName="compatibility"}if(value){this._lockedAttributesValues[attrName][options.pluginName]=value}else{delete this._lockedAttributesValues[attrName][options.pluginName]}return this}}]);return LockingModel}(Backbone.Model));var AdaptSingleton=function(_LockingModel){_inherits(AdaptSingleton,_LockingModel);var _super=_createSuper(AdaptSingleton);function AdaptSingleton(){_classCallCheck(this,AdaptSingleton);return _super.apply(this,arguments)}_createClass(AdaptSingleton,[{key:"initialize",value:function initialize(){this.loadScript=window.__loadScript;this.location={};this.store={};this.setupWait()}},{key:"defaults",value:function defaults(){return{_canScroll:true,_outstandingCompletionChecks:0,_pluginWaitCount:0,_isStarted:false,_shouldDestroyContentObjects:true}}},{key:"lockedAttributes",value:function lockedAttributes(){return{_canScroll:false}}},{key:"init",value:function init(){var _this=this;this.addDirection();this.disableAnimation();this.trigger("adapt:preInitialize");this.deferUntilCompletionChecked(function(){_this.trigger("adapt:start");if(!Backbone.History.started){Backbone.history.start()}_this.set("_isStarted",true);_this.trigger("adapt:initialize")})}},{key:"checkingCompletion",value:function checkingCompletion(){var outstandingChecks=this.get("_outstandingCompletionChecks");this.set("_outstandingCompletionChecks",outstandingChecks+1)}},{key:"checkedCompletion",value:function checkedCompletion(){var outstandingChecks=this.get("_outstandingCompletionChecks");this.set("_outstandingCompletionChecks",outstandingChecks-1)}},{key:"deferUntilCompletionChecked",value:function(){var _deferUntilCompletionChecked=_asyncToGenerator(regeneratorRuntime.mark(function _callee(){var _this2=this;var callback,_args=arguments;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:callback=_args.length>0&&_args[0]!==undefined?_args[0]:function(){};if(!(this.get("_outstandingCompletionChecks")===0)){_context.next=3;break}return _context.abrupt("return",callback());case 3:return _context.abrupt("return",new Promise(function(resolve){var checkIfAnyChecksOutstanding=function(model,outstandingChecks){if(outstandingChecks!==0)return;_this2.off("change:_outstandingCompletionChecks",checkIfAnyChecksOutstanding);callback();resolve()};_this2.on("change:_outstandingCompletionChecks",checkIfAnyChecksOutstanding)}));case 4:case"end":return _context.stop();}}},_callee,this)}));function deferUntilCompletionChecked(){return _deferUntilCompletionChecked.apply(this,arguments)}return deferUntilCompletionChecked}()},{key:"setupWait",value:function setupWait(){var _this3=this;this.wait=new Wait;var beginWait=function(){_this3.log.deprecated("Use Adapt.wait.begin() as Adapt.trigger('plugin:beginWait') may be removed in the future");_this3.wait.begin()};var endWait=function(){_this3.log.deprecated("Use Adapt.wait.end() as Adapt.trigger('plugin:endWait') may be removed in the future");_this3.wait.end()};var ready=function(){if(_this3.wait.isWaiting()){return}var isEventListening=_this3._events["plugins:ready"];if(!isEventListening){return}_this3.log.deprecated("Use Adapt.wait.queue(callback) as Adapt.on('plugins:ready', callback) may be removed in the future");_this3.trigger("plugins:ready")};this.listenTo(this.wait,"ready",ready);this.listenTo(this,{"plugin:beginWait":beginWait,"plugin:endWait":endWait})}},{key:"isWaitingForPlugins",value:function isWaitingForPlugins(){this.log.deprecated("Use Adapt.wait.isWaiting() as Adapt.isWaitingForPlugins() may be removed in the future");return this.wait.isWaiting()}},{key:"checkPluginsReady",value:function checkPluginsReady(){this.log.deprecated("Use Adapt.wait.isWaiting() as Adapt.checkPluginsReady() may be removed in the future");if(this.isWaitingForPlugins()){return}this.trigger("plugins:ready")}},{key:"navigateToElement",value:function(){var _navigateToElement=_asyncToGenerator(regeneratorRuntime.mark(function _callee2(){return regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:case"end":return _context2.stop();}}},_callee2)}));function navigateToElement(){return _navigateToElement.apply(this,arguments)}return navigateToElement}()},{key:"scrollTo",value:function(){var _scrollTo=_asyncToGenerator(regeneratorRuntime.mark(function _callee3(){return regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:case"end":return _context3.stop();}}},_callee3)}));function scrollTo(){return _scrollTo.apply(this,arguments)}return scrollTo}()},{key:"register",value:function register(name,object){var _this4=this;if(Array.isArray(name)){name.forEach(function(name){return _this4.register(name,object)});return object}if(name.split(" ").length>1){this.register(name.split(" "),object);return object}if(!object.view&&!object.model||object instanceof Backbone.View){this.log.deprecated("View-only registrations are no longer supported");object={view:object}}if(object.view&&!object.view.template){object.view.template=name}var isModelSetAndInvalid=object.model&&!(object.model.prototype instanceof Backbone.Model)&&!(object.model instanceof Function);if(isModelSetAndInvalid){throw new Error("The registered model is not a Backbone.Model or Function")}var isViewSetAndInvalid=object.view&&!(object.view.prototype instanceof Backbone.View)&&!(object.view instanceof Function);if(isViewSetAndInvalid){throw new Error("The registered view is not a Backbone.View or Function")}this.store[name]=Object.assign({},this.store[name],object);return object}},{key:"getViewName",value:function getViewName(nameModelViewOrData){var _this5=this;if(typeof nameModelViewOrData==="string"){return nameModelViewOrData}if(nameModelViewOrData instanceof Backbone.Model){nameModelViewOrData=nameModelViewOrData.toJSON()}if(nameModelViewOrData instanceof Backbone.View){var foundName;Object.entries(this.store).forEach(function(_ref){var _ref2=_slicedToArray(_ref,2),key=_ref2[0],entry=_ref2[1];if(!(entry===null||entry===void 0?void 0:entry.view))return;if(!(nameModelViewOrData instanceof entry.view))return;foundName=key;return true});return foundName}if(nameModelViewOrData instanceof Object){var names=[typeof nameModelViewOrData._view==="string"&&nameModelViewOrData._view,typeof nameModelViewOrData._component==="string"&&nameModelViewOrData._component,typeof nameModelViewOrData._type==="string"&&nameModelViewOrData._type].filter(Boolean);if(names.length){var name=names.find(function(name){var _this5$store$name;return(_this5$store$name=_this5.store[name])===null||_this5$store$name===void 0?void 0:_this5$store$name.view});return name||names.pop()}}throw new Error("Cannot derive view class name from input")}},{key:"getViewClass",value:function getViewClass(nameModelViewOrData){var _object$view;var name=this.getViewName(nameModelViewOrData);var object=this.store[name];if(!object){this.log.warnOnce("A view for '".concat(name,"' isn't registered in your project"));return}var isBackboneView=((_object$view=object.view)===null||_object$view===void 0?void 0:_object$view.prototype)instanceof Backbone.View;if(!isBackboneView&&object.view instanceof Function){return object.view()}return object.view}},{key:"getModelName",value:function getModelName(nameModelOrData){var _this6=this;if(typeof nameModelOrData==="string"){return nameModelOrData}if(nameModelOrData instanceof Backbone.Model){nameModelOrData=nameModelOrData.toJSON()}if(nameModelOrData instanceof Object){var _entry$view;var name=nameModelOrData._component;var entry=this.store[name];var isViewOnlyQuestion=entry&&!entry.model&&((_entry$view=entry.view)===null||_entry$view===void 0?void 0:_entry$view._isQuestionType);if(isViewOnlyQuestion){this.log.deprecated("Assuming a question model for a view-only question: ".concat(name));return"question"}var names=[typeof nameModelOrData._model==="string"&&nameModelOrData._model,typeof nameModelOrData._component==="string"&&nameModelOrData._component,typeof nameModelOrData._type==="string"&&nameModelOrData._type].filter(Boolean);if(names.length){var _name=names.find(function(name){var _this6$store$name;return(_this6$store$name=_this6.store[name])===null||_this6$store$name===void 0?void 0:_this6$store$name.model});return _name||names.pop()}}throw new Error("Cannot derive model class name from input")}},{key:"getModelClass",value:function getModelClass(nameModelOrData){var _object$model;var name=this.getModelName(nameModelOrData);var object=this.store[name];if(!object){this.log.warnOnce("A model for '".concat(name,"' isn't registered in your project"));return}var isBackboneModel=((_object$model=object.model)===null||_object$model===void 0?void 0:_object$model.prototype)instanceof Backbone.Model;if(!isBackboneModel&&object.model instanceof Function){return object.model()}return object.model}},{key:"findById",value:function findById(id){return this.data.findById(id)}},{key:"findViewByModelId",value:function findViewByModelId(id){var model=this.data.findById(id);if(!model)return;if(model===this.parentView.model)return this.parentView;var idPathToView=[id];var currentLocationId=this.location._currentId;var currentLocationModel=model.getAncestorModels().find(function(model){var modelId=model.get("_id");if(modelId===currentLocationId)return true;idPathToView.unshift(modelId)});if(!currentLocationModel){return console.warn("Adapt.findViewByModelId() unable to find view for model id: ".concat(id))}var foundView=idPathToView.reduce(function(view,currentId){if(!view)return;var childViews=view.getChildViews();return childViews===null||childViews===void 0?void 0:childViews.find(function(view){return view.model.get("_id")===currentId})},this.parentView);return foundView}},{key:"findByTrackingPosition",value:function findByTrackingPosition(trackingPosition){return this.data.findByTrackingPosition(trackingPosition)}},{key:"parseRelativeString",value:function parseRelativeString(relativeString){var splitIndex=relativeString.search(/[ +\-\d]{1}/);var type=relativeString.slice(0,splitIndex).replace(/^@/,"");var offset=parseInt(relativeString.slice(splitIndex).trim()||0);return{type:type,offset:offset}}},{key:"addDirection",value:function addDirection(){var defaultDirection=this.config.get("_defaultDirection");$("html").addClass("dir-"+defaultDirection).attr("dir",defaultDirection)}},{key:"disableAnimation",value:function disableAnimation(){var disableAnimationArray=this.config.get("_disableAnimationFor");var disableAnimation=this.config.get("_disableAnimation");if(disableAnimationArray){for(var i=0,l=disableAnimationArray.length;i<l;i++){if(!$("html").is(disableAnimationArray[i]))continue;this.config.set("_disableAnimation",true);$("html").addClass("disable-animation");console.log("Animation disabled.")}return}$("html").toggleClass("disable-animation",disableAnimation===true)}},{key:"remove",value:function(){var _remove=_asyncToGenerator(regeneratorRuntime.mark(function _callee4(){var currentView;return regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:currentView=this.parentView;if(currentView){currentView.model.setOnChildren({"_isReady":false,"_isRendered":false})}this.trigger("preRemove",currentView);_context4.next=5;return this.wait.queue();case 5:if(currentView&&this.get("_shouldDestroyContentObjects")){currentView.destroy()}this.trigger("remove",currentView);_.defer(this.trigger.bind(this),"postRemove",currentView);case 8:case"end":return _context4.stop();}}},_callee4,this)}));function remove(){return _remove.apply(this,arguments)}return remove}()},{key:"componentStore",get:function(){this.log.deprecated("Adapt.componentStore, please use Adapt.store instead");return this.store}}]);return AdaptSingleton}(LockingModel);var Adapt=__AMD("core/js/adapt",new AdaptSingleton);var TemplateRenderEvent=__AMD("core/js/templateRenderEvent",function(_Backbone$Controller){_inherits(TemplateRenderEvent,_Backbone$Controller);var _super=_createSuper(TemplateRenderEvent);function TemplateRenderEvent(){_classCallCheck(this,TemplateRenderEvent);return _super.apply(this,arguments)}_createClass(TemplateRenderEvent,[{key:"initialize",value:function initialize(type,name,mode,value,args){this.type=type;this.name=name;this.mode=mode;this.value=value;this.args=args}}]);return TemplateRenderEvent}(Backbone.Controller));function onRender(cb){var intercept=function(object,name,mode,cb){return object[name]=cb.bind(object,object[name],name,mode)};Object.keys(Handlebars.templates).forEach(function(name){intercept(Handlebars.templates,name,"template",cb)});Object.keys(Handlebars.partials).forEach(function(name){intercept(Handlebars.partials,name,"partial",cb)})}onRender(function(template,name,mode){for(var _len=arguments.length,args=new Array(_len>3?_len-3:0),_key=3;_key<_len;_key++){args[_key-3]=arguments[_key]}var preRenderEvent=new TemplateRenderEvent("".concat(mode,":preRender"),name,mode,null,args);Adapt.trigger(preRenderEvent.type,preRenderEvent);var value=template.apply(void 0,_toConsumableArray(preRenderEvent.args));var postRenderEvent=new TemplateRenderEvent("".concat(mode,":postRender"),name,mode,value,preRenderEvent.args);Adapt.trigger(postRenderEvent.type,postRenderEvent);return postRenderEvent.value});function find(hierarchy,iterator){if(iterator(hierarchy)){return true}if(!hierarchy.props||!hierarchy.props.children)return;if(Array.isArray(hierarchy.props.children)){return hierarchy.props.children.find(function(child){if(!child)return;return find(child,iterator)})}return find(hierarchy.props.children,iterator)}function clone(value){var isDeep=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var modifier=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;if(_typeof(value)!=="object"||value===null){return value}var cloned=Array.isArray(value)?[]:{};var descriptors=Object.getOwnPropertyDescriptors(value);for(var name in descriptors){var descriptor=descriptors[name];if(!descriptor.hasOwnProperty("value")){Object.defineProperty(cloned,name,descriptor);continue}var _value=descriptor.value;if(_typeof(_value)==="object"&&_value!==null){if(isDeep){_value=descriptor.value=clone(_value,isDeep,modifier)}if(modifier&&_typeof(_value.$$typeof)==="symbol"){modifier(_value)}}descriptor.writable=true;Object.defineProperty(cloned,name,descriptor)}if(modifier&&_typeof(cloned.$$typeof)==="symbol"){modifier(cloned)}return cloned}var register=__AMD("core/js/reactHelpers",function register(name,component){templates[name]=function(){var mode="reactTemplate";for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}var preRenderEvent=new TemplateRenderEvent("".concat(mode,":preRender"),name,mode,null,args);Adapt.trigger(preRenderEvent.type,preRenderEvent);var value=component.apply(void 0,_toConsumableArray(preRenderEvent.args));var postRenderEvent=new TemplateRenderEvent("".concat(mode,":postRender"),name,mode,value,preRenderEvent.args);Adapt.trigger(postRenderEvent.type,postRenderEvent);return postRenderEvent.value}});var templates={};function html(html){var ref=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;if(!html)return;var node=html?window.HTMLReactParser(html):"";if(_typeof(node)==="object"&&ref){node=clone(node);node.ref=ref}return node}function render(name){var template=templates[name];for(var _len2=arguments.length,args=new Array(_len2>1?_len2-1:0),_key2=1;_key2<_len2;_key2++){args[_key2-1]=arguments[_key2]}var component=template.apply(void 0,args);return component}function compile(template){for(var _len3=arguments.length,args=new Array(_len3>1?_len3-1:0),_key3=1;_key3<_len3;_key3++){args[_key3-1]=arguments[_key3]}var output=Handlebars.compile(template).apply(void 0,args);return output}function helper(name){var output=Handlebars.helpers[name].call(arguments.length<=1?undefined:arguments[1]);return output&&output.string||output}function classes(){for(var _len5=arguments.length,args=new Array(_len5),_key5=0;_key5<_len5;_key5++){args[_key5]=arguments[_key5]}return _.flatten(args).filter(Boolean).join(" ")}Adapt.on("app:dataReady",function(){var config=Adapt.config.get("_fixes");if((config===null||config===void 0?void 0:config._imgLazyLoad)===false)return;applyImgLoadingFix()});function applyImgLoadingFix(){var findImgTag=/<img([^>]*)>/gi;var hasLoadingAttr=/ loading=/gi;Adapt.on("template:postRender partial:postRender",function(event){var imgTagsFound=event.value.match(findImgTag);if(!imgTagsFound){return}event.value=imgTagsFound.reduce(function(value,img){if(hasLoadingAttr.test(img)){return value}return value.replace(img,img.replace(findImgTag,"<img loading=\"eager\"$1>"))},event.value)});Adapt.on("reactTemplate:postRender",function(event){var hasImageTagWithNoLoadingAttr=find(event.value,function(component){if(component.type!=="img")return;if(component.props.loading)return;return true});if(!hasImageTagWithNoLoadingAttr)return;event.value=clone(event.value,true,function(component){if(component.type!=="img")return;if(component.props.loading)return;component.props.loading="eager"})})}var BrowserFocus=__AMD("core/js/a11y/browserFocus",function(_Backbone$Controller){_inherits(BrowserFocus,_Backbone$Controller);var _super=_createSuper(BrowserFocus);function BrowserFocus(){_classCallCheck(this,BrowserFocus);return _super.apply(this,arguments)}_createClass(BrowserFocus,[{key:"initialize",value:function initialize(){this._onBlur=this._onBlur.bind(this);this._onClick=this._onClick.bind(this);this.$body=$("body");this.listenTo(Adapt,{"accessibility:ready":this._attachEventListeners})}},{key:"_attachEventListeners",value:function _attachEventListeners(){this.$body.on("blur","*",this._onBlur).on("blur",this._onBlur);this.$body[0].addEventListener("click",this._onClick,true)}},{key:"_onBlur",value:function _onBlur(event){var config=Adapt.a11y.config;if(!config._isEnabled||!config._options._isFocusNextOnDisabled){return}var $element=$(event.target);if($element.is("[data-a11y-force-focus]")){_.defer(function(){return $element.removeAttr("tabindex data-a11y-force-focus")})}if(event.target!==event.currentTarget){return}if(!$element.is("[disabled]")){return}Adapt.a11y.focusNext($element)}},{key:"_onClick",value:function _onClick(event){var $element=$(event.target);if($element.is("[aria-disabled=true]")){event.preventDefault();event.stopImmediatePropagation()}var config=Adapt.a11y.config;if(!config._isEnabled||!config._options._isFocusOnClickEnabled){return}var $stack=$([].concat(_toConsumableArray($element.toArray()),_toConsumableArray($element.parents().toArray())));var $focusable=$stack.filter(config._options._tabbableElements);if(!$focusable.length){return}$focusable[0].focus()}}]);return BrowserFocus}(Backbone.Controller));var FocusOptions=__AMD("core/js/a11y/focusOptions",function FocusOptions(){var _ref=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},_ref$preventScroll=_ref.preventScroll,preventScroll=_ref$preventScroll===void 0?false:_ref$preventScroll,_ref$defer=_ref.defer,defer=_ref$defer===void 0?false:_ref$defer;_classCallCheck(this,FocusOptions);this.preventScroll=preventScroll;this.defer=defer});var KeyboardFocusOutline=__AMD("core/js/a11y/keyboardFocusOutline",function(_Backbone$Controller){_inherits(KeyboardFocusOutline,_Backbone$Controller);var _super=_createSuper(KeyboardFocusOutline);function KeyboardFocusOutline(){_classCallCheck(this,KeyboardFocusOutline);return _super.apply(this,arguments)}_createClass(KeyboardFocusOutline,[{key:"initialize",value:function initialize(){this._onKeyDown=this._onKeyDown.bind(this);this.$html=$("html");this.showOnKeys={9:true,13:true,32:true,37:true,38:true,39:true,40:true};this.listenTo(Adapt,{"accessibility:ready":this._attachEventListeners})}},{key:"_attachEventListeners",value:function _attachEventListeners(){document.addEventListener("keydown",this._onKeyDown);this._start()}},{key:"_start",value:function _start(){var config=Adapt.a11y.config;if(config._options._isFocusOutlineDisabled){this.$html.addClass("a11y-disable-focusoutline");return}if(!config._isEnabled||!config._options._isFocusOutlineKeyboardOnlyEnabled){return}this.$html.addClass("a11y-disable-focusoutline")}},{key:"_onKeyDown",value:function _onKeyDown(event){var config=Adapt.a11y.config;if(config._options._isFocusOutlineDisabled){this.$html.addClass("a11y-disable-focusoutline");return}if(!config._isEnabled||!config._options._isFocusOutlineKeyboardOnlyEnabled||!this.showOnKeys[event.keyCode]){return}var $element=$(event.target);if(!$element.is(config._options._tabbableElements)||$element.is(config._options._focusOutlineKeyboardOnlyIgnore)){return}this.$html.removeClass("a11y-disable-focusoutline")}}]);return KeyboardFocusOutline}(Backbone.Controller));var Log=__AMD("core/js/a11y/log",function(_Backbone$Controller){_inherits(Log,_Backbone$Controller);var _super=_createSuper(Log);function Log(){_classCallCheck(this,Log);return _super.apply(this,arguments)}_createClass(Log,[{key:"initialize",value:function initialize(){this._warned={}}},{key:"_hasWarned",value:function _hasWarned(args){var config=Adapt.a11y.config;if(!config._options._warnFirstOnly){return false}var hash=args.map(String).join(":");if(this._warned[hash]){return true}this._warned[hash]=true;return false}},{key:"_canWarn",value:function _canWarn(){var config=Adapt.a11y.config;return Boolean(config._options._warn)}},{key:"removed",value:function removed(){var _Adapt$log;for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}if(!this._canWarn){return}args=["A11Y"].concat(args);if(this._hasWarned(args)){return}(_Adapt$log=Adapt.log).removed.apply(_Adapt$log,_toConsumableArray(args));return this}},{key:"deprecated",value:function deprecated(){var _Adapt$log2;for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++){args[_key2]=arguments[_key2]}if(!this._canWarn){return}args=["A11Y"].concat(args);if(this._hasWarned(args)){return}(_Adapt$log2=Adapt.log).deprecated.apply(_Adapt$log2,_toConsumableArray(args));return this}}]);return Log}(Backbone.Controller));var Scroll=__AMD("core/js/a11y/scroll",function(_Backbone$Controller){_inherits(Scroll,_Backbone$Controller);var _super=_createSuper(Scroll);function Scroll(){_classCallCheck(this,Scroll);return _super.apply(this,arguments)}_createClass(Scroll,[{key:"initialize",value:function initialize(){this._onTouchStart=this._onTouchStart.bind(this);this._onTouchEnd=this._onTouchEnd.bind(this);this._onScrollEvent=this._onScrollEvent.bind(this);this._onKeyDown=this._onKeyDown.bind(this);this._scrollDisabledElements=$([]);this.$window=$(window);this.$body=$("body");this._preventScrollOnKeys={37:true,38:true,39:true,40:true};this._ignoreKeysOnElementsMatching="textarea, input, select";this._isRunning=false;this._touchStartEventObject=null}},{key:"disable",value:function disable($elements){$elements=$($elements);this._scrollDisabledElements=this._scrollDisabledElements.add($elements);this._checkRunning();return this}},{key:"enable",value:function enable($elements){$elements=$($elements);if(!$elements.length){this.clear();return this}this._scrollDisabledElements=this._scrollDisabledElements.not($elements);this._checkRunning();return this}},{key:"clear",value:function clear(){this._scrollDisabledElements=$([]);this._checkRunning();return this}},{key:"_checkRunning",value:function _checkRunning(){if(!this._scrollDisabledElements.length){this._stop();return}this._start()}},{key:"_start",value:function _start(){if(this._isRunning){return}this._isRunning=true;window.addEventListener("touchstart",this._onTouchStart);window.addEventListener("touchend",this._onTouchEnd);window.addEventListener("touchmove",this._onScrollEvent,{passive:false});window.addEventListener("wheel",this._onScrollEvent,{passive:false});document.addEventListener("wheel",this._onScrollEvent,{passive:false});document.addEventListener("keydown",this._onKeyDown)}},{key:"_onTouchStart",value:function _onTouchStart(event){event=$.event.fix(event);this._touchStartEventObject=event;return true}},{key:"_onTouchEnd",value:function _onTouchEnd(){this._touchStartEventObject=null;return true}},{key:"_onScrollEvent",value:function _onScrollEvent(event){event=$.event.fix(event);return this._preventScroll(event)}},{key:"_onKeyDown",value:function _onKeyDown(event){event=$.event.fix(event);if(!this._preventScrollOnKeys[event.keyCode]){return}var $target=$(event.target);if($target.is(this._ignoreKeysOnElementsMatching)){return}return this._preventScroll(event)}},{key:"_preventScroll",value:function _preventScroll(event){var _event$touches;var isGesture=((_event$touches=event.touches)===null||_event$touches===void 0?void 0:_event$touches.length)>1;if(isGesture){return}var $target=$(event.target);if(this._scrollDisabledElements.length){var scrollingParent=this._getScrollingParent(event,$target);if(scrollingParent.filter(this._scrollDisabledElements).length===0){this.$window.scroll();return}}event.preventDefault();return false}},{key:"_getScrollingParent",value:function _getScrollingParent(event,$target){var _this$_touchStartEven;var isTouchEvent=event.type==="touchmove";var hasTouchStartEvent=(_this$_touchStartEven=this._touchStartEventObject)===null||_this$_touchStartEven===void 0?void 0:_this$_touchStartEven.originalEvent;if(isTouchEvent&&!hasTouchStartEvent){return $target}var directionY=this._getScrollDirection(event);if(directionY==="none"){return this.$body}var parents=$target.parents();for(var i=0,l=parents.length;i<l;i++){var $parent=$(parents[i]);if($parent.is("body")){return this.$body}if(!this._isScrollable($parent)){continue}if(!this._isScrolling($parent,directionY)){continue}return $parent}return this.$body}},{key:"_isScrollable",value:function _isScrollable($target){var scrollType=$target.css("overflow-y");if(scrollType!=="auto"&&scrollType!=="scroll"){return false}var pointerEvents=$target.css("pointer-events");if(pointerEvents==="none"){return false}return true}},{key:"_isScrolling",value:function _isScrolling($target,directionY){var scrollTop=Math.ceil($target.scrollTop());var innerHeight=$target.outerHeight();var scrollHeight=$target[0].scrollHeight;var hasScrollingSpace=false;switch(directionY){case"down":hasScrollingSpace=scrollTop+innerHeight<scrollHeight;if(hasScrollingSpace){return true}break;case"up":hasScrollingSpace=scrollTop>0;if(hasScrollingSpace){return true}break;}return false}},{key:"_getScrollDirection",value:function _getScrollDirection(event){var deltaY=this._getScrollDelta(event);if(deltaY===0){return"none"}return deltaY>0?"up":"down"}},{key:"_getScrollDelta",value:function _getScrollDelta(event){var deltaY=0;var isTouchEvent=event.type==="touchmove";var originalEvent=event.originalEvent;if(isTouchEvent){var startOriginalEvent=this._touchStartEventObject.originalEvent;var currentY=originalEvent.pageY;var previousY=startOriginalEvent.pageY;if(currentY===0||currentY===previousY){currentY=originalEvent.touches[0].pageY;previousY=startOriginalEvent.touches[0].pageY}deltaY=currentY-previousY}else{var hasDeltaY=originalEvent.wheelDeltaY||originalEvent.deltaY!==undefined;if(hasDeltaY){deltaY=-originalEvent.deltaY}else{deltaY=originalEvent.wheelDelta||0}}return deltaY}},{key:"_stop",value:function _stop(){if(!this._isRunning){return}this._isRunning=false;window.removeEventListener("touchstart",this._onTouchStart);window.removeEventListener("touchend",this._onTouchEnd);window.removeEventListener("touchmove",this._onScrollEvent,{passive:false});window.removeEventListener("wheel",this._onScrollEvent,{passive:false});document.removeEventListener("wheel",this._onScrollEvent,{passive:false});document.removeEventListener("keydown",this._onKeyDown)}}]);return Scroll}(Backbone.Controller));var WrapFocus=__AMD("core/js/a11y/wrapFocus",function(_Backbone$Controller){_inherits(WrapFocus,_Backbone$Controller);var _super=_createSuper(WrapFocus);function WrapFocus(){_classCallCheck(this,WrapFocus);return _super.apply(this,arguments)}_createClass(WrapFocus,[{key:"initialize",value:function initialize(){_.bindAll(this,"_onWrapAround");this.listenTo(Adapt,{"accessibility:ready":this._attachEventListeners})}},{key:"_attachEventListeners",value:function _attachEventListeners(){var config=Adapt.a11y.config;$("body").on("click focus",config._options._focusguard,this._onWrapAround)}},{key:"_onWrapAround",value:function _onWrapAround(event){var config=Adapt.a11y.config;if(!config._isEnabled||!config._options._isPopupWrapFocusEnabled){return}event.preventDefault();event.stopPropagation();Adapt.a11y.focusFirst("body",{defer:false})}}]);return WrapFocus}(Backbone.Controller));var Popup=__AMD("core/js/a11y/popup",function(_Backbone$Controller){_inherits(Popup,_Backbone$Controller);var _super=_createSuper(Popup);function Popup(){_classCallCheck(this,Popup);return _super.apply(this,arguments)}_createClass(Popup,[{key:"initialize",value:function initialize(){this._floorStack=[$("body")];this._focusStack=[];this._tabIndexes={};this._ariaHiddens={};this._elementUIDIndex=0;this.listenTo(Adapt,{"popup:opened":function($element,ignoreInternalTrigger){if(ignoreInternalTrigger){return}Adapt.a11y.log.deprecated("Adapt.trigger(\"popup:opened\", $element) is replaced with Adapt.a11y.popupOpened($element);");this.opened($element,true)},"popup:closed":function($target,ignoreInternalTrigger){if(ignoreInternalTrigger){return}Adapt.a11y.log.deprecated("Adapt.trigger(\"popup:closed\", $target) is replaced with Adapt.a11y.popupClosed($target);");this.closed($target,true)}})}},{key:"opened",value:function opened($popupElement,silent){$popupElement=$popupElement||$(document.activeElement);this._addPopupLayer($popupElement);if(!silent){Adapt.trigger("popup:opened",$popupElement,true)}return this}},{key:"_addPopupLayer",value:function _addPopupLayer($popupElement){var _this=this;$popupElement=$($popupElement);var config=Adapt.a11y.config;if(!config._isEnabled||!config._options._isPopupManagementEnabled||$popupElement.length===0){return $popupElement}this._floorStack.push($popupElement);this._focusStack.push($(document.activeElement));var $elements=$(config._options._tabbableElements).filter(config._options._tabbableElementsExcludes);var $branch=$popupElement.add($popupElement.parents());var $siblings=$branch.siblings().filter(config._options._tabbableElementsExcludes);$elements=$elements.add($siblings);$elements.each(function(index,item){var $item=$(item);var elementUID;if(typeof item.a11y_uid==="undefined"){item.a11y_uid="UID"+ ++_this._elementUIDIndex}elementUID=item.a11y_uid;if(_this._tabIndexes[elementUID]===undefined){_this._tabIndexes[elementUID]=[]}if(_this._ariaHiddens[elementUID]===undefined){_this._ariaHiddens[elementUID]=[]}var tabindex=$item.attr("tabindex");var ariaHidden=$item.attr("aria-hidden");_this._tabIndexes[elementUID].push(tabindex===undefined?"":tabindex);_this._ariaHiddens[elementUID].push(ariaHidden===undefined?"":ariaHidden);if(config._options._isPopupTabIndexManagementEnabled){$item.attr("tabindex",-1)}if(config._options._isPopupAriaHiddenManagementEnabled){$item.attr("aria-hidden",true)}});var $items=$popupElement.find(config._options._tabbableElements).filter(config._options._tabbableElementsExcludes);if(config._options._isPopupTabIndexManagementEnabled){$items.attr("tabindex",0)}if(config._options._isPopupAriaHiddenManagementEnabled){$items.removeAttr("aria-hidden").removeClass("aria-hidden").parents(config._options._ariaHiddenExcludes).removeAttr("aria-hidden").removeClass("aria-hidden")}}},{key:"closed",value:function closed($focusElement,silent){var $previousFocusElement=this._removeLastPopupLayer();$focusElement=$focusElement||$previousFocusElement||$("body");if(!silent){Adapt.trigger("popup:closed",$focusElement,true)}Adapt.a11y.focusFirst($($focusElement),{preventScroll:true});return this}},{key:"_removeLastPopupLayer",value:function _removeLastPopupLayer(){var _this2=this;var config=Adapt.a11y.config;if(!config._isEnabled||!config._options._isPopupManagementEnabled){return $(document.activeElement)}if(this._floorStack.length<=1){return}this._floorStack.pop();$(config._options._tabbableElements).filter(config._options._tabbableElementsExcludes).each(function(index,item){var _this2$_tabIndexes$el,_this2$_tabIndexes$el2;var $item=$(item);var previousTabIndex="";var previousAriaHidden="";var elementUID;if(typeof item.a11y_uid==="undefined"){item.a11y_uid="UID"+ ++_this2._elementUIDIndex}elementUID=item.a11y_uid;if((_this2$_tabIndexes$el=_this2._tabIndexes[elementUID])===null||_this2$_tabIndexes$el===void 0?void 0:_this2$_tabIndexes$el.length){previousTabIndex=_this2._tabIndexes[elementUID].pop();previousAriaHidden=_this2._ariaHiddens[elementUID].pop()}if((_this2$_tabIndexes$el2=_this2._tabIndexes[elementUID])===null||_this2$_tabIndexes$el2===void 0?void 0:_this2$_tabIndexes$el2.length){delete _this2._tabIndexes[elementUID];delete _this2._ariaHiddens[elementUID]}if(config._options._isPopupTabIndexManagementEnabled){if(previousTabIndex===""){$item.removeAttr("tabindex")}else{$item.attr({"tabindex":previousTabIndex})}}if(config._options._isPopupAriaHiddenManagementEnabled){if(previousAriaHidden===""){$item.removeAttr("aria-hidden")}else{$item.attr({"aria-hidden":previousAriaHidden})}}});return this._focusStack.pop()}},{key:"setCloseTo",value:function setCloseTo($focusElement){var $original=this._focusStack.pop();this._focusStack.push($focusElement);return $original}}]);return Popup}(Backbone.Controller));Object.assign($.fn,{isFixedPostion:function(){Adapt.a11y.log.removed("$(\"..\").isFixedPostion was unneeded and has been removed, let us know if you need it back.");return false},a11y_aria_label:function(){Adapt.a11y.log.removed("$(\"..\").a11y_aria_label was incorrect behaviour.");return this},limitedScrollTo:function(){Adapt.a11y.log.removed("$.limitedScrollTo had no impact on the screen reader cursor.");return this},a11y_text:function(){Adapt.a11y.log.removed("a11y_text is no longer required. https://tink.uk/understanding-screen-reader-interaction-modes/");return this},a11y_selected:function(){Adapt.a11y.log.removed("$(\"..\").a11y_selected is removed. Please use aria-live instead.");return this},a11y_on:function(isOn){Adapt.a11y.log.deprecated("$(\"..\").a11y_on, use Adapt.a11y.findTabbable($element); and Adapt.a11y.toggleAccessible($elements, isAccessible); instead.");var $tabbable=Adapt.a11y.findTabbable(this);Adapt.a11y.toggleAccessible($tabbable,isOn);return this},a11y_only:function(){Adapt.a11y.log.removed("$(\"..\").a11y_only, use Adapt.a11y.popupOpened($popupElement); instead.");return this},scrollDisable:function(){if(Adapt.a11y.config._options._isScrollDisableEnabled===false){return this}Adapt.a11y.log.deprecated("$(\"..\").scrollDisable, use Adapt.a11y.scrollDisable($elements); instead.");Adapt.a11y.scrollDisable(this);return this},scrollEnable:function(){if(Adapt.a11y.config._options._isScrollDisableEnabled===false){return this}Adapt.a11y.log.deprecated("$(\"..\").scrollEnable, use Adapt.a11y.scrollEnable($elements); instead.");Adapt.a11y.scrollEnable(this);return this},a11y_popup:function(){Adapt.a11y.log.deprecated("$(\"..\").a11y_popup, use Adapt.a11y.popupOpened($popupElement); instead.");return Adapt.a11y.popupOpened(this)},a11y_cntrl:function(isOn,withDisabled){Adapt.a11y.log.deprecated("$(\"..\").a11y_cntrl, use Adapt.a11y.toggleAccessible($elements, isAccessible); and if needed Adapt.a11y.toggleEnabled($elements, isEnabled); instead.");Adapt.a11y.toggleAccessible(this,isOn);if(withDisabled)Adapt.a11y.toggleEnabled(this,isOn);return this},a11y_cntrl_enabled:function(isOn){Adapt.a11y.log.deprecated("$(\"..\").a11y_cntrl_enabled, use Adapt.a11y.toggleAccessibleEnabled($elements, isAccessibleEnabled); instead.");Adapt.a11y.toggleAccessibleEnabled(this,isOn);return this},isReadable:function(){Adapt.a11y.log.deprecated("$(\"..\").isReadable, use Adapt.a11y.isReadable($element); instead.");return Adapt.a11y.isReadable(this)},findForward:function(selector){Adapt.a11y.log.removed("$(\"..\").findForward has been removed as the use cases are very small, let us know if you need it back.");return Adapt.a11y._findFirstForward(this,selector)},findWalk:function(selector){Adapt.a11y.log.removed("$(\"..\").findWalk has been removed as the use cases are very small, let us know if you need it back.");return Adapt.a11y._findFindForwardDescendant(this,selector)},focusNoScroll:function(){Adapt.a11y.log.deprecated("$(\"..\").focusNoScroll, use Adapt.a11y.focus($element); instead.");return Adapt.a11y.focus(this)},focusNext:function(returnOnly){Adapt.a11y.log.deprecated("$(\"..\").focusNext, use Adapt.a11y.focusNext($element); or if needed Adapt.a11y.findFirstReadable($element); instead.");if(returnOnly){return Adapt.a11y.findFirstReadable(this)}return Adapt.a11y.focusNext(this)},focusOrNext:function(returnOnly){Adapt.a11y.log.deprecated("$(\"..\").focusOrNext, use Adapt.a11y.focusFirst($element); or if needed Adapt.a11y.findFirstReadable($element); or Adapt.a11y.isReadable($element); instead.");if(returnOnly){if(Adapt.a11y.isReadable(this))return this;return Adapt.a11y.findFirstReadable(this)}return Adapt.a11y.focusFirst(this)},a11y_focus:function(dontDefer){Adapt.a11y.log.deprecated("$(\"..\").a11y_focus, use Adapt.a11y.focusFirst($element, { defer: true }); instead.");Adapt.a11y.focusFirst(this,{defer:!dontDefer});return this}});Object.assign($,{a11y_alert:function(){Adapt.a11y.log.removed("$.a11y_alert is removed. Please use aria-live instead.");return this},a11y_update:function(){Adapt.a11y.log.removed("a11y_update is no longer required.");return this},a11y_text:function(text){Adapt.a11y.log.removed("a11y_text is no longer required. https://tink.uk/understanding-screen-reader-interaction-modes/");return text},a11y_on:function(isOn,selector){Adapt.a11y.log.deprecated("$(\"..\").a11y_on, use Adapt.a11y.toggleHidden($elements, isHidden); instead.");return Adapt.a11y.toggleHidden(selector,!isOn)},a11y_popdown:function($focusTarget){Adapt.a11y.log.removed("$.a11y_popdown, use Adapt.a11y.popupClosed($focusTarget); instead.");return Adapt.a11y.popupClosed($focusTarget)},a11y_focus:function(dontDefer){Adapt.a11y.log.deprecated("$.a11y_focus, use Adapt.a11y.focusFirst(\"body\", { defer: true }); instead.");Adapt.a11y.focusFirst("body",{defer:!dontDefer});return this},a11y_normalize:function(html){Adapt.a11y.log.deprecated("$.a11y_normalize, use Adapt.a11y.normalize(\"html\"); instead.");return Adapt.a11y.normalize(html)},a11y_remove_breaks:function(html){Adapt.a11y.log.deprecated("$.a11y_remove_breaks, use Adapt.a11y.removeBreaks(\"html\"); instead.");return Adapt.a11y.removeBreaks(html)}});var A11y=function(_Backbone$Controller){_inherits(A11y,_Backbone$Controller);var _super=_createSuper(A11y);function A11y(){_classCallCheck(this,A11y);return _super.apply(this,arguments)}_createClass(A11y,[{key:"defaults",value:function defaults(){return{_isFocusOutlineKeyboardOnlyEnabled:true,_isFocusOutlineDisabled:false,_isFocusAssignmentEnabled:true,_isFocusOnClickEnabled:true,_isFocusNextOnDisabled:true,_isScrollDisableEnabled:true,_isAriaHiddenManagementEnabled:true,_isPopupManagementEnabled:true,_isPopupWrapFocusEnabled:true,_isPopupAriaHiddenManagementEnabled:true,_isPopupTabIndexManagementEnabled:true,_ariaHiddenExcludes:":not(#wrapper):not(body)",_tabbableElements:"a,button,input,select,textarea,[tabindex]:not([data-a11y-force-focus])",_focusOutlineKeyboardOnlyIgnore:"input,textarea",_tabbableElementsExcludes:":not(.a11y-ignore):not([data-a11y-force-focus])",_focusableElements:"a,button,input,select,textarea,[tabindex],label",_readableElements:"[role=heading],[aria-label],[aria-labelledby],[alt]",_focusguard:".a11y-focusguard",_wrapStyleElements:"b,i,abbr,strong,em,small,sub,sup,ins,del,mark,zw,nb",_warnFirstOnly:true,_warn:true}}},{key:"initialize",value:function initialize(){this.isReadable=this.isReadable.bind(this);this.isTabbable=this.isTabbable.bind(this);this.$html=$("html");this._htmlCharRegex=/&.*;/g;this.config=null;this._browserFocus=new BrowserFocus;this._keyboardFocusOutline=new KeyboardFocusOutline;this._wrapFocus=new WrapFocus;this._popup=new Popup;this._scroll=new Scroll;this.log=new Log;this._removeLegacyElements();this.listenToOnce(Adapt,{"app:dataLoaded":this._onDataLoaded,"navigationView:postRender":this._removeLegacyElements},this);Adapt.on("device:changed",this._setupNoSelect);this.listenTo(Adapt,{"router:location":this._onNavigationStart,"contentObjectView:ready router:plugin":this._onNavigationEnd})}},{key:"_onDataLoaded",value:function _onDataLoaded(){this.config=Adapt.config.get("_accessibility");this.config._isActive=false;this.config._options=_.defaults(this.config._options||{},this.defaults());Adapt.offlineStorage.set("a11y",false);this.$html.toggleClass("has-accessibility",this.isEnabled());this._setupNoSelect();this._addFocuserDiv();if(this._isReady){return}this._isReady=true;Adapt.trigger("accessibility:ready")}},{key:"_setupNoSelect",value:function _setupNoSelect(){var _this$config,_this=this;if(!((_this$config=this.config)===null||_this$config===void 0?void 0:_this$config._disableTextSelectOnClasses)){return}var classes=this.config._disableTextSelectOnClasses.split(" ");var isMatch=classes.some(function(className){return _this.$html.is(className)});this.$html.toggleClass("u-no-select",isMatch)}},{key:"_addFocuserDiv",value:function _addFocuserDiv(){if($("#a11y-focuser").length){return}$("body").append($("<div id=\"a11y-focuser\" class=\"a11y-ignore\" tabindex=\"-1\">&nbsp;</div>"))}},{key:"_removeLegacyElements",value:function _removeLegacyElements(){var $legacyElements=$("body").children("#accessibility-toggle, #accessibility-instructions");var $navigationElements=$(".nav").find("#accessibility-toggle, #accessibility-instructions");if(!$legacyElements.length&&!$navigationElements.length){return}Adapt.log.warn("REMOVED: #accessibility-toggle and #accessibility-instructions have been removed. Please remove them from all of your .html files.");$legacyElements.remove();$navigationElements.remove()}},{key:"_onNavigationStart",value:function _onNavigationStart(){var _this2=this;if(!this.isEnabled()){return}_.defer(function(){return _this2.toggleHidden(".contentobject",true)})}},{key:"_onNavigationEnd",value:function _onNavigationEnd(view){var _view$model;if((view===null||view===void 0?void 0:(_view$model=view.model)===null||_view$model===void 0?void 0:_view$model.get("_id"))!==Adapt.location._currentId||!this.isEnabled()){return}this.toggleHidden(".contentobject",false)}},{key:"isActive",value:function isActive(){this.log.removed("Accessibility is now always active when enabled. Please unify your user experiences.");return false}},{key:"isEnabled",value:function isEnabled(){var _this$config2;return(_this$config2=this.config)===null||_this$config2===void 0?void 0:_this$config2._isEnabled}},{key:"toggleHidden",value:function toggleHidden($elements){var isHidden=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;$elements=$($elements);var config=this.config;if(!config._isEnabled||!config._options._isAriaHiddenManagementEnabled){return this}if(isHidden===true){$elements.attr("aria-hidden",true)}else{$elements.removeAttr("aria-hidden")}return this}},{key:"toggleAccessibleEnabled",value:function toggleAccessibleEnabled($elements,isAccessibleEnabled){this.toggleAccessible($elements,isAccessibleEnabled);this.toggleEnabled($elements,isAccessibleEnabled);return this}},{key:"toggleAccessible",value:function toggleAccessible($elements){var isReadable=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;$elements=$($elements);var config=this.config;if(!config._isEnabled||!config._options._isAriaHiddenManagementEnabled||$elements.length===0){return this}if(!isReadable){$elements.attr({tabindex:"-1","aria-hidden":"true"}).addClass("aria-hidden")}else{$elements.removeAttr("aria-hidden tabindex").removeClass("aria-hidden");$elements.parents(config._options._ariaHiddenExcludes).removeAttr("aria-hidden").removeClass("aria-hidden")}return this}},{key:"toggleEnabled",value:function toggleEnabled($elements){var isEnabled=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;$elements=$($elements);if($elements.length===0){return this}if(!isEnabled){$elements.attr({tabindex:"-1","aria-disabled":"true"}).addClass("is-disabled")}else{$elements.removeAttr("aria-disabled tabindex").removeClass("is-disabled")}return this}},{key:"findFirstTabbable",value:function findFirstTabbable($element){$element=$($element).first();return this._findFirstForward($element,this.isTabbable)}},{key:"findFirstReadable",value:function findFirstReadable($element){$element=$($element).first();return this._findFirstForward($element,this.isReadable)}},{key:"findTabbable",value:function findTabbable($element){var config=this.config;return $($element).find(config._options._tabbableElements).filter(config._options._tabbableElementsExcludes)}},{key:"findReadable",value:function findReadable($element){var _this3=this;return $($element).find("*").filter(function(index,element){return _this3.isReadable(element)})}},{key:"isTabbable",value:function isTabbable($element){var config=this.config;var value=$($element).is(config._options._tabbableElements).is(config._options._tabbableElementsExcludes);if(!value){return undefined}return value}},{key:"isReadable",value:function isReadable($element){var checkParents=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var config=this.config;$element=$($element).first();var $branch=checkParents?$element.add($element.parents()):$element;var isNotVisible=$branch.toArray().some(function(item){var $item=$(item);return $item.css("display")==="none"||$item.css("visibility")==="hidden"||$item.attr("aria-hidden")==="true"});if(isNotVisible){return false}var hasNativeFocusOrIsScreenReadable=$element.is(config._options._focusableElements)||$element.is(config._options._readableElements);if(hasNativeFocusOrIsScreenReadable){return true}var childNodes=$element[0].childNodes;for(var c=0,cl=childNodes.length;c<cl;c++){var childNode=childNodes[c];var isTextNode=childNode.nodeType===3;if(!isTextNode){continue}var isOnlyWhiteSpace=/^\s*$/.test(childNode.nodeValue);if(isOnlyWhiteSpace){continue}return true}return undefined}},{key:"_findFirstForward",value:function _findFirstForward($element,selector){var _this4=this;$element=$($element).first();var iterator;switch(_typeof(selector)){case"string":iterator=function($tag){return $tag.is(selector)||undefined};break;case"function":iterator=selector;break;case"undefined":iterator=Boolean;}if($element.length===0){return $element.not("*")}var $found=this._findFirstForwardDescendant($element,iterator);if($found.length){return $found}$element.nextAll().toArray().some(function(sibling){var $sibling=$(sibling);var value=iterator($sibling);if(value===false){return}if(value){$found=$sibling;return true}$found=_this4._findFirstForwardDescendant($sibling,iterator);if($found.length)return true});if($found.length){return $found}$element.add($element.parents()).toArray().reverse().some(function(parent){var $parent=$(parent);if(iterator($parent)===false){return false}return $parent.nextAll().toArray().some(function(sibling){var $sibling=$(sibling);var value=iterator($sibling);if(value===false){return}if(value){$found=$sibling;return true}$found=_this4._findFirstForwardDescendant($sibling,iterator);if($found.length){return true}})});if(!$found.length){return $element.not("*")}return $found}},{key:"_findFirstForwardDescendant",value:function _findFirstForwardDescendant($element,selector){$element=$($element).first();var iterator;switch(_typeof(selector)){case"string":iterator=function($tag){return $tag.is(selector)||undefined};break;case"function":iterator=selector;break;case"undefined":iterator=Boolean;}var $notFound=$element.not("*");if($element.length===0){return $notFound}var stack=[{item:$element[0],value:undefined}];var stackIndexPosition=0;var childIndexPosition=stackIndexPosition+1;do{var stackEntry=stack[stackIndexPosition];var $stackItem=$(stackEntry.item);switch(stackEntry.value){case true:return $stackItem;case false:return $notFound;}$stackItem.children().toArray().forEach(function(item){var $item=$(item);var value=iterator($item);if(value===false){return}stack.splice(childIndexPosition++,0,{item:item,value:value})});stackIndexPosition++;childIndexPosition=stackIndexPosition+1}while(stackIndexPosition<stack.length);return $notFound}},{key:"focusNext",value:function focusNext($element,options){options=new FocusOptions(options);$element=$($element).first();$element=this.findFirstReadable($element);this.focus($element,options);return this}},{key:"focusFirst",value:function focusFirst($element,options){options=new FocusOptions(options);$element=$($element).first();if(this.isReadable($element)){this.focus($element,options);return $element}$element=this.findFirstReadable($element);this.focus($element,options);return $element}},{key:"focus",value:function focus($element,options){options=new FocusOptions(options);$element=$($element).first();var config=this.config;if(!config._isEnabled||!config._options._isFocusAssignmentEnabled||$element.length===0){return this}function perform(){if($element.attr("tabindex")===undefined){$element.attr({"tabindex":"-1","data-a11y-force-focus":"true"})}if(options.preventScroll){var y=$(window).scrollTop();try{$element[0].focus({preventScroll:true})}catch(e){}switch(Adapt.device.browser){case"internet explorer":case"microsoft edge":case"safari":window.scrollTo(null,y);}}else{$element[0].focus()}}if(options.defer){_.defer(perform)}else{perform()}return this}},{key:"normalize",value:function normalize(htmls){htmls=Array.prototype.slice.call(arguments).filter(Boolean).filter(_.isString).join(" ");var text=$("<div>"+htmls+"</div>").text();return text.replace(this._htmlCharRegex,"")}},{key:"removeBreaks",value:function removeBreaks(htmls){var _this5=this;htmls=Array.prototype.slice.call(arguments).filter(Boolean).filter(_.isString).join(" ");var $div=$("<div>"+htmls+"</div>");var stack=[$div[0]];var stackIndex=0;var outputs=[];do{if(stack[stackIndex].childNodes.length){var nodes=stack[stackIndex].childNodes;var usable=nodes.filter(function(node){var isTextNode=node.nodeType===3;if(isTextNode){return true}var isStyleElement=$(node).is(_this5.config._options._wrapStyleElements);if(isStyleElement){return true}return false});outputs.push.apply(outputs,usable);stack.push.apply(stack,nodes)}stackIndex++}while(stackIndex<stack.length);var rtnText="";outputs.forEach(function(item){rtnText+=item.outerHTML||item.textContent});return rtnText}},{key:"scrollEnable",value:function scrollEnable($elements){this._scroll.enable($elements);return this}},{key:"scrollDisable",value:function scrollDisable($elements){this._scroll.disable($elements);return this}},{key:"popupOpened",value:function popupOpened($popupElement){this._popup.opened($popupElement);return this}},{key:"popupClosed",value:function popupClosed($focusElement){this._popup.closed($focusElement);return this}},{key:"setPopupCloseTo",value:function setPopupCloseTo($focusElement){return this._popup.setCloseTo($focusElement)}}]);return A11y}(Backbone.Controller);var a11y=__AMD("core/js/a11y",Adapt.a11y=new A11y);Object.defineProperty(Adapt,"accessibility",{get:function(){a11y.log.deprecated("Adapt.accessibility has moved to Adapt.a11y");return a11y}});var AdaptCollection=__AMD("core/js/collections/adaptCollection",function(_Backbone$Collection){_inherits(AdaptCollection,_Backbone$Collection);var _super=_createSuper(AdaptCollection);function AdaptCollection(){_classCallCheck(this,AdaptCollection);return _super.apply(this,arguments)}_createClass(AdaptCollection,[{key:"initialize",value:function initialize(models,options){this.once("reset",this.loadedData,this)}},{key:"loadedData",value:function loadedData(){Adapt.trigger("adaptCollection:dataLoaded")}}]);return AdaptCollection}(Backbone.Collection));var LOG_LEVEL=ENUM(["DEBUG","INFO","WARN","ERROR","FATAL"]);var LOG_LEVEL$1=__AMD("core/js/enums/logLevelEnum",LOG_LEVEL);var Logging=function(_Backbone$Controller){_inherits(Logging,_Backbone$Controller);var _super=_createSuper(Logging);function Logging(){_classCallCheck(this,Logging);return _super.apply(this,arguments)}_createClass(Logging,[{key:"initialize",value:function initialize(){this._config={_isEnabled:true,_level:LOG_LEVEL$1.INFO.asLowerCase,_console:true,_warnFirstOnly:true};this._warned={};this.listenToOnce(Adapt,"configModel:dataLoaded",this.onLoadConfigData)}},{key:"onLoadConfigData",value:function onLoadConfigData(){this.loadConfig();this.debug("Logging config loaded");this.trigger("log:ready")}},{key:"loadConfig",value:function loadConfig(){if(Adapt.config.has("_logging")){this._config=Adapt.config.get("_logging")}this.checkQueryStringOverride()}},{key:"checkQueryStringOverride",value:function checkQueryStringOverride(){var matches=window.location.search.match(/[?&]loglevel=([a-z]*)/i);if(!matches||matches.length<2)return;var override=LOG_LEVEL$1(matches[1].toUpperCase());if(!override)return;this._config._level=override.asLowerCase;this.debug("Loglevel override in query string:",this._config._level)}},{key:"debug",value:function debug(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}this._log(LOG_LEVEL$1.DEBUG,args)}},{key:"info",value:function info(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++){args[_key2]=arguments[_key2]}this._log(LOG_LEVEL$1.INFO,args)}},{key:"warn",value:function warn(){for(var _len3=arguments.length,args=new Array(_len3),_key3=0;_key3<_len3;_key3++){args[_key3]=arguments[_key3]}this._log(LOG_LEVEL$1.WARN,args)}},{key:"error",value:function error(){for(var _len4=arguments.length,args=new Array(_len4),_key4=0;_key4<_len4;_key4++){args[_key4]=arguments[_key4]}this._log(LOG_LEVEL$1.ERROR,args)}},{key:"fatal",value:function fatal(){for(var _len5=arguments.length,args=new Array(_len5),_key5=0;_key5<_len5;_key5++){args[_key5]=arguments[_key5]}this._log(LOG_LEVEL$1.FATAL,args)}},{key:"removed",value:function removed(){for(var _len6=arguments.length,args=new Array(_len6),_key6=0;_key6<_len6;_key6++){args[_key6]=arguments[_key6]}args=["REMOVED"].concat(args);this.warnOnce.apply(this,_toConsumableArray(args))}},{key:"deprecated",value:function deprecated(){for(var _len7=arguments.length,args=new Array(_len7),_key7=0;_key7<_len7;_key7++){args[_key7]=arguments[_key7]}args=["DEPRECATED"].concat(args);this.warnOnce.apply(this,_toConsumableArray(args))}},{key:"warnOnce",value:function warnOnce(){for(var _len8=arguments.length,args=new Array(_len8),_key8=0;_key8<_len8;_key8++){args[_key8]=arguments[_key8]}if(this._hasWarned(args)){return}this._log(LOG_LEVEL$1.WARN,args)}},{key:"_log",value:function _log(level,data){var isEnabled=this._config._isEnabled;if(!isEnabled)return;var configLevel=LOG_LEVEL$1(this._config._level.toUpperCase());var isLogLevelAllowed=level>=configLevel;if(!isLogLevelAllowed)return;this._logToConsole(level,data);this.trigger("log",level,data);this.trigger("log:"+level.asLowerCase,level,data)}},{key:"_logToConsole",value:function _logToConsole(level,data){var shouldLogToConsole=this._config._console;if(!shouldLogToConsole)return;var log=[level.asUpperCase+":"];data&&log.push.apply(log,_toConsumableArray(data));if(console[level.asLowerCase]){var _console;(_console=console)[level.asLowerCase].apply(_console,log)}else{var _console2;(_console2=console).log.apply(_console2,log)}}},{key:"_hasWarned",value:function _hasWarned(args){if(!this._config._warnFirstOnly){return false}var hash=args.map(String).join(":");if(this._warned[hash]){return true}this._warned[hash]=true;return false}}]);return Logging}(Backbone.Controller);__AMD("core/js/logging",Adapt.log=new Logging);var BuildModel=__AMD("core/js/models/buildModel",function(_LockingModel){_inherits(BuildModel,_LockingModel);var _super=_createSuper(BuildModel);function BuildModel(){_classCallCheck(this,BuildModel);return _super.apply(this,arguments)}_createClass(BuildModel,[{key:"defaults",value:function defaults(){return{jsonext:"json"}}},{key:"initialize",value:function initialize(attrs,options){var _this=this;this.url=options.url;this.fetch({success:function(){_this.isLoaded=true;Adapt.trigger("buildModel:dataLoaded")},error:function(){console.log("Unable to load adapt/js/build.js");Adapt.trigger("buildModel:dataLoaded")}})}},{key:"whenReady",value:function whenReady(){if(this.isLoaded)return Promise.resolve();return new Promise(function(resolve){Adapt.once("buildModel:dataLoaded",resolve)})}}]);return BuildModel}(LockingModel));var ConfigModel=__AMD("core/js/models/configModel",function(_LockingModel){_inherits(ConfigModel,_LockingModel);var _super=_createSuper(ConfigModel);function ConfigModel(){_classCallCheck(this,ConfigModel);return _super.apply(this,arguments)}_createClass(ConfigModel,[{key:"defaults",value:function defaults(){return{screenSize:{large:900,medium:760,small:520},_forceRouteLocking:false,_canLoadData:true,_disableAnimation:false}}},{key:"initialize",value:function initialize(attrs,options){var _this=this;this.url=options.url;this.fetch({success:function(){Adapt.trigger("offlineStorage:prepare");Adapt.wait.queue(function(){Adapt.trigger("configModel:dataLoaded");if(!_this.get("_canLoadData"))return;Adapt.trigger("configModel:loadCourseData")})},error:function(){return console.log("Unable to load course/config.json")}})}},{key:"loadData",value:function loadData(){}}]);return ConfigModel}(LockingModel));var ModelEvent=__AMD("core/js/modelEvent",function(_Backbone$Controller){_inherits(ModelEvent,_Backbone$Controller);var _super=_createSuper(ModelEvent);function ModelEvent(){_classCallCheck(this,ModelEvent);return _super.apply(this,arguments)}_createClass(ModelEvent,[{key:"initialize",value:function initialize(type,target,value){this.type=type;this.target=target;this.value=value;this.canBubble=true;this.deepPath=[target];this.timeStamp=null}},{key:"stopPropagation",value:function stopPropagation(){this.canBubble=false}},{key:"addPath",value:function addPath(target){this.deepPath.unshift(target)}}]);return ModelEvent}(Backbone.Controller));var AdaptModel=__AMD("core/js/models/adaptModel",function(_LockingModel){_inherits(AdaptModel,_LockingModel);var _super=_createSuper(AdaptModel);function AdaptModel(){_classCallCheck(this,AdaptModel);return _super.apply(this,arguments)}_createClass(AdaptModel,[{key:"toJSON",value:function toJSON(){var json=_objectSpread2({},this.attributes);delete json._children;delete json._parent;return $.extend(true,{},json)}},{key:"get",value:function get(name){switch(name){case"_parent":case"_children":Adapt.log.deprecated("Use model.getChildren() or model.getParent() instead of model.get('_children') or model.get('_parent')");}return _get(_getPrototypeOf(AdaptModel.prototype),"get",this).call(this,name)}},{key:"defaults",value:function defaults(){return{_canShowFeedback:true,_classes:"",_canReset:false,_canRequestChild:false,_isComplete:false,_isInteractionComplete:false,_isA11yRegionEnabled:false,_isA11yCompletionDescriptionEnabled:true,_requireCompletionOf:-1,_isEnabled:true,_isResetOnRevisit:false,_isAvailable:true,_isOptional:false,_isRendered:false,_isReady:false,_isVisible:true,_isLocked:false,_isHidden:false}}},{key:"parse",value:function parse(data){if(data._isResetOnRevisit==="false"){data._isResetOnRevisit=false}return data}},{key:"trackable",value:function trackable(){return["_id","_isComplete","_isInteractionComplete"]}},{key:"trackableType",value:function trackableType(){return[String,Boolean,Boolean]}},{key:"bubblingEvents",value:function bubblingEvents(){return["change:_isComplete","change:_isInteractionComplete","change:_isActive"]}},{key:"setupModel",value:function setupModel(){var _this=this;if(this.hasManagedChildren){this.setupChildListeners()}this.init();_.defer(function(){if(_this.hasManagedChildren){_this.checkCompletionStatus();_this.checkInteractionCompletionStatus();_this.checkLocking()}_this.setupTrackables()})}},{key:"setupTrackables",value:function setupTrackables(){var _this2=this;var originalTrackableStateFunction=this.triggerTrackableState;this.triggerTrackableState=_.compose(function(){_this2.triggerTrackableState.isQueued=true},_.debounce(function(){originalTrackableStateFunction.apply(_this2);_this2.triggerTrackableState.isQueued=false},17));this.listenTo(this,"change",function(_ref){var changed=_ref.changed;if(_this2.triggerTrackableState.isQueued||!Adapt.attributes._isStarted){return}var trackablePropertyNames=_.result(_this2,"trackable",[]);var changedPropertyNames=Object.keys(changed);var isTrackable=changedPropertyNames.find(function(item){return trackablePropertyNames.includes(item)});if(isTrackable){_this2.triggerTrackableState()}})}},{key:"setupChildListeners",value:function setupChildListeners(){var children=this.getChildren();if(!children.length){return}this.listenTo(children,{"all":this.onAll,"bubble":this.bubble,"change:_isReady":this.checkReadyStatus,"change:_isComplete":this.onIsComplete,"change:_isInteractionComplete":this.checkInteractionCompletionStatus})}},{key:"init",value:function init(){}},{key:"getTrackableState",value:function getTrackableState(){var _ref2;var trackable=this.resultExtend("trackable",[]);var json=this.toJSON();var args=trackable;args.unshift(json);return(_ref2=_).pick.apply(_ref2,_toConsumableArray(args))}},{key:"setTrackableState",value:function setTrackableState(state){var _ref3;var trackable=this.resultExtend("trackable",[]);var args=trackable;args.unshift(state);state=(_ref3=_).pick.apply(_ref3,_toConsumableArray(args));this.set(state);return this}},{key:"triggerTrackableState",value:function triggerTrackableState(){Adapt.trigger("state:change",this,this.getTrackableState())}},{key:"reset",value:function reset(type,force){if(!this.get("_canReset")&&!force)return;type=type||true;switch(type){case"hard":case true:this.set({_isEnabled:true,_isComplete:false,_isInteractionComplete:false});break;case"soft":this.set({_isEnabled:true,_isInteractionComplete:false});break;}}},{key:"checkReadyStatus",value:function checkReadyStatus(model,value){if(value===false){return false}var children=this.getAvailableChildModels();if(children.find(function(child){return child.get("_isReady")===false&&child.get("_isRendered")})){return false}this.set("_isReady",true);return true}},{key:"setCompletionStatus",value:function setCompletionStatus(){if(!this.get("_isVisible"))return;this.set({_isComplete:true,_isInteractionComplete:true})}},{key:"checkCompletionStatus",value:function checkCompletionStatus(){Adapt.checkingCompletion();_.defer(this.checkCompletionStatusFor.bind(this),"_isComplete")}},{key:"checkInteractionCompletionStatus",value:function checkInteractionCompletionStatus(){Adapt.checkingCompletion();_.defer(this.checkCompletionStatusFor.bind(this),"_isInteractionComplete")}},{key:"checkCompletionStatusFor",value:function checkCompletionStatusFor(){var completionAttribute=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"_isComplete";var completed=false;var children=this.getAvailableChildModels();var requireCompletionOf=this.get("_requireCompletionOf");if(requireCompletionOf===-1){completed=children.every(function(child){return child.get(completionAttribute)||child.get("_isOptional")})}else{completed=children.filter(function(child){return child.get(completionAttribute)&&!child.get("_isOptional")}).length>=requireCompletionOf}this.set(completionAttribute,completed);Adapt.checkedCompletion()}},{key:"getTypeGroup",value:function getTypeGroup(){}},{key:"isTypeGroup",value:function isTypeGroup(typeGroup){var hasUpperCase=/[A-Z]+/.test(typeGroup);var isPluralized=typeGroup.slice(-1)==="s";var lowerCased=typeGroup.toLowerCase();var singular=isPluralized&&lowerCased.slice(0,-1);var singularLowerCased=(singular||lowerCased).toLowerCase();if(isPluralized||hasUpperCase){Adapt.log.deprecated("'".concat(typeGroup,"' appears pluralized or contains uppercase characters, suggest using the singular, lowercase type group '").concat(singularLowerCased,"'."))}var pluralizedLowerCaseTypes=[singularLowerCased,!isPluralized&&"".concat(lowerCased,"s")].filter(Boolean);var typeGroups=this.getTypeGroups();if(_.intersection(pluralizedLowerCaseTypes,typeGroups).length){return true}return false}},{key:"getTypeGroups",value:function getTypeGroups(){if(this._typeGroups)return this._typeGroups;var typeGroups=[this.get("_type")];var parentClass=this;while(parentClass=Object.getPrototypeOf(parentClass)){if(!parentClass.hasOwnProperty("getTypeGroup"))continue;typeGroups.push(parentClass.getTypeGroup.call(this))}return this._typeGroups=_.uniq(typeGroups.filter(Boolean).map(function(s){return s.toLowerCase()}))}},{key:"findAncestor",value:function findAncestor(ancestorType){var parent=this.getParent();if(!parent)return;if(!ancestorType||parent.isTypeGroup(ancestorType)){return parent}return parent.findAncestor(ancestorType)}},{key:"findDescendantModels",value:function findDescendantModels(descendants,options){var allDescendantsModels=this.getAllDescendantModels();var returnedDescendants=allDescendantsModels.filter(function(model){return model.isTypeGroup(descendants)});if(!options){return returnedDescendants}if(options.where){return returnedDescendants.filter(function(descendant){for(var property in options.where){var value=options.where[property];if(descendant.get(property)!==value){return false}}return true})}}},{key:"getAllDescendantModels",value:function getAllDescendantModels(isParentFirst){var descendants=[];if(!this.hasManagedChildren){return descendants}var children=this.getChildren();children.models.forEach(function(child){if(!child.hasManagedChildren){descendants.push(child);return}var subDescendants=child.getAllDescendantModels(isParentFirst);if(isParentFirst===true){descendants.push(child)}descendants.push.apply(descendants,_toConsumableArray(subDescendants));if(isParentFirst!==true){descendants.push(child)}});return descendants}},{key:"findRelativeModel",value:function findRelativeModel(relativeString){var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var rootModel=options.limitParentId?Adapt.findById(options.limitParentId):Adapt.course;var relativeDescriptor=Adapt.parseRelativeString(relativeString);var searchBackwards=relativeDescriptor.offset<0;var moveBy=Math.abs(relativeDescriptor.offset);var movementCount=0;var hasDescendantsOfType=Boolean(this.findDescendantModels(relativeDescriptor.type).length);if(hasDescendantsOfType){moveBy--}var pageDescendants;if(searchBackwards){var _pageDescendants;pageDescendants=[rootModel];(_pageDescendants=pageDescendants).push.apply(_pageDescendants,_toConsumableArray(rootModel.getAllDescendantModels(true)));pageDescendants.reverse()}else{pageDescendants=rootModel.getAllDescendantModels(false);pageDescendants.push(rootModel)}var modelId=this.get("_id");var modelIndex=pageDescendants.findIndex(function(pageDescendant){if(pageDescendant.get("_id")===modelId){return true}return false});var isFilterFunction=typeof options.filter==="function";if(options.loop){var totalOfType=pageDescendants.reduce(function(count,model){if(!model.isTypeGroup(relativeDescriptor.type))return count;return++count},0);moveBy=moveBy%totalOfType;pageDescendants=pageDescendants.concat(pageDescendants.slice(0))}for(var i=modelIndex,l=pageDescendants.length;i<l;i++){var descendant=pageDescendants[i];if(!descendant.isTypeGroup(relativeDescriptor.type))continue;var isSelf=i===modelIndex;if(!isSelf&&isFilterFunction&&!options.filter(descendant))continue;if(movementCount>moveBy){break}if(movementCount===moveBy){return Adapt.findById(descendant.get("_id"))}movementCount++}}},{key:"getChildren",value:function getChildren(){if(this._childrenCollection){return this._childrenCollection}var childrenCollection;if(!this.hasManagedChildren){childrenCollection=new Backbone.Collection}else{var id=this.get("_id");var children=Adapt.data.filter(function(model){return model.get("_parentId")===id});childrenCollection=new Backbone.Collection(children)}if(this.get("_type")==="block"&&childrenCollection.length===2&&childrenCollection.models[0].get("_layout")!=="left"){childrenCollection.comparator="_layout";childrenCollection.sort()}this.setChildren(childrenCollection);return this._childrenCollection}},{key:"setChildren",value:function setChildren(children){this._childrenCollection=children;this.set("_children",children)}},{key:"getAvailableChildModels",value:function getAvailableChildModels(){return this.getChildren().where({_isAvailable:true})}},{key:"getParent",value:function getParent(){if(this._parentModel){return this._parentModel}var parentId=this.get("_parentId");if(!parentId)return;this.setParent(Adapt.findById(parentId));return this._parentModel}},{key:"setParent",value:function setParent(parent){this._parentModel=parent;this.set("_parentId",this._parentModel.get("_id"));this.set("_parent",this._parentModel)}},{key:"getAncestorModels",value:function getAncestorModels(shouldIncludeChild){var parents=[];var context=this;if(shouldIncludeChild)parents.push(context);while(context.has("_parentId")){context=context.getParent();parents.push(context)}return parents.length?parents:null}},{key:"getSiblings",value:function getSiblings(passSiblingsAndIncludeSelf){var id=this.get("_id");var parentId=this.get("_parentId");var siblings;if(!passSiblingsAndIncludeSelf){if(this._hasSiblingsAndSelf===false){return this.get("_siblings")}siblings=Adapt.data.filter(function(model){return model.get("_parentId")===parentId&&model.get("_id")!==id});this._hasSiblingsAndSelf=false}else{if(this._hasSiblingsAndSelf){return this.get("_siblings")}siblings=Adapt.data.filter(function(model){return model.get("_parentId")===parentId});this._hasSiblingsAndSelf=true}var siblingsCollection=new Backbone.Collection(siblings);this.set("_siblings",siblingsCollection);return siblingsCollection}},{key:"setOnChildren",value:function setOnChildren(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}this.set.apply(this,args);if(!this.hasManagedChildren)return;var children=this.getChildren();children.models.forEach(function(child){return child.setOnChildren.apply(child,args)})}},{key:"setOptional",value:function setOptional(value){Adapt.log.deprecated("Use model.set('_isOptional', value) as setOptional() may be removed in the future");this.set({_isOptional:value})}},{key:"checkLocking",value:function checkLocking(){var lockType=this.get("_lockType");if(!lockType)return;switch(lockType){case"sequential":this.setSequentialLocking();break;case"unlockFirst":this.setUnlockFirstLocking();break;case"lockLast":this.setLockLastLocking();break;case"custom":this.setCustomLocking();break;default:console.warn("AdaptModel.checkLocking: unknown _lockType '".concat(lockType,"' found on ").concat(this.get("_id")));}}},{key:"setSequentialLocking",value:function setSequentialLocking(){var children=this.getAvailableChildModels();for(var i=1,j=children.length;i<j;i++){children[i].set("_isLocked",!children[i-1].get("_isComplete"))}}},{key:"setUnlockFirstLocking",value:function setUnlockFirstLocking(){var children=this.getAvailableChildModels();var isFirstChildComplete=children[0].get("_isComplete");for(var i=1,j=children.length;i<j;i++){children[i].set("_isLocked",!isFirstChildComplete)}}},{key:"setLockLastLocking",value:function setLockLastLocking(){var children=this.getAvailableChildModels();var lastIndex=children.length-1;for(var i=lastIndex-1;i>=0;i--){if(!children[i].get("_isComplete")){return children[lastIndex].set("_isLocked",true)}}children[lastIndex].set("_isLocked",false)}},{key:"setCustomLocking",value:function setCustomLocking(){var _this3=this;var children=this.getAvailableChildModels();children.forEach(function(child){child.set("_isLocked",_this3.shouldLock(child))})}},{key:"shouldLock",value:function shouldLock(child){var lockedBy=child.get("_lockedBy");if(!lockedBy)return false;for(var i=lockedBy.length-1;i>=0;i--){var id=lockedBy[i];try{var model=Adapt.findById(id);if(!model.get("_isAvailable"))continue;if(!model.get("_isComplete"))return true}catch(e){console.warn("AdaptModel.shouldLock: unknown _lockedBy ID '".concat(id,"' found on ").concat(child.get("_id")))}}return false}},{key:"onIsComplete",value:function onIsComplete(){this.checkCompletionStatus();this.checkLocking()}},{key:"checkIfResetOnRevisit",value:function checkIfResetOnRevisit(){var isResetOnRevisit=this.get("_isResetOnRevisit");if(!isResetOnRevisit){return}this.reset(isResetOnRevisit)}},{key:"deepClone",value:function deepClone(){var modifier=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;var ModelClass=this.constructor;var clonedModel=new ModelClass(this.toJSON());if(modifier){modifier(clonedModel,this)}var clonedId=clonedModel.get("_id");var hasId=Boolean(clonedId);var shouldAssignUniqueId=this.get("_id")===clonedId;if(hasId&&shouldAssignUniqueId){var cid=_.uniqueId(ModelClass.prototype.cidPrefix||"c");clonedId="".concat(clonedId,"_").concat(cid);clonedModel.set("_id",clonedId)}if(hasId){Adapt.data.add(clonedModel)}if(this.hasManagedChildren){this.getChildren().each(function(child){if(!child.deepClone){throw new Error("Cannot deepClone child.")}child.deepClone(function(clone,child){if(hasId){clone.set("_parentId",clonedId)}if(modifier){modifier(clone,child)}})})}clonedModel.getParent().getChildren().add(clonedModel);clonedModel.setupModel();return clonedModel}},{key:"onAll",value:function onAll(type,model,value){if(!_.result(this,"bubblingEvents").includes(type))return;var event=new ModelEvent(type,model,value);this.bubble(event)}},{key:"bubble",value:function bubble(event){if(!event.canBubble)return;event.addPath(this);this.trigger("bubble:".concat(event.type," bubble"),event)}},{key:"trackingPosition",get:function(){var _this4=this;var firstDescendant=this.getAllDescendantModels(false).concat([this])[0];var nearestTrackingIdModel=[firstDescendant].concat(firstDescendant.getAncestorModels()).find(function(model){return model.has("_trackingId")});if(!nearestTrackingIdModel)return;var trackingId=nearestTrackingIdModel.get("_trackingId");var trackingIdDescendants=[nearestTrackingIdModel].concat(nearestTrackingIdModel.getAllDescendantModels(true));var indexInTrackingIdDescendants=trackingIdDescendants.findIndex(function(descendant){return descendant===_this4});if(indexInTrackingIdDescendants>=0){return[trackingId,indexInTrackingIdDescendants]}var trackingIdAncestors=nearestTrackingIdModel.getAncestorModels();var ancestorDistance=trackingIdAncestors.findIndex(function(ancestor){return ancestor===_this4});return[trackingId,-(ancestorDistance+1)]}},{key:"hasManagedChildren",get:function(){return true}}]);return AdaptModel}(LockingModel));var ContentObjectModel=__AMD("core/js/models/contentObjectModel",function(_AdaptModel){_inherits(ContentObjectModel,_AdaptModel);var _super=_createSuper(ContentObjectModel);function ContentObjectModel(){_classCallCheck(this,ContentObjectModel);return _super.apply(this,arguments)}_createClass(ContentObjectModel,[{key:"getTypeGroup",value:function getTypeGroup(){return"contentobject"}},{key:"_parent",get:function(){Adapt.log.deprecated("contentObjectModel._parent, use contentObjectModel.getParent() instead, parent models are defined by the JSON");var isParentCourse=this.get("_parentId")===Adapt.course.get("_id");if(isParentCourse){return"course"}return"contentObjects"}},{key:"_siblings",get:function(){Adapt.log.deprecated("contentObjectModel._siblings, use contentObjectModel.getSiblings() instead, sibling models are defined by the JSON");return"contentObjects"}},{key:"_children",get:function(){Adapt.log.deprecated("contentObjectModel._children, use contentObjectModel.hasManagedChildren instead, child models are defined by the JSON");return null}}]);return ContentObjectModel}(AdaptModel));var MenuModel=function(_ContentObjectModel){_inherits(MenuModel,_ContentObjectModel);var _super=_createSuper(MenuModel);function MenuModel(){_classCallCheck(this,MenuModel);return _super.apply(this,arguments)}_createClass(MenuModel,[{key:"getTypeGroup",value:function getTypeGroup(){return"menu"}},{key:"setCustomLocking",value:function setCustomLocking(){var _this=this;var children=this.getAvailableChildModels();children.forEach(function(child){child.set("_isLocked",_this.shouldLock(child));if(!(child instanceof MenuModel))return;child.checkLocking()})}},{key:"_children",get:function(){Adapt.log.deprecated("menuModel._children, use menuModel.hasManagedChildren instead, child models are defined by the JSON");return"contentObjects"}}]);return MenuModel}(ContentObjectModel);Adapt.register("menu",{model:MenuModel});var MenuModel$1=__AMD("core/js/models/menuModel",MenuModel);var CourseModel=function(_MenuModel){_inherits(CourseModel,_MenuModel);var _super=_createSuper(CourseModel);function CourseModel(){_classCallCheck(this,CourseModel);return _super.apply(this,arguments)}_createClass(CourseModel,[{key:"_parent",get:function(){Adapt.log.deprecated("courseModel._parent, use courseModel.getParent() instead, parent models are defined by the JSON");return null}},{key:"_siblings",get:function(){Adapt.log.deprecated("courseModel._siblings, use courseModel.getSiblings() instead, sibling models are defined by the JSON");return null}}]);return CourseModel}(MenuModel$1);Adapt.register("course",{model:CourseModel});var CourseModel$1=__AMD("core/js/models/courseModel",CourseModel);var StartController=function(_Backbone$Controller){_inherits(StartController,_Backbone$Controller);var _super=_createSuper(StartController);function StartController(){_classCallCheck(this,StartController);return _super.apply(this,arguments)}_createClass(StartController,[{key:"initialize",value:function initialize(){var _get2;for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}(_get2=_get(_getPrototypeOf(StartController.prototype),"initialize",this)).call.apply(_get2,[this].concat(args));this.model=null}},{key:"loadCourseData",value:function loadCourseData(){this.model=new LockingModel(Adapt.course.get("_start"))}},{key:"setStartLocation",value:function setStartLocation(){if(!this.isEnabled())return;window.history.replaceState("","",this.getStartHash())}},{key:"returnToStartLocation",value:function returnToStartLocation(){var startIds=this.model.get("_startIds");if(startIds){startIds.forEach(function(startId){return startId._skipIfComplete=false})}window.location.hash=this.getStartHash(true)}},{key:"getStartHash",value:function getStartHash(alwaysForce){var startId=this.getStartId();var isRouteSpecified=window.location.href.indexOf("#")>-1;var shouldForceStartId=alwaysForce||this.model.get("_force");var shouldNavigateToStartId=startId&&(!isRouteSpecified||shouldForceStartId);if(shouldNavigateToStartId&&startId!==Adapt.course.get("_id")){return"#/id/"+startId}return window.location.hash||"#/"}},{key:"isEnabled",value:function isEnabled(){var _this$model;return Boolean((_this$model=this.model)===null||_this$model===void 0?void 0:_this$model.get("_isEnabled"))}},{key:"getStartId",value:function getStartId(){var startId=this.model.get("_id");var startIds=this.model.get("_startIds");if(!(startIds===null||startIds===void 0?void 0:startIds.length))return startId;var $html=$("html");for(var i=0,l=startIds.length;i<l;i++){var item=startIds[i];var className=item._className;var skipIfComplete=item._skipIfComplete;var model=Adapt.findById(item._id);if(!model){console.log("startController: cannot find id",item._id);continue}if(skipIfComplete){if(model.get("_isComplete"))continue}if(!className||$html.is(className)||$html.hasClass(className)){startId=item._id;break}}return startId}}]);return StartController}(Backbone.Controller);Adapt.once("adapt:start",function(){Adapt.startController.loadCourseData();Adapt.startController.setStartLocation()});Adapt.on("navigation:returnToStart",function(){Adapt.startController.returnToStartLocation()});__AMD("core/js/startController",Adapt.startController=new StartController);var Data=function(_AdaptCollection){_inherits(Data,_AdaptCollection);var _super=_createSuper(Data);function Data(){_classCallCheck(this,Data);return _super.apply(this,arguments)}_createClass(Data,[{key:"model",value:function model(json){var ModelClass=Adapt.getModelClass(json);if(!ModelClass){return new LockingModel(json)}return new ModelClass(json,{parse:true})}},{key:"initialize",value:function initialize(){_get(_getPrototypeOf(Data.prototype),"initialize",this).call(this);this.on({"add":this.onAdded,"remove":this.onRemoved})}},{key:"init",value:function(){var _init=_asyncToGenerator(regeneratorRuntime.mark(function _callee(){return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:this.reset();this._byAdaptID={};Adapt.build=new BuildModel(null,{url:"adapt/js/build.min.js",reset:true});_context.next=5;return Adapt.build.whenReady();case 5:$("html").attr("data-adapt-framework-version",Adapt.build.get("package").version);this.loadConfigData();case 7:case"end":return _context.stop();}}},_callee,this)}));function init(){return _init.apply(this,arguments)}return init}()},{key:"onAdded",value:function onAdded(model){this._byAdaptID[model.get("_id")]=model}},{key:"onRemoved",value:function onRemoved(model){delete this._byAdaptID[model.get("_id")]}},{key:"loadConfigData",value:function loadConfigData(){Adapt.config=new ConfigModel(null,{url:"course/config."+Adapt.build.get("jsonext"),reset:true});this.listenToOnce(Adapt,"configModel:loadCourseData",this.onLoadCourseData);this.listenTo(Adapt.config,{"change:_activeLanguage":this.onLanguageChange,"change:_defaultDirection":this.onDirectionChange})}},{key:"onDirectionChange",value:function onDirectionChange(model,direction){if(direction==="rtl"){$("html").removeClass("dir-ltr").addClass("dir-rtl").attr("dir","rtl")}else{$("html").removeClass("dir-rtl").addClass("dir-ltr").attr("dir","ltr")}}},{key:"onLoadCourseData",value:function onLoadCourseData(){if(!Adapt.config.get("_activeLanguage")){Adapt.config.set("_activeLanguage",Adapt.config.get("_defaultLanguage"));return}this.loadCourseData()}},{key:"onLanguageChange",value:function onLanguageChange(model,language){Adapt.offlineStorage.set("lang",language);if(Adapt.get("_isStarted")){Adapt.set("_isStarted",false)}this.loadCourseData(language)}},{key:"loadCourseData",value:function(){var _loadCourseData=_asyncToGenerator(regeneratorRuntime.mark(function _callee2(newLanguage){var language,courseFolder;return regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:language=Adapt.config.get("_activeLanguage");courseFolder="course/"+language+"/";$("html").attr("lang",language);_context2.next=5;return this.loadManifestFiles(courseFolder);case 5:_context2.next=7;return this.triggerDataLoaded();case 7:_context2.next=9;return this.triggerDataReady(newLanguage);case 9:this.triggerInit();case 10:case"end":return _context2.stop();}}},_callee2,this)}));function loadCourseData(_x){return _loadCourseData.apply(this,arguments)}return loadCourseData}()},{key:"getJSON",value:function getJSON(path){return new Promise(function(resolve,reject){$.getJSON(path,function(data){data.__path__=path;resolve(data)}).fail(reject)})}},{key:"loadManifestFiles",value:function(){var _loadManifestFiles=_asyncToGenerator(regeneratorRuntime.mark(function _callee3(languagePath){var _this=this;var manifestPath,manifest,allFileData,allModelData,course;return regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:this.trigger("loading");this.reset();manifestPath=languagePath+"language_data_manifest.js";_context3.prev=3;_context3.next=6;return this.getJSON(manifestPath);case 6:manifest=_context3.sent;_context3.next=13;break;case 9:_context3.prev=9;_context3.t0=_context3["catch"](3);manifest=["course.json","contentObjects.json","articles.json","blocks.json","components.json"];Adapt.log.warnOnce("Manifest path '".concat(manifestPath," not found. Using traditional files: ").concat(manifest.join(", ")));case 13:_context3.next=15;return Promise.all(manifest.map(function(filePath){return _this.getJSON("".concat(languagePath).concat(filePath))}));case 15:allFileData=_context3.sent;allModelData=allFileData.reduce(function(result,fileData){if(Array.isArray(fileData)){result.push.apply(result,_toConsumableArray(fileData))}else if(fileData instanceof Object){result.push(fileData)}else{Adapt.log.warnOnce("File data isn't an array or object: ".concat(fileData.__path__))}return result},[]);course=allModelData.find(function(modelData){return modelData._type==="course"});if(course){_context3.next=20;break}throw new Error("Expected a model data with \"_type\": \"course\", none found.");case 20:Adapt.trigger("courseModel:dataLoading");Adapt.course=this.push(course);Adapt.trigger("courseModel:dataLoaded");allModelData.forEach(function(modelData){if(modelData._type==="course"){return}_this.push(modelData)});this.trigger("reset");this.trigger("loaded");_context3.next=28;return Adapt.wait.queue();case 28:case"end":return _context3.stop();}}},_callee3,this,[[3,9]])}));function loadManifestFiles(_x2){return _loadManifestFiles.apply(this,arguments)}return loadManifestFiles}()},{key:"triggerDataLoaded",value:function(){var _triggerDataLoaded=_asyncToGenerator(regeneratorRuntime.mark(function _callee4(){return regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:Adapt.log.debug("Firing app:dataLoaded");try{this.forEach(function(model){var _model$setupModel;return(_model$setupModel=model.setupModel)===null||_model$setupModel===void 0?void 0:_model$setupModel.call(model)});Adapt.trigger("app:dataLoaded")}catch(e){Adapt.log.error("Error during app:dataLoading trigger",e)}_context4.next=4;return Adapt.wait.queue();case 4:case"end":return _context4.stop();}}},_callee4,this)}));function triggerDataLoaded(){return _triggerDataLoaded.apply(this,arguments)}return triggerDataLoaded}()},{key:"triggerDataReady",value:function(){var _triggerDataReady=_asyncToGenerator(regeneratorRuntime.mark(function _callee5(newLanguage){return regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:if(newLanguage){Adapt.trigger("app:languageChanged",newLanguage);_.defer(function(){Adapt.startController.loadCourseData();var hash=Adapt.startController.isEnabled()?Adapt.startController.getStartHash(true):"#/";Adapt.router.navigate(hash,{trigger:true,replace:true})})}Adapt.log.debug("Firing app:dataReady");try{Adapt.trigger("app:dataReady")}catch(e){Adapt.log.error("Error during app:dataReady trigger",e)}_context5.next=5;return Adapt.wait.queue();case 5:case"end":return _context5.stop();}}},_callee5)}));function triggerDataReady(_x3){return _triggerDataReady.apply(this,arguments)}return triggerDataReady}()},{key:"triggerInit",value:function triggerInit(){this.isReady=true;this.trigger("ready")}},{key:"whenReady",value:function whenReady(){var _this2=this;if(this.isReady)return Promise.resolve();return new Promise(function(resolve){_this2.once("ready",resolve)})}},{key:"findById",value:function findById(id){var model=this._byAdaptID[id];if(!model){console.warn("Adapt.findById() unable to find id: ".concat(id));return}return model}},{key:"findByTrackingPosition",value:function findByTrackingPosition(trackingPosition){var _trackingPosition=_slicedToArray(trackingPosition,2),trackingId=_trackingPosition[0],indexInTrackingIdDescendants=_trackingPosition[1];var trackingIdModel=this.find(function(model){return model.get("_trackingId")===trackingId});if(!trackingIdModel){console.warn("Adapt.findByTrackingPosition() unable to find trackingPosition: ".concat(trackingPosition));return}if(indexInTrackingIdDescendants>=0){var trackingIdDescendants=[trackingIdModel].concat(trackingIdModel.getAllDescendantModels(true));return trackingIdDescendants[indexInTrackingIdDescendants]}var trackingIdAncestors=trackingIdModel.getAncestorModels();var ancestorDistance=Math.abs(indexInTrackingIdDescendants)-1;return trackingIdAncestors[ancestorDistance]}}]);return Data}(AdaptCollection);var Data$1=__AMD("core/js/data",Adapt.data=new Data);var OfflineStorage=function(_Backbone$Controller){_inherits(OfflineStorage,_Backbone$Controller);var _super=_createSuper(OfflineStorage);function OfflineStorage(){_classCallCheck(this,OfflineStorage);return _super.apply(this,arguments)}_createClass(OfflineStorage,[{key:"initialize",value:function initialize(handler){this.ready=true;this._handler=undefined;if(!handler){return}this.ready=false;this._handler=handler}},{key:"hasHandler",value:function hasHandler(){return this._handler!==undefined}},{key:"save",value:function save(){var _this$_handler,_this$_handler$save;Adapt.trigger("tracking:save");return(_this$_handler=this._handler)===null||_this$_handler===void 0?void 0:(_this$_handler$save=_this$_handler.save)===null||_this$_handler$save===void 0?void 0:_this$_handler$save.apply(this._handler,arguments)}},{key:"serialize",value:function serialize(value){var _this$_handler2;if((_this$_handler2=this._handler)===null||_this$_handler2===void 0?void 0:_this$_handler2.serialize){return this._handler.serialize.apply(this._handler,arguments)}return JSON.stringify(value)}},{key:"deserialize",value:function deserialize(value){var _this$_handler3;if((_this$_handler3=this._handler)===null||_this$_handler3===void 0?void 0:_this$_handler3.deserialize){return this._handler.deserialize.apply(this._handler,arguments)}return JSON.parse(value)}},{key:"set",value:function set(name,value){var _this$_handler4;if((_this$_handler4=this._handler)===null||_this$_handler4===void 0?void 0:_this$_handler4.set){return this._handler.set.apply(this._handler,arguments)}this[name]=value}},{key:"get",value:function get(name){var _this$_handler5;if((_this$_handler5=this._handler)===null||_this$_handler5===void 0?void 0:_this$_handler5.get){return this._handler.get.apply(this._handler,arguments)}return this[name]}},{key:"setReadyStatus",value:function setReadyStatus(){this.ready=true;Adapt.trigger("offlineStorage:ready")}}]);return OfflineStorage}(Backbone.Controller);Adapt.offlineStorage=new OfflineStorage;__AMD("core/js/offlineStorage",Adapt.offlineStorage);var COMPLETION_STATE=ENUM(["INCOMPLETE","COMPLETED","PASSED","FAILED"]);var COMPLETION_STATE$1=__AMD("core/js/enums/completionStateEnum",COMPLETION_STATE);var Tracking=function(_Backbone$Controller){_inherits(Tracking,_Backbone$Controller);var _super=_createSuper(Tracking);function Tracking(){_classCallCheck(this,Tracking);return _super.apply(this,arguments)}_createClass(Tracking,[{key:"initialize",value:function initialize(){this._config={_requireContentCompleted:true,_requireAssessmentCompleted:false};this._assessmentState=null;Adapt.once("configModel:dataLoaded",this.loadConfig.bind(this));Adapt.on("app:dataReady",this.setupEventListeners.bind(this))}},{key:"setupEventListeners",value:function setupEventListeners(){if(this._config._requireAssessmentCompleted){this.listenTo(Adapt,{"assessment:complete":this.onAssessmentComplete,"assessment:restored":this.onAssessmentRestored})}if(this._config._requireContentCompleted){this.listenTo(Adapt.course,"change:_isComplete",this.checkCompletion)}}},{key:"onAssessmentComplete",value:function onAssessmentComplete(assessmentState){this._assessmentState=assessmentState;this.checkCompletion()}},{key:"onAssessmentRestored",value:function onAssessmentRestored(assessmentState){this._assessmentState=assessmentState}},{key:"checkCompletion",value:function checkCompletion(){var completionData=this.getCompletionData();if(completionData.status===COMPLETION_STATE$1.INCOMPLETE){return}Adapt.trigger("tracking:complete",completionData);Adapt.log.debug("tracking:complete",completionData)}},{key:"getCompletionData",value:function getCompletionData(){var completionData={status:COMPLETION_STATE$1.INCOMPLETE,assessment:null};if(this._config._requireContentCompleted&&!Adapt.course.get("_isComplete")){return completionData}if(this._config._requireAssessmentCompleted){if(!this._assessmentState){return completionData}completionData.status=this._assessmentState.isPass?COMPLETION_STATE$1.PASSED:COMPLETION_STATE$1.FAILED;completionData.assessment=this._assessmentState;return completionData}completionData.status=COMPLETION_STATE$1.COMPLETED;return completionData}},{key:"loadConfig",value:function loadConfig(){if(Adapt.config.has("_completionCriteria")){this._config=Adapt.config.get("_completionCriteria")}}}]);return Tracking}(Backbone.Controller);Adapt.tracking=new Tracking;__AMD("core/js/tracking",Adapt.tracking);var Device=function(_Backbone$Controller){_inherits(Device,_Backbone$Controller);var _super=_createSuper(Device);function Device(){_classCallCheck(this,Device);return _super.apply(this,arguments)}_createClass(Device,[{key:"initialize",value:function initialize(){this.$html=$("html");this.$window=$(window);this.touch=Modernizr.touchevents;this.screenWidth=this.getScreenWidth();this.screenHeight=this.getScreenHeight();this.browser=(Bowser__default["default"].name||"").toLowerCase();this.version=(Bowser__default["default"].version||"").toLowerCase();this.OS=this.getOperatingSystem().toLowerCase();this.osVersion=Bowser__default["default"].osversion||"";this.renderingEngine=this.getRenderingEngine();this.onWindowResize=_.debounce(this.onWindowResize.bind(this),100);this.listenTo(Adapt,{"app:dataReady":this.onDataReady});var browser=this.browser.toLowerCase();var browserString=browser.replace(/msie|internet explorer/,"ie");browserString+=" version-".concat(this.version," OS-").concat(this.OS," ").concat(this.getAppleDeviceType());browserString+=browserString.replace(".","-").toLowerCase();browserString+=" pixel-density-".concat(this.pixelDensity());this.$html.addClass(browserString)}},{key:"onDataReady",value:function onDataReady(){this.screenSize=this.checkScreenSize();this.$html.addClass("size-"+this.screenSize);if(this.orientation){this.$html.addClass("orientation-"+this.orientation)}this.$window.on("resize orientationchange",this.onWindowResize)}},{key:"checkScreenSize",value:function checkScreenSize(){var screenSizeConfig=Adapt.config.get("screenSize");var screenSize;var screensizeEmThreshold=300;var baseFontSize=16;var mediumEmBreakpoint=screenSizeConfig.medium>screensizeEmThreshold?screenSizeConfig.medium/baseFontSize:screenSizeConfig.medium;var smallEmBreakpoint=screenSizeConfig.small>screensizeEmThreshold?screenSizeConfig.small/baseFontSize:screenSizeConfig.small;var fontSize=parseFloat($("html").css("font-size"));var screenSizeEmWidth=this.screenWidth/fontSize;if(screenSizeEmWidth>=mediumEmBreakpoint){screenSize="large"}else if(screenSizeEmWidth>=smallEmBreakpoint){screenSize="medium"}else{screenSize="small"}return screenSize}},{key:"getScreenWidth",value:function getScreenWidth(){return this.isAppleDevice()?this.getAppleScreenWidth():window.innerWidth||this.$window.width()}},{key:"getScreenHeight",value:function getScreenHeight(){return this.isAppleDevice()?this.getAppleScreenHeight():window.innerHeight||this.$window.height()}},{key:"getOperatingSystem",value:function getOperatingSystem(){var flags=["windows","mac","linux","windowsphone","chromeos","android","ios","blackberry","firefoxos","webos","bada","tizen","sailfish"];var os=flags.find(function(name){return Bowser__default["default"][name]})||"";if(os===""){var platform=navigator.platform.toLowerCase();var match=platform.match(/win|mac|linux/);if(match)os=match[0];if(os==="win")os="windows";if(!os)os="PlatformUnknown"}return os}},{key:"getRenderingEngine",value:function getRenderingEngine(){var flags=["webkit","blink","gecko","msie","msedge"];return flags.find(function(name){return Bowser__default["default"][name]})||""}},{key:"onWindowResize",value:function onWindowResize(){var previousWidth=this.screenWidth;var previousHeight=this.screenHeight;this.screenWidth=this.getScreenWidth();this.screenHeight=this.getScreenHeight();if(previousWidth===this.screenWidth&&previousHeight===this.screenHeight){return}var newScreenSize=this.checkScreenSize();if(newScreenSize!==this.screenSize){this.screenSize=newScreenSize;this.$html.removeClass("size-small size-medium size-large").addClass("size-"+this.screenSize);if(this.orientation){this.$html.removeClass("orientation-landscape orientation-portrait").addClass("orientation-"+this.orientation)}Adapt.trigger("device:changed",this.screenSize)}Adapt.trigger("device:preResize device:resize device:postResize",this.screenWidth)}},{key:"isAppleDevice",value:function isAppleDevice(){return /iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream}},{key:"getAppleScreenWidth",value:function getAppleScreenWidth(){return Math.abs(window.orientation)===90?window.screen.height:window.screen.width}},{key:"getAppleScreenHeight",value:function getAppleScreenHeight(){return Math.abs(window.orientation)===90?window.screen.width:window.screen.height}},{key:"getAppleDeviceType",value:function getAppleDeviceType(){var flags=["iphone","ipad","ipod"];return flags.find(function(name){return Bowser__default["default"][name]})||""}},{key:"pixelDensity",value:function pixelDensity(){var pixelDensity=window.devicePixelRatio||1;if(pixelDensity>=3){return"ultra-high"}else if(pixelDensity>=2){return"high"}else if(pixelDensity>=1.5){return"medium"}else{return"low"}}},{key:"orientation",get:function(){return this.screenWidth>=this.screenHeight?"landscape":"portrait"}},{key:"aspectRatio",get:function(){return this.screenWidth/this.screenHeight}}]);return Device}(Backbone.Controller);__AMD("core/js/device",Adapt.device=new Device);var DrawerItemView=function(_Backbone$View){_inherits(DrawerItemView,_Backbone$View);var _super=_createSuper(DrawerItemView);function DrawerItemView(){_classCallCheck(this,DrawerItemView);return _super.apply(this,arguments)}_createClass(DrawerItemView,[{key:"className",value:function className(){return"drawer__menu drawer__item"}},{key:"attributes",value:function attributes(){return{role:"list"}}},{key:"initialize",value:function initialize(){this.listenTo(Adapt,"drawer:empty",this.remove);this.render()}},{key:"events",value:function events(){return{"click .drawer__item-btn":"onDrawerItemClicked"}}},{key:"render",value:function render(){var data=this.model.toJSON();var template=Handlebars.templates["drawerItem"];$(this.el).html(template(data)).appendTo(".drawer__holder");return this}},{key:"onDrawerItemClicked",value:function onDrawerItemClicked(event){event.preventDefault();var eventCallback=this.model.get("eventCallback");Adapt.trigger(eventCallback)}}]);return DrawerItemView}(Backbone.View);DrawerItemView.type="drawerItem";var DrawerItemView$1=__AMD("core/js/views/drawerItemView",DrawerItemView);var DrawerView=function(_Backbone$View){_inherits(DrawerView,_Backbone$View);var _super=_createSuper(DrawerView);function DrawerView(){_classCallCheck(this,DrawerView);return _super.apply(this,arguments)}_createClass(DrawerView,[{key:"className",value:function className(){return"drawer u-display-none"}},{key:"attributes",value:function attributes(){return{"role":"dialog","aria-modal":"true","aria-labelledby":"drawer-heading","aria-hidden":"true"}}},{key:"initialize",value:function initialize(){this.disableAnimation=Adapt.config.has("_disableAnimation")?Adapt.config.get("_disableAnimation"):false;this._isVisible=false;this.drawerDir="right";if(Adapt.config.get("_defaultDirection")==="rtl"){this.drawerDir="left"}this.setupEventListeners();this.render();this.drawerDuration=Adapt.config.get("_drawer")._duration;this.drawerDuration=this.drawerDuration?this.drawerDuration:400;this.$wrapper=$("#wrapper")}},{key:"setupEventListeners",value:function setupEventListeners(){this.listenTo(Adapt,{"navigation:toggleDrawer":this.toggleDrawer,"drawer:triggerCustomView":this.openCustomView,"drawer:closeDrawer":this.onCloseDrawer,"remove":this.onRemove,"drawer:remove":this.remove});this.onKeyUp=this.onKeyUp.bind(this);this.setupEscapeKey()}},{key:"setupEscapeKey",value:function setupEscapeKey(){$(window).on("keyup",this.onKeyUp)}},{key:"onKeyUp",value:function onKeyUp(event){if(event.which!==27)return;event.preventDefault();this.onCloseDrawer()}},{key:"events",value:function events(){return{"click .drawer__back":"onBackButtonClicked","click .drawer__close":"onCloseClicked"}}},{key:"render",value:function render(){var template=Handlebars.templates["drawer"];$(this.el).html(template({_globals:Adapt.course.get("_globals")})).prependTo("body");var shadowTemplate=Handlebars.templates["shadow"];$(shadowTemplate()).prependTo("body");_.defer(this.postRender.bind(this));return this}},{key:"postRender",value:function postRender(){this.$("a, button, input, select, textarea").attr("tabindex",-1);this.checkIfDrawerIsAvailable()}},{key:"openCustomView",value:function openCustomView(view,hasBackButton){this._hasBackButton=hasBackButton;this._isCustomViewVisible=true;Adapt.trigger("drawer:empty");this.showDrawer();this.$(".drawer__holder").html(view)}},{key:"checkIfDrawerIsAvailable",value:function checkIfDrawerIsAvailable(){var isEmptyDrawer=this.collection.length===0;$(".js-nav-drawer-btn").toggleClass("u-display-none",isEmptyDrawer);if(isEmptyDrawer){Adapt.trigger("drawer:noItems")}}},{key:"onBackButtonClicked",value:function onBackButtonClicked(event){event.preventDefault();this.showDrawer(true)}},{key:"onCloseClicked",value:function onCloseClicked(event){event.preventDefault();this.hideDrawer()}},{key:"onCloseDrawer",value:function onCloseDrawer($toElement){this.hideDrawer($toElement)}},{key:"onRemove",value:function onRemove(){this.hideDrawer()}},{key:"toggleDrawer",value:function toggleDrawer(){if(this._isVisible&&this._isCustomViewVisible===false){this.hideDrawer();return}this.showDrawer(true)}},{key:"showDrawer",value:function showDrawer(emptyDrawer){var _this=this;this.$el.removeClass("u-display-none").removeAttr("aria-hidden");if(!this._isVisible){Adapt.a11y.popupOpened(this.$el);Adapt.a11y.scrollDisable("body");this._isVisible=true}this.$("a, button, input, select, textarea").attr("tabindex",0);if(emptyDrawer){this.$(".drawer__back").addClass("u-display-none");this._isCustomViewVisible=false;this.emptyDrawer();if(this.collection.models.length===1){Adapt.trigger(this.collection.models[0].get("eventCallback"));this._isCustomViewVisible=false}else{this.renderItems();Adapt.trigger("drawer:openedItemView")}}else{var hideDrawerBackButton=!this._hasBackButton||this.collection.models.length<=1;this.$(".drawer__back").toggleClass("u-display-none",hideDrawerBackButton);Adapt.trigger("drawer:openedCustomView")}var complete=function(){_this.addShadowEvent();Adapt.trigger("drawer:opened");Adapt.a11y.focusFirst(_this.$el,{defer:true})};var direction={};if(this.disableAnimation){$(".js-shadow").removeClass("u-display-none");$(".js-drawer-holder").scrollTop(0);direction[this.drawerDir]=0;this.$el.css(direction);complete()}else{$(".js-shadow").velocity({opacity:1},{duration:this.drawerDuration,begin:function(){$(".js-shadow").removeClass("u-display-none");$(".js-drawer-holder").scrollTop(0);complete()}});var showEasingAnimation=Adapt.config.get("_drawer")._showEasing;var easing=showEasingAnimation||"easeOutQuart";direction[this.drawerDir]=0;this.$el.velocity(direction,this.drawerDuration,easing)}}},{key:"emptyDrawer",value:function emptyDrawer(){this.$(".drawer__holder").empty()}},{key:"renderItems",value:function renderItems(){Adapt.trigger("drawer:empty");this.emptyDrawer();var models=this.collection.models;for(var i=0,len=models.length;i<len;i++){var item=models[i];new DrawerItemView$1({model:item})}}},{key:"hideDrawer",value:function hideDrawer($toElement){var direction={};if(this._isVisible){Adapt.a11y.popupClosed($toElement);this._isVisible=false;Adapt.a11y.scrollEnable("body")}else{return}if(this.disableAnimation){direction[this.drawerDir]=-this.$el.width();this.$el.css(direction).addClass("u-display-none").attr("aria-hidden","true");$(".js-shadow").addClass("u-display-none");Adapt.trigger("drawer:closed")}else{var showEasingAnimation=Adapt.config.get("_drawer")._hideEasing;var easing=showEasingAnimation||"easeOutQuart";direction[this.drawerDir]=-this.$el.width();this.$el.velocity(direction,this.drawerDuration,easing,_.bind(function(){this.$el.addClass("u-display-none").attr("aria-hidden","true");Adapt.trigger("drawer:closed")},this));$(".js-shadow").velocity({opacity:0},{duration:this.drawerDuration,complete:function(){$(".js-shadow").addClass("u-display-none")}})}this._isCustomViewVisible=false;this.removeShadowEvent()}},{key:"addShadowEvent",value:function addShadowEvent(){var _this2=this;$(".js-shadow").one("click touchstart",function(){return _this2.onCloseDrawer()})}},{key:"removeShadowEvent",value:function removeShadowEvent(){$(".js-shadow").off("click touchstart")}},{key:"remove",value:function remove(){Backbone.View.prototype.remove.apply(this,arguments);$(window).off("keyup",this.onKeyUp);Adapt.trigger("drawer:empty");this.collection.reset();$(".js-shadow").remove()}}]);return DrawerView}(Backbone.View);Object.assign(DrawerView,{childContainer:".js-drawer-holder",childView:DrawerItemView$1});var DrawerView$1=__AMD("core/js/views/drawerView",DrawerView);var DrawerCollection=new Backbone.Collection(null,{comparator:"drawerOrder"});var Drawer={};Drawer.addItem=function(drawerObject,eventCallback){drawerObject.eventCallback=eventCallback;DrawerCollection.add(drawerObject)};Drawer.triggerCustomView=function(view,hasBackButton){if(hasBackButton!==false){hasBackButton=true}Adapt.trigger("drawer:triggerCustomView",view,hasBackButton)};Adapt.on({"adapt:start":function(){new DrawerView$1({collection:DrawerCollection})},"app:languageChanged":function(){Adapt.trigger("drawer:remove")}});__AMD("core/js/drawer",Adapt.drawer=Drawer);var NotifyPushView=__AMD("core/js/views/notifyPushView",function(_Backbone$View){_inherits(NotifyPushView,_Backbone$View);var _super=_createSuper(NotifyPushView);function NotifyPushView(){_classCallCheck(this,NotifyPushView);return _super.apply(this,arguments)}_createClass(NotifyPushView,[{key:"className",value:function className(){var classes="notify-push ";classes+=this.model.get("_classes")||"";return classes}},{key:"attributes",value:function attributes(){return{"role":"dialog","aria-labelledby":"notify-push-heading","aria-modal":"false"}}},{key:"initialize",value:function initialize(){this.listenTo(Adapt,{"notify:pushShown notify:pushRemoved":this.updateIndexPosition,"remove":this.remove});this.listenTo(this.model.collection,{"remove":this.updateIndexPosition,"change:_index":this.updatePushPosition});this.preRender();this.render()}},{key:"events",value:function events(){return{"click .js-notify-push-close-btn":"closePush","click .js-notify-push-inner":"triggerEvent"}}},{key:"preRender",value:function preRender(){this.hasBeenRemoved=false}},{key:"render",value:function render(){var data=this.model.toJSON();var template=Handlebars.templates["notifyPush"];this.$el.html(template(data)).appendTo("#wrapper");_.defer(this.postRender.bind(this));return this}},{key:"postRender",value:function postRender(){this.$el.addClass("is-active");_.delay(this.closePush.bind(this),this.model.get("_timeout"));Adapt.trigger("notify:pushShown")}},{key:"closePush",value:function closePush(event){var _this=this;if(event){event.preventDefault()}if(this.hasBeenRemoved===false){this.hasBeenRemoved=true;this.$el.removeClass("is-active");_.delay(function(){_this.model.collection.remove(_this.model);Adapt.trigger("notify:pushRemoved",_this);_this.remove()},600)}}},{key:"triggerEvent",value:function triggerEvent(event){Adapt.trigger(this.model.get("_callbackEvent"));this.closePush()}},{key:"updateIndexPosition",value:function updateIndexPosition(){var _this2=this;if(this.hasBeenRemoved)return;var models=this.model.collection.models;models.forEach(function(model,index){if(!model.get("_isActive"))return;model.set("_index",index);_this2.updatePushPosition()})}},{key:"updatePushPosition",value:function updatePushPosition(){if(this.hasBeenRemoved){return}if(typeof this.model.get("_index")!=="undefined"){var elementHeight=this.$el.height();var offset=20;var navigationHeight=$(".nav").height();var currentIndex=this.model.get("_index");var flippedIndex=currentIndex===0?1:0;if(this.model.collection.where({_isActive:true}).length===1){flippedIndex=0}var positionLowerPush=(elementHeight+offset)*flippedIndex+navigationHeight+offset;this.$el.css("top",positionLowerPush)}}}]);return NotifyPushView}(Backbone.View));var NotifyModel=__AMD("core/js/models/notifyModel",function(_LockingModel){_inherits(NotifyModel,_LockingModel);var _super=_createSuper(NotifyModel);function NotifyModel(){_classCallCheck(this,NotifyModel);return _super.apply(this,arguments)}_createClass(NotifyModel,[{key:"defaults",value:function defaults(){return{_isActive:false,_showIcon:false,_timeout:3000}}}]);return NotifyModel}(LockingModel));var NotifyPushCollection=__AMD("core/js/collections/notifyPushCollection",function(_Backbone$Collection){_inherits(NotifyPushCollection,_Backbone$Collection);var _super=_createSuper(NotifyPushCollection);function NotifyPushCollection(){_classCallCheck(this,NotifyPushCollection);return _super.apply(this,arguments)}_createClass(NotifyPushCollection,[{key:"initialize",value:function initialize(){this.model=NotifyModel;this.listenTo(this,"add",this.onPushAdded);this.listenTo(Adapt,"notify:pushRemoved",this.onRemovePush)}},{key:"onPushAdded",value:function onPushAdded(model){this.checkPushCanShow(model)}},{key:"checkPushCanShow",value:function checkPushCanShow(model){if(!this.canShowPush())return;model.set("_isActive",true);this.showPush(model)}},{key:"canShowPush",value:function canShowPush(){var availablePushNotifications=this.where({_isActive:true});return availablePushNotifications.length<2}},{key:"showPush",value:function showPush(model){new NotifyPushView({model:model})}},{key:"onRemovePush",value:function onRemovePush(view){var inactivePushNotifications=this.where({_isActive:false});if(inactivePushNotifications.length>0){this.checkPushCanShow(inactivePushNotifications[0])}}}]);return NotifyPushCollection}(Backbone.Collection));var ChildEvent=__AMD("core/js/childEvent",function(_Backbone$Controller){_inherits(ChildEvent,_Backbone$Controller);var _super=_createSuper(ChildEvent);function ChildEvent(){_classCallCheck(this,ChildEvent);return _super.apply(this,arguments)}_createClass(ChildEvent,[{key:"initialize",value:function initialize(type,target,model){this.type=type;this.target=target;this.isForced=false;this.isStoppedImmediate=false;this.isStoppedNext=false;this.hasRequestChild=false;this._model=model}},{key:"reset",value:function reset(){this.isStoppedImmediate=false;this.isStoppedNext=false}},{key:"force",value:function force(){this.isForced=true}},{key:"stop",value:function stop(){var immediate=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;if(!immediate){return this.stopNext()}this.isStoppedImmediate=true}},{key:"stopNext",value:function stopNext(){this.isStoppedNext=true}},{key:"close",value:function close(){this.trigger("closed")}},{key:"model",get:function(){return this._model},set:function(model){if(this.type!=="requestChild"){Adapt.log.warn("Cannot change model in ".concat(this.type," event."));return}if(this._model){Adapt.log.warn("Cannot inject two models in one sitting. ".concat(model.get("_id")," attempts to overwrite ").concat(this._model.get("_id")));return}this._model=model;this.hasRequestChild=true}}]);return ChildEvent}(Backbone.Controller));var AdaptView=function(_Backbone$View){_inherits(AdaptView,_Backbone$View);var _super=_createSuper(AdaptView);function AdaptView(){_classCallCheck(this,AdaptView);return _super.apply(this,arguments)}_createClass(AdaptView,[{key:"attributes",value:function attributes(){return{"data-adapt-id":this.model.get("_id")}}},{key:"initialize",value:function initialize(){this.listenTo(this.model,{"change:_isVisible":this.toggleVisibility,"change:_isHidden":this.toggleHidden,"change:_isComplete":this.onIsCompleteChange});this.isReact=(this.constructor.template||"").includes(".jsx");if(this.isReact){this._classSet=new Set(_.result(this,"className").trim().split(/\s+/));this.listenTo(this.model,"all",this.changed);this.listenTo(Adapt,"device:changed",this.changed)}this.model.set({"_globals":Adapt.course.get("_globals"),"_isReady":false});this._isRemoved=false;if(Adapt.location._currentId===this.model.get("_id")){Adapt.parentView=this}this.preRender();this.render();this.setupOnScreenHandler()}},{key:"preRender",value:function preRender(){}},{key:"postRender",value:function(){var _postRender=_asyncToGenerator(regeneratorRuntime.mark(function _callee(){return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return this.addChildren();case 2:case"end":return _context.stop();}}},_callee,this)}));function postRender(){return _postRender.apply(this,arguments)}return postRender}()},{key:"render",value:function render(){var _this=this;var type=this.constructor.type;Adapt.trigger("".concat(type,"View:preRender view:preRender"),this);if(this.isReact){this.changed()}else{var data=this.model.toJSON();data.view=this;var template=Handlebars.templates[this.constructor.template];this.$el.html(template(data))}Adapt.trigger("".concat(type,"View:render view:render"),this);_.defer(_asyncToGenerator(regeneratorRuntime.mark(function _callee2(){return regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!_this._isRemoved){_context2.next=2;break}return _context2.abrupt("return");case 2:_context2.next=4;return _this.postRender();case 4:Adapt.trigger("".concat(type,"View:postRender view:postRender"),_this);case 5:case"end":return _context2.stop();}}},_callee2)})));return this}},{key:"changed",value:function changed(){var eventName=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;if(!this.isReact){throw new Error("Cannot call changed on a non-react view")}if(typeof eventName==="string"&&eventName.startsWith("bubble")){return}var element=render(this.constructor.template.replace(".jsx",""),this.model,this);this.updateViewProperties();ReactDOM.render(element,this.el)}},{key:"updateViewProperties",value:function updateViewProperties(){var _this2=this;var classesToAdd=_.result(this,"className").trim().split(/\s+/);classesToAdd.forEach(function(i){return _this2._classSet.add(i)});var classesToRemove=_toConsumableArray(this._classSet).filter(function(i){return!classesToAdd.includes(i)});classesToRemove.forEach(function(i){return _this2._classSet.delete(i)});this._setAttributes(_objectSpread2(_objectSpread2({},_.result(this,"attributes")),{},{id:_.result(this,"id")}));this.$el.removeClass(classesToRemove).addClass(classesToAdd)}},{key:"setupOnScreenHandler",value:function setupOnScreenHandler(){var _this3=this;var onscreen=this.model.get("_onScreen");if(!(onscreen===null||onscreen===void 0?void 0:onscreen._isEnabled))return;this.$el.addClass("has-animation ".concat(onscreen._classes,"-before"));this.$el.on("onscreen.adaptView",function(e,m){if(!m.onscreen)return;var minVerticalInview=onscreen._percentInviewVertical||33;if(m.percentInviewVertical<minVerticalInview)return;_this3.$el.addClass("".concat(onscreen._classes,"-after")).off("onscreen.adaptView")})}},{key:"addChildren",value:function(){var _addChildren=_asyncToGenerator(regeneratorRuntime.mark(function _callee3(){var addedCount,models,event,subsequentModels,model,ChildView,childView;return regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:this.nthChild=this.nthChild||0;_context3.next=3;return this.addDescendants(false);case 3:addedCount=_context3.sent;case 4:models=this.model.getAvailableChildModels();event=this._getAddChildEvent(models[this.nthChild]);if(event){_context3.next=9;break}return _context3.abrupt("break",26);case 9:if(event.isForced){event.reset()}if(!(event.isStoppedImmediate||!event.model)){_context3.next=14;break}subsequentModels=models.slice(this.nthChild);subsequentModels.forEach(function(model){return model.setOnChildren("_isRendered",false)});return _context3.abrupt("break",26);case 14:model=event.model;model.set({"_isRendered":true,"_nthChild":++this.nthChild});ChildView=this.constructor.childView||Adapt.getViewClass(model);if(ChildView){_context3.next=19;break}throw new Error("The component '".concat(model.attributes._id,"' ('").concat(model.attributes._component,"') has not been installed, and so is not available in your project."));case 19:childView=new ChildView({model:model});this.addChildView(childView);addedCount++;if(!event.isStoppedNext){_context3.next=24;break}return _context3.abrupt("break",26);case 24:_context3.next=4;break;case 26:if(addedCount){_context3.next=28;break}return _context3.abrupt("return",addedCount);case 28:this.model.set("_isReady",false);return _context3.abrupt("return",addedCount);case 30:case"end":return _context3.stop();}}},_callee3,this)}));function addChildren(){return _addChildren.apply(this,arguments)}return addChildren}()},{key:"addChildView",value:function addChildView(childView){var childViews=this.getChildViews()||[];childViews.push(childView);this.setChildViews(childViews);var $parentContainer=this.$(this.constructor.childContainer);switch(childView.model.get("_renderPosition")){case"outer-append":this.$el.append(childView.$el);break;case"inner-append":default:$parentContainer.append(childView.$el);break;}Adapt.trigger("view:childAdded",this,childView);return childView}},{key:"addDescendants",value:function(){var _addDescendants=_asyncToGenerator(regeneratorRuntime.mark(function _callee4(){var addedDescendantCount,childViews,i,l,view;return regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:addedDescendantCount=0;childViews=this.getChildViews();if(childViews){_context4.next=4;break}return _context4.abrupt("return",addedDescendantCount);case 4:i=0,l=childViews.length;case 5:if(!(i<l)){_context4.next=20;break}view=childViews[i];if(!view.addChildren){_context4.next=13;break}_context4.next=10;return view.addChildren();case 10:_context4.t0=_context4.sent;_context4.next=14;break;case 13:_context4.t0=0;case 14:addedDescendantCount=_context4.t0;if(!addedDescendantCount){_context4.next=17;break}return _context4.abrupt("break",20);case 17:i++;_context4.next=5;break;case 20:if(addedDescendantCount){_context4.next=23;break}this.model.checkReadyStatus();return _context4.abrupt("return",addedDescendantCount);case 23:this.model.set("_isReady",false);return _context4.abrupt("return",addedDescendantCount);case 25:case"end":return _context4.stop();}}},_callee4,this)}));function addDescendants(){return _addDescendants.apply(this,arguments)}return addDescendants}()},{key:"whenReady",value:function(){var _whenReady=_asyncToGenerator(regeneratorRuntime.mark(function _callee5(){var _this4=this;return regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:if(!this.model.get("_isReady")){_context5.next=2;break}return _context5.abrupt("return");case 2:return _context5.abrupt("return",new Promise(function(resolve){var onReadyChange=function(model,value){if(!value)return;_this4.stopListening(_this4.model,"change:_isReady",onReadyChange);resolve()};_this4.listenTo(_this4.model,"change:_isReady",onReadyChange);_this4.model.checkReadyStatus()}));case 3:case"end":return _context5.stop();}}},_callee5,this)}));function whenReady(){return _whenReady.apply(this,arguments)}return whenReady}()},{key:"_getAddChildEvent",value:function _getAddChildEvent(model){var isRequestChild=!model;var event=new ChildEvent(null,this,model);if(isRequestChild){var canRequestChild=this.model.get("_canRequestChild");if(!canRequestChild){return}event.type="requestChild";Adapt.trigger("view:requestChild",event);if(!event.hasRequestChild){event.close();return}}event.type="addChild";Adapt.trigger("view:addChild",event);event.close();return event}},{key:"findDescendantViews",value:function findDescendantViews(isParentFirst){var descendants=[];var childViews=this.getChildViews();childViews===null||childViews===void 0?void 0:childViews.forEach(function(view){var _view$findDescendantV;if(isParentFirst)descendants.push(view);var children=(_view$findDescendantV=view.findDescendantViews)===null||_view$findDescendantV===void 0?void 0:_view$findDescendantV.call(view,isParentFirst);if(children)descendants.push.apply(descendants,_toConsumableArray(children));if(!isParentFirst)descendants.push(view)});return descendants}},{key:"setReadyStatus",value:function setReadyStatus(){this.model.set("_isReady",true)}},{key:"setCompletionStatus",value:function setCompletionStatus(){if(!this.model.get("_isVisible"))return;this.model.set({_isComplete:true,_isInteractionComplete:true})}},{key:"resetCompletionStatus",value:function resetCompletionStatus(type){if(!this.model.get("_canReset"))return;var descendantComponents=this.model.findDescendantModels("component");if(descendantComponents.length===0){this.model.reset(type)}else{descendantComponents.forEach(function(model){return model.reset(type)})}}},{key:"preRemove",value:function preRemove(){var type=this.constructor.type;Adapt.trigger("".concat(type,"View:preRemove view:preRemove"),this)}},{key:"remove",value:function remove(){var _this5=this;var type=this.constructor.type;this.preRemove();Adapt.trigger("".concat(type,"View:remove view:remove"),this);this._isRemoved=true;this.stopListening();Adapt.wait.for(function(end){if(_this5.isReact){ReactDOM.unmountComponentAtNode(_this5.el)}_this5.$el.off("onscreen.adaptView");_get(_getPrototypeOf(AdaptView.prototype),"remove",_this5).call(_this5);_.defer(function(){Adapt.trigger("".concat(type,"View:postRemove view:postRemove"),_this5)});end()});return this}},{key:"setVisibility",value:function setVisibility(){return this.model.get("_isVisible")?"":"u-visibility-hidden"}},{key:"toggleVisibility",value:function toggleVisibility(){this.$el.toggleClass("u-visibility-hidden",!this.model.get("_isVisible"))}},{key:"setHidden",value:function setHidden(){return this.model.get("_isHidden")?"u-display-none":""}},{key:"toggleHidden",value:function toggleHidden(){this.$el.toggleClass("u-display-none",this.model.get("_isHidden"))}},{key:"onIsCompleteChange",value:function onIsCompleteChange(model,isComplete){this.$el.toggleClass("is-complete",isComplete)}},{key:"getChildViews",value:function getChildViews(){if(!this._childViews)return this._childViews;return Object.entries(this._childViews).map(function(_ref2){var _ref3=_slicedToArray(_ref2,2),key=_ref3[0],value=_ref3[1];return value})}},{key:"setChildViews",value:function setChildViews(value){this._childViews=value}},{key:"childViews",get:function(){Adapt.log.deprecated("view.childViews use view.getChildViews() and view.setChildViews([])");if(Array.isArray(this._childViews)){return _.indexBy(this._childViews,function(view){return view.model.get("_id")})}return this._childViews},set:function(value){Adapt.log.deprecated("view.childViews use view.getChildViews() and view.setChildViews([])");this.setChildViews(value)}}]);return AdaptView}(Backbone.View);AdaptView.className="";var AdaptView$1=__AMD("core/js/views/adaptView",AdaptView);var NotifyView=__AMD("core/js/views/notifyView",function(_Backbone$View){_inherits(NotifyView,_Backbone$View);var _super=_createSuper(NotifyView);function NotifyView(){_classCallCheck(this,NotifyView);return _super.apply(this,arguments)}_createClass(NotifyView,[{key:"className",value:function className(){return"notify ".concat(this.model.get("_classes")||"")}},{key:"attributes",value:function attributes(){return Object.assign({role:"dialog","aria-labelledby":"notify-heading","aria-modal":"true"},this.model.get("_attributes"))}},{key:"events",value:function events(){return{"click .js-notify-btn-alert":"onAlertButtonClicked","click .js-notify-btn-prompt":"onPromptButtonClicked","click .js-notify-close-btn":"onCloseButtonClicked","click .js-notify-shadow-click":"onShadowClicked"}}},{key:"initialize",value:function initialize(){_.bindAll(this,"resetNotifySize","onKeyUp");this.disableAnimation=Adapt.config.get("_disableAnimation")||false;this.isOpen=false;this.hasOpened=false;this.setupEventListeners();this.render()}},{key:"setupEventListeners",value:function setupEventListeners(){this.listenTo(Adapt,{"remove page:scrollTo":this.closeNotify,"notify:resize":this.resetNotifySize,"notify:cancel":this.cancelNotify,"notify:close":this.closeNotify,"device:resize":this.resetNotifySize});this.setupEscapeKey()}},{key:"setupEscapeKey",value:function setupEscapeKey(){$(window).on("keyup",this.onKeyUp)}},{key:"onKeyUp",value:function onKeyUp(event){if(event.which!==27)return;event.preventDefault();this.cancelNotify()}},{key:"render",value:function render(){var data=this.model.toJSON();var template=Handlebars.templates.notify;this.$el.css("visibility","hidden");this.$el.html(template(data)).appendTo("body");this.$(".notify__popup").css("visibility","hidden");this.$el.css("visibility","visible");this.showNotify();return this}},{key:"onAlertButtonClicked",value:function onAlertButtonClicked(event){event.preventDefault();this.closeNotify();Adapt.trigger(this.model.get("_callbackEvent"),this)}},{key:"onPromptButtonClicked",value:function onPromptButtonClicked(event){event.preventDefault();this.closeNotify();Adapt.trigger($(event.currentTarget).attr("data-event"),this)}},{key:"onCloseButtonClicked",value:function onCloseButtonClicked(event){event.preventDefault();this.cancelNotify()}},{key:"onShadowClicked",value:function onShadowClicked(event){event.preventDefault();if(this.model.get("_closeOnShadowClick")===false)return;this.cancelNotify()}},{key:"cancelNotify",value:function cancelNotify(){if(this.model.get("_isCancellable")===false)return;this.closeNotify();Adapt.trigger("notify:cancelled",this)}},{key:"resetNotifySize",value:function resetNotifySize(){if(!this.hasOpened)return;this.resizeNotify()}},{key:"resizeNotify",value:function resizeNotify(){var windowHeight=$(window).height();var notifyHeight=this.$(".notify__popup-inner").outerHeight();var isFullWindow=notifyHeight>=windowHeight;this.$(".notify__popup").css({"height":isFullWindow?"100%":"auto","top":isFullWindow?0:"","margin-top":isFullWindow?"":-(notifyHeight/2),"overflow-y":isFullWindow?"scroll":"","-webkit-overflow-scrolling":isFullWindow?"touch":""})}},{key:"showNotify",value:function(){var _showNotify=_asyncToGenerator(regeneratorRuntime.mark(function _callee(){return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:this.isOpen=true;_context.next=3;return this.addSubView();case 3:Adapt.notify.stack.push(this);this.$previousActiveElement=$(document.activeElement);Adapt.trigger("notify:opened",this);this.$el.imageready(this.onLoaded.bind(this));case 7:case"end":return _context.stop();}}},_callee,this)}));function showNotify(){return _showNotify.apply(this,arguments)}return showNotify}()},{key:"onLoaded",value:function onLoaded(){var _this=this;if(this.disableAnimation){this.$(".notify__shadow").css("display","block")}else{this.$(".notify__shadow").velocity({opacity:0},{duration:0}).velocity({opacity:1},{duration:400,begin:function(){_this.$(".notify__shadow").css("display","block")}})}this.resizeNotify();if(this.disableAnimation){this.$(".notify__popup").css("visibility","visible");this.onOpened()}else{this.$(".notify__popup").velocity({opacity:0},{duration:0}).velocity({opacity:1},{duration:400,begin:function(){_this.$(".notify__popup").css("visibility","visible");_this.onOpened()}})}}},{key:"onOpened",value:function onOpened(){$.inview();this.hasOpened=true;Adapt.a11y.popupOpened(this.$(".notify__popup"));Adapt.a11y.scrollDisable("body");$("html").addClass("notify");Adapt.a11y.focusFirst(this.$(".notify__popup"),{defer:false})}},{key:"addSubView",value:function(){var _addSubView=_asyncToGenerator(regeneratorRuntime.mark(function _callee2(){var _this2=this;var model,View;return regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:this.subView=this.model.get("_view");if(this.model.get("_id")){model=Adapt.findById(this.model.get("_id"));View=Adapt.getViewClass(model);this.subView=new View({model:model})}if(this.subView){_context2.next=4;break}return _context2.abrupt("return");case 4:this.subView.$el.on("resize",this.resetNotifySize);this.$(".notify__content-inner").prepend(this.subView.$el);if(!(!(this.subView instanceof AdaptView$1)||this.subView.model.get("_isReady"))){_context2.next=8;break}return _context2.abrupt("return");case 8:return _context2.abrupt("return",new Promise(function(resolve){var check=function(model,value){if(!value)return;_this2.subView.model.off("change:_isReady",check);resolve()};_this2.subView.model.on("change:_isReady",check)}));case 9:case"end":return _context2.stop();}}},_callee2,this)}));function addSubView(){return _addSubView.apply(this,arguments)}return addSubView}()},{key:"closeNotify",value:function closeNotify(){var _this3=this;var stackItem=Adapt.notify.stack[Adapt.notify.stack.length-1];if(this!==stackItem)return;Adapt.notify.stack.pop();if(!this.isOpen)return;this.isOpen=false;if(this.hasOpened){this.onCloseReady();return}this.listenToOnce(Adapt,"popup:opened",function(){_.defer(_this3.onCloseReady.bind(_this3))})}},{key:"onCloseReady",value:function onCloseReady(){var _this4=this;if(this.disableAnimation){this.$(".notify__popup").css("visibility","hidden");this.$el.css("visibility","hidden");this.remove()}else{this.$(".notify__popup").velocity({opacity:0},{duration:400,complete:function(){_this4.$(".notify__popup").css("visibility","hidden")}});this.$(".notify__shadow").velocity({opacity:0},{duration:400,complete:function(){_this4.$el.css("visibility","hidden");_this4.remove()}})}Adapt.a11y.scrollEnable("body");$("html").removeClass("notify");Adapt.a11y.popupClosed(this.$previousActiveElement);Adapt.trigger("notify:closed",this)}},{key:"remove",value:function remove(){var _get2;this.removeSubView();$(window).off("keyup",this.onKeyUp);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}(_get2=_get(_getPrototypeOf(NotifyView.prototype),"remove",this)).call.apply(_get2,[this].concat(args))}},{key:"removeSubView",value:function removeSubView(){if(!this.subView)return;this.subView.$el.off("resize",this.resetNotifySize);if(this.subView instanceof AdaptView$1){var views=[].concat(_toConsumableArray(this.subView.findDescendantViews()),[this.subView]);views.forEach(function(view){view.model.set("_isReady",false);view.remove()})}else{this.subView.remove()}this.subView=null}}]);return NotifyView}(Backbone.View));var Notify=function(_Backbone$Controller){_inherits(Notify,_Backbone$Controller);var _super=_createSuper(Notify);function Notify(){_classCallCheck(this,Notify);return _super.apply(this,arguments)}_createClass(Notify,[{key:"initialize",value:function initialize(){this._stack=[];this.notifyPushes=new NotifyPushCollection;this.listenTo(Adapt,{"notify:popup":this._deprecated.bind(this,"popup"),"notify:alert":this._deprecated.bind(this,"alert"),"notify:prompt":this._deprecated.bind(this,"prompt"),"notify:push":this._deprecated.bind(this,"push")})}},{key:"_deprecated",value:function _deprecated(type,notifyObject){Adapt.log.deprecated("NOTIFY DEPRECATED: Adapt.trigger('notify:".concat(type,"', notifyObject); is no longer supported, please use Adapt.notify.").concat(type,"(notifyObject);"));return this.create(notifyObject,{_type:type})}},{key:"create",value:function create(notifyObject,defaults){notifyObject=_.defaults({},notifyObject,defaults,{_type:"popup",_isCancellable:true,_showCloseButton:true,_closeOnShadowClick:true});if(notifyObject._type==="push"){this.notifyPushes.push(notifyObject);return}return new NotifyView({model:new NotifyModel(notifyObject)})}},{key:"popup",value:function popup(notifyObject){return this.create(notifyObject,{_type:"popup"})}},{key:"alert",value:function alert(notifyObject){return this.create(notifyObject,{_type:"alert"})}},{key:"prompt",value:function prompt(notifyObject){return this.create(notifyObject,{_type:"prompt"})}},{key:"push",value:function push(notifyObject){return this.create(notifyObject,{_type:"push"})}},{key:"stack",get:function(){return this._stack}}]);return Notify}(Backbone.Controller);__AMD("core/js/notify",Adapt.notify=new Notify);var RouterModel=__AMD("core/js/models/routerModel",function(_LockingModel){_inherits(RouterModel,_LockingModel);var _super=_createSuper(RouterModel);function RouterModel(){_classCallCheck(this,RouterModel);return _super.apply(this,arguments)}_createClass(RouterModel,[{key:"defaults",value:function defaults(){return{_canNavigate:true,_shouldNavigateFocus:true}}},{key:"lockedAttributes",value:function lockedAttributes(){return{_canNavigate:false,_shouldNavigateFocus:false}}}]);return RouterModel}(LockingModel));var Router=function(_Backbone$Router){_inherits(Router,_Backbone$Router);var _super=_createSuper(Router);function Router(){_classCallCheck(this,Router);return _super.apply(this,arguments)}_createClass(Router,[{key:"routes",value:function routes(){return{"":"handleRoute","id/:id":"handleRoute",":pluginName(/*location)(/*action)":"handleRoute"}}},{key:"initialize",value:function initialize(_ref){var model=_ref.model;this._isBackward=false;this.model=model;this._navigationRoot=null;this._isCircularNavigationInProgress=false;this.showLoading();this.$wrapper=$("#wrapper");this.$html=$("html");this.listenToOnce(Adapt,"app:dataReady",this.setDocumentTitle);this.listenTo(Adapt,"router:navigateTo",this.navigateToArguments)}},{key:"showLoading",value:function showLoading(){$(".js-loading").show()}},{key:"hideLoading",value:function hideLoading(){$(".js-loading").hide()}},{key:"setDocumentTitle",value:function setDocumentTitle(){var currentModel=Adapt.location._currentModel;var hasSubTitle=currentModel&&currentModel!==Adapt.router.rootModel&&currentModel.get("title");var title=[this.rootModel.get("title"),hasSubTitle&&currentModel.get("title")].filter(Boolean).join(" | ");this.listenToOnce(Adapt,"contentObjectView:preRender",function(){var escapedTitle=$("<div>".concat(title,"</div>")).text();document.title=escapedTitle})}},{key:"navigateToArguments",value:function navigateToArguments(args){args=args.filter(function(v){return v!==null});var options={trigger:false,replace:false};if(args.length===1&&Adapt.findById(args[0])){this.navigate("#/id/"+args[0],options);return}if(args.length<=3){this.navigate("#/"+args.join("/"),options);return}Adapt.log.deprecated("Use Backbone.history.navigate or window.location.href instead of Adapt.trigger('router:navigateTo')");this.handleRoute.apply(this,_toConsumableArray(args))}},{key:"handleRoute",value:function handleRoute(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}args=args.filter(function(v){return v!==null});if(this.model.get("_canNavigate")){this._isCircularNavigationInProgress=false}if(this._isCircularNavigationInProgress===false){Adapt.trigger("router:navigate",args)}if(this.model.get("_canNavigate")){this.model.set("_canNavigate",false,{pluginName:"adapt"});this._isBackward=false;if(args.length<=1){return this.handleId.apply(this,_toConsumableArray(args))}return this.handlePluginRouter.apply(this,_toConsumableArray(args))}if(this._isCircularNavigationInProgress){this._isCircularNavigationInProgress=false;return}this._isCircularNavigationInProgress=true;Adapt.trigger("router:navigationCancelled",args);Backbone.history.history[this._isBackward?"forward":"back"]();this._isBackward=false}},{key:"handlePluginRouter",value:function(){var _handlePluginRouter=_asyncToGenerator(regeneratorRuntime.mark(function _callee(pluginName,location,action){var pluginLocation;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:pluginLocation=[pluginName,location&&"-".concat(location),action&&"-".concat(action)].filter(Boolean).join("");_context.next=3;return this.updateLocation(pluginLocation,null,null,null);case 3:Adapt.trigger("router:plugin:"+pluginName,pluginName,location,action);Adapt.trigger("router:plugin",pluginName,location,action);this.model.set("_canNavigate",true,{pluginName:"adapt"});case 6:case"end":return _context.stop();}}},_callee,this)}));function handlePluginRouter(_x,_x2,_x3){return _handlePluginRouter.apply(this,arguments)}return handlePluginRouter}()},{key:"handleId",value:function(){var _handleId=_asyncToGenerator(regeneratorRuntime.mark(function _callee2(id){var _this=this;var rootModel,model,isContentObject,navigateToId,isRoot,startController,isCourse,type,location,ViewClass,isMenu;return regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:rootModel=Adapt.router.rootModel;model=!id?rootModel:Adapt.findById(id);if(model){_context2.next=5;break}this.model.set("_canNavigate",true,{pluginName:"adapt"});return _context2.abrupt("return");case 5:isContentObject=model instanceof ContentObjectModel;navigateToId=model.get("_id");model=isContentObject?model:model.findAncestor("contentobject");id=model.get("_id");isRoot=model===rootModel;if(!(isRoot&&Adapt.course.has("_start"))){_context2.next=14;break}startController=Adapt.course.get("_start");if(!(startController._isEnabled===true&&startController._isMenuDisabled===true)){_context2.next=14;break}return _context2.abrupt("return");case 14:if(!(model.get("_isLocked")&&Adapt.config.get("_forceRouteLocking"))){_context2.next=20;break}Adapt.log.warn("Unable to navigate to locked id: "+id);this.model.set("_canNavigate",true,{pluginName:"adapt"});if(!(Adapt.location._previousId===undefined)){_context2.next=19;break}return _context2.abrupt("return",this.navigate("#/",{trigger:true,replace:true}));case 19:return _context2.abrupt("return",this.navigateBack());case 20:this.showLoading();_context2.next=23;return Adapt.remove();case 23:isCourse=model instanceof CourseModel$1;type=isCourse?"menu":model.get("_type");location=isCourse?"course":"".concat(type,"-").concat(id);model.set("_isVisited",true);_context2.next=29;return this.updateLocation(location,type,id,model);case 29:Adapt.once("contentObjectView:ready",function(){_this.model.set("_canNavigate",true,{pluginName:"adapt"});_this.handleNavigationFocus()});Adapt.trigger("router:".concat(type," router:contentObject"),model);ViewClass=Adapt.getViewClass(model);isMenu=model instanceof MenuModel$1;if(!(!ViewClass&&isMenu)){_context2.next=36;break}Adapt.log.deprecated("Using event based menu view instantiation for '".concat(Adapt.getViewName(model),"'"));return _context2.abrupt("return");case 36:if(isMenu){_context2.next=40;break}_.invoke(model.getAllDescendantModels(),"checkIfResetOnRevisit");_context2.next=40;return Adapt.deferUntilCompletionChecked();case 40:this.$wrapper.append(new ViewClass({model:model}).$el);if(!(!isContentObject&&!this.isScrolling)){_context2.next=44;break}_context2.next=44;return Adapt.navigateToElement("."+navigateToId,{replace:true,duration:400});case 44:case"end":return _context2.stop();}}},_callee2,this)}));function handleId(_x4){return _handleId.apply(this,arguments)}return handleId}()},{key:"updateLocation",value:function(){var _updateLocation=_asyncToGenerator(regeneratorRuntime.mark(function _callee3(currentLocation,type,id,currentModel){return regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:Adapt.location._previousModel=Adapt.location._currentModel;Adapt.location._previousId=Adapt.location._currentId;Adapt.location._previousContentType=Adapt.location._contentType;Adapt.location._currentModel=currentModel;Adapt.location._currentId=id;Adapt.location._contentType=type;Adapt.location._currentLocation=currentLocation;if(type==="menu"){Adapt.location._lastVisitedType="menu";Adapt.location._lastVisitedMenu=id}else if(type==="page"){Adapt.location._lastVisitedType="page";Adapt.location._lastVisitedPage=id}this.setDocumentTitle();this.setGlobalClasses();Adapt.trigger("router:location",Adapt.location);_context3.next=13;return Adapt.wait.queue();case 13:case"end":return _context3.stop();}}},_callee3,this)}));function updateLocation(_x5,_x6,_x7,_x8){return _updateLocation.apply(this,arguments)}return updateLocation}()},{key:"setGlobalClasses",value:function setGlobalClasses(){var currentModel=Adapt.location._currentModel;var htmlClasses=(currentModel===null||currentModel===void 0?void 0:currentModel.get("_htmlClasses"))||"";var classes=Adapt.location._currentId?"location-".concat(Adapt.location._contentType," location-id-").concat(Adapt.location._currentId):"location-".concat(Adapt.location._currentLocation);var currentClasses="".concat(classes," ").concat(htmlClasses);this.$html.removeClass(Adapt.location._previousClasses).addClass(currentClasses).attr("data-location",Adapt.location._currentLocation);this.$wrapper.removeClass().addClass(classes).attr("data-location",Adapt.location._currentLocation);Adapt.location._previousClasses=currentClasses}},{key:"handleNavigationFocus",value:function handleNavigationFocus(){if(!this.model.get("_shouldNavigateFocus"))return;Adapt.a11y.focus("body")}},{key:"navigateBack",value:function navigateBack(){this._isBackward=true;Backbone.history.history.back()}},{key:"navigateToCurrentRoute",value:function navigateToCurrentRoute(force){if(!this.model.get("_canNavigate")&&!force){return}if(!Adapt.location._currentId){return}var currentId=Adapt.location._currentModel.get("_id");var isRoot=Adapt.location._currentModel===this.rootModel;var route=isRoot?"#/":"#/id/"+currentId;this.navigate(route,{trigger:true,replace:true})}},{key:"navigateToPreviousRoute",value:function navigateToPreviousRoute(force){if(!this.model.get("_canNavigate")&&!force){return}var currentModel=Adapt.location._currentModel;var previousModel=Adapt.location._previousModel;if(!currentModel){return this.navigateBack()}if(Adapt.location._currentModel instanceof MenuModel$1){return this.navigateToParent()}if(previousModel){return this.navigateBack()}this.navigateToParent()}},{key:"navigateToParent",value:function navigateToParent(force){if(!this.model.get("_canNavigate")&&!force){return}var parentId=Adapt.location._currentModel.get("_parentId");var parentModel=Adapt.findById(parentId);var isRoot=parentModel===this.rootModel;var route=isRoot?"#/":"#/id/"+parentId;this.navigate(route,{trigger:true})}},{key:"navigateToHomeRoute",value:function navigateToHomeRoute(force){if(!this.model.get("_canNavigate")&&!force){return}this.navigate("#/",{trigger:true})}},{key:"navigateToElement",value:function(){var _navigateToElement=_asyncToGenerator(regeneratorRuntime.mark(function _callee4(selector){var _this2=this;var settings,currentModelId,currentModel,shouldReplace,contentObject,contentObjectId,isInCurrentContentObject,location,disableScrollToAnimation,offsetTop,_args4=arguments;return regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:settings=_args4.length>1&&_args4[1]!==undefined?_args4[1]:{};currentModelId=selector.replace(/\./g,"").split(" ")[0];currentModel=Adapt.findById(currentModelId);if(!(currentModel&&(!currentModel.get("_isRendered")||!currentModel.get("_isReady")))){_context4.next=17;break}shouldReplace=settings.replace||false;contentObject=currentModel instanceof ContentObjectModel?currentModel:currentModel.findAncestor("contentobject");contentObjectId=contentObject.get("_id");isInCurrentContentObject=contentObjectId!==Adapt.location._currentId;if(!isInCurrentContentObject){_context4.next=15;break}this.isScrolling=true;this.navigate("#/id/".concat(currentModelId),{trigger:true,replace:shouldReplace});this.model.set("_shouldNavigateFocus",false,{pluginName:"adapt"});_context4.next=14;return new Promise(function(resolve){return Adapt.once("contentObjectView:ready",_.debounce(function(){_this2.model.set("_shouldNavigateFocus",true,{pluginName:"adapt"});resolve()},1))});case 14:this.isScrolling=false;case 15:_context4.next=17;return Adapt.parentView.renderTo(currentModelId);case 17:if(currentModel&&selector===currentModel.get("_id")){selector=".".concat(selector)}location=Adapt.location._contentType?Adapt.location._contentType:Adapt.location._currentLocation;Adapt.trigger("".concat(location,":scrollTo"),selector);disableScrollToAnimation=Adapt.config.has("_disableAnimation")?Adapt.config.get("_disableAnimation"):false;if(disableScrollToAnimation){settings.duration=0}else if(!settings.duration){settings.duration=$.scrollTo.defaults.duration}offsetTop=0;if(Adapt.scrolling.isLegacyScrolling){offsetTop=-$(".nav").outerHeight();if($(selector).hasClass("component")){offsetTop-=$(selector).find(".aria-label").height()||0}}if(!settings.offset)settings.offset={top:offsetTop,left:0};if(settings.offset.top===undefined)settings.offset.top=offsetTop;if(settings.offset.left===undefined)settings.offset.left=0;if(settings.offset.left===0)settings.axis="y";if(Adapt.get("_canScroll")!==false){$.scrollTo(selector,settings)}_context4.next=31;return new Promise(function(resolve){_.delay(function(){Adapt.a11y.focusNext(selector);Adapt.trigger("".concat(location,":scrolledTo"),selector);resolve()},settings.duration+300)});case 31:case"end":return _context4.stop();}}},_callee4,this)}));function navigateToElement(_x9){return _navigateToElement.apply(this,arguments)}return navigateToElement}()},{key:"get",value:function get(){var _this$model;Adapt.log.deprecated("Adapt.router.get, please use Adapt.router.model.get");return(_this$model=this.model).get.apply(_this$model,arguments)}},{key:"set",value:function set(){var _this$model2;Adapt.log.deprecated("Adapt.router.set, please use Adapt.router.model.set");return(_this$model2=this.model).set.apply(_this$model2,arguments)}},{key:"rootModel",get:function(){return this._navigationRoot||Adapt.course},set:function(model){this._navigationRoot=model}}]);return Router}(Backbone.Router);Adapt.router=new Router({model:new RouterModel(null,{reset:true})});Adapt.navigateToElement=Adapt.router.navigateToElement.bind(Adapt.router);__AMD("core/js/router",Adapt.router);var AdaptSubsetCollection=__AMD("core/js/collections/adaptSubsetCollection",function(_AdaptCollection){_inherits(AdaptSubsetCollection,_AdaptCollection);var _super=_createSuper(AdaptSubsetCollection);function AdaptSubsetCollection(){_classCallCheck(this,AdaptSubsetCollection);return _super.apply(this,arguments)}_createClass(AdaptSubsetCollection,[{key:"initialize",value:function initialize(models,options){_get(_getPrototypeOf(AdaptSubsetCollection.prototype),"initialize",this).call(this,models,options);this.parent=options.parent;this.listenTo(this.parent,"reset",this.loadSubset)}},{key:"loadSubset",value:function loadSubset(){var _this=this;this.set(this.parent.filter(function(model){return model instanceof _this.model}));this._byAdaptID=this.groupBy("_id")}}]);return AdaptSubsetCollection}(AdaptCollection));var ArticleModel=function(_AdaptModel){_inherits(ArticleModel,_AdaptModel);var _super=_createSuper(ArticleModel);function ArticleModel(){_classCallCheck(this,ArticleModel);return _super.apply(this,arguments)}_createClass(ArticleModel,[{key:"getTypeGroup",value:function getTypeGroup(){return"article"}},{key:"_parent",get:function(){Adapt.log.deprecated("articleModel._parent, use articleModel.getParent() instead, parent models are defined by the JSON");return"contentObjects"}},{key:"_siblings",get:function(){Adapt.log.deprecated("articleModel._siblings, use articleModel.getSiblings() instead, sibling models are defined by the JSON");return"articles"}},{key:"_children",get:function(){Adapt.log.deprecated("articleModel._children, use articleModel.hasManagedChildren instead, child models are defined by the JSON");return"blocks"}}]);return ArticleModel}(AdaptModel);Adapt.register("article",{model:ArticleModel});var ArticleModel$1=__AMD("core/js/models/articleModel",ArticleModel);var BlockModel=function(_AdaptModel){_inherits(BlockModel,_AdaptModel);var _super=_createSuper(BlockModel);function BlockModel(){_classCallCheck(this,BlockModel);return _super.apply(this,arguments)}_createClass(BlockModel,[{key:"getTypeGroup",value:function getTypeGroup(){return"block"}},{key:"_parent",get:function(){Adapt.log.deprecated("blockModel._parent, use blockModel.getParent() instead, parent models are defined by the JSON");return"articles"}},{key:"_siblings",get:function(){Adapt.log.deprecated("blockModel._siblings, use blockModel.getSiblings() instead, sibling models are defined by the JSON");return"blocks"}},{key:"_children",get:function(){Adapt.log.deprecated("blockModel._children, use blockModel.hasManagedChildren instead, child models are defined by the JSON");return"components"}}]);return BlockModel}(AdaptModel);Adapt.register("block",{model:BlockModel});var BlockModel$1=__AMD("core/js/models/blockModel",BlockModel);var ComponentModel=function(_AdaptModel){_inherits(ComponentModel,_AdaptModel);var _super=_createSuper(ComponentModel);function ComponentModel(){_classCallCheck(this,ComponentModel);return _super.apply(this,arguments)}_createClass(ComponentModel,[{key:"getTypeGroup",value:function getTypeGroup(){return"component"}},{key:"defaults",value:function defaults(){return AdaptModel.resultExtend("defaults",{_isA11yComponentDescriptionEnabled:true,_userAnswer:null,_attemptStates:null})}},{key:"trackable",value:function trackable(){return AdaptModel.resultExtend("trackable",["_userAnswer","_attemptStates"])}},{key:"trackableType",value:function trackableType(){return AdaptModel.resultExtend("trackableType",[Array,Array])}},{key:"init",value:function init(){if(Adapt.get("_isStarted")){this.onAdaptInitialize();return}this.listenToOnce(Adapt,"adapt:initialize",this.onAdaptInitialize)}},{key:"onAdaptInitialize",value:function onAdaptInitialize(){this.restoreUserAnswers()}},{key:"restoreUserAnswers",value:function restoreUserAnswers(){}},{key:"storeUserAnswer",value:function storeUserAnswer(){}},{key:"resetUserAnswer",value:function resetUserAnswer(){this.set("_userAnswer",null)}},{key:"reset",value:function reset(type,force){if(!this.get("_canReset")&&!force)return;this.resetUserAnswer();_get(_getPrototypeOf(ComponentModel.prototype),"reset",this).call(this,type,force)}},{key:"getAttemptState",value:function getAttemptState(){var object=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.toJSON();var trackables=this.trackable();var types=this.trackableType();trackables.find(function(name,index){if(name!=="_attemptStates")return;trackables.splice(index,1);types.splice(index,1);return true});var values=trackables.map(function(n){return object[n]});var booleans=values.filter(function(v,i){return types[i]===Boolean}).map(Boolean);var numbers=values.filter(function(v,i){return types[i]===Number}).map(function(v){return Number(v)||0});var arrays=values.filter(function(v,i){return types[i]===Array});return[numbers,booleans,arrays]}},{key:"getAttemptObject",value:function getAttemptObject(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.getAttemptState();var trackables=this.trackable();var types=this.trackableType();trackables.find(function(name,index){if(name!=="_attemptStates")return;trackables.splice(index,1);types.splice(index,1);return true});var numbers=(state[0]||[]).slice(0);var booleans=(state[1]||[]).slice(0);var arrays=(state[2]||[]).slice(0);var object={};trackables.forEach(function(n,i){if(n==="_id")return;switch(types[i]){case Number:object[n]=numbers.shift();break;case Boolean:object[n]=booleans.shift();break;case Array:object[n]=arrays.shift();break;}});return object}},{key:"setAttemptObject",value:function setAttemptObject(object){var silent=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;this.set(object,{silent:silent})}},{key:"addAttemptObject",value:function addAttemptObject(){var object=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.getAttemptObject();var attemptStates=this.get("_attemptStates")||[];var state=this.getAttemptState(object);attemptStates.push(state);this.set("_attemptStates",attemptStates)}},{key:"getAttemptObjects",value:function getAttemptObjects(){var _this=this;var states=this.get("_attemptStates")||[];return states.map(function(state){return _this.getAttemptObject(state)})}},{key:"_parent",get:function(){Adapt.log.deprecated("componentModel._parent, use componentModel.getParent() instead, parent models are defined by the JSON");return"blocks"}},{key:"_siblings",get:function(){Adapt.log.deprecated("componentModel._siblings, use componentModel.getSiblings() instead, sibling models are defined by the JSON");return"components"}},{key:"hasManagedChildren",get:function(){return false}}]);return ComponentModel}(AdaptModel);Adapt.register("component",{model:ComponentModel});var ComponentModel$1=__AMD("core/js/models/componentModel",ComponentModel);var PageModel=function(_ContentObjectModel){_inherits(PageModel,_ContentObjectModel);var _super=_createSuper(PageModel);function PageModel(){_classCallCheck(this,PageModel);return _super.apply(this,arguments)}_createClass(PageModel,[{key:"getTypeGroup",value:function getTypeGroup(){return"page"}},{key:"_children",get:function(){Adapt.log.deprecated("pageModel._children, use menuModel.hasManagedChildren instead, child models are defined by the JSON");return"articles"}}]);return PageModel}(ContentObjectModel);Adapt.register("page",{model:PageModel});__AMD("core/js/models/pageModel",PageModel);var ContentObjectView=__AMD("core/js/views/contentObjectView",function(_AdaptView){_inherits(ContentObjectView,_AdaptView);var _super=_createSuper(ContentObjectView);function ContentObjectView(){_classCallCheck(this,ContentObjectView);return _super.apply(this,arguments)}_createClass(ContentObjectView,[{key:"attributes",value:function attributes(){return AdaptView$1.resultExtend("attributes",{"role":"main","aria-labelledby":"".concat(this.model.get("_id"),"-heading")},this)}},{key:"className",value:function className(){return[this.constructor.type,"contentobject",this.constructor.className,this.model.get("_id"),this.model.get("_classes"),this.setVisibility(),this.model.get("_isComplete")?"is-complete":"",this.model.get("_isOptional")?"is-optional":""].filter(Boolean).join(" ")}},{key:"preRender",value:function preRender(){$.inview.lock(this.constructor.type+"View");this.disableAnimation=Adapt.config.has("_disableAnimation")?Adapt.config.get("_disableAnimation"):false;this.$el.css("opacity",0);this.listenTo(this.model,"change:_isReady",this.isReady)}},{key:"render",value:function render(){var _this=this;var type=this.constructor.type;Adapt.trigger("".concat(type,"View:preRender contentObjectView:preRender view:preRender"),this);if(this.isReact){this.changed()}else{var data=this.model.toJSON();data.view=this;var template=Handlebars.templates[this.constructor.template];this.$el.html(template(data))}Adapt.trigger("".concat(type,"View:render contentObjectView:render view:render"),this);_.defer(function(){if(_this._isRemoved)return;_this.postRender();Adapt.trigger("".concat(type,"View:postRender contentObjectView:postRender view:postRender"),_this)});return this}},{key:"isReady",value:function(){var _isReady=_asyncToGenerator(regeneratorRuntime.mark(function _callee2(){var _this2=this;var type,performIsReady;return regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(!this.model.get("_isReady")||this._isTriggeredReady)){_context2.next=2;break}return _context2.abrupt("return");case 2:this._isTriggeredReady=true;type=this.constructor.type;performIsReady=function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark(function _callee(){var styleOptions;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:Adapt.trigger("".concat(type,"View:preReady contentObjectView:preReady view:preReady"),_this2);_context.next=3;return Adapt.wait.queue();case 3:$(".js-loading").hide();if(Adapt.get("_shouldContentObjectScrollTop")!==false){$(window).scrollTop(0)}Adapt.trigger("".concat(type,"View:ready contentObjectView:ready view:ready"),_this2);$.inview.unlock("".concat(type,"View"));styleOptions={opacity:1};if(_this2.disableAnimation){_this2.$el.css(styleOptions);$.inview();_.defer(function(){Adapt.trigger("".concat(type,"View:postReady contentObjectView:postReady view:postReady"),_this2)})}else{_this2.$el.velocity(styleOptions,{duration:"fast",complete:function(){$.inview();Adapt.trigger("".concat(type,"View:postReady contentObjectView:postReady view:postReady"),_this2)}})}$(window).scroll();case 10:case"end":return _context.stop();}}},_callee)}));return function performIsReady(){return _ref.apply(this,arguments)}}();_.defer(performIsReady);case 6:case"end":return _context2.stop();}}},_callee2,this)}));function isReady(){return _isReady.apply(this,arguments)}return isReady}()},{key:"renderTo",value:function(){var _renderTo=_asyncToGenerator(regeneratorRuntime.mark(function _callee3(id){var isRenderToSelf,models,index,model,ids,forceUntilId;return regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:isRenderToSelf=id===this.model.get("_id");if(!isRenderToSelf){_context3.next=3;break}return _context3.abrupt("return");case 3:models=this.model.getAllDescendantModels(true).filter(function(model){return model.get("_isAvailable")});index=models.findIndex(function(model){return model.get("_id")===id});if(!(index===-1)){_context3.next=7;break}throw new Error("Cannot renderTo \"".concat(id,"\" as it isn't a descendant."));case 7:model=models[index];if(!(model.get("_isRendered")&&model.get("_isReady"))){_context3.next=10;break}return _context3.abrupt("return");case 10:models=models.slice(0,index+1);ids=_.indexBy(models,function(model){return model.get("_id")});forceUntilId=function(event){var addingId=event.model.get("_id");if(!ids[addingId])return;event.force();if(addingId!==id)return;Adapt.off("view:addChild",forceUntilId)};Adapt.on("view:addChild",forceUntilId);_context3.next=16;return this.addChildren();case 16:_context3.next=18;return this.whenReady();case 18:if(!(!model.get("_isRendered")||!model.get("_isReady"))){_context3.next=20;break}throw new Error("Cannot renderTo \"".concat(id,"\"."));case 20:case"end":return _context3.stop();}}},_callee3,this)}));function renderTo(_x){return _renderTo.apply(this,arguments)}return renderTo}()},{key:"preRemove",value:function preRemove(){var type=this.constructor.type;Adapt.trigger("".concat(type,"View:preRemove contentObjectView:preRemove view:preRemove"),this)}},{key:"remove",value:function remove(){var _this3=this;var type=this.constructor.type;this.preRemove();Adapt.trigger("".concat(type,"View:remove contentObjectView:remove view:remove"),this);this._isRemoved=true;Adapt.wait.for(function(end){if(_this3.isReact){ReactDOM.unmountComponentAtNode(_this3.el)}_this3.$el.off("onscreen.adaptView");_this3.findDescendantViews().reverse().forEach(function(view){view.remove()});_this3.setChildViews(null);_get(_getPrototypeOf(ContentObjectView.prototype),"remove",_this3).call(_this3);_.defer(function(){Adapt.trigger("".concat(type,"View:postRemove contentObjectView:postRemove view:postRemove"),_this3);_this3.trigger("postRemove")});end()});return this}},{key:"destroy",value:function destroy(){this.remove();if(Adapt.parentView===this){Adapt.parentView=null}}}]);return ContentObjectView}(AdaptView$1));var PageView=function(_ContentObjectView){_inherits(PageView,_ContentObjectView);var _super=_createSuper(PageView);function PageView(){_classCallCheck(this,PageView);return _super.apply(this,arguments)}_createClass(PageView,[{key:"remove",value:function remove(){if(this.$pageLabel){this.$pageLabel.remove()}_get(_getPrototypeOf(PageView.prototype),"remove",this).call(this)}}]);return PageView}(ContentObjectView);Object.assign(PageView,{childContainer:".article__container",type:"page",template:"page"});Adapt.register("page",{view:PageView});__AMD("core/js/views/pageView",PageView);var ArticleView=function(_AdaptView){_inherits(ArticleView,_AdaptView);var _super=_createSuper(ArticleView);function ArticleView(){_classCallCheck(this,ArticleView);return _super.apply(this,arguments)}_createClass(ArticleView,[{key:"className",value:function className(){return["article",this.model.get("_id"),this.model.get("_classes"),this.setVisibility(),this.setHidden(),this.model.get("_isComplete")?"is-complete":"",this.model.get("_isOptional")?"is-optional":""].join(" ")}}]);return ArticleView}(AdaptView$1);Object.assign(ArticleView,{childContainer:".block__container",type:"article",template:"article"});Adapt.register("article",{view:ArticleView});var ArticleView$1=__AMD("core/js/views/articleView",ArticleView);var BlockView=function(_AdaptView){_inherits(BlockView,_AdaptView);var _super=_createSuper(BlockView);function BlockView(){_classCallCheck(this,BlockView);return _super.apply(this,arguments)}_createClass(BlockView,[{key:"className",value:function className(){return["block",this.model.get("_id"),this.model.get("_classes"),this.setVisibility(),this.setHidden(),this.model.get("_isComplete")?"is-complete":"",this.model.get("_isOptional")?"is-optional":""].join(" ")}}]);return BlockView}(AdaptView$1);Object.assign(BlockView,{childContainer:".component__container",type:"block",template:"block"});Adapt.register("block",{view:BlockView});__AMD("core/js/views/blockView",BlockView);var MPABC=function(_Backbone$Controller){_inherits(MPABC,_Backbone$Controller);var _super=_createSuper(MPABC);function MPABC(){_classCallCheck(this,MPABC);return _super.apply(this,arguments)}_createClass(MPABC,[{key:"initialize",value:function initialize(){this.listenTo(Data$1,{loading:this.waitForDataLoaded,loaded:this.onDataLoaded});this.setupSubsetCollections()}},{key:"waitForDataLoaded",value:function waitForDataLoaded(){Adapt.wait.begin()}},{key:"onDataLoaded",value:function onDataLoaded(){Adapt.wait.end()}},{key:"setupSubsetCollections",value:function setupSubsetCollections(){Adapt.contentObjects=new AdaptSubsetCollection(null,{parent:Data$1,model:ContentObjectModel});Adapt.articles=new AdaptSubsetCollection(null,{parent:Data$1,model:ArticleModel$1});Adapt.blocks=new AdaptSubsetCollection(null,{parent:Data$1,model:BlockModel$1});Adapt.components=new AdaptSubsetCollection(null,{parent:Data$1,model:ComponentModel$1})}}]);return MPABC}(Backbone.Controller);__AMD("core/js/mpabc",Adapt.mpabc=new MPABC);var defaultAriaLevels={"_menu":1,"_menuGroup":2,"_menuItem":2,"_page":1,"_article":2,"_block":3,"_component":4,"_componentItem":5,"_notify":1};var helpers={lowercase:function(text){return text.toLowerCase()},capitalise:function(text){return text.charAt(0).toUpperCase()+text.slice(1)},inc:function(index){return index+1},dec:function(index){return index-1},odd:function(index){return(index+1)%2===0?"even":"odd"},equals:function(value,text,block){return helpers.compare.call(this,value,"==",text,block)},compare:function(value,operator,text,block){switch(operator){case"===":if(value===text)return block.fn(this);break;case"=":case"==":if(value==text)return block.fn(this);break;case">=":if(value>=text)return block.fn(this);break;case"<=":if(value<=text)return block.fn(this);break;case">":if(value>text)return block.fn(this);break;case"<":if(value<text)return block.fn(this);break;}return block.inverse(this)},math:function(lvalue,operator,rvalue,options){lvalue=parseFloat(lvalue);rvalue=parseFloat(rvalue);switch(operator){case"+":return lvalue+rvalue;case"-":return lvalue-rvalue;case"*":return lvalue*rvalue;case"/":return lvalue/rvalue;case"%":return lvalue%rvalue;}},any:function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}var specified=args.slice(0,-1);var block=args.slice(-1)[0];return specified.some(Boolean)?block.fn?block.fn(this):true:block.inverse?block.inverse(this):false},all:function(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++){args[_key2]=arguments[_key2]}var specified=args.slice(0,-1);var block=args.slice(-1)[0];return specified.every(Boolean)?block.fn?block.fn(this):true:block.inverse?block.inverse(this):false},none:function(){for(var _len3=arguments.length,args=new Array(_len3),_key3=0;_key3<_len3;_key3++){args[_key3]=arguments[_key3]}var specified=args.slice(0,-1);var block=args.slice(-1)[0];return!specified.some(Boolean)?block.fn?block.fn(this):true:block.inverse?block.inverse(this):false},compile:function(template,context){if(!template){return""}if(template instanceof Object)template=template.toString();var data=this;if(context){var _context$data$root,_context$data;data=(_context$data$root=(_context$data=context.data)===null||_context$data===void 0?void 0:_context$data.root)!==null&&_context$data$root!==void 0?_context$data$root:context}return Handlebars.compile(template)(data)},compile_a11y_text:function(template,context){Adapt.a11y.log.deprecated("a11y_text is no longer required. https://tink.uk/understanding-screen-reader-interaction-modes/");return helpers.compile.call(this,template,context)},compile_a11y_normalize:function(template,context){if(!template){return""}if(template instanceof Object)template=template.toString();return Handlebars.helpers.a11y_normalize.call(this,helpers.compile.call(this,template,context))},compile_a11y_remove_breaks:function(template,context){if(!template){return""}return Handlebars.helpers.a11y_remove_breaks.call(this,helpers.compile.call(this,template,context))},import_globals:function(context){if(context.data.root._globals){return""}context.data.root._globals=Adapt.course.get("_globals");return""},import_adapt:function(context){if(context.data.root.Adapt){return}var adapt=context.data.root.Adapt={};var i,l,name;var directImport=["config","course"];for(i=0,l=directImport.length;i<l;i++){name=directImport[i];adapt[name]=Adapt[name].toJSON()}var indexedImport=["contentObjects","articles","blocks","components"];for(i=0,l=indexedImport.length;i<l;i++){name=indexedImport[i];var importArray=Adapt[name].toJSON();var importIndex={};for(var i1=0,l1=importArray.length;i1<l1;i1++){var item=importArray[i1];importIndex[item._id]=item}adapt[name]=importIndex}return""},component_description:function(override,context){var _this$_globals$_compo;if(!this._isA11yComponentDescriptionEnabled){return}var isNotDefined=!((_this$_globals$_compo=this._globals._components)===null||_this$_globals$_compo===void 0?void 0:_this$_globals$_compo["_"+this._component]);if(isNotDefined){return}var hasOverride=arguments.length>1;var description;if(hasOverride){description=override;description=helpers.compile(description,context)}else{description=this._globals._components["_"+this._component].ariaRegion;description=helpers.compile(description,override)}if(!description){return}return new Handlebars.SafeString("<div class=\"aria-label\">"+description+"</div>")},a11y_text:function(text){Adapt.a11y.log.deprecated("a11y_text is no longer required. https://tink.uk/understanding-screen-reader-interaction-modes/");return text},a11y_normalize:function(htmls){return Adapt.a11y.normalize.apply(Adapt.a11y,arguments)},a11y_remove_breaks:function(htmls){return Adapt.a11y.removeBreaks.apply(Adapt.a11y,arguments)},a11y_aria_label:function(htmls){var values=Array.prototype.slice.call(arguments,0,-1);values=values.filter(Boolean);return new Handlebars.SafeString("<div class=\"aria-label\">"+values.join(" ")+"</div>")},a11y_aria_label_relative:function(htmls){var values=Array.prototype.slice.call(arguments,0,-1);values=values.filter(Boolean);return new Handlebars.SafeString("<div class=\"aria-label relative\">"+values.join(" ")+"</div>")},a11y_aria_image:function(texts){var values=Array.prototype.slice.call(arguments,0,-1);values=values.filter(Boolean);return new Handlebars.SafeString("<div class=\"aria-label\" role=\"img\" aria-label=\""+values.join(" ")+"\"></div>")},a11y_wrap_focus:function(){var cfg=Adapt.config.get("_accessibility");if(cfg._isPopupWrapFocusEnabled===false)return"";return new Handlebars.SafeString("<a class=\"a11y-focusguard a11y-ignore a11y-ignore-focus\" role=\"presentation\">&nbsp;</a>")},a11y_attrs_heading:function(levelOrType){var cfg=Adapt.config.get("_accessibility");var level=1;if(this._ariaLevel){levelOrType=this._ariaLevel}if(isNaN(levelOrType)===false){level=levelOrType}else if(_.isString(levelOrType)){var _cfg$_ariaLevels;cfg._ariaLevels=cfg._ariaLevels||defaultAriaLevels;if(((_cfg$_ariaLevels=cfg._ariaLevels)===null||_cfg$_ariaLevels===void 0?void 0:_cfg$_ariaLevels["_"+levelOrType])!==undefined){level=cfg._ariaLevels["_"+levelOrType]}}return new Handlebars.SafeString(" role=\"heading\" aria-level=\""+level+"\" ")},a11y_attrs_tabbable:function(){Adapt.a11y.log.deprecated("a11y_attrs_tabbable should not be used. tabbable elements should be natively tabbable.");return new Handlebars.SafeString(" role=\"region\" tabindex=\"0\" ")},a11y_alt_text:function(visible,alternatives){var values=Array.prototype.slice.call(arguments,1,-1);values=values.filter(Boolean);return new Handlebars.SafeString("<span aria-hidden=\"true\">"+visible+"</span><span class=\"aria-label\">"+values.join(" ")+"</span>")}};Object.assign(helpers,{if_value_equals:function(){Adapt.a11y.log.deprecated("if_value_equals, use equals instead.");return helpers.equals.apply(this,arguments)},numbers:function(){Adapt.a11y.log.deprecated("numbers, use inc instead.");return helpers.inc.apply(this,arguments)},lowerCase:function(){Adapt.a11y.log.deprecated("lowerCase, use lowercase instead.");return helpers.lowercase.apply(this,arguments)}});for(var name in helpers){if(!helpers.hasOwnProperty(name))continue;Handlebars.registerHelper(name,helpers[name])}__AMD("core/js/helpers",helpers);var Scrolling=function(_Backbone$Controller){_inherits(Scrolling,_Backbone$Controller);var _super=_createSuper(Scrolling);function Scrolling(){_classCallCheck(this,Scrolling);return _super.apply(this,arguments)}_createClass(Scrolling,[{key:"initialize",value:function initialize(){this.$html=null;this.$app=null;this.isLegacyScrolling=true;this._checkApp();Adapt.once("configModel:dataLoaded",this._loadConfig.bind(this))}},{key:"_checkApp",value:function _checkApp(){this.$html=$("html");this.$app=$("#app");if(this.$app.length)return;this.$app=$("<div id=\"app\">");$("body").append(this.$app);this.$app.append($("#wrapper"));Adapt.log.warn("UPDATE - Your html file needs to have #app adding. See https://github.com/adaptlearning/adapt_framework/issues/2168")}},{key:"_loadConfig",value:function _loadConfig(){var config=Adapt.config.get("_scrollingContainer");if(!(config===null||config===void 0?void 0:config._isEnabled))return;var limitTo=config._limitToSelector;var isIncluded=!limitTo||this.$html.is(limitTo)||this.$html.hasClass(limitTo);if(!isIncluded)return;this.isLegacyScrolling=false;this._addStyling();this._fixJQuery();this._fixScrollTo();this._fixBrowser()}},{key:"_addStyling",value:function _addStyling(){this.$html.addClass("adapt-scrolling")}},{key:"_fixJQuery",value:function _fixJQuery(){var selectorScrollTop=$.fn.scrollTop;var $app=Adapt.scrolling.$app;$.fn.scrollTop=function(){if(this[0]===window||this[0]===document.body){return selectorScrollTop.apply($app,arguments)}return selectorScrollTop.apply(this,arguments)};var selectorOffset=$.fn.offset;$.fn.offset=function(coordinates){if(coordinates){return selectorOffset.apply(this,arguments)}var $app=Adapt.scrolling.$app;var $element=this;var elementOffset=selectorOffset.call($element);var isCorrectedContainer=$element.is("html, body, #app")||$element.parents().is("#app");if(!isCorrectedContainer){return elementOffset}var scrollTop=parseInt($app.scrollTop());var scrollLeft=parseInt($app.scrollLeft());var appOffset=selectorOffset.call($app);elementOffset.top+=scrollTop-appOffset.top;elementOffset.left+=scrollLeft-appOffset.left;return elementOffset}}},{key:"_fixScrollTo",value:function _fixScrollTo(){var selectorScrollTo=$.fn.scrollTo;var scrollTo=$.scrollTo;var $app=Adapt.scrolling.$app;$.fn.scrollTo=function(target,duration,settings){if(this[0]===window||this[0]===document.body){return selectorScrollTo.apply($app,arguments)}return selectorScrollTo.apply(this,arguments)};$.scrollTo=function(target,duration,settings){return selectorScrollTo.apply($app,arguments)};Object.assign($.scrollTo,scrollTo)}},{key:"_fixBrowser",value:function _fixBrowser(){var app=Adapt.scrolling.$app[0];window.scrollTo=function(x,y){app.scrollTop=y||0;app.scrollLeft=x||0};var $window=$(window);this.$app.on("scroll",function(){$window.scroll()})}},{key:"scrollTo",value:function(){var _scrollTo=_asyncToGenerator(regeneratorRuntime.mark(function _callee(selector){var settings,_args=arguments;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:settings=_args.length>1&&_args[1]!==undefined?_args[1]:{};Adapt.log.deprecated("Adapt.scrollTo and Adapt.scrolling.scrollTo, use Adapt.navigateToElement instead.");return _context.abrupt("return",Adapt.router.navigateToElement(selector,settings));case 3:case"end":return _context.stop();}}},_callee)}));function scrollTo(_x){return _scrollTo.apply(this,arguments)}return scrollTo}()}]);return Scrolling}(Backbone.Controller);Adapt.scrolling=new Scrolling;Adapt.scrollTo=Adapt.scrolling.scrollTo.bind(Adapt.scrolling);__AMD("core/js/scrolling",Adapt.scrolling);var HeadingView=function(_Backbone$View){_inherits(HeadingView,_Backbone$View);var _super=_createSuper(HeadingView);function HeadingView(){_classCallCheck(this,HeadingView);return _super.apply(this,arguments)}_createClass(HeadingView,[{key:"initialize",value:function initialize(){this.listenTo(Adapt.parentView,"postRemove",this.remove);this.listenTo(this.model,"change:_isComplete",this.render);this.render()}},{key:"render",value:function render(){var template=Handlebars.templates[this.constructor.template];var data=this.model.toJSON();var customHeadingType=this.$el.attr("data-a11y-heading-type");if(customHeadingType)data._type=customHeadingType;this.$el.html(template(data));this.checkCompletion()}},{key:"checkCompletion",value:function checkCompletion(){var isComplete=this.model.get("_isComplete");this.$el.toggleClass("is-complete",isComplete).toggleClass("is-incomplete",!isComplete)}}]);return HeadingView}(Backbone.View);HeadingView.template="heading";var HeadingView$1=__AMD("core/js/views/headingView",HeadingView);var Headings=function(_Backbone$Controller){_inherits(Headings,_Backbone$Controller);var _super=_createSuper(Headings);function Headings(){_classCallCheck(this,Headings);return _super.apply(this,arguments)}_createClass(Headings,[{key:"initialize",value:function initialize(){this.listenTo(Adapt,"view:render",this.onViewRender)}},{key:"onViewRender",value:function onViewRender(view){var $headingSeats=view.$(".js-heading");$headingSeats.each(function(index,el){return new HeadingView$1({el:el,model:view.model})})}}]);return Headings}(Backbone.Controller);__AMD("core/js/headings",new Headings);var NavigationView=function(_Backbone$View){_inherits(NavigationView,_Backbone$View);var _super=_createSuper(NavigationView);function NavigationView(){_classCallCheck(this,NavigationView);return _super.apply(this,arguments)}_createClass(NavigationView,[{key:"className",value:function className(){return"nav"}},{key:"events",value:function events(){return{"click [data-event]":"triggerEvent"}}},{key:"attributes",value:function attributes(){return{"role":"navigation"}}},{key:"initialize",value:function initialize(){this.listenToOnce(Adapt,{"courseModel:dataLoading":this.remove});this.listenTo(Adapt,"router:menu router:page",this.hideNavigationButton);this.preRender()}},{key:"preRender",value:function preRender(){Adapt.trigger("navigationView:preRender",this);this.render()}},{key:"render",value:function render(){var _this=this;var template=Handlebars.templates[this.constructor.template];this.$el.html(template({_globals:Adapt.course.get("_globals"),_accessibility:Adapt.config.get("_accessibility")})).insertBefore("#app");_.defer(function(){Adapt.trigger("navigationView:postRender",_this)});return this}},{key:"triggerEvent",value:function triggerEvent(event){event.preventDefault();var currentEvent=$(event.currentTarget).attr("data-event");Adapt.trigger("navigation:"+currentEvent);switch(currentEvent){case"backButton":Adapt.router.navigateToPreviousRoute();break;case"homeButton":Adapt.router.navigateToHomeRoute();break;case"parentButton":Adapt.router.navigateToParent();break;case"skipNavigation":this.skipNavigation();break;case"returnToStart":Adapt.startController.returnToStartLocation();break;}}},{key:"skipNavigation",value:function skipNavigation(){Adapt.a11y.focusFirst("."+Adapt.location._contentType)}},{key:"hideNavigationButton",value:function hideNavigationButton(model){var shouldHide=model.get("_type")==="course";this.$(".nav__back-btn, .nav__home-btn").toggleClass("u-display-none",shouldHide)}},{key:"showNavigationButton",value:function showNavigationButton(){this.$(".nav__back-btn, .nav__home-btn").removeClass("u-display-none")}}]);return NavigationView}(Backbone.View);NavigationView.template="nav";var NavigationView$1=__AMD("core/js/views/navigationView",NavigationView);var NavigationController=function(_Backbone$Controller){_inherits(NavigationController,_Backbone$Controller);var _super=_createSuper(NavigationController);function NavigationController(){_classCallCheck(this,NavigationController);return _super.apply(this,arguments)}_createClass(NavigationController,[{key:"initialize",value:function initialize(){this.listenTo(Adapt,"adapt:preInitialize",this.addNavigationBar)}},{key:"addNavigationBar",value:function addNavigationBar(){var adaptConfig=Adapt.course.get("_navigation");if(adaptConfig===null||adaptConfig===void 0?void 0:adaptConfig._isDefaultNavigationDisabled){Adapt.trigger("navigation:initialize");return}Adapt.navigation=new NavigationView$1}}]);return NavigationController}(Backbone.Controller);__AMD("core/js/navigation",new NavigationController);var ItemModel=__AMD("core/js/models/itemModel",function(_LockingModel){_inherits(ItemModel,_LockingModel);var _super=_createSuper(ItemModel);function ItemModel(){_classCallCheck(this,ItemModel);return _super.apply(this,arguments)}_createClass(ItemModel,[{key:"defaults",value:function defaults(){return{_isActive:false,_isVisited:false}}},{key:"reset",value:function reset(){this.set({_isActive:false,_isVisited:false})}},{key:"toggleActive",value:function toggleActive(){var isActive=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!this.get("_isActive");this.set("_isActive",isActive)}},{key:"toggleVisited",value:function toggleVisited(){var isVisited=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!this.get("_isVisited");this.set("_isVisited",isVisited)}}]);return ItemModel}(LockingModel));var ItemsComponentModel=__AMD("core/js/models/itemsComponentModel",function(_ComponentModel){_inherits(ItemsComponentModel,_ComponentModel);var _super=_createSuper(ItemsComponentModel);function ItemsComponentModel(){_classCallCheck(this,ItemsComponentModel);return _super.apply(this,arguments)}_createClass(ItemsComponentModel,[{key:"toJSON",value:function toJSON(){var json=_get(_getPrototypeOf(ItemsComponentModel.prototype),"toJSON",this).call(this);json._items=this.getChildren().toJSON();return json}},{key:"init",value:function init(){this.setUpItems();this.listenTo(this.getChildren(),{"all":this.onAll,"change:_isVisited":this.checkCompletionStatus});_get(_getPrototypeOf(ItemsComponentModel.prototype),"init",this).call(this)}},{key:"restoreUserAnswers",value:function restoreUserAnswers(){var booleanArray=this.get("_userAnswer");if(!booleanArray)return;this.getChildren().forEach(function(child,index){return child.set("_isVisited",booleanArray[index])})}},{key:"storeUserAnswer",value:function storeUserAnswer(){var booleanArray=this.getChildren().map(function(child){return child.get("_isVisited")});this.set("_userAnswer",booleanArray)}},{key:"setUpItems",value:function setUpItems(){var items=this.get("_items")||[];items.forEach(function(item,index){return item._index=index});this.setChildren(new Backbone.Collection(items,{model:ItemModel}))}},{key:"getItem",value:function getItem(index){return this.getChildren().findWhere({_index:index})}},{key:"getVisitedItems",value:function getVisitedItems(){return this.getChildren().where({_isVisited:true})}},{key:"getActiveItems",value:function getActiveItems(){return this.getChildren().where({_isActive:true})}},{key:"getActiveItem",value:function getActiveItem(){return this.getChildren().findWhere({_isActive:true})}},{key:"areAllItemsCompleted",value:function areAllItemsCompleted(){return this.getVisitedItems().length===this.getChildren().length}},{key:"checkCompletionStatus",value:function checkCompletionStatus(){this.storeUserAnswer();if(!this.areAllItemsCompleted())return;this.setCompletionStatus()}},{key:"reset",value:function reset(type,force){this.getChildren().each(function(item){return item.reset()});_get(_getPrototypeOf(ItemsComponentModel.prototype),"reset",this).call(this,type,force)}},{key:"resetActiveItems",value:function resetActiveItems(){this.getChildren().each(function(item){return item.toggleActive(false)})}},{key:"setActiveItem",value:function setActiveItem(index){var item=this.getItem(index);if(!item)return;var activeItem=this.getActiveItem();if(activeItem)activeItem.toggleActive(false);item.toggleActive(true)}}]);return ItemsComponentModel}(ComponentModel$1));var AccordionModel=function(_ItemsComponentModel){_inherits(AccordionModel,_ItemsComponentModel);var _super=_createSuper(AccordionModel);function AccordionModel(){_classCallCheck(this,AccordionModel);return _super.apply(this,arguments)}_createClass(AccordionModel,[{key:"defaults",value:function defaults(){return ItemsComponentModel.resultExtend("defaults",{_shouldCollapseItems:true,_toggleSpeed:200},this)}},{key:"toggleItemsState",value:function toggleItemsState(index){var item=this.getItem(index);var previousActiveItem=this.getActiveItem();item.toggleActive();item.toggleVisited(true);if(previousActiveItem&&this.get("_shouldCollapseItems")){previousActiveItem.toggleActive(false)}}}]);return AccordionModel}(ItemsComponentModel);var AccordionModel$1=__AMD("components/adapt-contrib-accordion/js/accordionModel",AccordionModel);var ComponentView=function(_AdaptView){_inherits(ComponentView,_AdaptView);var _super=_createSuper(ComponentView);function ComponentView(){_classCallCheck(this,ComponentView);return _super.apply(this,arguments)}_createClass(ComponentView,[{key:"attributes",value:function attributes(){if(!this.model.get("_isA11yRegionEnabled")){return AdaptView$1.resultExtend("attributes",{},this)}return AdaptView$1.resultExtend("attributes",{"aria-labelledby":this.model.get("_id")+"-heading","role":"region"},this)}},{key:"className",value:function className(){return["component",this.model.get("_component").toLowerCase(),this.model.get("_id"),this.model.get("_classes"),this.setVisibility(),this.setHidden(),"is-"+this.model.get("_layout"),this.model.get("_isComplete")?"is-complete":"",this.model.get("_isOptional")?"is-optional":""].join(" ")}},{key:"renderState",value:function renderState(){Adapt.log.removed("renderState is removed and moved to item title")}},{key:"setupInviewCompletion",value:function setupInviewCompletion(){var inviewElementSelector=arguments.length>0&&arguments[0]!==undefined?arguments[0]:".component__inner";var callback=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.setCompletionStatus;this.$inviewElement=this.$(inviewElementSelector);this.inviewCallback=callback;this.$inviewElement.on("inview.componentView",this.onInview.bind(this))}},{key:"removeInviewListener",value:function removeInviewListener(){if(!this.$inviewElement)return;this.$inviewElement.off("inview.componentView");this.$inviewElement=null}},{key:"onInview",value:function onInview(event,visible,visiblePartX,visiblePartY){if(!visible)return;switch(visiblePartY){case"top":this.hasSeenTop=true;break;case"bottom":this.hasSeenBottom=true;break;case"both":this.hasSeenTop=this.hasSeenBottom=true;}if(!this.hasSeenTop||!this.hasSeenBottom)return;this.inviewCallback();if(this.model.get("_isComplete")){this.removeInviewListener()}}},{key:"postRender",value:function postRender(){}},{key:"remove",value:function remove(){this.removeInviewListener();_get(_getPrototypeOf(ComponentView.prototype),"remove",this).call(this)}}]);return ComponentView}(AdaptView$1);ComponentView.type="component";var ComponentView$1=__AMD("core/js/views/componentView",ComponentView);var AccordionView=function(_ComponentView){_inherits(AccordionView,_ComponentView);var _super=_createSuper(AccordionView);function AccordionView(){_classCallCheck(this,AccordionView);return _super.apply(this,arguments)}_createClass(AccordionView,[{key:"events",value:function events(){return{"click .js-toggle-item":"onClick"}}},{key:"preRender",value:function preRender(){this.checkIfResetOnRevisit();this.model.resetActiveItems();this.listenTo(this.model.get("_children"),{"change:_isActive":this.onItemsActiveChange,"change:_isVisited":this.onItemsVisitedChange})}},{key:"postRender",value:function postRender(){this.setReadyStatus();if(this.model.get("_setCompletionOn")==="inview"){this.setupInviewCompletion()}}},{key:"checkIfResetOnRevisit",value:function checkIfResetOnRevisit(){var isResetOnRevisit=this.model.get("_isResetOnRevisit");if(isResetOnRevisit){this.model.reset(isResetOnRevisit)}}},{key:"onClick",value:function onClick(event){this.model.toggleItemsState($(event.currentTarget).parent().data("index"))}},{key:"onItemsActiveChange",value:function onItemsActiveChange(item,isActive){this.toggleItem(item,isActive)}},{key:"onItemsVisitedChange",value:function onItemsVisitedChange(item,isVisited){if(!isVisited)return;var $item=this.getItemElement(item);$item.children(".accordion__item-btn").addClass("is-visited")}},{key:"toggleItem",value:function toggleItem(item,shouldExpand){var $item=this.getItemElement(item);var $body=$item.children(".accordion__item-content").stop(true,true);$item.children(".accordion__item-btn").toggleClass("is-selected is-open",shouldExpand).toggleClass("is-closed",!shouldExpand).attr("aria-expanded",shouldExpand);if(!shouldExpand){$body.slideUp(this.model.get("_toggleSpeed"));return}$body.slideDown(this.model.get("_toggleSpeed"))}},{key:"getItemElement",value:function getItemElement(item){var index=item.get("_index");return this.$(".accordion__item").filter("[data-index=\"".concat(index,"\"]"))}}]);return AccordionView}(ComponentView$1);AccordionView.template="accordion";var AccordionView$1=__AMD("components/adapt-contrib-accordion/js/accordionView",AccordionView);__AMD("components/adapt-contrib-accordion/js/adapt-contrib-accordion",Adapt.register("accordion",{model:AccordionModel$1,view:AccordionView$1}));var AssessmentResultsModel=function(_ComponentModel){_inherits(AssessmentResultsModel,_ComponentModel);var _super=_createSuper(AssessmentResultsModel);function AssessmentResultsModel(){_classCallCheck(this,AssessmentResultsModel);return _super.apply(this,arguments)}_createClass(AssessmentResultsModel,[{key:"init",value:function init(){var _get2;this.set("originalBody",this.get("body"));this.listenTo(Adapt,{"assessments:complete":this.onAssessmentComplete,"assessments:reset":this.onAssessmentReset});for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}(_get2=_get(_getPrototypeOf(AssessmentResultsModel.prototype),"init",this)).call.apply(_get2,[this].concat(args))}},{key:"checkIfAssessmentComplete",value:function checkIfAssessmentComplete(){if(!Adapt.assessment||this.get("_assessmentId")===undefined){return}var assessmentModel=Adapt.assessment.get(this.get("_assessmentId"));if(!assessmentModel||assessmentModel.length===0)return;var state=assessmentModel.getState();var isResetOnRevisit=assessmentModel.get("_assessment")._isResetOnRevisit;if(state.isComplete&&(!state.allowResetIfPassed||!isResetOnRevisit)){this.onAssessmentComplete(state);return}this.setVisibility()}},{key:"onAssessmentComplete",value:function onAssessmentComplete(state){if(this.get("_assessmentId")===undefined||this.get("_assessmentId")!=state.id)return;this.set({_state:state,attempts:state.attempts,attemptsSpent:state.attemptsSpent,attemptsLeft:state.attemptsLeft,score:state.score,scoreAsPercent:state.scoreAsPercent,maxScore:state.maxScore,isPass:state.isPass});this.setFeedbackBand(state);this.checkRetryEnabled(state);this.setFeedbackText();this.toggleVisibility(true)}},{key:"setFeedbackBand",value:function setFeedbackBand(state){var scoreProp=state.isPercentageBased?"scoreAsPercent":"score";var bands=_.sortBy(this.get("_bands"),"_score");for(var i=bands.length-1;i>=0;i--){var isScoreInBandRange=state[scoreProp]>=bands[i]._score;if(!isScoreInBandRange)continue;this.set("_feedbackBand",bands[i]);break}}},{key:"checkRetryEnabled",value:function checkRetryEnabled(state){var assessmentModel=Adapt.assessment.get(state.id);if(!assessmentModel.canResetInPage())return false;var feedbackBand=this.get("_feedbackBand");var isRetryEnabled=(feedbackBand&&feedbackBand._allowRetry)!==false;var isAttemptsLeft=state.attemptsLeft>0||state.attemptsLeft==="infinite";var showRetry=isRetryEnabled&&isAttemptsLeft&&(!state.isPass||state.allowResetIfPassed);this.set({_isRetryEnabled:showRetry,retryFeedback:showRetry?this.get("_retry").feedback:""})}},{key:"setFeedbackText",value:function setFeedbackText(){var feedbackBand=this.get("_feedbackBand");var feedback=feedbackBand?Handlebars.compile(feedbackBand.feedback)(this.toJSON()):"";this.set({feedback:feedback,body:this.get("_completionBody")})}},{key:"setVisibility",value:function setVisibility(){if(!Adapt.assessment)return;var isVisibleBeforeCompletion=this.get("_isVisibleBeforeCompletion")||false;var wasVisible=this.get("_isVisible");var assessmentModel=Adapt.assessment.get(this.get("_assessmentId"));if(!assessmentModel||assessmentModel.length===0)return;var state=assessmentModel.getState();var isComplete=state.isComplete;var isAttemptInProgress=state.attemptInProgress;var attemptsSpent=state.attemptsSpent;var hasHadAttempt=!isAttemptInProgress&&attemptsSpent>0;var isVisible=isVisibleBeforeCompletion&&!isComplete||hasHadAttempt;if(!wasVisible&&isVisible)isVisible=(_readOnlyError("isVisible"),false);this.toggleVisibility(isVisible)}},{key:"toggleVisibility",value:function toggleVisibility(isVisible){if(isVisible===undefined){isVisible=!this.get("_isVisible")}this.set("_isVisible",isVisible,{pluginName:"assessmentResults"})}},{key:"checkCompletion",value:function checkCompletion(){if(this.get("_setCompletionOn")==="pass"&&!this.get("isPass")){return}this.setCompletionStatus()}},{key:"onAssessmentReset",value:function onAssessmentReset(state){if(this.get("_assessmentId")===undefined||this.get("_assessmentId")!=state.id)return;var resetType=this.get("_resetType");if(!resetType||resetType==="inherit"){resetType=state.resetType||"hard"}this.reset(resetType,true)}},{key:"reset",value:function reset(){var _get3;this.set({body:this.get("originalBody"),state:null,feedback:"",_feedbackBand:null,retryFeedback:"",_isRetryEnabled:false});for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++){args[_key2]=arguments[_key2]}(_get3=_get(_getPrototypeOf(AssessmentResultsModel.prototype),"reset",this)).call.apply(_get3,[this].concat(args))}}]);return AssessmentResultsModel}(ComponentModel$1);var AssessmentResultsModel$1=__AMD("components/adapt-contrib-assessmentResults/js/assessmentResultsModel",AssessmentResultsModel);var AssessmentResultsView=function(_ComponentView){_inherits(AssessmentResultsView,_ComponentView);var _super=_createSuper(AssessmentResultsView);function AssessmentResultsView(){_classCallCheck(this,AssessmentResultsView);return _super.apply(this,arguments)}_createClass(AssessmentResultsView,[{key:"events",value:function events(){return{"click .js-assessment-retry-btn":"onRetryClicked"}}},{key:"preRender",value:function preRender(){this.model.setLocking("_isVisible",false);this.listenTo(Adapt.parentView,"preRemove",function(){this.model.unsetLocking("_isVisible")});this.listenTo(this.model,{"change:_feedbackBand":this.addClassesToArticle,"change:body":this.render})}},{key:"postRender",value:function postRender(){this.model.checkIfAssessmentComplete();this.setReadyStatus();this.setupInviewCompletion(".component__inner",this.model.checkCompletion.bind(this.model))}},{key:"onRetryClicked",value:function onRetryClicked(){var _this=this;var state=this.model.get("_state");Adapt.assessment.get(state.id).reset(null,function(wasReset){if(!wasReset){return}if(_this.model.get("_retry")._routeToAssessment===true){Adapt.navigateToElement("."+state.articleId)}})}},{key:"addClassesToArticle",value:function addClassesToArticle(model,value){if(!value||!value._classes)return;this.$el.parents(".article").addClass(value._classes)}}]);return AssessmentResultsView}(ComponentView$1);AssessmentResultsView.template="assessmentResults";var AssessmentResultsView$1=__AMD("components/adapt-contrib-assessmentResults/js/assessmentResultsView",AssessmentResultsView);__AMD("components/adapt-contrib-assessmentResults/js/adapt-contrib-assessmentResults",Adapt.register("assessmentResults",{model:AssessmentResultsModel$1,view:AssessmentResultsView$1}));var BlankView=function(_ComponentView){_inherits(BlankView,_ComponentView);var _super=_createSuper(BlankView);function BlankView(){_classCallCheck(this,BlankView);return _super.apply(this,arguments)}_createClass(BlankView,[{key:"preRender",value:function preRender(){this.checkIfResetOnRevisit()}},{key:"postRender",value:function postRender(){this.setReadyStatus();this.setupInviewCompletion()}},{key:"checkIfResetOnRevisit",value:function checkIfResetOnRevisit(){var isResetOnRevisit=this.model.get("_isResetOnRevisit");if(isResetOnRevisit){this.model.reset(isResetOnRevisit)}}}]);return BlankView}(ComponentView$1);BlankView.template="blank";__AMD("components/adapt-contrib-blank/js/adapt-contrib-blank",Adapt.register("blank",{model:ComponentModel$1.extend({}),view:BlankView}));var BUTTON_STATE=ENUM(["SUBMIT","CORRECT","INCORRECT","SHOW_CORRECT_ANSWER","HIDE_CORRECT_ANSWER","SHOW_FEEDBACK","RESET"]);var BUTTON_STATE$1=__AMD("core/js/enums/buttonStateEnum",BUTTON_STATE);var textPropertyName={"SUBMIT":"submit","CORRECT":"correct","INCORRECT":"incorrect","SHOW_CORRECT_ANSWER":"showCorrectAnswer","HIDE_CORRECT_ANSWER":"hideCorrectAnswer","SHOW_FEEDBACK":"showFeedback","RESET":"reset"};var ButtonsView=__AMD("core/js/views/buttonsView",function(_Backbone$View){_inherits(ButtonsView,_Backbone$View);var _super=_createSuper(ButtonsView);function ButtonsView(){_classCallCheck(this,ButtonsView);return _super.apply(this,arguments)}_createClass(ButtonsView,[{key:"initialize",value:function initialize(options){this.parent=options.parent;this.listenTo(Adapt.parentView,"postRemove",this.remove);this.listenTo(this.model,{"change:_buttonState":this.onButtonStateChanged,"change:feedbackMessage":this.onFeedbackMessageChanged,"change:_attemptsLeft":this.onAttemptsChanged,"change:_canSubmit":this.onCanSubmitChange});this.render()}},{key:"events",value:function events(){return{"click .js-btn-action":"onActionClicked","click .js-btn-feedback":"onFeedbackClicked"}}},{key:"render",value:function render(){var _this=this;var data=this.model.toJSON();var template=Handlebars.templates.buttons;_.defer(function(){_this.postRender();Adapt.trigger("buttonsView:postRender",_this)});this.$el.html(template(data))}},{key:"postRender",value:function postRender(){this.refresh()}},{key:"checkResetSubmittedState",value:function checkResetSubmittedState(){var isSubmitted=this.model.get("_isSubmitted");if(isSubmitted){this.$el.addClass("is-submitted");return}this.$(".js-btn-marking").removeClass("is-incorrect is-correct").addClass("u-display-none");this.$el.removeClass("is-submitted");this.model.set("feedbackMessage",undefined);Adapt.a11y.toggleEnabled(this.$(".js-btn-feedback"),false)}},{key:"onActionClicked",value:function onActionClicked(){var buttonState=BUTTON_STATE$1(this.model.get("_buttonState"));this.trigger("buttons:stateUpdate",buttonState);this.checkResetSubmittedState();if(buttonState===BUTTON_STATE$1.SHOW_CORRECT_ANSWER){var _this$model$getCorrec,_this$model;var correctAnswer=(_this$model$getCorrec=(_this$model=this.model).getCorrectAnswerAsText)===null||_this$model$getCorrec===void 0?void 0:_this$model$getCorrec.call(_this$model);this.updateAnswerLiveRegion(correctAnswer)}if(buttonState===BUTTON_STATE$1.HIDE_CORRECT_ANSWER){var _this$model$getUserAn,_this$model2;var userAnswer=(_this$model$getUserAn=(_this$model2=this.model).getUserAnswerAsText)===null||_this$model$getUserAn===void 0?void 0:_this$model$getUserAn.call(_this$model2);this.updateAnswerLiveRegion(userAnswer)}}},{key:"onFeedbackClicked",value:function onFeedbackClicked(){this.trigger("buttons:stateUpdate",BUTTON_STATE$1.SHOW_FEEDBACK)}},{key:"onFeedbackMessageChanged",value:function onFeedbackMessageChanged(model,changedAttribute){if(changedAttribute&&this.model.get("_canShowFeedback")){Adapt.a11y.toggleEnabled(this.$(".js-btn-feedback"),true);return}Adapt.a11y.toggleEnabled(this.$(".js-btn-feedback"),false)}},{key:"onCanSubmitChange",value:function onCanSubmitChange(){this.onButtonStateChanged(this.model,this.model.get("_buttonState"))}},{key:"onButtonStateChanged",value:function onButtonStateChanged(model,changedAttribute){this.updateAttemptsCount();var $buttonsAction=this.$(".js-btn-action");var buttonState=BUTTON_STATE$1(changedAttribute);if(changedAttribute===BUTTON_STATE$1.CORRECT||changedAttribute===BUTTON_STATE$1.INCORRECT){Adapt.a11y.toggleEnabled($buttonsAction,false);return}var propertyName=textPropertyName[buttonState.asString];var ariaLabel=this.model.get("_buttons")["_"+propertyName].ariaLabel;var buttonText=this.model.get("_buttons")["_"+propertyName].buttonText;Adapt.a11y.toggleEnabled($buttonsAction,this.model.get("_canSubmit"));$buttonsAction.html(buttonText).attr("aria-label",ariaLabel)}},{key:"checkFeedbackState",value:function checkFeedbackState(){var canShowFeedback=this.model.get("_canShowFeedback");this.$(".js-btn-action").toggleClass("is-full-width",!canShowFeedback);this.$(".js-btn-feedback").toggleClass("u-display-none",!canShowFeedback);this.$(".js-btn-marking").toggleClass("is-full-width u-display-none",!canShowFeedback)}},{key:"updateAttemptsCount",value:function updateAttemptsCount(){var isInteractionComplete=this.model.get("_isInteractionComplete");var attemptsLeft=this.model.get("_attemptsLeft")?this.model.get("_attemptsLeft"):this.model.get("_attempts");var shouldDisplayAttempts=this.model.get("_shouldDisplayAttempts");var attemptsString;this.checkResetSubmittedState();if(!isInteractionComplete&&attemptsLeft!==0){attemptsString=attemptsLeft+" ";attemptsString+=attemptsLeft===1?this.model.get("_buttons").remainingAttemptText:this.model.get("_buttons").remainingAttemptsText}else{this.$(".js-display-attempts").addClass("u-visibility-hidden");this.showMarking()}if(shouldDisplayAttempts){this.$(".js-insert-attempts-string").html(attemptsString)}}},{key:"updateAnswerLiveRegion",value:function updateAnswerLiveRegion(answer){if(!answer)return;this.$(".js-answer-live-region").html(answer)}},{key:"showMarking",value:function showMarking(){if(!this.model.shouldShowMarking)return;var isCorrect=this.model.get("_isCorrect");var ariaLabels=Adapt.course.get("_globals")._accessibility._ariaLabels;this.$(".js-btn-marking").removeClass("u-display-none").addClass(isCorrect?"is-correct":"is-incorrect").attr("aria-label",isCorrect?ariaLabels.answeredCorrectly:ariaLabels.answeredIncorrectly)}},{key:"refresh",value:function refresh(){this.updateAttemptsCount();this.checkResetSubmittedState();this.checkFeedbackState();this.onButtonStateChanged(null,this.model.get("_buttonState"));this.onFeedbackMessageChanged(null,this.model.get("feedbackMessage"))}}]);return ButtonsView}(Backbone.View));var QuestionModel=function(_ComponentModel){_inherits(QuestionModel,_ComponentModel);var _super=_createSuper(QuestionModel);function QuestionModel(){_classCallCheck(this,QuestionModel);return _super.apply(this,arguments)}_createClass(QuestionModel,[{key:"defaults",value:function defaults(){return ComponentModel$1.resultExtend("defaults",{_isQuestionType:true,_shouldDisplayAttempts:false,_canShowModelAnswer:true,_canShowFeedback:true,_canShowMarking:true,_canSubmit:true,_isSubmitted:false,_questionWeight:Adapt.config.get("_questionWeight"),_items:[]})}},{key:"trackable",value:function trackable(){return ComponentModel$1.resultExtend("trackable",["_isSubmitted","_score","_isCorrect","_attemptsLeft"])}},{key:"trackableType",value:function trackableType(){return ComponentModel$1.resultExtend("trackableType",[Boolean,Number,Boolean,Number])}},{key:"getTypeGroup",value:function getTypeGroup(){return"question"}},{key:"init",value:function init(){this.setupDefaultSettings();this.setLocking("_canSubmit",true);_get(_getPrototypeOf(QuestionModel.prototype),"init",this).call(this)}},{key:"setupDefaultSettings",value:function setupDefaultSettings(){this.setupWeightSettings();this.setupButtonSettings()}},{key:"setupButtonSettings",value:function setupButtonSettings(){var globalButtons=Adapt.course.get("_buttons");if(!this.has("_buttons")){this.set("_buttons",globalButtons)}else{var componentButtons=this.get("_buttons");for(var key in componentButtons){if(_typeof(componentButtons[key])==="object"){if(!componentButtons[key].buttonText&&globalButtons[key].buttonText){componentButtons[key].buttonText=globalButtons[key].buttonText}if(!componentButtons[key].ariaLabel&&globalButtons[key].ariaLabel){componentButtons[key].ariaLabel=globalButtons[key].ariaLabel}}if(!componentButtons[key]&&globalButtons[key]){componentButtons[key]=globalButtons[key]}}}}},{key:"setupWeightSettings",value:function setupWeightSettings(){}},{key:"canSubmit",value:function canSubmit(){}},{key:"checkCanSubmit",value:function checkCanSubmit(){this.set("_canSubmit",this.canSubmit(),{pluginName:"adapt"})}},{key:"updateAttempts",value:function updateAttempts(){if(!this.get("_attemptsLeft")){this.set("_attemptsLeft",this.get("_attempts"))}this.set("_attemptsLeft",this.get("_attemptsLeft")-1)}},{key:"setQuestionAsSubmitted",value:function setQuestionAsSubmitted(){this.set({_isEnabled:false,_isSubmitted:true})}},{key:"markQuestion",value:function markQuestion(){if(this.isCorrect()){this.set("_isCorrect",true)}else{this.set("_isCorrect",false)}}},{key:"isCorrect",value:function isCorrect(){}},{key:"setScore",value:function setScore(){}},{key:"checkQuestionCompletion",value:function checkQuestionCompletion(){var isComplete=this.get("_isCorrect")||this.get("_attemptsLeft")===0;if(isComplete){this.setCompletionStatus()}return isComplete}},{key:"updateButtons",value:function updateButtons(){var isInteractionComplete=this.get("_isInteractionComplete");var isCorrect=this.get("_isCorrect");var isEnabled=this.get("_isEnabled");var buttonState=this.get("_buttonState");var canShowModelAnswer=this.get("_canShowModelAnswer");if(isInteractionComplete){if(isCorrect||!canShowModelAnswer){this.set("_buttonState",BUTTON_STATE$1.CORRECT)}else{switch(buttonState){case BUTTON_STATE$1.SUBMIT:case BUTTON_STATE$1.HIDE_CORRECT_ANSWER:this.set("_buttonState",BUTTON_STATE$1.SHOW_CORRECT_ANSWER);break;default:this.set("_buttonState",BUTTON_STATE$1.HIDE_CORRECT_ANSWER);}}}else{if(isEnabled){this.set("_buttonState",BUTTON_STATE$1.SUBMIT)}else{this.set("_buttonState",BUTTON_STATE$1.RESET)}}}},{key:"setupFeedback",value:function setupFeedback(){if(!this.has("_feedback"))return;if(this.get("_isCorrect")){this.setupCorrectFeedback()}else if(this.isPartlyCorrect()){this.setupPartlyCorrectFeedback()}else{this.setupIncorrectFeedback()}}},{key:"isPartlyCorrect",value:function isPartlyCorrect(){}},{key:"setupCorrectFeedback",value:function setupCorrectFeedback(){this.set({feedbackTitle:this.getFeedbackTitle(),feedbackMessage:this.get("_feedback").correct})}},{key:"setupPartlyCorrectFeedback",value:function setupPartlyCorrectFeedback(){var feedback=this.get("_feedback")._partlyCorrect;if(feedback===null||feedback===void 0?void 0:feedback.final){this.setAttemptSpecificFeedback(feedback)}else{this.setupIncorrectFeedback()}}},{key:"setupIncorrectFeedback",value:function setupIncorrectFeedback(){this.setAttemptSpecificFeedback(this.get("_feedback")._incorrect)}},{key:"setAttemptSpecificFeedback",value:function setAttemptSpecificFeedback(feedback){var body=this.get("_attemptsLeft")&&feedback.notFinal||feedback.final;this.set({feedbackTitle:this.getFeedbackTitle(),feedbackMessage:body})}},{key:"getFeedbackTitle",value:function getFeedbackTitle(){return this.get("_feedback").title||this.get("displayTitle")||this.get("title")||""}},{key:"isInteractive",value:function isInteractive(){return!this.get("_isComplete")||this.get("_isEnabled")&&!this.get("_isSubmitted")}},{key:"reset",value:function reset(type,force){if(!this.get("_canReset")&&!force)return;type=type||true;_get(_getPrototypeOf(QuestionModel.prototype),"reset",this).call(this,type,force);var attempts=this.get("_attempts");this.set({_attemptsLeft:attempts,_isCorrect:undefined,_isSubmitted:false,_buttonState:BUTTON_STATE$1.SUBMIT})}},{key:"setQuestionAsReset",value:function setQuestionAsReset(){this.set({_isEnabled:true,_isSubmitted:false})}},{key:"refresh",value:function refresh(){this.trigger("question:refresh")}},{key:"getButtonState",value:function getButtonState(){if(this.get("_isCorrect")){return BUTTON_STATE$1.CORRECT}if(this.get("_attemptsLeft")===0){return this.get("_canShowModelAnswer")?BUTTON_STATE$1.SHOW_CORRECT_ANSWER:BUTTON_STATE$1.INCORRECT}return this.get("_isSubmitted")?BUTTON_STATE$1.RESET:BUTTON_STATE$1.SUBMIT}},{key:"getInteractionObject",value:function getInteractionObject(){return{}}},{key:"getResponse",value:function getResponse(){}},{key:"getResponseType",value:function getResponseType(){}},{key:"onSubmitted",value:function onSubmitted(){this.addAttemptObject()}},{key:"shouldShowMarking",get:function(){if(!this.get("_canShowMarking")){return false}return this.get("_isInteractionComplete")}}]);return QuestionModel}(ComponentModel$1);Adapt.register("question",{model:QuestionModel});var QuestionModel$1=__AMD("core/js/models/questionModel",QuestionModel);var QuestionView=function(_ComponentView){_inherits(QuestionView,_ComponentView);var _super=_createSuper(QuestionView);function QuestionView(){_classCallCheck(this,QuestionView);return _super.apply(this,arguments)}_createClass(QuestionView,[{key:"className",value:function className(){return["component","is-question",this.model.get("_component").toLowerCase(),this.model.get("_id"),this.model.get("_classes"),this.setVisibility(),"is-"+this.model.get("_layout"),this.model.get("_isComplete")?"is-complete":"",this.model.get("_isOptional")?"is-optional":"",this.model.get("_canShowModelAnswer")?"can-show-model-answer":"",this.model.get("_canShowFeedback")?"can-show-feedback":"",this.model.get("_canShowMarking")?"can-show-marking":""].join(" ")}},{key:"preRender",value:function preRender(){this.listenTo(this.model,"change:_isEnabled",this.onEnabledChanged);this.listenTo(this.model,"question:refresh",this.refresh);this.checkIfResetOnRevisit();this._runModelCompatibleFunction("setupDefaultSettings");this.setupQuestion()}},{key:"onEnabledChanged",value:function onEnabledChanged(model,changedAttribute){if(!changedAttribute){this.$(".component__widget").addClass("is-disabled");this.disableQuestion()}else{this.$(".component__widget").removeClass("is-disabled");this.enableQuestion()}}},{key:"disableQuestion",value:function disableQuestion(){}},{key:"enableQuestion",value:function enableQuestion(){}},{key:"checkIfResetOnRevisit",value:function checkIfResetOnRevisit(){var _this=this;var isResetOnRevisit=this.model.get("_isResetOnRevisit");if(isResetOnRevisit){this.model.reset(isResetOnRevisit,true);_.defer(function(){_this.resetQuestionOnRevisit(isResetOnRevisit)});return}var isInteractionComplete=this.model.get("_isInteractionComplete");if(isInteractionComplete){this.model.set("_buttonState",BUTTON_STATE$1.HIDE_CORRECT_ANSWER);_.defer(function(){_this.onHideCorrectAnswerClicked()});return}this.model.set("_buttonState",BUTTON_STATE$1.SUBMIT);_.defer(function(){_this.onResetClicked()})}},{key:"resetQuestionOnRevisit",value:function resetQuestionOnRevisit(type){}},{key:"setupQuestion",value:function setupQuestion(){}},{key:"postRender",value:function postRender(){this.addButtonsView();this.onQuestionRendered()}},{key:"addButtonsView",value:function addButtonsView(){this.buttonsView=new ButtonsView({model:this.model,el:this.$(".btn__container")});this.listenTo(this.buttonsView,"buttons:stateUpdate",this.onButtonStateUpdate)}},{key:"onButtonStateUpdate",value:function onButtonStateUpdate(buttonState){switch(buttonState){case BUTTON_STATE$1.SUBMIT:this.onSubmitClicked();break;case BUTTON_STATE$1.RESET:this.onResetClicked();break;case BUTTON_STATE$1.SHOW_CORRECT_ANSWER:this.onShowCorrectAnswerClicked();break;case BUTTON_STATE$1.HIDE_CORRECT_ANSWER:this.onHideCorrectAnswerClicked();break;case BUTTON_STATE$1.SHOW_FEEDBACK:this.showFeedback();break;}}},{key:"onQuestionRendered",value:function onQuestionRendered(){}},{key:"onSubmitClicked",value:function onSubmitClicked(){var canSubmit=this._runModelCompatibleFunction("canSubmit");if(!canSubmit){this.showInstructionError();this.onCannotSubmit();return}this._runModelCompatibleFunction("updateAttempts");this._runModelCompatibleFunction("setQuestionAsSubmitted");this.removeInstructionError();this._runModelCompatibleFunction("storeUserAnswer");this._runModelCompatibleFunction("markQuestion","isCorrect");this._runModelCompatibleFunction("setScore");this._runModelCompatibleFunction("checkQuestionCompletion");if(this.model.shouldShowMarking){this.showMarking()}this.recordInteraction();this._runModelCompatibleFunction("setupFeedback");this.showFeedback();$(window).resize();this._runModelCompatibleFunction("updateButtons");this.model.onSubmitted();this.onSubmitted()}},{key:"showInstructionError",value:function showInstructionError(){Adapt.trigger("questionView:showInstructionError",this)}},{key:"onCannotSubmit",value:function onCannotSubmit(){}},{key:"onSubmitted",value:function onSubmitted(){}},{key:"setQuestionAsSubmitted",value:function setQuestionAsSubmitted(){this.model.setQuestionAsSubmitted();this.$(".component__widget").addClass("is-submitted")}},{key:"removeInstructionError",value:function removeInstructionError(){this.$(".component__instruction-inner").removeClass("validation-error")}},{key:"showMarking",value:function showMarking(){}},{key:"checkQuestionCompletion",value:function checkQuestionCompletion(){var isComplete=this.model.checkQuestionCompletion();if(isComplete){this.$(".component__widget").addClass("is-complete show-user-answer")}}},{key:"recordInteraction",value:function recordInteraction(){if(this.model.get("_recordInteraction")===true||!this.model.has("_recordInteraction")){Adapt.trigger("questionView:recordInteraction",this)}}},{key:"showFeedback",value:function showFeedback(){if(this.model.get("_canShowFeedback")){Adapt.trigger("questionView:showFeedback",this)}else{Adapt.trigger("questionView:disabledFeedback",this)}}},{key:"onResetClicked",value:function onResetClicked(){this.setQuestionAsReset();this._runModelCompatibleFunction("resetUserAnswer");this.resetQuestion();this.model.checkCanSubmit();this._runModelCompatibleFunction("updateButtons");if(!this.model.get("_isReady"))return;var currentModel=Adapt.findById(Adapt.location._currentId);if(!(currentModel===null||currentModel===void 0?void 0:currentModel.get("_isReady")))return;Adapt.a11y.focusNext(this.$el)}},{key:"setQuestionAsReset",value:function setQuestionAsReset(){this.model.setQuestionAsReset();this.$(".component__widget").removeClass("is-submitted")}},{key:"resetQuestion",value:function resetQuestion(){}},{key:"refresh",value:function refresh(){this.model.set("_buttonState",this.model.getButtonState());if(this.model.shouldShowMarking&&this.model.get("_isSubmitted")){this.showMarking()}if(this.buttonsView){_.defer(this.buttonsView.refresh.bind(this.buttonsView))}}},{key:"onShowCorrectAnswerClicked",value:function onShowCorrectAnswerClicked(){this.setQuestionAsShowCorrect();this._runModelCompatibleFunction("updateButtons");this.showCorrectAnswer()}},{key:"setQuestionAsShowCorrect",value:function setQuestionAsShowCorrect(){this.$(".component__widget").addClass("is-submitted show-correct-answer").removeClass("show-user-answer")}},{key:"showCorrectAnswer",value:function showCorrectAnswer(){}},{key:"onHideCorrectAnswerClicked",value:function onHideCorrectAnswerClicked(){this.setQuestionAsHideCorrect();this._runModelCompatibleFunction("updateButtons");this.hideCorrectAnswer()}},{key:"setQuestionAsHideCorrect",value:function setQuestionAsHideCorrect(){this.$(".component__widget").addClass("is-submitted show-user-answer").removeClass("show-correct-answer")}},{key:"hideCorrectAnswer",value:function hideCorrectAnswer(){}},{key:"getLatency",value:function getLatency(){return null}},{key:"_runModelCompatibleFunction",value:function _runModelCompatibleFunction(name,lookForViewOnlyFunction){return this.model[name]()}}]);return QuestionView}(ComponentView$1);QuestionView._isQuestionType=true;var ViewOnlyQuestionViewCompatibilityLayer=function(_QuestionView){_inherits(ViewOnlyQuestionViewCompatibilityLayer,_QuestionView);var _super2=_createSuper(ViewOnlyQuestionViewCompatibilityLayer);function ViewOnlyQuestionViewCompatibilityLayer(){_classCallCheck(this,ViewOnlyQuestionViewCompatibilityLayer);return _super2.apply(this,arguments)}_createClass(ViewOnlyQuestionViewCompatibilityLayer,[{key:"getInteractionObject",value:function getInteractionObject(){Adapt.log.deprecated("QuestionView.getInteractionObject, please use QuestionModel.getInteractionObject");return this.model.getInteractionObject()}},{key:"getResponse",value:function getResponse(){Adapt.log.deprecated("QuestionView.getInteractionObject, please use QuestionModel.getInteractionObject");return this.model.getResponse()}},{key:"getResponseType",value:function getResponseType(){Adapt.log.deprecated("QuestionView.getResponseType, please use QuestionModel.getResponseType");return this.model.getResponseType()}},{key:"setupDefaultSettings",value:function setupDefaultSettings(){Adapt.log.deprecated("QuestionView.setupDefaultSettings, please use QuestionModel.setupDefaultSettings");return this.model.setupDefaultSettings()}},{key:"setupButtonSettings",value:function setupButtonSettings(){Adapt.log.deprecated("QuestionView.setupButtonSettings, please use QuestionModel.setupButtonSettings");return this.model.setupButtonSettings()}},{key:"setupWeightSettings",value:function setupWeightSettings(){Adapt.log.deprecated("QuestionView.setupWeightSettings, please use QuestionModel.setupWeightSettings");return this.model.setupWeightSettings()}},{key:"canSubmit",value:function canSubmit(){Adapt.log.deprecated("QuestionView.canSubmit, please use QuestionModel.canSubmit");return this.model.canSubmit()}},{key:"updateAttempts",value:function updateAttempts(){Adapt.log.deprecated("QuestionView.updateAttempts, please use QuestionModel.updateAttempts");return this.model.updateAttempts()}},{key:"storeUserAnswer",value:function storeUserAnswer(){Adapt.log.deprecated("QuestionView.storeUserAnswer, please use QuestionModel.storeUserAnswer");return this.model.storeUserAnswer()}},{key:"resetUserAnswer",value:function resetUserAnswer(){Adapt.log.deprecated("QuestionView.resetUserAnswer, please use QuestionModel.resetUserAnswer");return this.model.resetUserAnswer()}},{key:"markQuestion",value:function markQuestion(){if(this._isInViewOnlyCompatibleMode("isCorrect")){if(this.isCorrect()){this.model.set("_isCorrect",true)}else{this.model.set("_isCorrect",false)}}else{return this.model.markQuestion()}}},{key:"isCorrect",value:function isCorrect(){Adapt.log.deprecated("QuestionView.isCorrect, please use QuestionModel.isCorrect");return this.model.isCorrect()}},{key:"setScore",value:function setScore(){Adapt.log.deprecated("QuestionView.setScore, please use QuestionModel.setScore");return this.model.setScore()}},{key:"updateButtons",value:function updateButtons(){Adapt.log.deprecated("QuestionView.updateButtons, please use QuestionModel.updateButtons");return this.model.updateButtons()}},{key:"setupFeedback",value:function setupFeedback(){if(this._isInViewOnlyCompatibleMode("isPartlyCorrect")){if(this.model.get("_isCorrect")){this._runModelCompatibleFunction("setupCorrectFeedback")}else if(this.isPartlyCorrect()){this._runModelCompatibleFunction("setupPartlyCorrectFeedback")}else{this._runModelCompatibleFunction("setupIncorrectFeedback")}}else{this.model.setupFeedback()}}},{key:"isPartlyCorrect",value:function isPartlyCorrect(){Adapt.log.deprecated("QuestionView.isPartlyCorrect, please use QuestionModel.isPartlyCorrect");return this.model.isPartlyCorrect()}},{key:"setupCorrectFeedback",value:function setupCorrectFeedback(){Adapt.log.deprecated("QuestionView.setupCorrectFeedback, please use QuestionModel.setupCorrectFeedback");return this.model.setupCorrectFeedback()}},{key:"setupPartlyCorrectFeedback",value:function setupPartlyCorrectFeedback(){Adapt.log.deprecated("QuestionView.setupPartlyCorrectFeedback, please use QuestionModel.setupPartlyCorrectFeedback");return this.model.setupPartlyCorrectFeedback()}},{key:"setupIncorrectFeedback",value:function setupIncorrectFeedback(){Adapt.log.deprecated("QuestionView.setupIncorrectFeedback, please use QuestionModel.setupIncorrectFeedback");return this.model.setupIncorrectFeedback()}},{key:"_runModelCompatibleFunction",value:function _runModelCompatibleFunction(name,lookForViewOnlyFunction){if(this._isInViewOnlyCompatibleMode(name,lookForViewOnlyFunction)){return this[name]()}else{return this.model[name]()}}},{key:"_isInViewOnlyCompatibleMode",value:function _isInViewOnlyCompatibleMode(name,lookForViewOnlyFunction){var checkForFunction=lookForViewOnlyFunction||name;if(!this.constructor.prototype[checkForFunction])return false;var hasCompatibleVersion=ViewOnlyQuestionViewCompatibilityLayer.prototype.hasOwnProperty(checkForFunction);var usingCompatibleVersion=this.constructor.prototype[checkForFunction]===ViewOnlyQuestionViewCompatibilityLayer.prototype[checkForFunction];if(hasCompatibleVersion&&usingCompatibleVersion){switch(checkForFunction){case"setupFeedback":case"markQuestion":return true;}return false}return true}}]);return ViewOnlyQuestionViewCompatibilityLayer}(QuestionView);var QuestionView$1=__AMD("core/js/views/questionView",ViewOnlyQuestionViewCompatibilityLayer);var McqView=QuestionView$1.extend({events:{"focus .js-item-input":"onItemFocus","blur .js-item-input":"onItemBlur","change .js-item-input":"onItemSelect","keyup .js-item-input":"onKeyPress"},isCorrectAnswerShown:false,initialize:function(){QuestionView$1.prototype.initialize.apply(this,arguments);this.update=_.debounce(this.update.bind(this),1);this.listenTo(this.model,{"change:_isEnabled change:_isComplete change:_isSubmitted":this.update});this.listenTo(this.model.getChildren(),{"change:_isActive":this.update})},resetQuestionOnRevisit:function(){this.resetQuestion()},setupQuestion:function(){this.model.setupRandomisation()},onQuestionRendered:function(){this.setReadyStatus();this.update()},onKeyPress:function(event){if(event.which!==13)return;this.onItemSelect(event)},onItemFocus:function(event){if(!this.model.isInteractive())return;this.$(".js-item-label[for="+$(event.currentTarget).attr("id")+"]").addClass("is-highlighted")},onItemBlur:function(event){this.$(".js-item-label[for="+$(event.currentTarget).attr("id")+"]").removeClass("is-highlighted")},onItemSelect:function(event){if(!this.model.isInteractive())return;var index=$(event.currentTarget).data("adapt-index");var itemModel=this.model.getItem(index);var shouldSelect=!itemModel.get("_isActive");if(this.model.isSingleSelect()){shouldSelect=true;this.model.resetActiveItems()}else if(shouldSelect&&this.model.isAtActiveLimit()){this.model.getLastActiveItem().toggleActive(false)}itemModel.toggleActive(shouldSelect)},onCannotSubmit:function(){},showMarking:function(){this.update()},resetQuestion:function(){this.model.resetActiveItems();this.model.resetItems()},showCorrectAnswer:function(){this.isCorrectAnswerShown=true;this.update()},hideCorrectAnswer:function(){this.isCorrectAnswerShown=false;this.update()},update:function(){this.updateSelection();this.updateMarking()},updateSelection:function(){var isEnabled=this.model.get("_isEnabled");this.model.getChildren().each(function(itemModel){var isSelected=this.isCorrectAnswerShown?itemModel.get("_shouldBeSelected"):itemModel.get("_isActive");var index=itemModel.get("_index");this.$(".js-item-label").filter("[data-adapt-index=\""+index+"\"]").toggleClass("is-selected",isSelected).toggleClass("is-disabled",!isEnabled);this.$(".js-item-input").filter("[data-adapt-index=\""+index+"\"]").prop("checked",isSelected).prop("disabled",!isEnabled)}.bind(this))},updateMarking:function(){var isInteractive=this.model.isInteractive();var canShowMarking=this.model.get("_canShowMarking");var ariaLabels=Adapt.course.get("_globals")._accessibility._ariaLabels;this.model.getChildren().each(function(itemModel){var index=itemModel.get("_index");var $itemInput=this.$(".js-item-input").filter("[data-adapt-index=\""+index+"\"]");var $item=$itemInput.parents(".js-mcq-item");if(isInteractive||!canShowMarking){$item.removeClass("is-correct is-incorrect");$itemInput.attr("aria-label",$.a11y_normalize(itemModel.get("text")));return}var shouldBeSelected=itemModel.get("_shouldBeSelected");var isCorrect=Boolean(itemModel.get("_isCorrect"));var isActive=Boolean(itemModel.get("_isActive"));$item.toggleClass("is-correct",isCorrect).toggleClass("is-incorrect",!isCorrect);$itemInput.attr("aria-label",[shouldBeSelected?ariaLabels.correct:ariaLabels.incorrect,", ",isActive?ariaLabels.selectedAnswer:ariaLabels.unselectedAnswer,". ",$.a11y_normalize(itemModel.get("text"))].join(""))}.bind(this))}});var McqView$1=__AMD("components/adapt-contrib-mcq/js/mcqView",McqView);var BlendedItemsComponentQuestionModel=function(_QuestionModel){_inherits(BlendedItemsComponentQuestionModel,_QuestionModel);var _super=_createSuper(BlendedItemsComponentQuestionModel);function BlendedItemsComponentQuestionModel(){_classCallCheck(this,BlendedItemsComponentQuestionModel);return _super.apply(this,arguments)}_createClass(BlendedItemsComponentQuestionModel,[{key:"init",value:function init(){ItemsComponentModel.prototype.init.call(this);_get(_getPrototypeOf(BlendedItemsComponentQuestionModel.prototype),"init",this).call(this)}},{key:"reset",value:function reset(type,force){ItemsComponentModel.prototype.reset.call(this,type,force);_get(_getPrototypeOf(BlendedItemsComponentQuestionModel.prototype),"reset",this).call(this,type,force)}}]);return BlendedItemsComponentQuestionModel}(QuestionModel$1);Object.getOwnPropertyNames(ItemsComponentModel.prototype).forEach(function(name){if(name==="constructor"||name==="init"||name==="reset")return;Object.defineProperty(BlendedItemsComponentQuestionModel.prototype,name,{value:ItemsComponentModel.prototype[name]})});var ItemsQuestionModel=__AMD("core/js/models/itemsQuestionModel",function(_BlendedItemsComponen){_inherits(ItemsQuestionModel,_BlendedItemsComponen);var _super2=_createSuper(ItemsQuestionModel);function ItemsQuestionModel(){_classCallCheck(this,ItemsQuestionModel);return _super2.apply(this,arguments)}_createClass(ItemsQuestionModel,[{key:"init",value:function init(){_get(_getPrototypeOf(ItemsQuestionModel.prototype),"init",this).call(this);this.set("_isRadio",this.isSingleSelect());this.listenTo(this.getChildren(),"change:_isActive",this.checkCanSubmit);this.checkCanSubmit()}},{key:"restoreUserAnswers",value:function restoreUserAnswers(){if(!this.get("_isSubmitted"))return;var itemModels=this.getChildren();var userAnswer=this.get("_userAnswer");itemModels.each(function(item){item.toggleActive(userAnswer[item.get("_index")])});this.setQuestionAsSubmitted();this.markQuestion();this.setScore();this.setupFeedback()}},{key:"setupRandomisation",value:function setupRandomisation(){if(!this.get("_isRandom")||!this.get("_isEnabled"))return;var children=this.getChildren();children.set(children.shuffle())}},{key:"canSubmit",value:function canSubmit(){var activeItems=this.getActiveItems();return activeItems.length>0}},{key:"storeUserAnswer",value:function storeUserAnswer(){var items=this.getChildren().slice(0);items.sort(function(a,b){return a.get("_index")-b.get("_index")});var userAnswer=items.map(function(itemModel){return itemModel.get("_isActive")});this.set("_userAnswer",userAnswer)}},{key:"isCorrect",value:function isCorrect(){var props={_numberOfRequiredAnswers:0,_numberOfIncorrectAnswers:0,_isAtLeastOneCorrectSelection:false,_numberOfCorrectAnswers:0};this.getChildren().each(function(itemModel){var itemShouldBeActive=itemModel.get("_shouldBeSelected");if(itemShouldBeActive){props._numberOfRequiredAnswers++}if(!itemModel.get("_isActive"))return;if(!itemShouldBeActive){props._numberOfIncorrectAnswers++;return}props._isAtLeastOneCorrectSelection=true;props._numberOfCorrectAnswers++;itemModel.set("_isCorrect",true)});this.set(props);var hasRightNumberOfCorrectAnswers=props._numberOfCorrectAnswers===props._numberOfRequiredAnswers;var hasNoIncorrectAnswers=!props._numberOfIncorrectAnswers;return hasRightNumberOfCorrectAnswers&&hasNoIncorrectAnswers}},{key:"setScore",value:function setScore(){var questionWeight=this.get("_questionWeight");var answeredCorrectly=this.get("_isCorrect");var score=answeredCorrectly?questionWeight:0;this.set("_score",score)}},{key:"setupFeedback",value:function setupFeedback(){if(!this.has("_feedback"))return;if(this.get("_isCorrect")){this.setupCorrectFeedback();return}if(this.isPartlyCorrect()){this.setupPartlyCorrectFeedback();return}var activeItem=this.getActiveItem();if(this.isSingleSelect()&&activeItem.get("feedback")){this.setupIndividualFeedback(activeItem);return}this.setupIncorrectFeedback()}},{key:"setupIndividualFeedback",value:function setupIndividualFeedback(selectedItem){this.set({feedbackTitle:this.getFeedbackTitle(this.get("_feedback")),feedbackMessage:selectedItem.get("feedback")})}},{key:"isPartlyCorrect",value:function isPartlyCorrect(){return this.get("_isAtLeastOneCorrectSelection")}},{key:"resetUserAnswer",value:function resetUserAnswer(){this.set("_userAnswer",[])}},{key:"isAtActiveLimit",value:function isAtActiveLimit(){var selectedItems=this.getActiveItems();return selectedItems.length===this.get("_selectable")}},{key:"isSingleSelect",value:function isSingleSelect(){return this.get("_selectable")===1}},{key:"getLastActiveItem",value:function getLastActiveItem(){var selectedItems=this.getActiveItems();return selectedItems[selectedItems.length-1]}},{key:"resetItems",value:function resetItems(){this.resetActiveItems();this.set("_isAtLeastOneCorrectSelection",false)}},{key:"getInteractionObject",value:function getInteractionObject(){var interactions={correctResponsesPattern:[],choices:[]};interactions.choices=this.getChildren().map(function(itemModel){return{id:(itemModel.get("_index")+1).toString(),description:itemModel.get("text")}});var correctItems=this.getChildren().filter(function(itemModel){return itemModel.get("_shouldBeSelected")});interactions.correctResponsesPattern=[correctItems.map(function(itemModel){return String(itemModel.get("_index")+1)}).join("[,]")];return interactions}},{key:"getResponse",value:function getResponse(){var activeItems=this.getActiveItems();var activeIndexes=activeItems.map(function(itemModel){return itemModel.get("_index")+1});return activeIndexes.join(",")}},{key:"getResponseType",value:function getResponseType(){return"choice"}},{key:"getCorrectAnswerAsText",value:function getCorrectAnswerAsText(){var globals=Adapt.course.get("_globals")._components["_"+this.get("_component")];var ariaAnswer;var correctAnswer;if(this.isSingleSelect()){ariaAnswer=globals.ariaCorrectAnswer;var correctOption=this.getChildren().findWhere({_shouldBeSelected:true});correctAnswer=correctOption.get("text")}else{ariaAnswer=globals.ariaCorrectAnswers;var correctOptions=this.getChildren().where({_shouldBeSelected:true});correctAnswer=correctOptions.map(function(correctOption){return correctOption.get("text")}).join("<br>")}return Handlebars.compile(ariaAnswer)({correctAnswer:correctAnswer})}},{key:"getUserAnswerAsText",value:function getUserAnswerAsText(){var globals=Adapt.course.get("_globals")._components["_"+this.get("_component")];var ariaAnswer;var userAnswer;var selectedItems=this.getActiveItems();if(selectedItems.length===1){ariaAnswer=globals.ariaUserAnswer;userAnswer=selectedItems[0].get("text")}else{ariaAnswer=globals.ariaUserAnswers;userAnswer=selectedItems.map(function(selectedItem){return selectedItem.get("text")}).join("<br>")}return Handlebars.compile(ariaAnswer)({userAnswer:userAnswer})}}]);return ItemsQuestionModel}(BlendedItemsComponentQuestionModel));var Mcq=__AMD("components/adapt-contrib-mcq/js/adapt-contrib-mcq",Adapt.register("mcq",{view:McqView$1,model:ItemsQuestionModel.extend({})}));var Gmcq=Mcq.view.extend({setupQuestion:function(){Mcq.view.prototype.setupQuestion.call(this);this.listenTo(Adapt,{"device:changed":this.resizeImage,"device:resize":this.onDeviceResize})},onQuestionRendered:function(){this.resizeImage(Adapt.device.screenSize);this.setUpColumns();this.$(".js-item-label").imageready(this.setReadyStatus.bind(this))},onDeviceResize:function(){this.setUpColumns()},resizeImage:function(width){var imageWidth=width==="medium"?"small":width;this.$(".js-item-label").each(function(index){var $img=$(this).find("img");var newSrc=$img.attr("data-"+imageWidth);if(!newSrc)return;$img.attr("src",newSrc)})},setUpColumns:function(){var columns=this.model.get("_columns");if(!columns)return;var isLarge=Adapt.device.screenSize==="large";this.$el.toggleClass("has-column-layout",isLarge);this.$(".js-mcq-item").css("width",isLarge?100/columns+"%":"")}},{template:"gmcq"});__AMD("components/adapt-contrib-gmcq/js/adapt-contrib-gmcq",Adapt.register("gmcq",{view:Gmcq,model:Mcq.model.extend({})}));var GraphicView=function(_ComponentView){_inherits(GraphicView,_ComponentView);var _super=_createSuper(GraphicView);function GraphicView(){_classCallCheck(this,GraphicView);return _super.apply(this,arguments)}_createClass(GraphicView,[{key:"preRender",value:function preRender(){this.listenTo(Adapt,"device:changed",this.resizeImage);this.checkIfResetOnRevisit()}},{key:"postRender",value:function postRender(){this.resizeImage(Adapt.device.screenSize,true)}},{key:"checkIfResetOnRevisit",value:function checkIfResetOnRevisit(){var isResetOnRevisit=this.model.get("_isResetOnRevisit");if(isResetOnRevisit){this.model.reset(isResetOnRevisit)}}},{key:"resizeImage",value:function resizeImage(width,setupInView){var _this=this;var imageWidth=width==="medium"?"small":width;var imageSrc=this.model.get("_graphic")?this.model.get("_graphic")[imageWidth]:"";this.$(".js-graphic-set-image-src").attr("src",imageSrc);this.$(".graphic__widget").imageready(function(){_this.setReadyStatus();if(setupInView){_this.setupInviewCompletion(".graphic__widget")}})}}]);return GraphicView}(ComponentView$1);GraphicView.template="graphic";__AMD("components/adapt-contrib-graphic/js/adapt-contrib-graphic",Adapt.register("graphic",{model:ComponentModel$1.extend({}),view:GraphicView}));var HotgraphicPopupView=function(_Backbone$View){_inherits(HotgraphicPopupView,_Backbone$View);var _super=_createSuper(HotgraphicPopupView);function HotgraphicPopupView(){_classCallCheck(this,HotgraphicPopupView);return _super.apply(this,arguments)}_createClass(HotgraphicPopupView,[{key:"className",value:function className(){return"hotgraphic-popup"}},{key:"events",value:function events(){return{"click .js-hotgraphic-popup-close":"closePopup","click .js-hotgraphic-controls-click":"onControlClick"}}},{key:"initialize",value:function initialize(){var _get2;for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}(_get2=_get(_getPrototypeOf(HotgraphicPopupView.prototype),"initialize",this)).call.apply(_get2,[this].concat(args));this.onControlClick=_.debounce(this.onControlClick.bind(this),100);this.listenToOnce(Adapt,"notify:opened",this.onOpened);this.listenTo(this.model.get("_children"),{"change:_isActive":this.onItemsActiveChange,"change:_isVisited":this.onItemsVisitedChange});this.render()}},{key:"onOpened",value:function onOpened(){this.applyNavigationClasses(this.model.getActiveItem().get("_index"));this.updatePageCount();this.handleTabs()}},{key:"applyNavigationClasses",value:function applyNavigationClasses(index){var itemCount=this.model.get("_items").length;var canCycleThroughPagination=this.model.get("_canCycleThroughPagination");var shouldEnableBack=index>0||canCycleThroughPagination;var shouldEnableNext=index<itemCount-1||canCycleThroughPagination;var $controls=this.$(".hotgraphic-popup__controls");this.$("hotgraphic-popup__nav").toggleClass("first",!shouldEnableBack).toggleClass("last",!shouldEnableNext);Adapt.a11y.toggleAccessibleEnabled($controls.filter(".back"),shouldEnableBack);Adapt.a11y.toggleAccessibleEnabled($controls.filter(".next"),shouldEnableNext)}},{key:"updatePageCount",value:function updatePageCount(){var template=Adapt.course.get("_globals")._components._hotgraphic.popupPagination||"{{itemNumber}} / {{totalItems}}";var labelText=Handlebars.compile(template)({itemNumber:this.model.getActiveItem().get("_index")+1,totalItems:this.model.get("_items").length});this.$(".hotgraphic-popup__count").html(labelText)}},{key:"handleTabs",value:function handleTabs(){Adapt.a11y.toggleHidden(this.$(".hotgraphic-popup__item:not(.is-active)"),true);Adapt.a11y.toggleHidden(this.$(".hotgraphic-popup__item.is-active"),false)}},{key:"onItemsActiveChange",value:function onItemsActiveChange(item,_isActive){if(!_isActive)return;var index=item.get("_index");this.updatePageCount();this.applyItemClasses(index);this.handleTabs();this.handleFocus(index)}},{key:"applyItemClasses",value:function applyItemClasses(index){this.$(".hotgraphic-popup__item[data-index=\"".concat(index,"\"]")).addClass("is-active").removeAttr("aria-hidden");this.$(".hotgraphic-popup__item[data-index=\"".concat(index,"\"] .hotgraphic-popup__item-title")).attr("id","notify-heading");this.$(".hotgraphic-popup__item:not([data-index=\"".concat(index,"\"])")).removeClass("is-active").attr("aria-hidden","true");this.$(".hotgraphic-popup__item:not([data-index=\"".concat(index,"\"]) .hotgraphic-popup__item-title")).removeAttr("id")}},{key:"handleFocus",value:function handleFocus(index){Adapt.a11y.focusFirst(this.$(".hotgraphic-popup__inner .is-active"));this.applyNavigationClasses(index)}},{key:"onItemsVisitedChange",value:function onItemsVisitedChange(item,_isVisited){if(!_isVisited)return;this.$(".hotgraphic-popup__item").filter("[data-index=\"".concat(item.get("_index"),"\"]")).addClass("is-visited")}},{key:"render",value:function render(){var data=this.model.toJSON();data.view=this;var template=Handlebars.templates[this.constructor.template];this.$el.html(template(data))}},{key:"closePopup",value:function closePopup(){Adapt.trigger("notify:close")}},{key:"onControlClick",value:function onControlClick(event){var direction=$(event.currentTarget).data("direction");var index=this.getNextIndex(direction);if(index===-1)return;this.setItemState(index)}},{key:"getNextIndex",value:function getNextIndex(direction){var index=this.model.getActiveItem().get("_index");var lastIndex=this.model.get("_items").length-1;switch(direction){case"back":if(index>0)return--index;if(this.model.get("_canCycleThroughPagination"))return lastIndex;break;case"next":if(index<lastIndex)return++index;if(this.model.get("_canCycleThroughPagination"))return 0;}return-1}},{key:"setItemState",value:function setItemState(index){this.model.getActiveItem().toggleActive();var nextItem=this.model.getItem(index);nextItem.toggleActive();nextItem.toggleVisited(true)}}]);return HotgraphicPopupView}(Backbone.View);HotgraphicPopupView.template="hotgraphicPopup";var HotgraphicPopupView$1=__AMD("components/adapt-contrib-hotgraphic/js/hotgraphicPopupView",HotgraphicPopupView);var HotGraphicView=function(_ComponentView){_inherits(HotGraphicView,_ComponentView);var _super=_createSuper(HotGraphicView);function HotGraphicView(){_classCallCheck(this,HotGraphicView);return _super.apply(this,arguments)}_createClass(HotGraphicView,[{key:"events",value:function events(){return{"click .js-hotgraphic-item-click":"onPinClicked"}}},{key:"initialize",value:function initialize(){var _get2;for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}(_get2=_get(_getPrototypeOf(HotGraphicView.prototype),"initialize",this)).call.apply(_get2,[this].concat(args));this.setUpViewData();this.setUpModelData();this.setUpEventListeners();this.checkIfResetOnRevisit()}},{key:"setUpViewData",value:function setUpViewData(){this.popupView=null;this._isPopupOpen=false}},{key:"setUpModelData",value:function setUpModelData(){if(this.model.get("_canCycleThroughPagination")===undefined){this.model.set("_canCycleThroughPagination",false)}}},{key:"setUpEventListeners",value:function setUpEventListeners(){this.listenTo(Adapt,"device:changed",this.reRender);this.listenTo(this.model.get("_children"),{"change:_isActive":this.onItemsActiveChange,"change:_isVisited":this.onItemsVisitedChange})}},{key:"reRender",value:function reRender(){if(Adapt.device.screenSize==="large"||this.model.get("_isNarrativeOnMobile")===false)return;this.replaceWithNarrative()}},{key:"replaceWithNarrative",value:function replaceWithNarrative(){var NarrativeView=Adapt.getViewClass("narrative");if(!NarrativeView)return;var model=this.prepareNarrativeModel();var newNarrative=new NarrativeView({model:model});var $container=Adapt.findViewByModelId(model.get("_parentId")).$el.find(".component__container");$container.append(newNarrative.$el);this.remove();_.defer(function(){Adapt.trigger("device:resize")})}},{key:"prepareNarrativeModel",value:function prepareNarrativeModel(){this.model.set({_component:"narrative",_wasHotgraphic:true,originalBody:this.model.get("body"),originalInstruction:this.model.get("instruction")});var activeItem=this.model.getActiveItem();if(!activeItem){this.model.getItem(0).toggleActive(true)}if(this.model.get("mobileBody")){this.model.set("body",this.model.get("mobileBody"))}if(this.model.get("mobileInstruction")){this.model.set("instruction",this.model.get("mobileInstruction"))}return this.model}},{key:"onItemsActiveChange",value:function onItemsActiveChange(model,_isActive){this.getItemElement(model).toggleClass("is-active",_isActive)}},{key:"getItemElement",value:function getItemElement(model){var index=model.get("_index");return this.$(".js-hotgraphic-item-click").filter("[data-index=\"".concat(index,"\"]"))}},{key:"onItemsVisitedChange",value:function onItemsVisitedChange(model,_isVisited){if(!_isVisited)return;var $pin=this.getItemElement(model);var visitedLabel=" ".concat(this.model.get("_globals")._accessibility._ariaLabels.visited,".");$pin.find(".aria-label").each(function(index,el){el.innerHTML+=visitedLabel});$pin.addClass("is-visited")}},{key:"checkIfResetOnRevisit",value:function checkIfResetOnRevisit(){var isResetOnRevisit=this.model.get("_isResetOnRevisit");if(isResetOnRevisit){this.model.reset(isResetOnRevisit)}}},{key:"preRender",value:function preRender(){if(Adapt.device.screenSize==="large"){this.render();return}this.reRender()}},{key:"postRender",value:function postRender(){this.$(".hotgraphic__widget").imageready(this.setReadyStatus.bind(this));if(this.model.get("_setCompletionOn")==="inview"){this.setupInviewCompletion(".component__widget")}}},{key:"onPinClicked",value:function onPinClicked(event){var item=this.model.getItem($(event.currentTarget).data("index"));item.toggleActive(true);item.toggleVisited(true);this.openPopup()}},{key:"openPopup",value:function openPopup(){if(this._isPopupOpen)return;this._isPopupOpen=true;this.popupView=new HotgraphicPopupView$1({model:this.model});Adapt.notify.popup({_view:this.popupView,_isCancellable:true,_showCloseButton:false,_classes:"hotgraphic "+this.model.get("_classes")});this.listenToOnce(Adapt,{"popup:closed":this.onPopupClosed})}},{key:"onPopupClosed",value:function onPopupClosed(){this.model.getActiveItem().toggleActive();this._isPopupOpen=false}}]);return HotGraphicView}(ComponentView$1);HotGraphicView.template="hotgraphic";var HotgraphicView=__AMD("components/adapt-contrib-hotgraphic/js/hotgraphicView",HotGraphicView);__AMD("components/adapt-contrib-hotgraphic/js/adapt-contrib-hotgraphic",Adapt.register("hotgraphic",{model:ItemsComponentModel.extend({}),view:HotgraphicView}));var DropDownItem=Backbone.View.extend({events:{"click":"onClick","click *":"onClick"},initialize:function(settings){this.settings=settings;this.$inner=this.$(".js-dropdown-list-item-inner")},isPlaceholder:function(){return this.$el.is("[hidden]")},parent:function(){return this.settings.parent},onClick:function(event){var parent=this.parent();event.preventDefault();this.select().scrollTo();parent.$button.focus()},getValue:function(){return this.$el.attr("value").trim()},select:function(){var parent=this.parent();parent.deselectAll();parent.setActiveDescendantId(this.el.id);this.$el.attr({selected:"","aria-selected":"true"});parent.$inner.html(this.$el.attr("text"));var value=this.isPlaceholder()?"":this.getValue();parent.$input.val(value).trigger("change");parent.trigger("change",parent);return this},deselect:function(){if(!this.isSelected())return this;var parent=this.parent();parent.removeActiveDescendantId();this.$el.removeAttr("selected");this.$el.attr("aria-selected","false");parent.$inner.html("");parent.$input.val("").trigger("change");parent.trigger("change",parent);return this},reselect:function(){var parent=this.parent();parent.setActiveDescendantId(this.$el[0].id);if(this.isSelected())return this;this.select();return this},isSelected:function(){return Boolean(this.$el.attr("selected"))},getIndex:function(){var parent=this.parent();return _.findIndex(parent.options,function(option){return option===this}.bind(this))},getNext:function(){var parent=this.parent();return parent.options[this.getIndex()+1]},getPrevious:function(){var parent=this.parent();return parent.options[this.getIndex()-1]},getFirst:function(){var parent=this.parent();return parent.options[0]},getLast:function(){var parent=this.parent();return parent.options[parent.options.length-1]},scrollTo:function(){var parent=this.parent();parent.settings.scrollToItem.call(parent,this)},destroy:function(){var parent=this.parent();this.remove();if(this.isPlaceholder()){parent.placeholder=null}else{for(var i=0,l=parent.options.length;i<l;i++){var item=parent.options[i];if(item!==this)continue;parent.options.splice(i,1);break}}delete this.settings}});var DropDownOption=__AMD("components/adapt-contrib-matching/js/dropdownOption",DropDownItem);var DropDown=Backbone.View.extend({initialize:function(settings){_.bindAll(this,"onStartInteraction","onButtonClick","onListBlur","onKeyDown");this.settings=_.defaults(settings,this.getDefaults());this.placeholder=null;this.options=[];this.setUpElements();this.setUpItems();this.select(this.settings.value);this.addEventListeners();this.toggleOpen(false);this.settings.load.call(this,this);this.trigger("load",this)},getDefaults:function(){return{load:DropDown.defaults.load,openList:DropDown.defaults.openList,closeList:DropDown.defaults.closeList,scrollToItem:DropDown.defaults.scrollToItem}},setUpElements:function(){this.$list=this.$(".js-dropdown-list");this.$button=this.$(".js-dropdown-btn");this.$inner=this.$button.find(".js-dropdown-inner");this.$input=this.$(".js-data-output")},setUpItems:function(){var $options=this.$(".js-dropdown-list-item");$options.each(function(index,el){var option=new DropDownOption({parent:this,el:el});if(option.isPlaceholder()){this.placeholder=option;return}this.options.push(option)}.bind(this))},addEventListeners:function(){this.$button.on({"mousedown touchstart":this.onStartInteraction,click:this.onButtonClick});this.$list.on("blur",this.onListBlur);$(document).on("keydown",this.onKeyDown)},onStartInteraction:function(){this.wasOpen=this.isOpen()},deselectAll:function(){this.placeholder.deselect();this.options.forEach(function(option){option.deselect()})},onButtonClick:function(event){if(this.wasOpen||this.isOpen()){this.wasOpen=false;return}this.toggleOpen();var option=this.getFirstSelectedItem()||this.placeholder;if(!option)return;option.reselect();option.scrollTo();this.$list.focus()},isOpen:function(){return!this.$list.hasClass("u-display-none")},toggleOpen:function(open){if(open===undefined)open=!this.isOpen();if(open)clearTimeout(this.blurTimeout);this.$button.attr("aria-expanded",open?"true":"false");var name=open?"openList":"closeList";this.settings[name].call(this,this);this.trigger(name,this)},onListBlur:function(event){var handleBlur=function(){this.toggleOpen(false);this.removeActiveDescendantId()}.bind(this);this.blurTimeout=setTimeout(handleBlur,100)},onKeyDown:function(event){if(!this.isOpen())return;var option=this.getFirstSelectedItem()||this.placeholder;switch(event.keyCode){case 38:event.preventDefault();option=option.getPrevious()||option.getLast();break;case 40:event.preventDefault();option=option.getNext()||option.getFirst();break;case 13:case 32:case 27:event.preventDefault();this.$button.focus();return;default:return;}option.select().scrollTo()},getFirstSelectedItem:function(){return _.find(this.options,function(option){return option.isSelected()})},setActiveDescendantId:function(id){this.$list.attr("aria-activedescendant",id)},removeActiveDescendantId:function(){this.$list.removeAttr("aria-activedescendant")},select:function(value){value=String(value);var option=_.find(this.options,function(option){return option.getValue()===value});if(option){option.select();return}this.placeholder.select()},toggleDisabled:function(value){if(value===undefined){value=!this.$input.attr("disabled")}if(value===false){this.$input.removeAttr("disabled");this.$button.removeAttr("disabled").removeClass("is-disabled");this.$el.removeAttr("disabled");return}this.$input.attr("disabled","");this.$button.attr("disabled","").addClass("is-disabled");this.$el.attr("disabled","")},isEmpty:function(){return!this.getFirstSelectedItem()},val:function(){return this.$input.val()},destroy:function(){this.removeEventListeners();this.$el.remove();delete this.options;delete this.$input;delete this.$inner;delete this.$button;delete this.$list;delete this.$el},removeEventListeners:function(){this.$button.off({"mousedown touchstart":this.onStartInteraction,click:this.onButtonClick});this.$list.off("blur",this.onListBlur);$(document).off("keydown",this.onKeyDown)}},{defaults:{load:function(){},openList:function(){this.$list.css({top:"",left:this.$button[0].offsetLeft,width:this.$button.outerWidth()}).addClass("u-visibility-hidden").removeClass("u-display-none");var offset=this.$list[0].getBoundingClientRect();var height=this.$list.height();var windowHeight=$(window).height();var isOffscreen=offset.top+height>windowHeight;this.$list.css("top",isOffscreen?-height:"").removeClass("u-visibility-hidden").focus()},closeList:function(){this.$list.removeClass("u-visibility-hidden").addClass("u-display-none").css("top","")},scrollToItem:function(option){var height=this.$list[0].clientHeight;var pos=option.$el[0].offsetTop-height/2;this.$list[0].scrollTop=pos}}});var DropDown$1=__AMD("components/adapt-contrib-matching/js/dropdown",DropDown);var MatchingView=QuestionView$1.extend({dropdowns:null,disableQuestion:function(){this.dropdowns.forEach(function(dropdown){dropdown.toggleDisabled(true)})},enableQuestion:function(){this.dropdowns.forEach(function(dropdown){dropdown.toggleDisabled(false)})},resetQuestionOnRevisit:function(){this.resetQuestion()},setupQuestion:function(){this.listenToOnce(Adapt.parentView,"postRemove",this.onPostRemove);this.model.setupRandomisation()},onPostRemove:function(){this.dropdowns.forEach(function(dropdown){dropdown.off("change",this.onOptionSelected);dropdown.destroy()},this)},onQuestionRendered:function(){this.setReadyStatus();this.setUpDropdowns()},setUpDropdowns:function(){_.bindAll(this,"onOptionSelected");this.dropdowns=[];var items=this.model.get("_items");this.$(".matching__item").each(function(i,el){var item=items[i];var selectedOption=_.find(item._options,function(option){return option._isSelected});var value=selectedOption?selectedOption._index:null;var dropdown=new DropDown$1({el:$(el).find(".dropdown")[0],placeholder:this.model.get("placeholder"),value:value});this.dropdowns.push(dropdown);dropdown.on("change",this.onOptionSelected)}.bind(this));this.enableQuestion();if(this.model.get("_isEnabled")!==true){this.disableQuestion()}},onCannotSubmit:function(){this.dropdowns.forEach(function(dropdown){if(!dropdown.isEmpty())return;dropdown.$el.parents(".matching__select-container").addClass("has-error")})},onOptionSelected:function(dropdown){if(this.model.get("_isInteractionComplete"))return;var $container=dropdown.$el.parents(".matching__select-container");$container.removeClass("error");var itemIndex=dropdown.$el.parents(".matching__item").index();if(dropdown.isEmpty())return;var optionIndex=parseInt(dropdown.val());this.model.setOptionSelected(itemIndex,optionIndex,true)},showMarking:function(){if(!this.model.get("_canShowMarking"))return;this.model.get("_items").forEach(function(item,i){var $item=this.$(".matching__item").eq(i);$item.removeClass("is-correct is-incorrect").addClass(item._isCorrect?"is-correct":"is-incorrect")},this)},resetQuestion:function(){this.$(".matching__item").removeClass("is-correct is-incorrect");this.model.set("_isAtLeastOneCorrectSelection",false);var resetAll=this.model.get("_shouldResetAllAnswers");this.model.get("_items").forEach(function(item,index){if(item._isCorrect&&resetAll===false)return;this.selectValue(index,null);item._options.forEach(function(option,index){option._isSelected=false});item._selected=null},this)},showCorrectAnswer:function(){this.model.get("_items").forEach(function(item,index){var correctOption=_.findWhere(item._options,{_isCorrect:true});this.selectValue(index,correctOption._index)},this)},hideCorrectAnswer:function(){var answerArray=this.model.has("_tempUserAnswer")?this.model.get("_tempUserAnswer"):this.model.get("_userAnswer");this.model.get("_items").forEach(function(item,index){var key=answerArray[index];var value=item._options[key]._index;this.selectValue(index,value)},this)},selectValue:function(index,optionIndex){if(!this.dropdowns)return;var dropdown=this.dropdowns[index];if(!dropdown)return;dropdown.select(optionIndex)}});var MatchingView$1=__AMD("components/adapt-contrib-matching/js/matchingView",MatchingView);var MatchingModel=QuestionModel$1.extend({init:function(){QuestionModel$1.prototype.init.call(this);this.setupQuestionItemIndexes()},setupQuestionItemIndexes:function(){this.get("_items").forEach(function(item,index){if(item._index===undefined){item._index=index;item._selected=false}item._options.forEach(function(option,index){if(option._index===undefined){option._index=index;option._isSelected=false}})})},setupRandomisation:function(){if(!this.get("_isRandom")||!this.get("_isEnabled"))return;this.get("_items").forEach(function(item){item._options=_.shuffle(item._options)})},restoreUserAnswers:function(){if(!this.get("_isSubmitted"))return;var userAnswer=this.get("_userAnswer");this.get("_items").forEach(function(item,index){item._options.forEach(function(option,index){if(option._index===userAnswer[item._index]){option._isSelected=true;item._selected=option}})});this.setQuestionAsSubmitted();this.checkCanSubmit();this.markQuestion();this.setScore();this.setupFeedback()},canSubmit:function(){var canSubmit=_.every(this.get("_items"),function(item){return _.findWhere(item._options,{"_isSelected":true})!==undefined});return canSubmit},setOptionSelected:function(itemIndex,optionIndex,isSelected){var item=this.get("_items")[itemIndex];var option=_.findWhere(item._options,{"_index":optionIndex});option._isSelected=isSelected;item._selected=option;this.checkCanSubmit()},storeUserAnswer:function(){var userAnswer=new Array(this.get("_items").length);var tempUserAnswer=new Array(this.get("_items").length);this.get("_items").forEach(function(item,index){var optionIndex=_.findIndex(item._options,function(o){return o._isSelected});tempUserAnswer[item._index]=optionIndex;userAnswer[item._index]=item._options[optionIndex]._index},this);this.set({_userAnswer:userAnswer,_tempUserAnswer:tempUserAnswer})},isCorrect:function(){var numberOfCorrectAnswers=0;this.get("_items").forEach(function(item,index){var isCorrect=item._selected&&item._selected._isCorrect;if(!isCorrect){item._isCorrect=false;return}numberOfCorrectAnswers++;item._isCorrect=true;this.set({_numberOfCorrectAnswers:numberOfCorrectAnswers,_isAtLeastOneCorrectSelection:true})},this);this.set("_numberOfCorrectAnswers",numberOfCorrectAnswers);if(numberOfCorrectAnswers===this.get("_items").length){return true}return false},setScore:function(){var questionWeight=this.get("_questionWeight");if(this.get("_isCorrect")){this.set("_score",questionWeight);return}var numberOfCorrectAnswers=this.get("_numberOfCorrectAnswers");var itemLength=this.get("_items").length;var score=questionWeight*numberOfCorrectAnswers/itemLength;this.set("_score",score)},isPartlyCorrect:function(){return this.get("_isAtLeastOneCorrectSelection")},resetUserAnswer:function(){this.set("_userAnswer",[])},getInteractionObject:function(){var interactions={correctResponsesPattern:null,source:null,target:null};var items=this.get("_items");interactions.correctResponsesPattern=[items.map(function(item,questionIndex){questionIndex=questionIndex+1;return[questionIndex,item._options.filter(function(item){return item._isCorrect}).map(function(item){return questionIndex+"_"+(item._index+1).toString()})].join("[.]")}).join("[,]")];interactions.source=_.flatten(items.map(function(item){return{id:(item._index+1).toString(),description:item.text}}));interactions.target=_.flatten(items.map(function(item,index){index=index+1;return item._options.map(function(option){return{id:index+"_"+(option._index+1),description:option.text}})}));return interactions},getResponse:function(){var responses=[];this.get("_userAnswer").forEach(function(userAnswer,index){responses.push(index+1+"."+(userAnswer+1))});return responses.join("#")},getResponseType:function(){return"matching"}});var MatchingModel$1=__AMD("components/adapt-contrib-matching/js/matchingModel",MatchingModel);__AMD("components/adapt-contrib-matching/js/adapt-contrib-matching",Adapt.register("matching",{view:MatchingView$1,model:MatchingModel$1}));var mepPrototype=$.extend({},mejs.MediaElementPlayer.prototype);$.extend(mejs.MediaElementPlayer.prototype,{detectFullscreenMode:function(){var vendorPrefix=this.getVendorPrefix();var fsEventName="on"+vendorPrefix+"fullscreenchange";if(document[fsEventName]===null){document[fsEventName]=function fullScreenEventHandler(){var elementName=vendorPrefix===""?"fullscreenElement":vendorPrefix+"FullscreenElement";if(document[elementName]!==null){$.inview.lock("mediaelement");Adapt.trigger("media:fullscreen:enter")}else{$.inview.unlock("mediaelement");Adapt.trigger("media:fullscreen:exit")}}}return mepPrototype.detectFullscreenMode.apply(this,arguments)},getVendorPrefix:function(){var browser=Adapt.device.browser;if(browser==="internet explorer"){return"ms"}if(browser==="microsoft edge"||browser==="safari"){return"webkit"}return""}});var froogaloopAdded=false;function purge(d){var a=d.attributes;if(a){for(var i=a.length-1;i>=0;i-=1){var n=a[i].name;if(typeof d[n]==="function"){d[n]=null}}}a=d.childNodes;if(a){for(var _i=0,count=a.length;_i<count;_i+=1){purge(d.childNodes[_i])}}}Object.assign(window.mejs.MepDefaults,{keyActions:[],defaultSeekForwardInterval:function(duration){if(_typeof(duration)==="object")return duration.duration*0.05;return duration*0.05},defaultSeekBackwardInterval:function(duration){if(_typeof(duration)==="object")return duration.duration*0.05;return duration*0.05}});var MediaView=function(_ComponentView){_inherits(MediaView,_ComponentView);var _super=_createSuper(MediaView);function MediaView(){_classCallCheck(this,MediaView);return _super.apply(this,arguments)}_createClass(MediaView,[{key:"events",value:function events(){return{"click .js-media-inline-transcript-toggle":"onToggleInlineTranscript","click .js-media-external-transcript-click":"onExternalTranscriptClicked","click .js-skip-to-transcript":"onSkipToTranscript"}}},{key:"className",value:function className(){var classes=_get(_getPrototypeOf(MediaView.prototype),"className",this).call(this);var playerOptions=this.model.get("_playerOptions");if(playerOptions&&playerOptions.toggleCaptionsButtonWhenOnlyOne){classes+=" toggle-captions"}return classes}},{key:"preRender",value:function preRender(){this.listenTo(Adapt,{"device:resize":this.onScreenSizeChanged,"device:changed":this.onDeviceChanged,"media:stop":this.onMediaStop});_.bindAll(this,"onMediaElementPlay","onMediaElementPause","onMediaElementEnded","onMediaElementTimeUpdate","onMediaElementSeeking","onOverlayClick","onMediaElementClick");this.model.set({_isMediaEnded:false,_isMediaPlaying:false});if(this.model.get("_media").source){var media=this.model.get("_media");if(window.location.protocol==="https:"&&media.source.indexOf("http:")===0){media.source=media.source.replace(/^http:/,"https:")}this.model.set("_media",media)}this.checkIfResetOnRevisit()}},{key:"postRender",value:function postRender(){this.setupPlayer();this.addMejsButtonClass()}},{key:"addMejsButtonClass",value:function addMejsButtonClass(){this.$(".mejs-overlay-button").addClass("icon")}},{key:"setupPlayer",value:function setupPlayer(){var _this=this;if(!this.model.get("_playerOptions"))this.model.set("_playerOptions",{});var modelOptions=this.model.get("_playerOptions");if(modelOptions.pluginPath===undefined){_.extend(modelOptions,{pluginPath:"https://cdnjs.cloudflare.com/ajax/libs/mediaelement/2.21.2/",flashName:"flashmediaelement-cdn.swf",flashScriptAccess:"always"})}if(modelOptions.features===undefined){modelOptions.features=["playpause","progress","current","duration"];if(this.model.get("_useClosedCaptions")){modelOptions.features.unshift("tracks")}if(this.model.get("_allowFullScreen")){modelOptions.features.push("fullscreen")}if(this.model.get("_showVolumeControl")){modelOptions.features.push("volume")}}modelOptions.success=_.debounce(this.onPlayerReady.bind(this),100);if(this.model.get("_useClosedCaptions")){var startLanguage=this.model.get("_startLanguage")||"en";if(!Adapt.offlineStorage.get("captions")){Adapt.offlineStorage.set("captions",startLanguage)}modelOptions.startLanguage=this.checkForSupportedCCLanguage(Adapt.offlineStorage.get("captions"))}if(modelOptions.alwaysShowControls===undefined){modelOptions.alwaysShowControls=false}if(modelOptions.hideVideoControlsOnLoad===undefined){modelOptions.hideVideoControlsOnLoad=true}this.addMediaTypeClass();this.addThirdPartyFixes(modelOptions,function(){_this.$("audio, video").mediaelementplayer(modelOptions);_this.cleanUpPlayer();var _media=_this.model.get("_media");if(!_media.mp3&&!_media.mp4&&!_media.ogv&&!_media.webm&&!_media.source){Adapt.log.warn("ERROR! No media is selected in components.json for component "+_this.model.get("_id"));_this.setReadyStatus();return}if(_media.source){_this.$(".media__widget").addClass("external-source")}})}},{key:"addMediaTypeClass",value:function addMediaTypeClass(){var media=this.model.get("_media");if(media&&media.type){var typeClass=media.type.replace(/\//,"-");this.$(".media__widget").addClass(typeClass)}}},{key:"addThirdPartyFixes",value:function addThirdPartyFixes(modelOptions,callback){var media=this.model.get("_media");if(!media)return callback();if(media.mp3||media.ogg){modelOptions.alwaysShowControls=true}switch(media.type){case"video/vimeo":modelOptions.alwaysShowControls=false;modelOptions.hideVideoControlsOnLoad=true;modelOptions.features=[];if(froogaloopAdded)return callback();$.getScript("assets/froogaloop.js").done(function(){froogaloopAdded=true;callback()}).fail(function(){froogaloopAdded=false;Adapt.log.error("Could not load froogaloop.js")});break;default:callback();}}},{key:"cleanUpPlayer",value:function cleanUpPlayer(){this.$(".media__widget").children(".mejs-offscreen").remove();this.$("[role=application]").removeAttr("role tabindex");this.$("[aria-controls]").removeAttr("aria-controls")}},{key:"setupEventListeners",value:function setupEventListeners(){this.completionEvent=this.model.get("_setCompletionOn")||"play";if(this.completionEvent==="inview"){this.setupInviewCompletion(".component__widget")}if(this.model.get("_preventForwardScrubbing")&&!this.model.get("_isComplete")){$(this.mediaElement).on({"seeking":this.onMediaElementSeeking,"timeupdate":this.onMediaElementTimeUpdate})}$(this.mediaElement).on({"play":this.onMediaElementPlay,"pause":this.onMediaElementPause,"ended":this.onMediaElementEnded});_.delay(this.listenForCaptionsChange.bind(this),250)}},{key:"listenForCaptionsChange",value:function listenForCaptionsChange(){var _this2=this;if(!this.model.get("_useClosedCaptions"))return;var selector=this.model.get("_playerOptions").toggleCaptionsButtonWhenOnlyOne?".mejs-captions-button button":".mejs-captions-selector";this.$(selector).on("click.mediaCaptionsChange",_.debounce(function(){var srclang=_this2.mediaElement.player.selectedTrack?_this2.mediaElement.player.selectedTrack.srclang:"none";Adapt.offlineStorage.set("captions",srclang);Adapt.trigger("media:captionsChange",_this2,srclang)},250));this.listenTo(Adapt,"media:captionsChange",this.onCaptionsChanged)}},{key:"onCaptionsChanged",value:function onCaptionsChanged(view,lang){if(view&&view.cid===this.cid)return;lang=this.checkForSupportedCCLanguage(lang);this.mediaElement.player.setTrack(lang);var $inputs=this.$(".mejs-captions-selector input");$inputs.filter(":checked").prop("checked",false);$inputs.filter("[value=\"".concat(lang,"\"]")).prop("checked",true)}},{key:"checkForSupportedCCLanguage",value:function checkForSupportedCCLanguage(lang){if(!lang||lang==="none")return"none";if(_.findWhere(this.model.get("_media").cc,{srclang:lang}))return lang;return this.model.get("_startLanguage")||"none"}},{key:"onMediaElementPlay",value:function onMediaElementPlay(event){this.queueGlobalEvent("play");Adapt.trigger("media:stop",this);if(this.model.get("_pauseWhenOffScreen"))$(this.mediaElement).on("inview",this.onMediaElementInview);this.model.set({"_isMediaPlaying":true,"_isMediaEnded":false});if(this.completionEvent==="play"){this.setCompletionStatus()}}},{key:"onMediaElementPause",value:function onMediaElementPause(event){this.queueGlobalEvent("pause");$(this.mediaElement).off("inview",this.onMediaElementInview);this.model.set("_isMediaPlaying",false)}},{key:"onMediaElementEnded",value:function onMediaElementEnded(event){this.queueGlobalEvent("ended");this.model.set("_isMediaEnded",true);if(this.completionEvent==="ended"){this.setCompletionStatus()}}},{key:"onMediaElementInview",value:function onMediaElementInview(event,isInView){if(!isInView&&!event.currentTarget.paused)event.currentTarget.pause()}},{key:"onMediaElementSeeking",value:function onMediaElementSeeking(event){var maxViewed=this.model.get("_maxViewed");if(!maxViewed){maxViewed=0}if(event.target.currentTime>maxViewed){event.target.currentTime=maxViewed}}},{key:"onMediaElementTimeUpdate",value:function onMediaElementTimeUpdate(event){var maxViewed=this.model.get("_maxViewed");if(!maxViewed){maxViewed=0}if(event.target.currentTime>maxViewed){this.model.set("_maxViewed",event.target.currentTime)}}},{key:"setupPlayPauseToggle",value:function setupPlayPauseToggle(){var player=this.mediaElement.player;if(!player){Adapt.log.warn("MediaView.setupPlayPauseToggle: OOPS! there is no player reference.");return}player.options.clickToPlayPause=false;this.$(".mejs-overlay-button").on("click",this.onOverlayClick);this.$(".mejs-mediaelement").on("click",this.onMediaElementClick)}},{key:"onMediaStop",value:function onMediaStop(view){if(view&&view.cid===this.cid)return;if(!this.mediaElement||!this.mediaElement.player)return;this.mediaElement.player.pause()}},{key:"onOverlayClick",value:function onOverlayClick(){var player=this.mediaElement.player;if(!player)return;player.play()}},{key:"onMediaElementClick",value:function onMediaElementClick(event){var player=this.mediaElement.player;if(!player)return;var isPaused=player.media.paused;if(!isPaused)player.pause()}},{key:"checkIfResetOnRevisit",value:function checkIfResetOnRevisit(){var isResetOnRevisit=this.model.get("_isResetOnRevisit");if(isResetOnRevisit){this.model.reset(isResetOnRevisit)}}},{key:"remove",value:function remove(){this.$(".mejs-overlay-button").off("click",this.onOverlayClick);this.$(".mejs-mediaelement").off("click",this.onMediaElementClick);if(this.model.get("_useClosedCaptions")){var selector=this.model.get("_playerOptions").toggleCaptionsButtonWhenOnlyOne?".mejs-captions-button button":".mejs-captions-selector";this.$(selector).off("click.mediaCaptionsChange")}var modelOptions=this.model.get("_playerOptions");delete modelOptions.success;var media=this.model.get("_media");if(media){switch(media.type){case"video/vimeo":this.$("iframe")[0].isRemoved=true;}}if(this.mediaElement&&this.mediaElement.player){var playerId=this.mediaElement.player.id;purge(this.$el[0]);this.mediaElement.player.remove();if(window.mejs.players[playerId]){delete window.mejs.players[playerId]}}if(this.mediaElement){$(this.mediaElement).off({"play":this.onMediaElementPlay,"pause":this.onMediaElementPause,"ended":this.onMediaElementEnded,"seeking":this.onMediaElementSeeking,"timeupdate":this.onMediaElementTimeUpdate,"inview":this.onMediaElementInview});this.mediaElement.src="";$(this.mediaElement.pluginElement).remove();delete this.mediaElement}_get(_getPrototypeOf(MediaView.prototype),"remove",this).call(this)}},{key:"onDeviceChanged",value:function onDeviceChanged(){if(this.model.get("_media").source){this.$(".mejs-container").width(this.$(".component__widget").width())}}},{key:"onPlayerReady",value:function onPlayerReady(mediaElement,domObject){this.mediaElement=mediaElement;var player=this.mediaElement.player;if(!player)player=window.mejs.players[this.$(".mejs-container").attr("id")];var hasTouch=window.mejs.MediaFeatures.hasTouch;if(hasTouch){this.setupPlayPauseToggle()}this.addThirdPartyAfterFixes();this.cleanUpPlayerAfter();if(player&&this.model.has("_startVolume")){player.setVolume(parseInt(this.model.get("_startVolume"))/100)}this.setReadyStatus();this.setupEventListeners()}},{key:"addThirdPartyAfterFixes",value:function addThirdPartyAfterFixes(){var media=this.model.get("_media");switch(media.type){case"video/vimeo":this.$(".mejs-container").attr("tabindex",0);}}},{key:"cleanUpPlayerAfter",value:function cleanUpPlayerAfter(){this.$("[aria-valuemax='NaN']").attr("aria-valuemax",0)}},{key:"onScreenSizeChanged",value:function onScreenSizeChanged(){this.$("audio, video").width(this.$(".component__widget").width())}},{key:"onSkipToTranscript",value:function onSkipToTranscript(){var _this3=this;_.delay(function(){Adapt.a11y.focus(_this3.$(".media__transcript-btn"))},250)}},{key:"onToggleInlineTranscript",value:function onToggleInlineTranscript(event){if(event)event.preventDefault();var $transcriptBodyContainer=this.$(".media__transcript-body-inline");var $button=this.$(".media__transcript-btn-inline");var $buttonText=this.$(".media__transcript-btn-inline .media__transcript-btn-text");if($transcriptBodyContainer.hasClass("inline-transcript-open")){$transcriptBodyContainer.stop(true,true).slideUp(function(){$(window).resize()}).removeClass("inline-transcript-open");$button.attr("aria-expanded",false);$buttonText.html(this.model.get("_transcript").inlineTranscriptButton);return}$transcriptBodyContainer.stop(true,true).slideDown(function(){$(window).resize()}).addClass("inline-transcript-open");$button.attr("aria-expanded",true);$buttonText.html(this.model.get("_transcript").inlineTranscriptCloseButton);if(this.model.get("_transcript")._setCompletionOnView!==false){this.setCompletionStatus()}}},{key:"onExternalTranscriptClicked",value:function onExternalTranscriptClicked(event){if(this.model.get("_transcript")._setCompletionOnView!==false){this.setCompletionStatus()}}},{key:"queueGlobalEvent",value:function queueGlobalEvent(eventType){var time=Date.now();var lastEvent=this.lastEvent||{time:0};var timeSinceLastEvent=time-lastEvent.time;var debounceTime=500;this.lastEvent={time:time,type:eventType};clearTimeout(this.eventTimeout);if(eventType==="ended"){return this.triggerGlobalEvent(eventType)}if(timeSinceLastEvent>debounceTime){this.eventTimeout=setTimeout(this.triggerGlobalEvent.bind(this,eventType),debounceTime)}}},{key:"triggerGlobalEvent",value:function triggerGlobalEvent(eventType){var player=this.mediaElement.player;var eventObj={type:eventType,src:this.mediaElement.src,platform:this.mediaElement.pluginType};if(player)eventObj.isVideo=player.isVideo;Adapt.trigger("media",eventObj)}}]);return MediaView}(ComponentView$1);var MediaView$1=__AMD("components/adapt-contrib-media/js/mediaView",MediaView);__AMD("components/adapt-contrib-media/js/adapt-contrib-media",Adapt.register("media",{model:ComponentModel$1.extend({}),view:MediaView$1}));var MODE=__AMD("components/adapt-contrib-narrative/js/modeEnum",new ENUM(["SMALL","LARGE"]));var NarrativeView=function(_ComponentView){_inherits(NarrativeView,_ComponentView);var _super=_createSuper(NarrativeView);function NarrativeView(){_classCallCheck(this,NarrativeView);return _super.apply(this,arguments)}_createClass(NarrativeView,[{key:"events",value:function events(){return{"click .js-narrative-strapline-open-popup":"openPopup","click .js-narrative-controls-click":"onNavigationClicked","click .js-narrative-progress-click":"onProgressClicked"}}},{key:"initialize",value:function initialize(){var _get2;for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}(_get2=_get(_getPrototypeOf(NarrativeView.prototype),"initialize",this)).call.apply(_get2,[this].concat(args));this._isInitial=true}},{key:"preRender",value:function preRender(){this.listenTo(Adapt,{"device:changed device:resize":this.reRender,"notify:closed":this.closeNotify});this.renderMode();this.listenTo(this.model.getChildren(),{"change:_isActive":this.onItemsActiveChange,"change:_isVisited":this.onItemsVisitedChange});this.checkIfResetOnRevisit();this.calculateWidths()}},{key:"onItemsActiveChange",value:function onItemsActiveChange(item,_isActive){if(!_isActive)return;this.setStage(item);this.setFocus(item.get("_index"))}},{key:"setFocus",value:function setFocus(itemIndex){var _this=this;if(this._isInitial)return;var $straplineHeaderElm=this.$(".narrative__strapline-header-inner");var hasStraplineTransition=!this.isLargeMode()&&$straplineHeaderElm.css("transitionDuration")!=="0s";if(hasStraplineTransition){$straplineHeaderElm.one("transitionend",function(){_this.focusOnNarrativeElement(itemIndex)});return}this.focusOnNarrativeElement(itemIndex)}},{key:"focusOnNarrativeElement",value:function focusOnNarrativeElement(itemIndex){var dataIndexAttr="[data-index='".concat(itemIndex,"']");var $elementToFocus=this.isLargeMode()?this.$(".narrative__content-item".concat(dataIndexAttr)):this.$(".narrative__strapline-btn".concat(dataIndexAttr));Adapt.a11y.focusFirst($elementToFocus)}},{key:"onItemsVisitedChange",value:function onItemsVisitedChange(item,_isVisited){if(!_isVisited)return;this.$("[data-index=\"".concat(item.get("_index"),"\"]")).addClass("is-visited")}},{key:"calculateMode",value:function calculateMode(){var mode=Adapt.device.screenSize==="large"?MODE.LARGE:MODE.SMALL;this.model.set("_mode",mode)}},{key:"renderMode",value:function renderMode(){this.calculateMode();var isLargeMode=this.isLargeMode();this.$el.toggleClass("mode-large",isLargeMode).toggleClass("mode-small",!isLargeMode)}},{key:"isLargeMode",value:function isLargeMode(){return this.model.get("_mode")===MODE.LARGE}},{key:"postRender",value:function postRender(){this.renderMode();this.setupNarrative();this.$(".narrative__slider").imageready(this.setReadyStatus.bind(this));if(Adapt.config.get("_disableAnimation")){this.$el.addClass("disable-animation")}}},{key:"checkIfResetOnRevisit",value:function checkIfResetOnRevisit(){var isResetOnRevisit=this.model.get("_isResetOnRevisit");if(isResetOnRevisit){this.model.reset(isResetOnRevisit)}}},{key:"setupNarrative",value:function setupNarrative(){this.renderMode();var items=this.model.getChildren();if(!items||!items.length)return;var activeItem=this.model.getActiveItem();if(!activeItem){activeItem=this.model.getItem(0);activeItem.toggleActive(true)}else{items.trigger("change:_isActive",activeItem,true)}this.calculateWidths();if(!this.isLargeMode()&&!this.model.get("_wasHotgraphic")){this.replaceInstructions()}this.setupEventListeners();this._isInitial=false}},{key:"calculateWidths",value:function calculateWidths(){var itemCount=this.model.getChildren().length;this.model.set({_totalWidth:100*itemCount,_itemWidth:100/itemCount})}},{key:"resizeControl",value:function resizeControl(){var previousMode=this.model.get("_mode");this.renderMode();if(previousMode!==this.model.get("_mode"))this.replaceInstructions();this.evaluateNavigation();var activeItem=this.model.getActiveItem();if(activeItem)this.setStage(activeItem)}},{key:"reRender",value:function reRender(){if(this.model.get("_wasHotgraphic")&&this.isLargeMode()){this.replaceWithHotgraphic();return}this.resizeControl()}},{key:"closeNotify",value:function closeNotify(){this.evaluateCompletion()}},{key:"replaceInstructions",value:function replaceInstructions(){if(this.isLargeMode()){this.$(".narrative__instruction-inner").html(this.model.get("instruction"));return}if(this.model.get("mobileInstruction")&&!this.model.get("_wasHotgraphic")){this.$(".narrative__instruction-inner").html(this.model.get("mobileInstruction"))}}},{key:"replaceWithHotgraphic",value:function replaceWithHotgraphic(){var HotgraphicView=Adapt.getViewClass("hotgraphic");if(!HotgraphicView)return;var model=this.prepareHotgraphicModel();var newHotgraphic=new HotgraphicView({model:model});this.$el.parents(".component__container").append(newHotgraphic.$el);this.remove();_.defer(function(){Adapt.trigger("device:resize")})}},{key:"prepareHotgraphicModel",value:function prepareHotgraphicModel(){var model=this.model;model.resetActiveItems();model.set({_isPopupOpen:false,_component:"hotgraphic",body:model.get("originalBody"),instruction:model.get("originalInstruction")});return model}},{key:"moveSliderToIndex",value:function moveSliderToIndex(itemIndex){var offset=this.model.get("_itemWidth")*itemIndex;if(Adapt.config.get("_defaultDirection")==="ltr"){offset*=-1}var cssValue="translateX(".concat(offset,"%)");var $sliderElm=this.$(".narrative__slider");var $straplineHeaderElm=this.$(".narrative__strapline-header-inner");$sliderElm.css("transform",cssValue);$straplineHeaderElm.css("transform",cssValue)}},{key:"setStage",value:function setStage(item){var index=item.get("_index");var indexSelector="[data-index=\"".concat(index,"\"]");if(this.isLargeMode()){item.toggleVisited(true)}this.$(".narrative__progress").removeClass("is-selected").filter(indexSelector).addClass("is-selected");var $slideGraphics=this.$(".narrative__slider-image-container");Adapt.a11y.toggleAccessibleEnabled($slideGraphics.children(".controls"),false);Adapt.a11y.toggleAccessibleEnabled($slideGraphics.filter(indexSelector).children(".controls"),true);var $narrativeItems=this.$(".narrative__content-item");$narrativeItems.addClass("u-visibility-hidden u-display-none");Adapt.a11y.toggleAccessible($narrativeItems,false);Adapt.a11y.toggleAccessible($narrativeItems.filter(indexSelector).removeClass("u-visibility-hidden u-display-none"),true);var $narrativeStraplineButtons=this.$(".narrative__strapline-btn");Adapt.a11y.toggleAccessibleEnabled($narrativeStraplineButtons,false);Adapt.a11y.toggleAccessibleEnabled($narrativeStraplineButtons.filter(indexSelector),true);this.evaluateNavigation();this.evaluateCompletion();this.moveSliderToIndex(index)}},{key:"evaluateNavigation",value:function evaluateNavigation(){var active=this.model.getActiveItem();if(!active)return;var index=active.get("_index");var itemCount=this.model.getChildren().length;var isAtStart=index===0;var isAtEnd=index===itemCount-1;var $left=this.$(".narrative__controls-left");var $right=this.$(".narrative__controls-right");var globals=Adapt.course.get("_globals");var ariaLabelsGlobals=globals._accessibility._ariaLabels;var narrativeGlobals=globals._components._narrative;var ariaLabelPrevious=narrativeGlobals.previous||ariaLabelsGlobals.previous;var ariaLabelNext=narrativeGlobals.next||ariaLabelsGlobals.next;var prevTitle=isAtStart?"":this.model.getItem(index-1).get("title");var nextTitle=isAtEnd?"":this.model.getItem(index+1).get("title");$left.toggleClass("u-visibility-hidden",isAtStart);$right.toggleClass("u-visibility-hidden",isAtEnd);$left.attr("aria-label",Handlebars.compile(ariaLabelPrevious)({title:prevTitle,_globals:globals,itemNumber:isAtStart?null:index,totalItems:itemCount}));$right.attr("aria-label",Handlebars.compile(ariaLabelNext)({title:nextTitle,_globals:globals,itemNumber:isAtEnd?null:index+2,totalItems:itemCount}))}},{key:"evaluateCompletion",value:function evaluateCompletion(){if(this.model.areAllItemsCompleted()){this.trigger("allItems")}}},{key:"openPopup",value:function openPopup(){var currentItem=this.model.getActiveItem();Adapt.notify.popup({title:currentItem.get("title"),body:currentItem.get("body")});Adapt.on("popup:opened",function(){currentItem.toggleVisited(true)})}},{key:"onNavigationClicked",value:function onNavigationClicked(event){var $btn=$(event.currentTarget);var index=this.model.getActiveItem().get("_index");$btn.data("direction")==="right"?index++:index--;this.model.setActiveItem(index)}},{key:"onProgressClicked",value:function onProgressClicked(event){var index=$(event.target).data("index");this.model.setActiveItem(index)}},{key:"setupEventListeners",value:function setupEventListeners(){if(this.model.get("_setCompletionOn")==="inview"){this.setupInviewCompletion(".component__widget")}}}]);return NarrativeView}(ComponentView$1);NarrativeView.template="narrative";var NarrativeView$1=__AMD("components/adapt-contrib-narrative/js/narrativeView",NarrativeView);__AMD("components/adapt-contrib-narrative/js/adapt-contrib-narrative",Adapt.register("narrative",{model:ItemsComponentModel.extend({}),view:NarrativeView$1}));var SliderView=function(_QuestionView){_inherits(SliderView,_QuestionView);var _super=_createSuper(SliderView);function SliderView(){_classCallCheck(this,SliderView);return _super.apply(this,arguments)}_createClass(SliderView,[{key:"events",value:function events(){return{"click .js-slider-number-click":"onNumberSelected","focus .js-slider-item-input":"onHandleFocus","blur .js-slider-item-input":"onHandleBlur"}}},{key:"resetQuestionOnRevisit",value:function resetQuestionOnRevisit(){this.setAllItemsEnabled();this.model.deselectAllItems();this.resetQuestion()}},{key:"setupQuestion",value:function setupQuestion(){if(this.model.get("_isSubmitted"))return;this.selectItem(this.getIndexFromValue(this.model.get("_selectedItem").value))}},{key:"setupRangeslider",value:function setupRangeslider(){this.$sliderScaleMarker=this.$(".js-slider-number-selection");this.$slider=this.$(".js-slider-item-input");if(this.model.has("_scaleStep")){this.$slider.attr({"step":this.model.get("_scaleStep")})}this.$slider.rangeslider({polyfill:false,onSlide:this.handleSlide.bind(this)});this.oldValue=0;if(this._deferEnable){this.setAllItemsEnabled()}}},{key:"handleSlide",value:function handleSlide(position,value){if(this.oldValue===value){return}var itemIndex=this.getIndexFromValue(value);var pixels=this.mapIndexToPixels(itemIndex);this.selectItem(itemIndex);this.animateToPosition(pixels);this.oldValue=value}},{key:"disableQuestion",value:function disableQuestion(){this.setAllItemsEnabled()}},{key:"enableQuestion",value:function enableQuestion(){this.setAllItemsEnabled()}},{key:"setAllItemsEnabled",value:function setAllItemsEnabled(){var isEnabled=this.model.get("_isEnabled");if(!this.$slider){this._deferEnable=true;return}this.$(".slider__widget").toggleClass("is-disabled",!isEnabled);this.$slider.prop("disabled",!isEnabled).rangeslider("update",true)}},{key:"onQuestionRendered",value:function onQuestionRendered(){this.setupRangeslider();this.setScalePositions();this.onScreenSizeChanged();this.showScaleMarker(true);this.listenTo(Adapt,"device:resize",this.onScreenSizeChanged);this.setReadyStatus()}},{key:"animateToPosition",value:function animateToPosition(newPosition){if(!this.$sliderScaleMarker)return;this.$sliderScaleMarker.velocity("stop").velocity({left:newPosition},{duration:200,easing:"linear",mobileHA:false})}},{key:"getIndexFromValue",value:function getIndexFromValue(itemValue){var scaleStart=this.model.get("_scaleStart");var scaleEnd=this.model.get("_scaleEnd");return Math.round(this.mapValue(itemValue,scaleStart,scaleEnd,0,this.model.get("_items").length-1))}},{key:"mapIndexToPixels",value:function mapIndexToPixels(value,$widthObject){var numberOfItems=this.model.get("_items").length;var width=$widthObject?$widthObject.width():this.$(".js-slider-scale").width();return Math.round(this.mapValue(value,0,numberOfItems-1,0,width))}},{key:"mapPixelsToIndex",value:function mapPixelsToIndex(value){var numberOfItems=this.model.get("_items").length;var width=this.$(".slider-sliderange").width();return Math.round(this.mapValue(value,0,width,0,numberOfItems-1))}},{key:"normalise",value:function normalise(value,low,high){var range=high-low;return(value-low)/range}},{key:"mapValue",value:function mapValue(value,inputLow,inputHigh,outputLow,outputHigh){var normal=this.normalise(value,inputLow,inputHigh);return normal*(outputHigh-outputLow)+outputLow}},{key:"onHandleFocus",value:function onHandleFocus(event){event.preventDefault();this.$slider.on("keydown",this.onKeyDown.bind(this))}},{key:"onHandleBlur",value:function onHandleBlur(event){event.preventDefault();this.$slider.off("keydown")}},{key:"onKeyDown",value:function onKeyDown(event){if(event.which===9)return;event.preventDefault();var newItemIndex=this.getIndexFromValue(this.model.get("_selectedItem").value);switch(event.which){case 40:case 37:newItemIndex=Math.max(newItemIndex-1,0);break;case 38:case 39:newItemIndex=Math.min(newItemIndex+1,this.model.get("_items").length-1);break;}this.selectItem(newItemIndex);if(typeof newItemIndex==="number")this.showScaleMarker(true);this.animateToPosition(this.mapIndexToPixels(newItemIndex));this.setSliderValue(this.getValueFromIndex(newItemIndex))}},{key:"onNumberSelected",value:function onNumberSelected(event){event.preventDefault();if(this.model.get("_isInteractionComplete")){return}if(this.$slider.prop("disabled")){return}var itemValue=parseFloat($(event.currentTarget).attr("data-id"));var index=this.getIndexFromValue(itemValue);this.selectItem(index);this.animateToPosition(this.mapIndexToPixels(index));this.setSliderValue(itemValue)}},{key:"getValueFromIndex",value:function getValueFromIndex(index){return this.model.get("_items")[index].value}},{key:"resetControlStyles",value:function resetControlStyles(){this.$(".slider-handle").empty();this.showScaleMarker(false);this.$(".slider-bar").animate({width:"0"});this.setSliderValue(this.model.get("_items")[0].value)}},{key:"onCannotSubmit",value:function onCannotSubmit(){}},{key:"setSliderValue",value:function setSliderValue(value){if(!this.$slider)return;this.$slider.val(value).change()}},{key:"showMarking",value:function showMarking(){if(!this.model.get("_canShowMarking"))return;this.$(".slider__widget").removeClass("is-correct is-incorrect").addClass(this.model.get("_selectedItem").correct?"is-correct":"is-incorrect")}},{key:"resetQuestion",value:function resetQuestion(){this.selectItem(0);this.animateToPosition(0);this.resetControlStyles();this.showScaleMarker(true)}},{key:"setScalePositions",value:function setScalePositions(){var _this=this;var numberOfItems=this.model.get("_items").length;this.model.get("_items").forEach(function(item,index){var normalisedPosition=_this.normalise(index,0,numberOfItems-1);_this.$(".js-slider-number").eq(index).data("normalisedPosition",normalisedPosition)})}},{key:"showScale",value:function showScale(){var $markers=this.$(".js-slider-scale-notch-container").empty();if(this.model.get("_showScale")===false){$markers.eq(0).addClass("u-display-none");this.$(".js-slider-number").addClass(this.model.get("_showScaleIndicator")?"u-visibility-hidden":"u-display-none");return}var $scaler=this.$(".js-slider-scale");for(var i=1,count=this.model.get("_items").length-1;i<count;i++){$markers.append("<div class=\"slider__scale-notch\" style=\"left: ".concat(this.mapIndexToPixels(i,$scaler),"px\">"))}this.showScaleNumbers()}},{key:"showScaleNumbers",value:function showScaleNumbers(){var $scaler=this.$(".js-slider-scale");var $numbers=this.$(".js-slider-number");if(this.model.get("_showScaleNumbers")===false){$numbers.addClass("u-display-none");return}var scaleWidth=$scaler.width();this.model.get("_items").forEach(function(item,index){var $number=$numbers.eq(index);var newLeft=Math.round($number.data("normalisedPosition")*scaleWidth);$number.css({left:newLeft})})}},{key:"showLabels",value:function showLabels(){if(this.model.get("labelStart")||this.model.get("labelEnd"))return;this.$(".js-slider-label-container").eq(0).addClass("u-display-none")}},{key:"remapSliderBar",value:function remapSliderBar(){var $scaler=this.$(".js-slider-scale");var currentIndex=this.getIndexFromValue(this.model.get("_selectedItem").value);var left=this.mapIndexToPixels(currentIndex,$scaler);this.$(".slider-handle").css({left:"".concat(left,"px")});this.$(".js-slider-number-selection").css({left:"".concat(left,"px")});this.$(".slider-bar").width(left)}},{key:"onScreenSizeChanged",value:function onScreenSizeChanged(){this.showScale();this.showLabels();this.remapSliderBar();if(this.$(".slider__widget").hasClass("show-user-answer")){this.hideCorrectAnswer()}else if(this.$(".slider__widget").hasClass("show-correct-answer")){this.showCorrectAnswer()}}},{key:"showCorrectAnswer",value:function showCorrectAnswer(){this.showScaleMarker(false);var answers=this.model.getCorrectAnswers();if(answers.length===0){console.log("adapt-contrib-slider::WARNING: no correct answer or correct range set in JSON");return}var middleAnswer=answers[Math.floor(answers.length/2)];this.animateToPosition(this.mapIndexToPixels(this.getIndexFromValue(middleAnswer)));this.showModelAnswers(answers);this.setSliderValue(middleAnswer)}},{key:"showModelAnswers",value:function showModelAnswers(correctAnswerArray){var _this2=this;var $parentDiv=this.$(".js-slider-model-range");correctAnswerArray.forEach(function(correctAnswer,index){$parentDiv.append($("<div class=\"slider__number-model-answer\">"));var $element=_this2.$(".js-slider-model-range .slider__number-model-answer").eq(index);var startingLeft=_this2.mapIndexToPixels(_this2.getIndexFromValue(_this2.model.get("_selectedItem").value));if(_this2.model.get("_showNumber"))$element.html(correctAnswer);$element.css({left:startingLeft}).fadeIn(0,function(){$element.animate({left:_this2.mapIndexToPixels(_this2.getIndexFromValue(correctAnswer))})})})}},{key:"hideCorrectAnswer",value:function hideCorrectAnswer(){var userAnswerIndex=this.getIndexFromValue(this.model.get("_userAnswer"));this.$(".js-slider-model-range").empty();this.showScaleMarker(true);this.selectItem(userAnswerIndex);this.animateToPosition(this.mapIndexToPixels(userAnswerIndex));this.setSliderValue(this.model.get("_userAnswer"))}},{key:"selectItem",value:function selectItem(itemIndex){this.model.deselectAllItems();var item=this.model.get("_items")[itemIndex];if(!item)return;item.selected=true;this.model.set("_selectedItem",item);this.$(".js-slider-item-input").attr({"value":item.value,"aria-valuenow":item.value});this.showNumber(true)}},{key:"showScaleMarker",value:function showScaleMarker(show){var $scaleMarker=this.$(".js-slider-number-selection");if(this.model.get("_showScaleIndicator")){this.showNumber(show);$scaleMarker.toggleClass("display-block",show)}}},{key:"showNumber",value:function showNumber(show){var $scaleMarker=this.$(".js-slider-number-selection");if(this.model.get("_showNumber")){if(show){$scaleMarker.html(this.model.get("_selectedItem").value)}else{$scaleMarker.html=""}}}}]);return SliderView}(QuestionView$1);var SliderView$1=__AMD("components/adapt-contrib-slider/js/sliderView",SliderView);var SliderModel=function(_QuestionModel){_inherits(SliderModel,_QuestionModel);var _super=_createSuper(SliderModel);function SliderModel(){_classCallCheck(this,SliderModel);return _super.apply(this,arguments)}_createClass(SliderModel,[{key:"init",value:function init(){QuestionModel$1.prototype.init.call(this);this.setupModelItems();this.selectDefaultItem()}},{key:"selectDefaultItem",value:function selectDefaultItem(){this.set("_selectedItem",this.get("_items")[0])}},{key:"getDecimalPlaces",value:function getDecimalPlaces(num){return(num.toString().split(".")[1]||[]).length}},{key:"setupModelItems",value:function setupModelItems(){var items=[];var answer=this.get("_correctAnswer");var range=this.get("_correctRange");var start=this.get("_scaleStart");var end=this.get("_scaleEnd");var step=this.get("_scaleStep")||1;var dp=this.getDecimalPlaces(step);for(var i=start;i<=end;i+=step){if(dp!==0){i=parseFloat(i.toFixed(dp))}items.push({value:i,selected:false,correct:answer?i===Number(answer):i>=range._bottom&&i<=range._top})}this.set({"_items":items,"_marginDir":Adapt.config.get("_defaultDirection")==="rtl"?"right":"left"})}},{key:"canSubmit",value:function canSubmit(){return true}},{key:"restoreUserAnswers",value:function restoreUserAnswers(){if(!this.get("_isSubmitted")){this.set({_userAnswer:undefined});this.selectDefaultItem();return}var items=this.get("_items");var userAnswer=this.get("_userAnswer");var selectedItem=items.find(function(_ref){var value=_ref.value;return value===userAnswer});if(selectedItem){selectedItem.selected=true;this.set("_selectedItem",selectedItem)}this.setQuestionAsSubmitted();this.markQuestion();this.setScore();this.setupFeedback()}},{key:"storeUserAnswer",value:function storeUserAnswer(){this.set("_userAnswer",this.get("_selectedItem").value)}},{key:"resetUserAnswer",value:function resetUserAnswer(){this.set({_isAtLeastOneCorrectSelection:false,_userAnswer:undefined});this.selectDefaultItem()}},{key:"deselectAllItems",value:function deselectAllItems(){this.get("_items").forEach(function(item){return item.selected=false})}},{key:"isCorrect",value:function isCorrect(){var numberOfCorrectAnswers=this.get("_items").filter(function(_ref2){var selected=_ref2.selected,correct=_ref2.correct;return selected&&correct}).length;this.set("_isAtLeastOneCorrectSelection",numberOfCorrectAnswers>0);this.set("_numberOfCorrectAnswers",numberOfCorrectAnswers);return this.get("_isAtLeastOneCorrectSelection")}},{key:"isPartlyCorrect",value:function isPartlyCorrect(){return this.get("_isAtLeastOneCorrectSelection")}},{key:"setScore",value:function setScore(){var numberOfCorrectAnswers=this.get("_numberOfCorrectAnswers");var questionWeight=this.get("_questionWeight");var score=questionWeight*numberOfCorrectAnswers;this.set("_score",score)}},{key:"getResponse",value:function getResponse(){return this.get("_userAnswer").toString()}},{key:"getResponseType",value:function getResponseType(){return"numeric"}},{key:"getCorrectAnswers",value:function getCorrectAnswers(){var answerSingle=this.get("_correctAnswer");var answers=[];if(answerSingle){return[answerSingle]}var answerMultiple=this.get("_correctRange");if(!answerMultiple){return answers}var bottom=answerMultiple._bottom;var top=answerMultiple._top;if(bottom===undefined||top===undefined){return answers}var answer=bottom;var step=this.get("_scaleStep")||1;while(answer<=top){answers.push(answer);answer+=step}return answers}}]);return SliderModel}(QuestionModel$1);var SliderModel$1=__AMD("components/adapt-contrib-slider/js/sliderModel",SliderModel);__AMD("components/adapt-contrib-slider/js/adapt-contrib-slider",Adapt.register("slider",{view:SliderView$1,model:SliderModel$1}));var TextView=function(_ComponentView){_inherits(TextView,_ComponentView);var _super=_createSuper(TextView);function TextView(){_classCallCheck(this,TextView);return _super.apply(this,arguments)}_createClass(TextView,[{key:"preRender",value:function preRender(){this.checkIfResetOnRevisit()}},{key:"postRender",value:function postRender(){this.setReadyStatus();this.setupInview()}},{key:"setupInview",value:function setupInview(){var selector=this.getInviewElementSelector();if(!selector){this.setCompletionStatus();return}this.setupInviewCompletion(selector)}},{key:"getInviewElementSelector",value:function getInviewElementSelector(){if(this.model.get("body"))return".component__body";if(this.model.get("instruction"))return".component__instruction";if(this.model.get("displayTitle"))return".component__title";return null}},{key:"checkIfResetOnRevisit",value:function checkIfResetOnRevisit(){var isResetOnRevisit=this.model.get("_isResetOnRevisit");if(isResetOnRevisit){this.model.reset(isResetOnRevisit)}}}]);return TextView}(ComponentView$1);TextView.template="text";__AMD("components/adapt-contrib-text/js/adapt-contrib-text",Adapt.register("text",{model:ComponentModel$1.extend({}),view:TextView}));var TextInputView=QuestionView$1.extend({events:{"focus .js-textinput-textbox":"clearValidationError","change .js-textinput-textbox":"onInputChanged","keyup .js-textinput-textbox":"onInputChanged"},resetQuestionOnRevisit:function(){this.setAllItemsEnabled(false);this.resetQuestion()},setupQuestion:function(){this.model.setupRandomisation()},disableQuestion:function(){this.setAllItemsEnabled(false)},enableQuestion:function(){this.setAllItemsEnabled(true)},setAllItemsEnabled:function(isEnabled){this.model.get("_items").forEach(function(item,index){var $itemInput=this.$(".js-textinput-textbox").eq(index);$itemInput.prop("disabled",!isEnabled)},this)},onQuestionRendered:function(){this.setReadyStatus()},clearValidationError:function(){this.$(".js-textinput-textbox").removeClass("has-error")},onCannotSubmit:function(){this.showValidationError()},showValidationError:function(){this.$(".js-textinput-textbox").addClass("has-error")},showMarking:function(){if(!this.model.get("_canShowMarking"))return;this.model.get("_items").forEach(function(item,i){var $item=this.$(".js-textinput-item").eq(i);$item.removeClass("is-correct is-incorrect").addClass(item._isCorrect?"is-correct":"is-incorrect")},this)},resetQuestion:function(){this.$(".js-textinput-textbox").prop("disabled",!this.model.get("_isEnabled")).val("");this.model.set({_isAtLeastOneCorrectSelection:false,_isCorrect:undefined})},showCorrectAnswer:function(){if(this.model.get("_answers")){var correctAnswers=this.model.get("_answers");this.model.get("_items").forEach(function(item,index){this.$(".js-textinput-textbox").eq(index).val(correctAnswers[index][0])},this)}else{this.model.get("_items").forEach(function(item,index){this.$(".js-textinput-textbox").eq(index).val(item._answers[0])},this)}},hideCorrectAnswer:function(){this.model.get("_items").forEach(function(item,index){this.$(".js-textinput-textbox").eq(index).val(item.userAnswer)},this)},onInputChanged:function(e){var $input=$(e.target);this.model.setItemUserAnswer($input.parents(".js-textinput-item").index(),$input.val())}});var TextInputView$1=__AMD("components/adapt-contrib-textInput/js/textInputView",TextInputView);var TextInputModel=QuestionModel$1.extend({init:function(){QuestionModel$1.prototype.init.call(this);this.set("_genericAnswerIndexOffset",TextInputModel.genericAnswerIndexOffset);this.setupQuestionItemIndexes();this.checkCanSubmit()},setupQuestionItemIndexes:function(){this.get("_items").forEach(function(item,index){if(item._index===undefined)item._index=index;if(item._answerIndex===undefined)item._answerIndex=-1})},restoreUserAnswers:function(){if(!this.get("_isSubmitted"))return;var userAnswer=this.get("_userAnswer");var genericAnswers=this.get("_answers");this.get("_items").forEach(function(item){var answerIndex=userAnswer[item._index];if(answerIndex>=TextInputModel.genericAnswerIndexOffset){item.userAnswer=genericAnswers[answerIndex-TextInputModel.genericAnswerIndexOffset];item._answerIndex=answerIndex}else if(answerIndex>-1){item.userAnswer=item._answers[answerIndex];item._answerIndex=answerIndex}else{if(item.userAnswer===undefined)item.userAnswer="******";item._answerIndex=-1}if(item.userAnswer instanceof Array)item.userAnswer=item.userAnswer[0]});this.setQuestionAsSubmitted();this.markQuestion();this.setScore();this.setupFeedback()},setupRandomisation:function(){if(!this.get("_isRandom")||!this.get("_isEnabled"))return;this.set("_items",_.shuffle(this.get("_items")))},canSubmit:function(){return this.get("_items").every(function(_ref){var userAnswer=_ref.userAnswer;return userAnswer})},setItemUserAnswer:function(itemIndex,userAnswer){var item=this.get("_items")[itemIndex];item.userAnswer=userAnswer;this.checkCanSubmit()},storeUserAnswer:function(){var items=this.get("_items");this.isCorrect();var userAnswer=new Array(items.length);items.forEach(function(item,index){userAnswer[item._index]=item._answerIndex});this.set("_userAnswer",userAnswer)},isCorrect:function(){if(this.get("_answers")){this.markGenericAnswers()}else{this.markSpecificAnswers()}return!_.contains(_.pluck(this.get("_items"),"_isCorrect"),false)},isPartlyCorrect:function(){return this.get("_isAtLeastOneCorrectSelection")},markGenericAnswers:function(){var numberOfCorrectAnswers=0;var correctAnswers=this.get("_answers").slice();var usedAnswerIndexes=[];this.get("_items").forEach(function(item){correctAnswers.forEach(function(answerGroup,answerIndex){if(_.indexOf(usedAnswerIndexes,answerIndex)>-1)return;if(this.checkAnswerIsCorrect(answerGroup,item.userAnswer)==false)return;usedAnswerIndexes.push(answerIndex);item._isCorrect=true;item._answerIndex=answerIndex+TextInputModel.genericAnswerIndexOffset;this.set({_numberOfCorrectAnswers:++numberOfCorrectAnswers,_isAtLeastOneCorrectSelection:true})},this);if(!item._isCorrect)item._isCorrect=false},this)},markSpecificAnswers:function(){var numberOfCorrectAnswers=0;this.get("_items").forEach(function(item){if(!item._answers)return;var userAnswer=item.userAnswer||"";if(this.checkAnswerIsCorrect(item._answers,userAnswer)){item._isCorrect=true;item._answerIndex=_.indexOf(item._answers,this.cleanupUserAnswer(userAnswer));this.set({_numberOfCorrectAnswers:++numberOfCorrectAnswers,_isAtLeastOneCorrectSelection:true})}else{item._isCorrect=false;item._answerIndex=-1}},this)},checkAnswerIsCorrect:function(possibleAnswers,userAnswer){var uAnswer=this.cleanupUserAnswer(userAnswer);var matched=possibleAnswers.filter(function(cAnswer){return this.cleanupUserAnswer(cAnswer)==uAnswer},this);var answerIsCorrect=matched&&matched.length>0;if(answerIsCorrect)this.set("_hasAtLeastOneCorrectSelection",true);return answerIsCorrect},cleanupUserAnswer:function(userAnswer){if(this.get("_allowsAnyCase")){userAnswer=userAnswer.toLowerCase()}if(this.get("_allowsPunctuation")){userAnswer=userAnswer.replace(/[\.,-\/#!$£%\^&\*;:{}=\-_`~()]/g,"");userAnswer=userAnswer.replace(/(  +)+/g," ")}return $.trim(userAnswer)},setScore:function(){var numberOfCorrectAnswers=this.get("_numberOfCorrectAnswers");var questionWeight=this.get("_questionWeight");var itemLength=this.get("_items").length;var score=questionWeight*numberOfCorrectAnswers/itemLength;this.set("_score",score)},resetUserAnswer:function(){this.get("_items").forEach(function(item){item._isCorrect=false;item.userAnswer=""})},getResponse:function(){return _.pluck(this.get("_items"),"userAnswer").join("[,]")},getResponseType:function(){return"fill-in"}},{genericAnswerIndexOffset:65536});var TextInputModel$1=__AMD("components/adapt-contrib-textInput/js/textInputModel",TextInputModel);__AMD("components/adapt-contrib-textInput/js/adapt-contrib-textInput",Adapt.register("textinput",{view:TextInputView$1,model:TextInputModel$1}));var TextView$1=function(_ComponentView){_inherits(TextView,_ComponentView);var _super=_createSuper(TextView);function TextView(){_classCallCheck(this,TextView);return _super.apply(this,arguments)}_createClass(TextView,[{key:"preRender",value:function preRender(){this.checkIfResetOnRevisit()}},{key:"postRender",value:function postRender(){this.setReadyStatus();this.setupInview()}},{key:"setupInview",value:function setupInview(){var selector=this.getInviewElementSelector();if(!selector){this.setCompletionStatus();return}this.setupInviewCompletion(selector)}},{key:"getInviewElementSelector",value:function getInviewElementSelector(){if(this.model.get("body"))return".component__body";if(this.model.get("instruction"))return".component__instruction";if(this.model.get("displayTitle"))return".component__title";return null}},{key:"checkIfResetOnRevisit",value:function checkIfResetOnRevisit(){var isResetOnRevisit=this.model.get("_isResetOnRevisit");if(isResetOnRevisit){this.model.reset(isResetOnRevisit)}}}]);return TextView}(ComponentView$1);TextView$1.template="tobistext";__AMD("components/adapt-contrib-tobistext/js/adapt-contrib-tobistext",Adapt.register("tobistext",{model:ComponentModel$1.extend({}),view:TextView$1}));var AssessmentView={postRender:function(){ArticleView$1.prototype.postRender.call(this);if(this.model.isAssessmentEnabled()){this._setupEventListeners();var config=this.model.getConfig();if(config&&config._questions&&config._questions._canShowMarking===false){this.$el.addClass("has-no-marking")}}this.$el.addClass("is-assessment")},_setupEventListeners:function(){this.listenTo(Adapt,{"assessments:complete":this._onAssessmentComplete,"assessments:reset":this._onAssessmentReset,remove:this._onRemove})},_removeEventListeners:function(){this.stopListening(Adapt,{"assessments:complete":this._onAssessmentComplete,"assessments:reset":this._onAssessmentReset})},_onAssessmentComplete:function(state,model){if(state.id!==this.model.get("_assessment")._id)return;console.log("assessment complete",state,model)},_onAssessmentReset:function(state,model){if(state.id!==this.model.get("_assessment")._id)return;console.log("assessment reset",state,model)},_onRemove:function(){this._removeEventListeners()}};var AdaptAssessmentArticleView=__AMD("extensions/adapt-contrib-assessment/js/adapt-assessmentArticleView",AssessmentView);var QuestionBank=function(quizBankid,articleId,numQuestionBlocks,uniqueQuestions){this._id=quizBankid;this._articleId=articleId;this._numQuestionBlocks=numQuestionBlocks;this._uniqueQuestions=uniqueQuestions;this.questionBlocks=[];this.unUsedQuestionBlocks=undefined;this.usedQuestionBlocks=[]};QuestionBank.prototype={getID:function(){return this._id},addBlock:function(block){this.questionBlocks.push(block)},getRandomQuestionBlocks:function(){this.checkResetUnunsedBlocks();var questionBlocks=[];var usedQuestionBlocks=this.usedQuestionBlocks.slice(0);for(var i=0;i<this._numQuestionBlocks;i++){var question=this.getRandomQuestion();if(question!==undefined){questionBlocks.push(question)}else{if(usedQuestionBlocks.length===0)break;var index=Math.floor(Math.random()*(usedQuestionBlocks.length-1));question=usedQuestionBlocks.splice(index,1)[0];questionBlocks.push(question)}}return questionBlocks},checkResetUnunsedBlocks:function(){if(this.unUsedQuestionBlocks!==undefined&&this._uniqueQuestions)return;this.unUsedQuestionBlocks=this.questionBlocks.slice(0)},getRandomQuestion:function(){if(this.unUsedQuestionBlocks!==undefined&&this.unUsedQuestionBlocks.length<1){console.warn("assessment:"+this._articleId+" No more unique questions for _assessment._quizBankID "+this._id);return undefined}var index=Math.round(Math.random()*(this.unUsedQuestionBlocks.length-1));var questionBlock=this.unUsedQuestionBlocks[index];this.usedQuestionBlocks.push(questionBlock);this.unUsedQuestionBlocks.splice(index,1);return questionBlock}};var QuestionBank$1=__AMD("extensions/adapt-contrib-assessment/js/adapt-assessmentQuestionBank",QuestionBank);var givenIdCount=0;var assessmentConfigDefaults={_isEnabled:true,_questions:{_resetType:"soft",_canShowFeedback:false,_canShowMarking:false,_canShowModelAnswer:false},_suppressMarking:false,_isPercentageBased:true,_scoreToPass:100,_includeInTotalScore:true,_assessmentWeight:1,_isResetOnRevisit:true,_reloadPageOnReset:true,_attempts:"infinite",_allowResetIfPassed:false};var AssessmentModel={_postInitialize:function(){if(!this.isAssessmentEnabled())return;var assessmentConfig=this.getConfig();_.extend(this,{_currentQuestionComponents:null,_originalChildModels:null,_questionBanks:null,_forceResetOnRevisit:false});var attemptsLeft;switch(assessmentConfig._attempts){case"infinite":case 0:case undefined:case-1:case null:attemptsLeft="infinite";break;default:attemptsLeft=assessmentConfig._attempts;break;}this.set({_currentQuestionComponentIds:[],_assessmentCompleteInSession:false,_attemptInProgress:false,_isAssessmentComplete:false,_numberOfQuestionsAnswered:0,_lastAttemptScoreAsPercent:0,_attempts:attemptsLeft,_attemptsLeft:attemptsLeft,_attemptsSpent:0});this.listenToOnce(Adapt,"app:dataReady",this._onDataReady);this.listenTo(Adapt,"remove",this._onRemove)},init:function(){this._originalChildModels=this.getChildren().models;this._currentQuestionComponents=this.findDescendantModels("components",{where:{_isQuestionType:true}});this.set("_currentQuestionComponentIds",this._currentQuestionComponents.map(function(comp){return comp.get("_id")}));this._setAssessmentOwnershipOnChildrenModels();this._updateQuestionsState()},_setAssessmentOwnershipOnChildrenModels:function(){var assessmentConfig=this.get("_assessment");var childConfig={_isPartOfAssessment:true,_assessmentId:assessmentConfig._id};for(var i=0,l=this._originalChildModels.length;i<l;i++){var blockModel=this._originalChildModels[i];blockModel.set(childConfig);blockModel.setOnChildren(childConfig)}},_onDataReady:function(){Adapt.assessment.register(this)},_setupAssessmentData:function(force,callback){var assessmentConfig=this.getConfig();var state=this.getState();var shouldResetAssessment=!this.get("_attemptInProgress")&&!state.isPass||force===true;var shouldResetQuestions=assessmentConfig._isResetOnRevisit&&(state.allowResetIfPassed||!state.isPass)||force===true;if(shouldResetAssessment||shouldResetQuestions){Adapt.trigger("assessments:preReset",this.getState(),this)}var quizModels;if(shouldResetAssessment){this.set({_numberOfQuestionsAnswered:0,_isAssessmentComplete:false,_assessmentCompleteInSession:false,_score:0});this.getChildren().models=this._originalChildModels;if(assessmentConfig._banks&&assessmentConfig._banks._isEnabled&&assessmentConfig._banks._split.length>1){quizModels=this._setupBankedAssessment()}else if(assessmentConfig._randomisation&&assessmentConfig._randomisation._isEnabled){quizModels=this._setupRandomisedAssessment()}}if(!quizModels){quizModels=this.getChildren().models}else if(quizModels.length===0){quizModels=this.getChildren().models;console.warn("assessment: Not enough unique questions to create a fresh assessment, using last selection")}this.getChildren().models=quizModels;this._currentQuestionComponents=this.findDescendantModels("components",{where:{_isQuestionType:true}});this.set("_currentQuestionComponentIds",this._currentQuestionComponents.map(function(comp){return comp.get("_id")}));if(shouldResetAssessment||shouldResetQuestions){this._resetQuestions(function(){this.set("_attemptInProgress",true);Adapt.trigger("assessments:reset",this.getState(),this);finalise.apply(this)}.bind(this))}else{finalise.apply(this)}function finalise(){if(!state.isComplete){this.set("_attemptInProgress",true)}this._overrideQuestionComponentSettings();this._setupQuestionListeners();this._checkNumberOfQuestionsAnswered();this._updateQuestionsState();Adapt.assessment.saveState();if(typeof callback==="function")callback.apply(this);if(shouldResetAssessment||shouldResetQuestions){Adapt.trigger("assessments:postReset",this.getState(),this)}}},_setupBankedAssessment:function(){var assessmentConfig=this.getConfig();this._setupBanks();var questionModels=[];for(var bankId in this._questionBanks){if(this._questionBanks.hasOwnProperty(bankId)){var questionBank=this._questionBanks[bankId];var questions=questionBank.getRandomQuestionBlocks();questionModels=questionModels.concat(questions)}}if(assessmentConfig._banks._randomisation){questionModels=_.shuffle(questionModels)}return questionModels},_setupBanks:function(){var assessmentConfig=this.getConfig();var banks=assessmentConfig._banks._split.split(",");var bankId;this._questionBanks=[];for(var i=0,l=banks.length;i<l;i++){var bank=banks[i];bankId=i+1;var questionBank=new QuestionBank$1(bankId,this.get("_id"),bank,true);this._questionBanks[bankId]=questionBank}var children=this.getChildren().models;for(var j=0,count=children.length;j<count;j++){var blockModel=children[j];var blockAssessmentConfig=blockModel.get("_assessment");if(!blockAssessmentConfig)continue;bankId=blockAssessmentConfig._quizBankID;this._questionBanks[bankId].addBlock(blockModel)}},_setupRandomisedAssessment:function(){var assessmentConfig=this.getConfig();var randomisationModel=assessmentConfig._randomisation;var blockModels=this.getChildren().models;var questionModels=_.shuffle(blockModels);if(randomisationModel._blockCount>0){questionModels=questionModels.slice(0,randomisationModel._blockCount)}return questionModels},_overrideQuestionComponentSettings:function(){var newSettings=this._getMarkingSettings();var questionConfig=this.getConfig()._questions;if(questionConfig.hasOwnProperty("_canShowFeedback")){newSettings._canShowFeedback=questionConfig._canShowFeedback}if(!_.isEmpty(newSettings)){for(var i=0,l=this._currentQuestionComponents.length;i<l;i++){this._currentQuestionComponents[i].set(newSettings,{pluginName:"_assessment"})}}},_setupQuestionListeners:function(){var questionComponents=this._currentQuestionComponents;for(var i=0,l=questionComponents.length;i<l;i++){var question=questionComponents[i];if(question.get("_isInteractionComplete"))continue;this.listenTo(question,"change:_isInteractionComplete",this._onQuestionCompleted)}},_checkNumberOfQuestionsAnswered:function(){var questionComponents=this._currentQuestionComponents;var numberOfQuestionsAnswered=0;for(var i=0,l=questionComponents.length;i<l;i++){var question=questionComponents[i];if(question.get("_isInteractionComplete")){numberOfQuestionsAnswered++}}this.set("_numberOfQuestionsAnswered",numberOfQuestionsAnswered)},_removeQuestionListeners:function(){var questionComponents=this._currentQuestionComponents;if(!questionComponents)return;for(var i=0,l=questionComponents.length;i<l;i++){var question=questionComponents[i];this.stopListening(question,"change:_isInteractionComplete",this._onQuestionCompleted)}},_onQuestionCompleted:function(questionModel,value){if(value===false)return;if(!questionModel.get("_isInteractionComplete"))return;var numberOfQuestionsAnswered=this.get("_numberOfQuestionsAnswered");numberOfQuestionsAnswered++;this.set("_numberOfQuestionsAnswered",numberOfQuestionsAnswered);this._updateQuestionsState();Adapt.assessment.saveState();this._checkAssessmentComplete()},_checkAssessmentComplete:function(){var numberOfQuestionsAnswered=this.get("_numberOfQuestionsAnswered");var allQuestionsAnswered=numberOfQuestionsAnswered>=this._currentQuestionComponents.length;if(!allQuestionsAnswered)return;this._onAssessmentComplete()},_onAssessmentComplete:function(){this.set("_attemptInProgress",false);this._spendAttempt();var scoreAsPercent=this._getScoreAsPercent();var score=this._getScore();var maxScore=this._getMaxScore();this.set({_scoreAsPercent:scoreAsPercent,_score:score,_maxScore:maxScore,_lastAttemptScoreAsPercent:scoreAsPercent,_assessmentCompleteInSession:true,_isAssessmentComplete:true});this._updateQuestionsState();this._checkIsPass();this._removeQuestionListeners();if(this._isMarkingSuppressionEnabled()&&!this._isAttemptsLeft()){_.defer(function(){this._overrideMarkingSettings();this._refreshQuestions()}.bind(this))}Adapt.trigger("assessments:complete",this.getState(),this)},_updateQuestionsState:function(){var questions=[];var questionComponents=this._currentQuestionComponents;for(var i=0,l=questionComponents.length;i<l;i++){var questionComponent=questionComponents[i];var questionModel={_id:questionComponent.get("_id"),_isCorrect:questionComponent.get("_isCorrect")===undefined?null:questionComponent.get("_isCorrect")};questions.push(questionModel)}this.set("_questions",questions)},_checkIsPass:function(){var assessmentConfig=this.getConfig();var isPercentageBased=assessmentConfig._isPercentageBased;var scoreToPass=assessmentConfig._scoreToPass;var scoreAsPercent=this.get("_scoreAsPercent");var score=this.get("_score");var isPass=isPercentageBased?scoreAsPercent>=scoreToPass:score>=scoreToPass;this.set("_isPass",isPass)},_getMarkingSettings:function(){var markingSettings={};if(this._shouldSuppressMarking()){markingSettings={_canShowMarking:false,_canShowModelAnswer:false}}else{var questionConfig=this.getConfig()._questions;if(questionConfig.hasOwnProperty("_canShowModelAnswer")){markingSettings._canShowModelAnswer=questionConfig._canShowModelAnswer}if(questionConfig.hasOwnProperty("_canShowMarking")){markingSettings._canShowMarking=questionConfig._canShowMarking}}return markingSettings},_overrideMarkingSettings:function(){var newMarkingSettings=this._getMarkingSettings();for(var i=0,l=this._currentQuestionComponents.length;i<l;i++){this._currentQuestionComponents[i].set(newMarkingSettings,{pluginName:"_assessment"})}},_refreshQuestions:function(){for(var a=0,b=this._currentQuestionComponents.length;a<b;a++){var question=this._currentQuestionComponents[a];question.refresh()}},_shouldSuppressMarking:function(){return this._isMarkingSuppressionEnabled()&&this._isAttemptsLeft()},_isMarkingSuppressionEnabled:function(){var assessmentConfig=this.getConfig();return assessmentConfig._suppressMarking},_isAttemptsLeft:function(){if(this.get("_isAssessmentComplete")&&this.get("_isPass"))return false;if(this.get("_attemptsLeft")===0)return false;return true},_spendAttempt:function(){if(!this._isAttemptsLeft())return false;var attemptsSpent=this.get("_attemptsSpent");this.set("_attemptsSpent",++attemptsSpent);if(this.get("_attempts")==="infinite")return true;var attemptsLeft=this.get("_attemptsLeft");this.set("_attemptsLeft",--attemptsLeft);return true},_getScore:function(){var score=0;var questionComponents=this._currentQuestionComponents;for(var i=0,l=questionComponents.length;i<l;i++){var question=questionComponents[i];if(question.get("_isCorrect")&&question.get("_questionWeight")){score+=question.get("_questionWeight")}}return score},_getMaxScore:function(){var maxScore=0;var questionComponents=this._currentQuestionComponents;for(var i=0,l=questionComponents.length;i<l;i++){var question=questionComponents[i];if(question.get("_questionWeight")){maxScore+=question.get("_questionWeight")}}return maxScore},_getScoreAsPercent:function(){if(this._getMaxScore()===0)return 0;return Math.round(this._getScore()/this._getMaxScore()*100)},_getLastAttemptScoreAsPercent:function(){return this.get("_lastAttemptScoreAsPercent")},_checkReloadPage:function(){if(!this.canResetInPage())return false;var parentId=this.getParent().get("_id");var currentLocation=Adapt.location._currentId;if(currentLocation!==parentId)return false;if(!this.get("_isReady"))return false;return true},_reloadPage:function(callback){this._forceResetOnRevisit=true;this.listenToOnce(Adapt,"pageView:ready",callback);_.delay(function(){Backbone.history.navigate("#/id/"+Adapt.location._currentId,{replace:true,trigger:true})},250)},_resetQuestions:function(callback){var assessmentConfig=this.getConfig();var syncIterations=1;var i=0;var qs=this._currentQuestionComponents;var len=qs.length;function step(){for(var j=0,count=Math.min(syncIterations,len-i);j<count;i++,j++){var question=qs[i];question.reset(assessmentConfig._questions._resetType,true)}i===len?callback():setTimeout(step)}step()},_onRemove:function(){this._removeQuestionListeners()},_setCompletionStatus:function(){this.set({_isComplete:true,_isInteractionComplete:true})},_checkIfQuestionsWereRestored:function(){if(this.get("_assessmentCompleteInSession"))return;if(!this.get("_isAssessmentComplete"))return;var wereQuestionsRestored=true;var questions=this.get("_questions");for(var i=0,l=questions.length;i<l;i++){var question=questions[i];var questionModel=Adapt.findById(question._id);if(!questionModel.get("_isSubmitted")){wereQuestionsRestored=false;break}}if(!wereQuestionsRestored){this.set("_assessmentCompleteInSession",true);return true}return false},isAssessmentEnabled:function(){if(this.get("_assessment")&&this.get("_assessment")._isEnabled)return true;return false},canResetInPage:function(){var assessmentConfig=this.getConfig();if(assessmentConfig._reloadPageOnReset===false)return false;return true},reset:function(force,callback){if(this._isResetInProgress){this.once("reset",function(){this._isResetInProgress=false;if(typeof callback==="function"){callback(true)}});return}var assessmentConfig=this.getConfig();force=this._forceResetOnRevisit||force===true;this._forceResetOnRevisit=false;var isPageReload=this._checkReloadPage();if(this.get("_assessmentCompleteInSession")&&!assessmentConfig._isResetOnRevisit&&!isPageReload&&!force){if(typeof callback==="function"){callback(false)}return false}var wereQuestionsRestored=this._checkIfQuestionsWereRestored();force=force||wereQuestionsRestored;if(force&&!this._isAttemptsLeft()){this.set({_attemptsLeft:this.get("_attempts"),_attemptsSpent:0})}var allowResetIfPassed=this.get("_assessment")._allowResetIfPassed;if(!this._isAttemptsLeft()&&!force&&!allowResetIfPassed){if(typeof callback==="function")callback(false);return false}if(!isPageReload){this.once("reset",function(){this._isResetInProgress=false;if(typeof callback==="function"){callback(true)}});this._isResetInProgress=true;this._setupAssessmentData(force,function(){this.trigger("reset")})}else{this._reloadPage(function(){if(typeof callback==="function"){callback(true)}})}return true},getSaveState:function(){var state=this.getState();var blocks;var cfg=this.getConfig();var banksActive=cfg._banks&&cfg._banks._isEnabled&&cfg._banks._split.length>1;var randomisationActive=cfg._randomisation&&cfg._randomisation._isEnabled;if(!banksActive&&!randomisationActive){blocks=this.findDescendantModels("block")}else{blocks=state.questions.map(function(question){return Adapt.findById(question._id).getParent()})}blocks=blocks.filter(function(block){var trackingId=block.get("_trackingId");return Number.isInteger(trackingId)&&trackingId>=0});var blockTrackingIds=blocks.map(function(block){return block.get("_trackingId")});var blockCompletion=blocks.map(function(block){var questions=block.findDescendantModels("question");return questions.map(function(question){return question.get("_isCorrect")||false})});var blockData=[blockTrackingIds,blockCompletion];var saveState=[state.isComplete?1:0,state.attemptsSpent,state.maxScore||0,state.score,state.attemptInProgress?1:0];var dataPackage=[saveState,blockData];return dataPackage},setRestoreState:function(dataPackage){var restoreState=dataPackage[0];var blockData=dataPackage[1];var isComplete=restoreState[0]===1;var attempts=this.get("_attempts");var attemptsSpent=restoreState[1];var maxScore=restoreState[2];var score=restoreState[3];var scoreAsPercent=score?Math.round(score/maxScore*100):0;var attemptInProgress=restoreState[4]===1;var blocks=blockData[0].map(function(trackingId){return Adapt.data.findWhere({_trackingId:trackingId})});if(blocks.length){this.getChildren().models=blocks}this.set({_isAssessmentComplete:isComplete,_assessmentCompleteInSession:false,_attemptsSpent:attemptsSpent,_attemptInProgress:attemptInProgress,_attemptsLeft:attempts==="infinite"?attempts:attempts-attemptsSpent,_maxScore:maxScore||this._getMaxScore(),_score:score||0,_scoreAsPercent:scoreAsPercent,_lastAttemptScoreAsPercent:scoreAsPercent});var questions=[];blocks.forEach(function(block,blockIndex){var blockQuestions=block.findDescendantModels("question");blockQuestions.forEach(function(question,questionIndex){questions.push({_id:question.get("_id"),_isCorrect:blockData[1][blockIndex][questionIndex]})})});this.set("_questions",questions);if(isComplete)this._checkIsPass();Adapt.trigger("assessments:restored",this.getState(),this)},getState:function(){var assessmentConfig=this.getConfig();var state={id:assessmentConfig._id,type:"article-assessment",pageId:this.getParent().get("_id"),articleId:this.get("_id"),isEnabled:assessmentConfig._isEnabled,isComplete:this.get("_isAssessmentComplete"),isPercentageBased:assessmentConfig._isPercentageBased,scoreToPass:assessmentConfig._scoreToPass,score:this.get("_score"),scoreAsPercent:this.get("_scoreAsPercent"),maxScore:this.get("_maxScore"),isPass:this.get("_isPass"),includeInTotalScore:assessmentConfig._includeInTotalScore,assessmentWeight:assessmentConfig._assessmentWeight,attempts:this.get("_attempts"),attemptsSpent:this.get("_attemptsSpent"),attemptsLeft:this.get("_attemptsLeft"),attemptInProgress:this.get("_attemptInProgress"),lastAttemptScoreAsPercent:this.get("_lastAttemptScoreAsPercent"),questions:this.get("_questions"),resetType:assessmentConfig._questions._resetType,allowResetIfPassed:assessmentConfig._allowResetIfPassed,questionModels:new Backbone.Collection(this._currentQuestionComponents)};return state},getConfig:function(){var assessmentConfig=this.get("_assessment");if(!assessmentConfig){assessmentConfig=$.extend(true,{},assessmentConfigDefaults)}else{assessmentConfig=$.extend(true,{},assessmentConfigDefaults,assessmentConfig)}if(assessmentConfig._id===undefined){assessmentConfig._id="givenId"+givenIdCount++}this.set("_assessment",assessmentConfig);return assessmentConfig}};var AdaptAssessmentArticleModel=__AMD("extensions/adapt-contrib-assessment/js/adapt-assessmentArticleModel",AssessmentModel);var assessmentsConfigDefaults={_isPercentageBased:true,_scoreToPass:100,_isDefaultsLoaded:true};Adapt.assessment=_.extend({_assessments:_.extend([],{_byPageId:{},_byAssessmentId:{}}),initialize:function(){this.listenTo(Adapt,{"assessments:complete":this._onAssessmentsComplete,"router:location":this._checkResetAssessmentsOnRevisit,"router:plugin":this._handleRoute,"app:dataReady":this._onDataReady})},_onAssessmentsComplete:function(state){var assessmentId=state.id;state.isComplete=true;if(assessmentId===undefined)return;if(!this._getStateByAssessmentId(assessmentId)){Adapt.log.warn("assessments: state was not registered when assessment was created")}this.saveState();this._setPageProgress();this._checkAssessmentsComplete()},_restoreModelState:function(assessmentModel){if(!this._saveStateModel){this._saveStateModel=Adapt.offlineStorage.get("a")}if(this._saveStateModel){var state=assessmentModel.getState();if(this._saveStateModel[state.id]){assessmentModel.setRestoreState(Adapt.offlineStorage.deserialize(this._saveStateModel[state.id]))}}},_handleRoute:function(plugin,id){if(plugin!=="assessment"&&plugin!=="article-assessment"||id===undefined){return}if(!Adapt.findById(id)){var assessment=Adapt.assessment._assessments._byAssessmentId[id];if(assessment){id=assessment.get("_id")}else{Adapt.log.warn("Assessment not found with _id: "+id);return}}_.defer(function(){Backbone.history.navigate("#/id/"+id,{trigger:true,replace:true})})},_checkResetAssessmentsOnRevisit:function(toObject){if(toObject._contentType!=="page")return;var pageAssessmentModels=this._getAssessmentByPageId(toObject._currentId);if(pageAssessmentModels===undefined)return;Adapt.wait.for(function resetAllAssessments(allAssessmentHaveReset){var numberOfAssessments=pageAssessmentModels.length;var numberOfResetAssessments=0;var forceAssessmentReset=false;pageAssessmentModels.forEach(function(model){model.reset(forceAssessmentReset,function(){numberOfResetAssessments++;var haveAllModelsReset=numberOfResetAssessments===numberOfAssessments;if(!haveAllModelsReset){return}allAssessmentHaveReset()})})});this._setPageProgress()},_onDataReady:function(){this._assessments=_.extend([],{_byPageId:{},_byAssessmentId:{}});this._restoredCount=0},_checkAssessmentsComplete:function(){var allAssessmentsComplete=true;var assessmentToPostBack=0;var states=this._getStatesByAssessmentId();var assessmentStates=[];for(var id in states){var state=states[id];if(!state.includeInTotalScore)continue;if(!state.isComplete){allAssessmentsComplete=false;break}assessmentToPostBack++;assessmentStates.push(state)}if(!allAssessmentsComplete||assessmentToPostBack===0)return false;if(assessmentToPostBack===1){this._setupSingleAssessmentConfiguration(assessmentStates[0])}_.defer(function(){Adapt.trigger("assessment:complete",this.getState())}.bind(this));return true},_setupSingleAssessmentConfiguration:function(assessmentState){var assessmentsConfig=Adapt.course.get("_assessment");$.extend(true,assessmentsConfig,{_isPercentageBased:assessmentState.isPercentageBased,_scoreToPass:assessmentState.scoreToPass});Adapt.course.set("_assessment",assessmentsConfig)},_getAssessmentByPageId:function(pageId){return this._assessments._byPageId[pageId]},_getStateByAssessmentId:function(assessmentId){if(assessmentId===undefined){return null}return this._assessments._byAssessmentId[assessmentId].getState()},_getStatesByAssessmentId:function(){var states={};for(var i=0,l=this._assessments.length;i<l;i++){var assessmentModel=this._assessments[i];if(!assessmentModel.get("_isAvailable"))continue;var state=assessmentModel.getState();states[state.id]=state}return states},_setPageProgress:function(){for(var k in this._assessments._byPageId){var assessments=this._assessments._byPageId[k];var assessmentsTotal=assessments.length;var assessmentsPassed=0;for(var i=0,l=assessments.length;i<l;i++){var assessmentState=assessments[i].getState();if(assessmentState.includeInTotalScore&&!assessmentState.isPass)continue;if(assessmentState.isComplete){assessmentsPassed++}}try{var pageModel=Adapt.findById(k);pageModel.set({_subProgressTotal:assessmentsTotal,_subProgressComplete:assessmentsPassed})}catch(e){}}},_addToAssessmentIdMap:function(id,model){if(id===undefined){Adapt.log.warn("An assessment has been registered with an undefined value for \"_id\"");return}if(id===""){Adapt.log.warn("An assessment has been registered with an empty value for \"_id\"")}if(!this._assessments._byAssessmentId[id]){this._assessments._byAssessmentId[id]=model}else{Adapt.log.warn("An assessment with an _id of \""+id+"\" already exists!")}},_setupQuestionNumbering:function(){var getRelatedQuestions=function(data){var currentAssessmentId=data._assessmentId;var currentAssessment=Adapt.assessment.get(currentAssessmentId);return currentAssessment.getState().questions};Handlebars.registerHelper("questionNumber",function getQuestionNumber(){var data=this.view?this.view.model.toJSON():this;if(!data._isPartOfAssessment)return;var related=_.pluck(getRelatedQuestions(data),"_id");return related.indexOf(data._id)+1});Handlebars.registerHelper("questionCount",function getTotalQuestions(){var data=this.view?this.view.model.toJSON():this;if(!data._isPartOfAssessment)return;return getRelatedQuestions(data).length})},register:function(assessmentModel){var state=assessmentModel.getState();var assessmentId=state.id;var pageId=state.pageId;if(this._assessments._byPageId[pageId]===undefined){this._assessments._byPageId[pageId]=[]}this._assessments._byPageId[pageId].push(assessmentModel);this._addToAssessmentIdMap(assessmentId,assessmentModel);this._assessments.push(assessmentModel);this._restoreModelState(assessmentModel);this._restoredCount++;Adapt.trigger("assessments:register",state,assessmentModel);this._setPageProgress();this._setupQuestionNumbering();if(this._restoredCount===this._assessments.length){Adapt.trigger("assessment:restored",this.getState())}},get:function(id){if(id===undefined){return this._assessments.slice(0)}else{return this._assessments._byAssessmentId[id]}},saveState:function(){this._saveStateModel={};for(var i=0,assessmentModel;assessmentModel=this._assessments[i++];){var state=assessmentModel.getState();this._saveStateModel[state.id]=Adapt.offlineStorage.serialize(assessmentModel.getSaveState())}Adapt.offlineStorage.set("a",this._saveStateModel)},getConfig:function(){var assessmentsConfig=Adapt.course.get("_assessment");if(assessmentsConfig&&assessmentsConfig._isDefaultsLoaded){return assessmentsConfig}if(assessmentsConfig===undefined){assessmentsConfig=$.extend(true,{},assessmentsConfigDefaults)}else{assessmentsConfig=$.extend(true,{},assessmentsConfigDefaults,assessmentsConfig)}Adapt.course.set("_assessment",assessmentsConfig);return assessmentsConfig},getState:function(){var assessmentsConfig=this.getConfig();var score=0;var maxScore=0;var isPass=false;var totalAssessments=0;var states=this._getStatesByAssessmentId();var assessmentsComplete=0;for(var id in states){var state=states[id];if(!state.includeInTotalScore)continue;if(state.isComplete)assessmentsComplete++;totalAssessments++;maxScore+=state.maxScore/state.assessmentWeight;score+=state.score/state.assessmentWeight}var isComplete=assessmentsComplete===totalAssessments;var scoreAsPercent=Math.round(score/maxScore*100);if((assessmentsConfig._scoreToPass||100)&&isComplete){if(assessmentsConfig._isPercentageBased!==false){if(scoreAsPercent>=assessmentsConfig._scoreToPass)isPass=true}else{if(score>=assessmentsConfig._scoreToPass)isPass=true}}return{isComplete:isComplete,isPercentageBased:assessmentsConfig._isPercentageBased,isPass:isPass,scoreAsPercent:scoreAsPercent,maxScore:maxScore,score:score,scoreToPass:assessmentsConfig._scoreToPass,assessmentsComplete:assessmentsComplete,assessments:totalAssessments}}},Backbone.Events);Adapt.assessment.initialize();var ArticleViewInitialize=ArticleView$1.prototype.initialize;ArticleView$1.prototype.initialize=function(options){if(this.model.get("_assessment")&&this.model.get("_assessment")._isEnabled===true){_.extend(this,AdaptAssessmentArticleView)}return ArticleViewInitialize.apply(this,arguments)};var ArticleModelInitialize=ArticleModel$1.prototype.initialize;ArticleModel$1.prototype.initialize=function(options){if(this.get("_assessment")&&this.get("_assessment")._isEnabled===true){_.extend(this,AdaptAssessmentArticleModel);var returnValue=ArticleModelInitialize.apply(this,arguments);this._postInitialize();return returnValue}return ArticleModelInitialize.apply(this,arguments)};var Bookmarking=function(_Backbone$Controller){_inherits(Bookmarking,_Backbone$Controller);var _super=_createSuper(Bookmarking);function Bookmarking(){_classCallCheck(this,Bookmarking);return _super.apply(this,arguments)}_createClass(Bookmarking,[{key:"initialize",value:function initialize(){this.bookmarkLevel=null;this.restoredLocationID=null;this.currentLocationID=null;this.listenToOnce(Adapt,"router:location",this.onAdaptInitialize)}},{key:"onAdaptInitialize",value:function onAdaptInitialize(){if(!this.checkIsEnabled())return;this.setupEventListeners();this.checkRestoreLocation()}},{key:"checkIsEnabled",value:function checkIsEnabled(){var courseBookmarkModel=Adapt.course.get("_bookmarking");if(!courseBookmarkModel||!courseBookmarkModel._isEnabled)return false;return true}},{key:"setupEventListeners",value:function setupEventListeners(){this._onScroll=_.debounce(this.checkLocation.bind(this),1000);this.listenTo(Adapt,{"menuView:ready":this.setupMenu,"pageView:preRender":this.setupPage})}},{key:"checkRestoreLocation",value:function checkRestoreLocation(){this.restoredLocationID=Adapt.offlineStorage.get("location");if(!this.restoredLocationID||this.restoredLocationID==="undefined"||!Adapt.findById(this.restoredLocationID)){return}this.listenToOnce(Adapt,"pageView:ready menuView:ready",this.restoreLocation)}},{key:"restoreLocation",value:function restoreLocation(){var _this=this;this.stopListening(Adapt,"pageView:ready menuView:ready",this.restoreLocation);_.delay(function(){if(_this.isAlreadyOnScreen(_this.restoredLocationID)){return}if(Adapt.course.get("_bookmarking")._showPrompt===false){_this.navigateToPrevious();return}_this.showPrompt()},500)}},{key:"isAlreadyOnScreen",value:function isAlreadyOnScreen(id){if(id===Adapt.location._currentId)return true;var type=Adapt.findById(id).getTypeGroup();if(type==="menu"||type==="page"){return false}var locationOnscreen=$("."+id).onscreen();var isLocationOnscreen=locationOnscreen&&locationOnscreen.percentInview>0;var isLocationFullyInview=locationOnscreen&&locationOnscreen.percentInview===100;if(isLocationOnscreen&&isLocationFullyInview){return true}return false}},{key:"showPrompt",value:function showPrompt(){var courseBookmarkModel=Adapt.course.get("_bookmarking");var buttons=courseBookmarkModel._buttons||{yes:"Yes",no:"No"};this.listenToOnce(Adapt,{"bookmarking:continue":this.navigateToPrevious,"bookmarking:cancel":this.navigateCancel});Adapt.notify.prompt({_classes:"is-bookmarking",_showIcon:true,title:courseBookmarkModel.title,body:courseBookmarkModel.body,_prompts:[{promptText:buttons.yes||"Yes",_callbackEvent:"bookmarking:continue"},{promptText:buttons.no||"No",_callbackEvent:"bookmarking:cancel"}]})}},{key:"navigateToPrevious",value:function navigateToPrevious(){var _this2=this;_.defer(_asyncToGenerator(regeneratorRuntime.mark(function _callee(){var isSinglePage;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:isSinglePage=Adapt.contentObjects.models.length===1;_context.next=3;return Adapt.router.navigateToElement(_this2.restoredLocationID,{trigger:true,replace:isSinglePage,duration:400});case 3:case"end":return _context.stop();}}},_callee)})));this.stopListening(Adapt,"bookmarking:cancel")}},{key:"navigateCancel",value:function navigateCancel(){this.stopListening(Adapt,"bookmarking:continue")}},{key:"resetLocationID",value:function resetLocationID(){this.setLocationID("")}},{key:"setupMenu",value:function setupMenu(menuView){var menuModel=menuView.model;if(!menuModel.get("_parentId")){this.resetLocationID();return}this.setLocationID(menuModel.get("_id"))}},{key:"getBookmarkLevel",value:function getBookmarkLevel(pageModel){var defaultLevel=Adapt.course.get("_bookmarking")._level||"component";var bookmarkModel=pageModel.get("_bookmarking");var isInherit=!bookmarkModel||!bookmarkModel._level||bookmarkModel._level==="inherit";return isInherit?defaultLevel:bookmarkModel._level}},{key:"setupPage",value:function setupPage(pageView){var pageBookmarkModel=pageView.model.get("_bookmarking");if(pageBookmarkModel&&pageBookmarkModel._isEnabled===false){this.resetLocationID();return}this.setLocationID(pageView.model.get("_id"));this.bookmarkLevel=this.getBookmarkLevel(pageView.model);if(this.bookmarkLevel==="page"){return}this.listenToOnce(Adapt,"remove",this.releaseViews);$(window).on("scroll",this._onScroll)}},{key:"setLocationID",value:function setLocationID(id){if(this.currentLocationID===id)return;Adapt.offlineStorage.set("location",id);this.currentLocationID=id}},{key:"releaseViews",value:function releaseViews(){this.stopListening(Adapt,"remove",this.releaseViews);$(window).off("scroll",this._onScroll)}},{key:"checkLocation",value:function checkLocation(){var currentModel=Adapt.location._currentModel;if(!currentModel)return;var possibleViewIds=currentModel.findDescendantModels(this.bookmarkLevel+"s").map(function(desc){return desc.get("_id")});var highestOnscreen=0;var highestOnscreenLocation="";possibleViewIds.forEach(function(id){var element=$("[data-adapt-id=".concat(id,"]"));if(!element.length)return;var measurements=element.onscreen();if(!measurements.onscreen)return;if(measurements.percentInview<=highestOnscreen)return;highestOnscreen=measurements.percentInview;highestOnscreenLocation=id});if(highestOnscreenLocation)this.setLocationID(highestOnscreenLocation)}}]);return Bookmarking}(Backbone.Controller);__AMD("extensions/adapt-contrib-bookmarking/js/adapt-contrib-bookmarking",new Bookmarking);var NavigationView$2=Backbone.View.extend({className:"nav",attributes:{role:"navigation"},initialize:function(){this.template="languagePickerNavigation";this.setupHelpers();this.preRender()},preRender:function(){Adapt.trigger("navigationView:preRender",this);this.render()},render:function(){var _this=this;var template=Handlebars.templates[this.template];this.$el.html(template({_config:this.model.get("_accessibility"),_accessibility:Adapt.config.get("_accessibility")})).insertBefore("#app");_.defer(function(){return Adapt.trigger("navigationView:postRender",_this)});return this},setupHelpers:function(){Handlebars.registerHelper("a11y_aria_label",function(text){return"<div class=\"aria-label\">".concat(text,"</div>")})}});var NavigationView$3=__AMD("extensions/adapt-contrib-languagePicker/js/languagePickerNavigationView",NavigationView$2);var LanguagePickerView=Backbone.View.extend({events:{"click .js-languagepicker-btn-click":"onLanguageClick"},className:"languagepicker",initialize:function(){this.initializeNavigation();$("html").addClass("in-languagepicker");this.listenTo(Adapt,"remove",this.remove);this.render()},render:function(){var data=this.model.toJSON();var template=Handlebars.templates[this.constructor.template];this.$el.html(template(data));this.$el.addClass(data._classes);document.title=this.model.get("title")||"";_.defer(this.postRender.bind(this))},postRender:function(){$(".js-loading").hide()},onLanguageClick:function(event){this.destroyNavigation();var lang=event.currentTarget.value;this.model.setLanguage(lang)},initializeNavigation:function(){this.navigationView=new NavigationView$3({model:this.model})},destroyNavigation:function(){this.navigationView.remove()},remove:function(){$("html").removeClass("in-languagepicker");Backbone.View.prototype.remove.apply(this,arguments)}},{template:"languagePickerView"});var LanguagePickerView$1=__AMD("extensions/adapt-contrib-languagePicker/js/languagePickerView",LanguagePickerView);var LanguagePickerDrawerView=Backbone.View.extend({events:{"click .js-languagepicker-item-btn":"onButtonClick"},initialize:function(){this.listenTo(Adapt,{remove:this.remove,"languagepicker:changelanguage:yes":this.onDoChangeLanguage,"languagepicker:changelanguage:no":this.onDontChangeLanguage});this.render()},render:function(){var data=this.model.toJSON();var template=Handlebars.templates[this.constructor.template];this.$el.html(template(data))},onButtonClick:function(event){var newLanguage=$(event.currentTarget).attr("data-language");this.model.set("newLanguage",newLanguage);var data=this.model.getLanguageDetails(newLanguage);var promptObject={_attributes:{lang:newLanguage},_classes:"is-lang-".concat(newLanguage," ").concat(data._direction==="rtl"?"is-rtl":"is-ltr"),title:data.warningTitle,body:data.warningMessage,_prompts:[{promptText:data._buttons.yes,_callbackEvent:"languagepicker:changelanguage:yes"},{promptText:data._buttons.no,_callbackEvent:"languagepicker:changelanguage:no"}],_showIcon:true};this.$finishFocus=Adapt.a11y._popup._focusStack.pop();Adapt.a11y._popup._focusStack.push($("#a11y-focuser"));Adapt.once("drawer:closed",function(){_.delay(function(){Adapt.once("popup:opened",function(){Adapt.a11y._popup._focusStack.pop();Adapt.a11y._popup._focusStack.push($("#a11y-focuser"))});Adapt.notify.prompt(promptObject)},250)});Adapt.trigger("drawer:closeDrawer")},onDoChangeLanguage:function(){var newLanguage=this.model.get("newLanguage");this.model.setTrackedData();this.model.setLanguage(newLanguage);this.remove()},onDontChangeLanguage:function(){var _this=this;this.remove();_.delay(function(){return Adapt.a11y.focusFirst(_this.$finishFocus)},500)}},{template:"languagePickerDrawerView"});var LanguagePickerDrawerView$1=__AMD("extensions/adapt-contrib-languagePicker/js/languagePickerDrawerView",LanguagePickerDrawerView);var LanguagePickerNavView=Backbone.View.extend({tagName:"button",className:function(){var classNames="btn-icon nav__btn nav__languagepicker-btn js-languagepicker-nav-btn icon";var customClass=this.model.get("_languagePickerIconClass")||"icon-language-2";return classNames+" "+customClass},events:{"click":"onClick"},initialize:function(){this.listenTo(Adapt,"remove",this.remove)},onClick:function(event){Adapt.drawer.triggerCustomView(new LanguagePickerDrawerView$1({model:this.model}).$el,false)}});var LanguagePickerNavView$1=__AMD("extensions/adapt-contrib-languagePicker/js/languagePickerNavView",LanguagePickerNavView);var LanguagePickerModel=Backbone.Model.extend({defaults:{_isEnabled:false,displayTitle:"",body:"",_languages:[]},trackedData:{components:[],blocks:[]},locationId:null,initialize:function(){this.listenTo(Adapt.config,"change:_activeLanguage",this.markLanguageAsSelected);this.listenTo(Adapt,"app:dataLoaded",this.onDataLoaded)},getLanguageDetails:function(language){var _languages=this.get("_languages");return _.find(_languages,function(item){return item._language===language})},setLanguage:function(language){Adapt.config.set({_activeLanguage:language,_defaultDirection:this.getLanguageDetails(language)._direction})},markLanguageAsSelected:function(model,language){this.get("_languages").forEach(function(item){item._isSelected=item._language===language})},onDataLoaded:function(){var _this=this;if(!this.get("_restoreStateOnLanguageChange")){return}_.defer(function(){_this.locationId=Adapt.offlineStorage.get("location")||null;_this.restoreState()})},restoreLocation:function(){var _this2=this;if(!Adapt.findById(this.locationId))return;_.defer(function(){return Adapt.navigateToElement("."+_this2.locationId)})},restoreState:function(){if(this.isTrackedDataEmpty())return;if(this.trackedData.components){this.trackedData.components.forEach(this.setTrackableState)}if(this.trackedData.blocks){this.trackedData.blocks.forEach(this.setTrackableState)}},isTrackedDataEmpty:function(){return _.isEqual(this.trackedData,{components:[],blocks:[]})},getTrackableState:function(){var components=this.getState(Adapt.components.models);var blocks=this.getState(Adapt.blocks.models);return{components:_.compact(components),blocks:_.compact(blocks)}},getState:function(models){return models.map(function(model){if(model.get("_isComplete")){return model.getTrackableState()}})},setTrackedData:function(){if(!this.get("_restoreStateOnLanguageChange")){return}this.listenToOnce(Adapt,"menuView:ready",this.restoreLocation);this.trackedData=this.getTrackableState()},setTrackableState:function(stateObject){var restoreModel=Adapt.findById(stateObject._id);if(!restoreModel){Adapt.log.warn("LanguagePicker unable to restore state for: "+stateObject._id);return}restoreModel.setTrackableState(stateObject)}});var LanguagePickerModel$1=__AMD("extensions/adapt-contrib-languagePicker/js/languagePickerModel",LanguagePickerModel);var languagePickerModel;Adapt.once("configModel:dataLoaded",onConfigLoaded);function onConfigLoaded(){if(!Adapt.config.has("_languagePicker"))return;if(!Adapt.config.get("_languagePicker")._isEnabled)return;Adapt.config.set("_canLoadData",false);languagePickerModel=new LanguagePickerModel$1(Adapt.config.get("_languagePicker"));Adapt.on("router:menu router:page",setupNavigationView);if(Adapt.offlineStorage.ready){onOfflineStorageReady();return}Adapt.once("offlineStorage:ready",onOfflineStorageReady)}function onOfflineStorageReady(){var storedLanguage=Adapt.offlineStorage.get("lang");if(storedLanguage){languagePickerModel.setLanguage(storedLanguage);return}if(languagePickerModel.get("_showOnCourseLoad")===false){languagePickerModel.setLanguage(Adapt.config.get("_defaultLanguage"));return}showLanguagePickerView()}function showLanguagePickerView(){var languagePickerView=new LanguagePickerView$1({model:languagePickerModel});languagePickerView.$el.appendTo("#wrapper")}function setupNavigationView(){var courseGlobals=Adapt.course.get("_globals")._extensions;var navigationBarLabel="";if(courseGlobals._languagePicker){navigationBarLabel=courseGlobals._languagePicker.navigationBarLabel}var languagePickerNavView=new LanguagePickerNavView$1({model:languagePickerModel,attributes:{"aria-label":navigationBarLabel}});languagePickerNavView.$el.appendTo(".nav__inner")}var Completion=Backbone.Controller.extend({subProgressCompleted:0,subProgressTotal:0,nonAssessmentCompleted:0,nonAssessmentTotal:0,assessmentCompleted:0,assessmentTotal:0});function calculateCompletion(contentObjectModel){var completion=new Completion;var viewType=contentObjectModel.get("_type");var isComplete=contentObjectModel.get("_isComplete")?1:0;var children;switch(viewType){case"page":children=contentObjectModel.getAllDescendantModels().filter(function(model){return model.get("_isAvailable")&&!model.get("_isOptional")});var availableChildren=filterAvailableChildren(children);var components=getPageLevelProgressEnabledModels(availableChildren);var nonAssessmentComponents=getNonAssessmentComponents(components);completion.nonAssessmentTotal=nonAssessmentComponents.length;completion.nonAssessmentCompleted=getComponentsCompleted(nonAssessmentComponents).length;var assessmentComponents=getAssessmentComponents(components);completion.assessmentTotal=assessmentComponents.length;completion.assessmentCompleted=getComponentsInteractionCompleted(assessmentComponents).length;if(contentObjectModel.get("_pageLevelProgress")._excludeAssessments!==true){completion.subProgressCompleted=contentObjectModel.get("_subProgressComplete")||0;completion.subProgressTotal=contentObjectModel.get("_subProgressTotal")||0}var showPageCompletionCourse=Adapt.course.get("_pageLevelProgress")&&Adapt.course.get("_pageLevelProgress")._showPageCompletion!==false;var showPageCompletionPage=contentObjectModel.get("_pageLevelProgress")&&contentObjectModel.get("_pageLevelProgress")._showPageCompletion!==false;if(showPageCompletionCourse&&showPageCompletionPage){completion.nonAssessmentCompleted+=isComplete;completion.nonAssessmentTotal+=1}break;case"menu":case"course":children=contentObjectModel.get("_children").models;children.forEach(function(contentObject){var completionObject=calculateCompletion(contentObject);completion.subProgressCompleted+=completionObject.subProgressCompleted||0;completion.subProgressTotal+=completionObject.subProgressTotal||0;completion.nonAssessmentTotal+=completionObject.nonAssessmentTotal;completion.nonAssessmentCompleted+=completionObject.nonAssessmentCompleted;completion.assessmentTotal+=completionObject.assessmentTotal;completion.assessmentCompleted+=completionObject.assessmentCompleted});break;}return completion}function getNonAssessmentComponents(models){return models.filter(function(model){return!model.get("_isPartOfAssessment")})}function getAssessmentComponents(models){return models.filter(function(model){return model.get("_isPartOfAssessment")})}function getComponentsCompleted(models){return models.filter(function(item){return item.get("_isComplete")})}function getComponentsInteractionCompleted(models){return models.filter(function(item){return item.get("_isComplete")})}function getPageLevelProgressEnabledModels(models){return models.filter(function(model){var config=model.get("_pageLevelProgress");return config&&config._isEnabled})}function unavailableInHierarchy(parents){if(!parents)return;return parents.some(function(parent){return!parent.get("_isAvailable")})}function filterAvailableChildren(children){var availableChildren=[];for(var i=0,count=children.length;i<count;i++){var parents=children[i].getAncestorModels();if(unavailableInHierarchy(parents))continue;availableChildren.push(children[i])}return availableChildren}function calculatePercentageComplete(model){var completionObject=calculateCompletion(model);var completed=completionObject.nonAssessmentCompleted+completionObject.assessmentCompleted+completionObject.subProgressCompleted;var total=completionObject.nonAssessmentTotal+completionObject.assessmentTotal+completionObject.subProgressTotal;var percentageComplete=Math.floor(completed/total*100);return percentageComplete}var completionCalculations=__AMD("extensions/adapt-contrib-pageLevelProgress/js/completionCalculations",{calculateCompletion:calculateCompletion,calculatePercentageComplete:calculatePercentageComplete,getPageLevelProgressEnabledModels:getPageLevelProgressEnabledModels,filterAvailableChildren:filterAvailableChildren});var PageLevelProgressIndicatorView=Backbone.View.extend({initialize:function(options){options=options||{};this.parent=options.parent;this.calculatePercentage=options.calculatePercentage||this.calculatePercentage;this.ariaLabel=options.ariaLabel||"";this.type=options.type||this.model.get("_type");this.addClasses();this.setUpEventListeners();this.setPercentageComplete();this.render();this.refresh()},addClasses:function(){this.$el.addClass(["pagelevelprogress__indicator","is-"+this.type].join(" "))},checkAria:function(){if(!this.ariaLabel){this.$el.attr("aria-hidden",true);return}var data=this.getRenderData();this.$(".js-indicator-aria-label").html(Handlebars.compile(this.ariaLabel)(data))},setUpEventListeners:function(){if(this.parent){this.listenToOnce(this.parent,"postRemove",this.remove)}else{this.listenTo(Adapt,"remove",this.remove)}this.listenTo(this.model,"change:_isComplete",this.refresh);if(!this.collection)return;this.listenTo(this.collection,"change:_isComplete",this.refresh)},setPercentageComplete:function(){var percentage=this.calculatePercentage();this.model.set("percentageComplete",percentage);return percentage},calculatePercentage:function(){return this.model.get("_isComplete")?100:0},render:function(){var data=this.getRenderData();var template=Handlebars.templates[this.constructor.template];this.$el.html(template(data))},getRenderData:function(){var data=this.model.toJSON();data.ariaLabel=this.ariaLabel;data.type=this.type;return data},refresh:function(){this.checkCompletion();this.checkAria();this.$(".js-indicator-bar").css({width:this.calculatePercentage()+"%"})},checkCompletion:function(){var percentage=this.setPercentageComplete();this.$el.toggleClass("is-complete",percentage===100).toggleClass("is-incomplete",percentage!==100)}},{template:"pageLevelProgressIndicator"});var PageLevelProgressIndicatorView$1=__AMD("extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressIndicatorView",PageLevelProgressIndicatorView);var PageLevelProgressItemView=Backbone.View.extend({className:function(){return["pagelevelprogress__item drawer__item",this.model.get("_type")+"__indicator"].join(" ")},attributes:{"role":"listitem"},initialize:function(){this.listenTo(Adapt,"remove",this.remove);this.render();this.addIndicator()},render:function(){var data=this.model.toJSON();var template=Handlebars.templates[this.constructor.template];this.$el.html(template(data))},addIndicator:function(){if(this.model.get("_isOptional"))return;var item=new PageLevelProgressIndicatorView$1({model:this.model});this.$(".js-indicator").append(item.$el)}},{template:"pageLevelProgressItem"});var PageLevelProgressItemView$1=__AMD("extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressItemView",PageLevelProgressItemView);var PageLevelProgressView=Backbone.View.extend({className:"pagelevelprogress",events:{"click .js-pagelevelprogress-item-click":"scrollToPageElement"},initialize:function(){this.listenTo(Adapt,"remove",this.remove);this.render();this.addChildren()},scrollToPageElement:function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark(function _callee(event){var $target,id,model,currentComponentSelector;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(event&&event.preventDefault)event.preventDefault();$target=$(event.currentTarget);if(!$target.is(".is-disabled")){_context.next=4;break}return _context.abrupt("return");case 4:id=$target.attr("data-pagelevelprogress-id");model=Adapt.findById(id);if(model.get("_isRendered")){_context.next=15;break}_context.prev=7;_context.next=10;return Adapt.parentView.renderTo(id);case 10:_context.next=15;break;case 12:_context.prev=12;_context.t0=_context["catch"](7);return _context.abrupt("return");case 15:currentComponentSelector="."+id;Adapt.once("drawer:closed",function(){Adapt.scrollTo(currentComponentSelector,{duration:400})}).trigger("drawer:closeDrawer",$(currentComponentSelector));case 17:case"end":return _context.stop();}}},_callee,null,[[7,12]])}));return function scrollToPageElement(_x){return _ref.apply(this,arguments)}}(),render:function(){var template=Handlebars.templates["pageLevelProgress"];this.$el.html(template({}))},addChildren:function(){var $children=this.$(".js-children");this.collection.each(function(model){$children.append(new PageLevelProgressItemView$1({model:model}).$el)}.bind(this))}});var PageLevelProgressView$1=__AMD("extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressView",PageLevelProgressView);var PageLevelProgressNavigationView=Backbone.View.extend({tagName:"button",className:"btn-icon nav__btn nav__pagelevelprogress-btn pagelevelprogress__nav-btn",events:{"click":"onProgressClicked"},initialize:function(){_.bindAll(this,"updateProgressBar");this.setUpEventListeners();this.render();this.addIndicator();this.deferredUpdate()},setUpEventListeners:function(){this.listenTo(Adapt,{"remove":this.remove,"router:location":this.updateProgressBar,"view:childAdded pageLevelProgress:update":this.refreshProgressBar})},render:function(){var template=Handlebars.templates["pageLevelProgressNavigation"];this.$el.html(template({}))},addIndicator:function(){this.indicatorView=new PageLevelProgressIndicatorView$1({model:this.model,collection:this.collection,calculatePercentage:this._getPageCompletionPercentage,ariaLabel:Adapt.course.get("_globals")._extensions._pageLevelProgress.pageLevelProgressIndicatorBar});this.$el.prepend(this.indicatorView.$el)},_getPageCompletionPercentage:function(){return completionCalculations.calculatePercentageComplete(this.model)},deferredUpdate:function(){_.defer(this.updateProgressBar)},updateProgressBar:function(){this.indicatorView.refresh()},refreshProgressBar:function(){this.collection.repopulate();this.updateProgressBar()},onProgressClicked:function(event){if(event&&event.preventDefault)event.preventDefault();Adapt.drawer.triggerCustomView(new PageLevelProgressView$1({collection:this.collection}).$el,false)},remove:function(){Backbone.View.prototype.remove.call(this);this.collection.reset()}});var PageLevelProgressNavigationView$1=__AMD("extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressNavigationView",PageLevelProgressNavigationView);var PageLevelProgressCollection=Backbone.Collection.extend({initialize:function(models,options){this.listenTo(Adapt,"remove",this.reset);if(!options||!options.pageModel)return;this._pageModel=options.pageModel;this.repopulate()},repopulate:function(){this.reset();if(!this._pageModel)return;var allDescendants=this._pageModel.getAllDescendantModels(true);var currentPageItems=allDescendants.filter(function(item){return item.get("_isAvailable")===true});var availableItems=completionCalculations.filterAvailableChildren(currentPageItems);var enabledProgressItems=completionCalculations.getPageLevelProgressEnabledModels(availableItems);this.add(enabledProgressItems)}});var PageLevelProgressCollection$1=__AMD("extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressCollection",PageLevelProgressCollection);var PageLevelProgress=Backbone.Controller.extend({initialize:function(){Adapt.on({"app:dataReady":this.onDataReady.bind(this),"app:languageChanged":function(){this.stopListening()}.bind(this)})},getCourseConfig:function(){return Adapt.course.get("_pageLevelProgress")},onDataReady:function(){var coursePLPConfig=this.getCourseConfig();if(!coursePLPConfig||!coursePLPConfig._isEnabled){return}this.setUpEventListeners()},setUpEventListeners:function(){var headerIndicatorTypes=["menu","menuItem","page","article","block","component"];var headerIndicatorEventNames=headerIndicatorTypes.concat([""]).join("View:render ");this.listenTo(Adapt,headerIndicatorEventNames,this.renderHeaderIndicatorView);this.listenTo(Adapt,{"menuItemView:postRender":this.renderMenuItemIndicatorView,"router:page":this.renderNavigationView});this.listenTo(Adapt.course,"bubble:change:_isComplete",this.onCompletionChange)},onCompletionChange:function(event){if(!Adapt.location._currentId)return;var currentModel=Adapt.findById(Adapt.location._currentId);var completionState={currentLocation:completionCalculations.calculatePercentageComplete(currentModel),course:completionCalculations.calculatePercentageComplete(Adapt.course)};var hasChanged=!_.isMatch(this._previousCompletionState,completionState);if(!hasChanged)return;this._previousCompletionState=completionState;Adapt.trigger("pageLevelProgress:percentageCompleteChange",completionState)},renderHeaderIndicatorView:function(view){var model=view.model;var config=model.get("_pageLevelProgress");if(!config||!config._isEnabled||!config._isCompletionIndicatorEnabled){return}var pageModel=model.findAncestor("contentObjects");var pageConfig=pageModel&&pageModel.get("_pageLevelProgress");if(pageConfig&&!pageConfig._isEnabled){return}var $headings=view.$(".js-heading");$headings.each(function(index,el){var $el=$(el);var indicatorView=new PageLevelProgressIndicatorView$1({parent:view,model:model});indicatorView.$el.insertAfter($el)})},renderMenuItemIndicatorView:function(view){if(view.model.get("_id")===Adapt.location._currentId){return}var viewType=view.model.get("_type");if(viewType==="course"){return}var pageLevelProgress=view.model.get("_pageLevelProgress");if(!pageLevelProgress||!pageLevelProgress._isEnabled){return}view.$el.find(".js-menu-item-progress").append(new PageLevelProgressIndicatorView$1({parent:view,model:view.model,type:"menu-item",calculatePercentage:this._getMenuItemCompletionPercentage.bind(view),ariaLabel:Adapt.course.get("_globals")._extensions._pageLevelProgress.pageLevelProgressMenuBar}).$el)},_getMenuItemCompletionPercentage:function(){return completionCalculations.calculatePercentageComplete(this.model)},renderNavigationView:function(pageModel){var coursePLPConfig=this.getCourseConfig();if(coursePLPConfig&&coursePLPConfig._isShownInNavigationBar===false){return}var pagePLPConfig=pageModel.get("_pageLevelProgress");if(!pagePLPConfig||!pagePLPConfig._isEnabled){return}var collection=new PageLevelProgressCollection$1(null,{pageModel:pageModel});if(collection.length===0){return}$(".nav__drawer-btn").after(new PageLevelProgressNavigationView$1({model:pageModel,collection:collection}).$el)}});Adapt.pageLevelProgress=new PageLevelProgress;var ResourcesView=Backbone.View.extend({className:"resources",initialize:function(){this.listenTo(Adapt,"remove",this.remove);this.render()},events:{"click .js-resources-filter-btn-click":"onFilterClicked"},render:function(){this.$el.html(Handlebars.templates.resources({model:this.model.toJSON(),resources:this.collection.toJSON()}));_.defer(function(){this.listenTo(Adapt,"drawer:triggerCustomView",this.remove)}.bind(this));return this},onFilterClicked:function(e){if(e&&e.preventDefault)e.preventDefault();this.$(".js-resources-filter-btn-click").removeClass("is-selected");var items;var filter=$(e.currentTarget).addClass("is-selected").attr("data-filter");if(filter==="all"){items=this.$(".js-resources-item").removeClass("u-display-none")}else{this.$(".js-resources-item").removeClass("u-display-none").not(".is-"+filter).addClass("u-display-none");items=this.$(".js-resources-item.is-"+filter)}if(items.length>0)$(items[0]).a11y_focus()}});var ResourcesView$1=__AMD("extensions/adapt-contrib-resources/js/adapt-contrib-resourcesView",ResourcesView);var helpers$1={resources_has_type:function(resources,type,block){var hasType=resources.some(_.matcher({_type:type}));return hasType?block.fn(this):block.inverse(this)},resources_has_multiple_types:function(resources,block){if(resources.length===1)return block.inverse(this);var allSameType=resources.every(_.matcher({_type:resources[0]._type}));return allSameType?block.inverse(this):block.fn(this)},resources_get_column_count:function(resources){return _.uniq(_.pluck(resources,"_type")).length+1},resources_force_download:function(resource,block){if(Adapt.device.browser==="internet explorer"||Adapt.device.OS==="ios"){return block.inverse(this)}return resource._forceDownload||resource.filename?block.fn(this):block.inverse(this)}};for(var name$1 in helpers$1){Handlebars__default["default"].registerHelper(name$1,helpers$1[name$1])}__AMD("extensions/adapt-contrib-resources/js/adapt-contrib-resourcesHelpers",helpers$1);function setupResources(resourcesData){var resourcesModel=new Backbone.Model(resourcesData);var resourcesCollection=new Backbone.Collection(resourcesModel.get("_resourcesItems"));Adapt.on("resources:showResources",function(){Adapt.drawer.triggerCustomView(new ResourcesView$1({model:resourcesModel,collection:resourcesCollection}).$el)})}function initResources(){var courseResources=Adapt.course.get("_resources");if(!courseResources||courseResources._isEnabled===false)return;var drawerObject={title:courseResources.title,description:courseResources.description,className:"is-resources",drawerOrder:courseResources._drawerOrder||0};Adapt.drawer.addItem(drawerObject,"resources:showResources");setupResources(courseResources)}Adapt.on("adapt:start",initResources);var Logger=function(){function Logger(){_classCallCheck(this,Logger);this.logArr=[];this.registeredViews=[]}_createClass(Logger,[{key:"getEntries",value:function getEntries(){return this.logArr}},{key:"getLastEntry",value:function getLastEntry(){return this.logArr[this.logArr.length-1]}},{key:"info",value:function info(str){this.logArr[this.logArr.length]={str:str,type:Logger.LOG_TYPE_INFO,time:Date.now()};this.updateViews()}},{key:"warn",value:function warn(str){this.logArr[this.logArr.length]={str:str,type:Logger.LOG_TYPE_WARN,time:Date.now()};this.updateViews()}},{key:"error",value:function error(str){this.logArr[this.logArr.length]={str:str,type:Logger.LOG_TYPE_ERROR,time:Date.now()};this.updateViews()}},{key:"debug",value:function debug(str){this.logArr[this.logArr.length]={str:str,type:Logger.LOG_TYPE_DEBUG,time:Date.now()};this.updateViews()}},{key:"registerView",value:function registerView(_view){this.registeredViews[this.registeredViews.length]=_view}},{key:"unregisterView",value:function unregisterView(_view){for(var i=0,l=this.registeredViews.length;i<l;i++){if(this.registeredViews[i]!==_view)continue;this.registeredViews.splice(i,1);i--}}},{key:"updateViews",value:function updateViews(){for(var i=0,l=this.registeredViews.length;i<l;i++){if(!this.registeredViews[i])continue;this.registeredViews[i].update(this)}}}],[{key:"getInstance",value:function getInstance(){if(Logger.instance===null){Logger.instance=new Logger}return Logger.instance}}]);return Logger}();Logger.instance=null;Logger.LOG_TYPE_INFO=0;Logger.LOG_TYPE_WARN=1;Logger.LOG_TYPE_ERROR=2;Logger.LOG_TYPE_DEBUG=3;var Logger$1=__AMD("extensions/adapt-contrib-spoor/js/scorm/logger",window.Logger=Logger);var ScormError=function ScormError(name){var data=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck(this,ScormError);this.name=name;this.data=data};ScormError.CLIENT_COULD_NOT_CONNECT="CLIENT_COULD_NOT_CONNECT";ScormError.SERVER_STATUS_UNSUPPORTED="SERVER_STATUS_UNSUPPORTED";ScormError.CLIENT_STATUS_UNSUPPORTED="CLIENT_STATUS_UNSUPPORTED";ScormError.CLIENT_COULD_NOT_COMMIT="CLIENT_COULD_NOT_COMMIT";ScormError.CLIENT_NOT_CONNECTED="CLIENT_NOT_CONNECTED";ScormError.CLIENT_COULD_NOT_FINISH="CLIENT_COULD_NOT_FINISH";ScormError.CLIENT_COULD_NOT_GET_PROPERTY="CLIENT_COULD_NOT_GET_PROPERTY";ScormError.CLIENT_COULD_NOT_SET_PROPERTY="CLIENT_COULD_NOT_SET_PROPERTY";ScormError.CLIENT_INVALID_CHOICE_VALUE="CLIENT_INVALID_CHOICE_VALUE";ScormError.defaultMessages={title:"An error has occurred",pressOk:"Press 'OK' to view detailed debug information to send to technical support.",CLIENT_COULD_NOT_CONNECT:"The course could not connect to the Learning Management System",SERVER_STATUS_UNSUPPORTED:"An invalid lesson status of '{{{status}}}' was received from Learning Management System",CLIENT_STATUS_UNSUPPORTED:"The status '{{{status}}}' is not supported.",CLIENT_COULD_NOT_COMMIT:"There was a problem saving data to the Learning Management System\n\nError: {{errorCode}} - {{{errorInfo}}}\nLMS Error Info: {{{diagnosticInfo}}}",CLIENT_NOT_CONNECTED:"The course is not connected to the Learning Management System",CLIENT_COULD_NOT_FINISH:"The course was unable to terminate the learning session\n\nError: {{errorCode}} - {{{errorInfo}}}\nLMS Error Info: {{{diagnosticInfo}}}",CLIENT_COULD_NOT_GET_PROPERTY:"Unable to get the value of {{property}} from the Learning Management System\n\nError: {{errorCode}} - {{{errorInfo}}}\nLMS Error Info: {{{diagnosticInfo}}}",CLIENT_COULD_NOT_SET_PROPERTY:"Unable to set {{property}} to: '{{{value}}}'\n\nError: {{errorCode}} - {{{errorInfo}}}\nLMS Error Info: {{{diagnosticInfo}}}",CLIENT_INVALID_CHOICE_VALUE:"Numeric choice/matching response elements must use a value from 0 to 35 in SCORM 1.2"};var ScormError$1=__AMD("extensions/adapt-contrib-spoor/js/scorm/error",ScormError);var _ScormError=ScormError$1,CLIENT_COULD_NOT_CONNECT=_ScormError.CLIENT_COULD_NOT_CONNECT,SERVER_STATUS_UNSUPPORTED=_ScormError.SERVER_STATUS_UNSUPPORTED,CLIENT_STATUS_UNSUPPORTED=_ScormError.CLIENT_STATUS_UNSUPPORTED,CLIENT_COULD_NOT_COMMIT=_ScormError.CLIENT_COULD_NOT_COMMIT,CLIENT_NOT_CONNECTED=_ScormError.CLIENT_NOT_CONNECTED,CLIENT_COULD_NOT_FINISH=_ScormError.CLIENT_COULD_NOT_FINISH,CLIENT_COULD_NOT_GET_PROPERTY=_ScormError.CLIENT_COULD_NOT_GET_PROPERTY,CLIENT_COULD_NOT_SET_PROPERTY=_ScormError.CLIENT_COULD_NOT_SET_PROPERTY,CLIENT_INVALID_CHOICE_VALUE=_ScormError.CLIENT_INVALID_CHOICE_VALUE;var ScormWrapper=function(){function ScormWrapper(){_classCallCheck(this,ScormWrapper);this.setCompletedWhenFailed=true;this.commitOnStatusChange=true;this.commitOnAnyChange=false;this.timedCommitFrequency=10;this.maxCommitRetries=5;this.commitRetryDelay=1000;this.commitRetryPending=false;this.commitRetries=0;this.lastCommitSuccessTime=null;this.exitStateIfIncomplete="auto";this.exitStateIfComplete="auto";this.timedCommitIntervalID=null;this.retryCommitTimeoutID=null;this.logOutputWin=null;this.startTime=null;this.endTime=null;this.lmsConnected=false;this.finishCalled=false;this.logger=Logger$1.getInstance();this.scorm=pipwerks__default["default"].SCORM;this.scorm.handleExitMode=false;this.suppressErrors=false;this.debouncedCommit=_.debounce(this.commit.bind(this),100);if(window.__debug){this.showDebugWindow()}if(window.API&&window.API.__offlineAPIWrapper||window.API_1484_11&&window.API_1484_11.__offlineAPIWrapper){this.logger.error("Offline SCORM API is being used. No data will be reported to the LMS!")}}_createClass(ScormWrapper,[{key:"getVersion",value:function getVersion(){return this.scorm.version}},{key:"setVersion",value:function setVersion(value){this.logger.debug("ScormWrapper::setVersion: ".concat(value));this.scorm.version=value}},{key:"initialize",value:function initialize(){this.logger.debug("ScormWrapper::initialize");this.lmsConnected=this.scorm.init();if(!this.lmsConnected){this.handleError(new ScormError$1(CLIENT_COULD_NOT_CONNECT));return this.lmsConnected}this.startTime=new Date;this.initTimedCommit();return this.lmsConnected}},{key:"isFirstSession",value:function isFirstSession(){return this.getValue(this.isSCORM2004()?"cmi.entry":"cmi.core.entry")==="ab-initio"}},{key:"setIncomplete",value:function setIncomplete(){this.setValue(this.isSCORM2004()?"cmi.completion_status":"cmi.core.lesson_status","incomplete");if(this.commitOnStatusChange&&!this.commitOnAnyChange)this.commit()}},{key:"setCompleted",value:function setCompleted(){this.setValue(this.isSCORM2004()?"cmi.completion_status":"cmi.core.lesson_status","completed");if(this.commitOnStatusChange&&!this.commitOnAnyChange)this.commit()}},{key:"setPassed",value:function setPassed(){if(this.isSCORM2004()){this.setValue("cmi.completion_status","completed");this.setValue("cmi.success_status","passed")}else{this.setValue("cmi.core.lesson_status","passed")}if(this.commitOnStatusChange&&!this.commitOnAnyChange)this.commit()}},{key:"setFailed",value:function setFailed(){if(this.isSCORM2004()){this.setValue("cmi.success_status","failed");if(this.setCompletedWhenFailed){this.setValue("cmi.completion_status","completed")}}else{this.setValue("cmi.core.lesson_status","failed")}if(this.commitOnStatusChange&&!this.commitOnAnyChange)this.commit()}},{key:"getStatus",value:function getStatus(){var status=this.getValue(this.isSCORM2004()?"cmi.completion_status":"cmi.core.lesson_status");switch(status.toLowerCase()){case"passed":case"completed":case"incomplete":case"failed":case"browsed":case"not attempted":case"not_attempted":case"unknown":return status;default:this.handleError(new ScormError$1(SERVER_STATUS_UNSUPPORTED,{status:status}));return null;}}},{key:"setStatus",value:function setStatus(status){switch(status.toLowerCase()){case"incomplete":this.setIncomplete();break;case"completed":this.setCompleted();break;case"passed":this.setPassed();break;case"failed":this.setFailed();break;default:this.handleError(new ScormError$1(CLIENT_STATUS_UNSUPPORTED,{status:status}));}}},{key:"getScore",value:function getScore(){return this.getValue(this.isSCORM2004()?"cmi.score.raw":"cmi.core.score.raw")}},{key:"setScore",value:function setScore(score){var minScore=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var maxScore=arguments.length>2&&arguments[2]!==undefined?arguments[2]:100;if(this.isSCORM2004()){this.setValue("cmi.score.raw",score);this.setValue("cmi.score.min",minScore);this.setValue("cmi.score.max",maxScore);var range=maxScore-minScore;var scaledScore=((score-minScore)/range).toFixed(7);this.setValue("cmi.score.scaled",scaledScore);return}this.setValue("cmi.core.score.raw",score);if(this.isSupported("cmi.core.score.min"))this.setValue("cmi.core.score.min",minScore);if(this.isSupported("cmi.core.score.max"))this.setValue("cmi.core.score.max",maxScore)}},{key:"getLessonLocation",value:function getLessonLocation(){return this.getValue(this.isSCORM2004()?"cmi.location":"cmi.core.lesson_location")}},{key:"setLessonLocation",value:function setLessonLocation(location){this.setValue(this.isSCORM2004()?"cmi.location":"cmi.core.lesson_location",location)}},{key:"getSuspendData",value:function getSuspendData(){return this.getValue("cmi.suspend_data")}},{key:"setSuspendData",value:function setSuspendData(data){this.setValue("cmi.suspend_data",data)}},{key:"getStudentName",value:function getStudentName(){return this.getValue(this.isSCORM2004()?"cmi.learner_name":"cmi.core.student_name")}},{key:"getStudentId",value:function getStudentId(){return this.getValue(this.isSCORM2004()?"cmi.learner_id":"cmi.core.student_id")}},{key:"setLanguage",value:function setLanguage(lang){if(this.isSCORM2004()){this.setValue("cmi.learner_preference.language",lang);return}if(this.isSupported("cmi.student_preference.language")){this.setValue("cmi.student_preference.language",lang)}}},{key:"commit",value:function commit(){this.logger.debug("ScormWrapper::commit");if(!this.lmsConnected){this.handleError(new ScormError$1(ScormError$1.CLIENT_NOT_CONNECTED));return}if(this.commitRetryPending){this.logger.debug("ScormWrapper::commit: skipping this commit call as one is already pending.");return}if(this.scorm.save()){this.commitRetries=0;this.lastCommitSuccessTime=new Date;Adapt.trigger("spoor:commit",this);return}if(this.commitRetries<this.maxCommitRetries&&!this.finishCalled){this.commitRetries++;this.initRetryCommit();return}var errorCode=this.scorm.debug.getCode();this.handleError(new ScormError$1(CLIENT_COULD_NOT_COMMIT,{errorCode:errorCode,errorInfo:this.scorm.debug.getInfo(errorCode),diagnosticInfo:this.scorm.debug.getDiagnosticInfo(errorCode)}))}},{key:"finish",value:function finish(){this.logger.debug("ScormWrapper::finish");if(!this.lmsConnected||this.finishCalled){this.handleError(new ScormError$1(CLIENT_NOT_CONNECTED));return}this.finishCalled=true;if(this.timedCommitIntervalID!==null){window.clearInterval(this.timedCommitIntervalID)}if(this.commitRetryPending){window.clearTimeout(this.retryCommitTimeoutID);this.commitRetryPending=false}if(this.logOutputWin&&!this.logOutputWin.closed){this.logOutputWin.close()}this.endTime=new Date;if(this.isSCORM2004()){this.scorm.set("cmi.session_time",this.convertToSCORM2004Time(this.endTime.getTime()-this.startTime.getTime()));this.scorm.set("cmi.exit",this.getExitState())}else{this.scorm.set("cmi.core.session_time",this.convertToSCORM12Time(this.endTime.getTime()-this.startTime.getTime()));this.scorm.set("cmi.core.exit",this.getExitState())}this.lmsConnected=false;if(!this.scorm.quit()){var errorCode=this.scorm.debug.getCode();this.handleError(new ScormError$1(CLIENT_COULD_NOT_FINISH,{errorCode:errorCode,errorInfo:this.scorm.debug.getInfo(errorCode),diagnosticInfo:this.scorm.debug.getDiagnosticInfo(errorCode)}))}}},{key:"recordInteraction",value:function recordInteraction(id,response,correct,latency,type){if(!this.isSupported("cmi.interactions._count")){this.logger.info("ScormWrapper::recordInteraction: cmi.interactions are not supported by this LMS...");return}switch(type){case"choice":this.recordInteractionMultipleChoice.apply(this,arguments);break;case"matching":this.recordInteractionMatching.apply(this,arguments);break;case"numeric":this.isSCORM2004()?this.recordInteractionScorm2004.apply(this,arguments):this.recordInteractionScorm12.apply(this,arguments);break;case"fill-in":this.recordInteractionFillIn.apply(this,arguments);break;default:console.error("ScormWrapper.recordInteraction: unknown interaction type of '".concat(type,"' encountered..."));}}},{key:"getValue",value:function getValue(property){this.logger.debug("ScormWrapper::getValue: _property=".concat(property));if(this.finishCalled){this.logger.debug("ScormWrapper::getValue: ignoring request as 'finish' has been called");return}if(!this.lmsConnected){this.handleError(new ScormError$1(CLIENT_NOT_CONNECTED));return}var value=this.scorm.get(property);var errorCode=this.scorm.debug.getCode();switch(errorCode){case 0:break;case 403:this.logger.warn("ScormWrapper::getValue: data model element not initialized");break;default:this.handleError(new ScormError$1(CLIENT_COULD_NOT_GET_PROPERTY,{property:property,errorCode:errorCode,errorInfo:this.scorm.debug.getInfo(errorCode),diagnosticInfo:this.scorm.debug.getDiagnosticInfo(errorCode)}));}this.logger.debug("ScormWrapper::getValue: returning ".concat(value));return value+""}},{key:"setValue",value:function setValue(property,value){this.logger.debug("ScormWrapper::setValue: _property=".concat(property," _value=").concat(value));if(this.finishCalled){this.logger.debug("ScormWrapper::setValue: ignoring request as 'finish' has been called");return}if(!this.lmsConnected){this.handleError(new ScormError$1(CLIENT_NOT_CONNECTED));return}var success=this.scorm.set(property,value);if(!success){var errorCode=this.scorm.debug.getCode();if(errorCode!==0){this.handleError(new ScormError$1(CLIENT_COULD_NOT_SET_PROPERTY,{property:property,value:value,errorCode:errorCode,errorInfo:this.scorm.debug.getInfo(errorCode),diagnosticInfo:this.scorm.debug.getDiagnosticInfo(errorCode)}));return success}this.logger.warn("ScormWrapper::setValue: LMS reported that the 'set' call failed but then said there was no error!")}if(this.commitOnAnyChange)this.debouncedCommit();return success}},{key:"isSupported",value:function isSupported(property){this.logger.debug("ScormWrapper::isSupported: _property=".concat(property));if(this.finishCalled){this.logger.debug("ScormWrapper::isSupported: ignoring request as 'finish' has been called");return}if(!this.lmsConnected){this.handleError(new ScormError$1(CLIENT_NOT_CONNECTED));return false}this.scorm.get(property);return this.scorm.debug.getCode()!==401}},{key:"initTimedCommit",value:function initTimedCommit(){this.logger.debug("ScormWrapper::initTimedCommit");if(!this.commitOnAnyChange&&this.timedCommitFrequency>0){var delay=this.timedCommitFrequency*(60*1000);this.timedCommitIntervalID=window.setInterval(this.commit.bind(this),delay)}}},{key:"initRetryCommit",value:function initRetryCommit(){this.logger.debug("ScormWrapper::initRetryCommit ".concat(this.commitRetries," out of ").concat(this.maxCommitRetries));this.commitRetryPending=true;this.retryCommitTimeoutID=window.setTimeout(this.doRetryCommit.bind(this),this.commitRetryDelay)}},{key:"doRetryCommit",value:function doRetryCommit(){this.logger.debug("ScormWrapper::doRetryCommit");this.commitRetryPending=false;this.commit()}},{key:"handleError",value:function handleError(error){if(!Adapt.get("_isStarted")){Adapt.once("contentObjectView:ready",this.handleError.bind(this,error));return}if("value"in error.data){if(error.data.value.length&&error.data.value.length>80)error.data.value=error.data.value.slice(0,80)+"...";if(error.data.value==="")error.data.value="''"}var config=Adapt.course.get("_spoor");var messages=Object.assign({},ScormError$1.defaultMessages,config&&config._messages);var message=Handlebars.compile(messages[error.name])(error.data);switch(error.name){case CLIENT_COULD_NOT_CONNECT:Adapt.notify.popup({_isCancellable:false,title:messages.title,body:message});return;}this.logger.error(message);if(!this.suppressErrors&&(!this.logOutputWin||this.logOutputWin.closed)&&confirm("".concat(messages.title,":\n\n").concat(message,"\n\n").concat(messages.pressOk))){this.showDebugWindow()}}},{key:"getInteractionCount",value:function getInteractionCount(){var count=this.getValue("cmi.interactions._count");return count===""?0:count}},{key:"recordInteractionScorm12",value:function recordInteractionScorm12(id,response,correct,latency,type){id=id.trim();var cmiPrefix="cmi.interactions.".concat(this.getInteractionCount());this.setValue("".concat(cmiPrefix,".id"),id);this.setValue("".concat(cmiPrefix,".type"),type);this.setValue("".concat(cmiPrefix,".student_response"),response);this.setValue("".concat(cmiPrefix,".result"),correct?"correct":"wrong");if(latency!==null&&latency!==undefined)this.setValue("".concat(cmiPrefix,".latency"),this.convertToSCORM12Time(latency));this.setValue("".concat(cmiPrefix,".time"),this.getCMITime())}},{key:"recordInteractionScorm2004",value:function recordInteractionScorm2004(id,response,correct,latency,type){id=id.trim();var cmiPrefix="cmi.interactions.".concat(this.getInteractionCount());this.setValue("".concat(cmiPrefix,".id"),id);this.setValue("".concat(cmiPrefix,".type"),type);this.setValue("".concat(cmiPrefix,".learner_response"),response);this.setValue("".concat(cmiPrefix,".result"),correct?"correct":"incorrect");if(latency!==null&&latency!==undefined)this.setValue("".concat(cmiPrefix,".latency"),this.convertToSCORM2004Time(latency));this.setValue("".concat(cmiPrefix,".timestamp"),this.getISO8601Timestamp())}},{key:"recordInteractionMultipleChoice",value:function recordInteractionMultipleChoice(id,response,correct,latency,type){if(this.isSCORM2004()){response=response.replace(/,|#/g,"[,]")}else{response=response.replace(/#/g,",");response=this.checkResponse(response,"choice")}var scormRecordInteraction=this.isSCORM2004()?this.recordInteractionScorm2004:this.recordInteractionScorm12;scormRecordInteraction.call(this,id,response,correct,latency,type)}},{key:"recordInteractionMatching",value:function recordInteractionMatching(id,response,correct,latency,type){response=response.replace(/#/g,",");if(this.isSCORM2004()){response=response.replace(/,/g,"[,]");response=response.replace(/\./g,"[.]")}else{response=this.checkResponse(response,"matching")}var scormRecordInteraction=this.isSCORM2004()?this.recordInteractionScorm2004:this.recordInteractionScorm12;scormRecordInteraction.call(this,id,response,correct,latency,type)}},{key:"recordInteractionFillIn",value:function recordInteractionFillIn(id,response,correct,latency,type){var maxLength=this.isSCORM2004()?250:255;if(response.length>maxLength){response=response.substr(0,maxLength);this.logger.warn("ScormWrapper::recordInteractionFillIn: response data for ".concat(id," is longer than the maximum allowed length of ").concat(maxLength," characters; data will be truncated to avoid an error."))}var scormRecordInteraction=this.isSCORM2004()?this.recordInteractionScorm2004:this.recordInteractionScorm12;scormRecordInteraction.call(this,id,response,correct,latency,type)}},{key:"showDebugWindow",value:function showDebugWindow(){if(this.logOutputWin&&!this.logOutputWin.closed){this.logOutputWin.close()}this.logOutputWin=window.open("log_output.html","Log","width=600,height=300,status=no,scrollbars=yes,resizable=yes,menubar=yes,toolbar=yes,location=yes,top=0,left=0");if(this.logOutputWin){this.logOutputWin.focus()}}},{key:"convertToSCORM12Time",value:function convertToSCORM12Time(msConvert){var msPerSec=1000;var msPerMin=msPerSec*60;var msPerHour=msPerMin*60;var ms=msConvert%msPerSec;msConvert=msConvert-ms;var secs=msConvert%msPerMin;msConvert=msConvert-secs;secs=secs/msPerSec;var mins=msConvert%msPerHour;msConvert=msConvert-mins;mins=mins/msPerMin;var hrs=msConvert/msPerHour;if(hrs>9999){return"9999:99:99.99"}var str=[this.padWithZeroes(hrs,4),this.padWithZeroes(mins,2),this.padWithZeroes(secs,2)].join(":");return"".concat(str,".").concat(Math.floor(ms/10))}},{key:"convertToSCORM2004Time",value:function convertToSCORM2004Time(msConvert){var csConvert=Math.floor(msConvert/10);var csPerSec=100;var csPerMin=csPerSec*60;var csPerHour=csPerMin*60;var csPerDay=csPerHour*24;var days=Math.floor(csConvert/csPerDay);csConvert-=days*csPerDay;days=days?days+"D":"";var hours=Math.floor(csConvert/csPerHour);csConvert-=hours*csPerHour;hours=hours?hours+"H":"";var mins=Math.floor(csConvert/csPerMin);csConvert-=mins*csPerMin;mins=mins?mins+"M":"";var secs=Math.floor(csConvert/csPerSec);csConvert-=secs*csPerSec;secs=secs||"0";var cs=csConvert;cs=cs?"."+cs:"";var seconds=secs+cs+"S";var hms=[hours,mins,seconds].join("");return"P"+days+"T"+hms}},{key:"getCMITime",value:function getCMITime(){var date=new Date;var hours=this.padWithZeroes(date.getHours(),2);var min=this.padWithZeroes(date.getMinutes(),2);var sec=this.padWithZeroes(date.getSeconds(),2);return[hours,min,sec].join(":")}},{key:"getISO8601Timestamp",value:function getISO8601Timestamp(){var date=new Date().toISOString();return date.replace(/.\d\d\dZ/,"")}},{key:"padWithZeroes",value:function padWithZeroes(numToPad,padBy){var len=padBy;while(--len){numToPad="0"+numToPad}return numToPad.slice(-padBy)}},{key:"isSCORM2004",value:function isSCORM2004(){return this.scorm.version==="2004"}},{key:"checkResponse",value:function checkResponse(response,responseType){if(!response)return response;if(responseType!=="choice"&&responseType!=="matching")return response;response=response.split(/,|#/);var self=this;if(responseType==="choice"){response=response.map(checkIdentifier)}else{response=response.map(function(r){var identifiers=r.split(".");return checkIdentifier(identifiers[0])+"."+checkIdentifier(identifiers[1])})}function checkIdentifier(r){var i;if(r.length===1&&r>="0"&&r<="9")return r;if(r.length===1&&r>="a"&&r<="z")return r;i=parseInt(r);if(isNaN(i)||i<10||i>35){self.handleError(new ScormError$1(CLIENT_INVALID_CHOICE_VALUE))}return Number(i).toString(36)}return response.join(",")}},{key:"getExitState",value:function getExitState(){var completionStatus=this.scorm.data.completionStatus;var isIncomplete=completionStatus==="incomplete"||completionStatus==="not attempted";var exitState=isIncomplete?this.exitStateIfIncomplete:this.exitStateIfComplete;if(exitState!=="auto")return exitState;if(this.isSCORM2004())return isIncomplete?"suspend":"normal";return""}}],[{key:"getInstance",value:function getInstance(){if(ScormWrapper.instance===null){ScormWrapper.instance=new ScormWrapper}return ScormWrapper.instance}}]);return ScormWrapper}();ScormWrapper.instance=null;var ScormWrapper$1=__AMD("extensions/adapt-contrib-spoor/js/scorm/wrapper",ScormWrapper);var ZeroString={};function makeZeroString(length){ZeroString[length]=ZeroString[length]||new Array(length+1).join("0");return ZeroString[length]}for(var i=1,l=64;i<=l;i++){makeZeroString(i)}function zeroPadRightToLength(string,length){var padLength=length-string.length;if(padLength>0){string+=makeZeroString(padLength)}return string}function zeroPadLeftToLength(string,length){var padLength=length-string.length;if(padLength>0){string=makeZeroString(padLength)+string}return string}function zeroPadRightToMultiple(string,multiple){var padLength=multiple-string.length%multiple;if(padLength!==multiple){string+=makeZeroString(padLength)}return string}function binaryToUnsignedInteger(binary,binaryLength){if(binaryLength===0){return 0}binary=zeroPadLeftToLength(binary,binaryLength);var integer=parseInt(binary.slice(0,binaryLength),2);return integer}function shiftUnsignedIntegerFromBinary(binary,binaryLength){if(binaryLength===0){return[0,binary]}binary=zeroPadLeftToLength(binary,binaryLength);var integer=parseInt(binary.slice(0,binaryLength),2);binary=binary.slice(binaryLength);return[integer,binary]}function shiftBinary(binary,binaryLength){if(binaryLength===0){return["",binary]}binary=zeroPadLeftToLength(binary,binaryLength);var shifted=binary.slice(0,binaryLength);binary=binary.slice(binaryLength);return[shifted,binary]}function unsignedIntegerToBinary(integer,binaryLength){if(binaryLength===0){return""}var binary=Math.abs(integer).toString(2);if(typeof binaryLength==="undefined"){return binary}var length=binary.length;if(length>binaryLength){throw new Error("Integer too big for specified binary length. integer: ".concat(integer," binarylen: ").concat(binaryLength))}binary=zeroPadLeftToLength(binary,binaryLength);return binary}function byteArrayToString(array){var arrayLength=array.length;var string=new Array(arrayLength);for(var _i=0,_l=arrayLength;_i<_l;_i++){string[_i]=String.fromCharCode(array[_i])}string=string.join("");return string}function stringToByteArray(string){var stringLength=string.length;var array=new Array(stringLength);for(var _i2=0,_l2=stringLength;_i2<_l2;_i2++){array[_i2]=string.charCodeAt(_i2)}return array}var BYTE_BIT_LENGTH=8;function binaryToBase64(binary){binary=___default["default"].flatten(binary).join("");binary=zeroPadRightToMultiple(binary,BYTE_BIT_LENGTH);var bytesCount=binary.length/BYTE_BIT_LENGTH;var charCodes=new Array(bytesCount);for(var _i3=0,_l3=bytesCount;_i3<_l3;_i3++){var _shiftUnsignedInteger=shiftUnsignedIntegerFromBinary(binary,BYTE_BIT_LENGTH);var _shiftUnsignedInteger2=_slicedToArray(_shiftUnsignedInteger,2);charCodes[_i3]=_shiftUnsignedInteger2[0];binary=_shiftUnsignedInteger2[1]}var base64=btoa(byteArrayToString(charCodes));base64=base64.replace(/=/g,"");base64=base64.replace(/\+/g,"-");return base64}function base64ToBinary(base64){base64=base64.replace(/-/g,"+");var charCodes=stringToByteArray(atob(base64));var bytesCount=charCodes.length;var binary=new Array(bytesCount);for(var _i4=0,_l4=bytesCount;_i4<_l4;_i4++){binary[_i4]=unsignedIntegerToBinary(charCodes[_i4],BYTE_BIT_LENGTH)}binary=binary.join("");return binary}var logs={usedTypes:{},typeLengths:{},binarySamples:{}};var AbstractValueType=function(){function AbstractValueType(options){_classCallCheck(this,AbstractValueType);Object.assign(this,options);this.binaryTypeLength=this.binaryType.length}_createClass(AbstractValueType,[{key:"log",value:function log(binary){var name=this.name;logs.usedTypes[name]=logs.usedTypes[name]||0;logs.usedTypes[name]++;logs.binarySamples[name]=logs.binarySamples[name]||[];logs.binarySamples[name].push(binary)}}]);return AbstractValueType}();var FixedIntegerType=function(_AbstractValueType){_inherits(FixedIntegerType,_AbstractValueType);var _super=_createSuper(FixedIntegerType);function FixedIntegerType(options){var _this;_classCallCheck(this,FixedIntegerType);_this=_super.call(this,options);_this.esType="number";if(!_this.valueBinaryLength){return _possibleConstructorReturn(_this)}_this.minValue=options.minValue||0;_this.maxValue=options.maxValue||Math.pow(2,_this.valueBinaryLength)-1;return _this}_createClass(FixedIntegerType,[{key:"valueToBinary",value:function valueToBinary(integer){var logStats=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var binary=unsignedIntegerToBinary(integer,this.valueBinaryLength);if(logStats){this.log(binary)}binary=[binary];return binary}},{key:"shiftValueFromBinary",value:function shiftValueFromBinary(binary){var integer;var _shiftUnsignedInteger3=shiftUnsignedIntegerFromBinary(binary,this.valueBinaryLength);var _shiftUnsignedInteger4=_slicedToArray(_shiftUnsignedInteger3,2);integer=_shiftUnsignedInteger4[0];binary=_shiftUnsignedInteger4[1];return[integer,binary]}}]);return FixedIntegerType}(AbstractValueType);var FixedBooleanType=function(_FixedIntegerType){_inherits(FixedBooleanType,_FixedIntegerType);var _super2=_createSuper(FixedBooleanType);function FixedBooleanType(options){var _this2;_classCallCheck(this,FixedBooleanType);options.valueBinaryLength=1;_this2=_super2.call(this,options);_this2.esType="boolean";return _this2}_createClass(FixedBooleanType,[{key:"shiftValueFromBinary",value:function shiftValueFromBinary(binary){var bool=binary[0]==="1";binary=binary.slice(1);return[bool,binary]}}]);return FixedBooleanType}(FixedIntegerType);var LengthAndValueBinary=function(){function LengthAndValueBinary(parent,name,bitSizes){_classCallCheck(this,LengthAndValueBinary);this.parent=parent;this.name=name;this.bitSizes=bitSizes;this.maxValues=___default["default"].flatten(this.bitSizes).map(function(value){return Math.pow(2,value)-1});this.maxValue=this.maxValues[this.maxValues.length-1];this.sizeBinaryLength=unsignedIntegerToBinary(this.bitSizes.length-1).length}_createClass(LengthAndValueBinary,[{key:"valueToBinary",value:function valueToBinary(integer){var logStats=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var parentName=this.parent.name;var sizeIndex=this.maxValues.findIndex(function(maxValue){return integer<=maxValue});if(sizeIndex===-1){throw new Error("Value is too large for type: ".concat(parentName," value: ").concat(integer," max: ").concat(this.maxValue))}var sizeBinary=unsignedIntegerToBinary(sizeIndex,this.sizeBinaryLength);var valueLength=this.bitSizes[sizeIndex];var name=this.name;if(logStats){logs.typeLengths[parentName]=logs.typeLengths[parentName]||{};logs.typeLengths[parentName][name]=logs.typeLengths[parentName][name]||{};logs.typeLengths[parentName][name][valueLength]=logs.typeLengths[parentName][name][valueLength]||0;logs.typeLengths[parentName][name][valueLength]++}var integerBinary=unsignedIntegerToBinary(integer,valueLength);var binary=[sizeBinary,integerBinary];return binary}},{key:"shiftValueFromBinary",value:function shiftValueFromBinary(binary){var sizeBinary;var _shiftBinary=shiftBinary(binary,this.sizeBinaryLength);var _shiftBinary2=_slicedToArray(_shiftBinary,2);sizeBinary=_shiftBinary2[0];binary=_shiftBinary2[1];var sizeIndex=binaryToUnsignedInteger(sizeBinary);var valueLength=this.bitSizes[sizeIndex];var integer;var _shiftUnsignedInteger5=shiftUnsignedIntegerFromBinary(binary,valueLength);var _shiftUnsignedInteger6=_slicedToArray(_shiftUnsignedInteger5,2);integer=_shiftUnsignedInteger6[0];binary=_shiftUnsignedInteger6[1];return[integer,binary]}}]);return LengthAndValueBinary}();var VariableIntegerType=function(_FixedIntegerType2){_inherits(VariableIntegerType,_FixedIntegerType2);var _super3=_createSuper(VariableIntegerType);function VariableIntegerType(options){var _this3;_classCallCheck(this,VariableIntegerType);_this3=_super3.call(this,options);_this3.isNegative=_this3.minValue<0&&_this3.maxValue===0;_this3.integer=new LengthAndValueBinary(_assertThisInitialized(_this3),"integer",options.integerBitSizes);return _this3}_createClass(VariableIntegerType,[{key:"valueToBinary",value:function valueToBinary(integer){var logStats=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;integer=integer.toFixed(0);var binary=this.integer.valueToBinary(Math.abs(integer),logStats);if(logStats){this.log(binary)}return binary}},{key:"shiftValueFromBinary",value:function shiftValueFromBinary(binary){var integer;var _this$integer$shiftVa=this.integer.shiftValueFromBinary(binary);var _this$integer$shiftVa2=_slicedToArray(_this$integer$shiftVa,2);integer=_this$integer$shiftVa2[0];binary=_this$integer$shiftVa2[1];if(this.isNegative){integer=-integer}return[integer,binary]}}]);return VariableIntegerType}(FixedIntegerType);var VariableArrayType=function(_VariableIntegerType){_inherits(VariableArrayType,_VariableIntegerType);var _super4=_createSuper(VariableArrayType);function VariableArrayType(options){var _this4;_classCallCheck(this,VariableArrayType);_this4=_super4.call(this,options);_this4.esType="array";return _this4}_createClass(VariableArrayType,[{key:"valueToBinary",value:function valueToBinary(array){var logStats=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var arrayLength=array.length;var binary=_get(_getPrototypeOf(VariableArrayType.prototype),"valueToBinary",this).call(this,arrayLength);if(arrayLength){var valueType=findValueTypeFromValues(array);binary.push(valueType.binaryType);binary.type=valueType.name;binary.push(array.map(function(value){return valueType.valueToBinary(value,logStats)}))}if(logStats){this.log(binary)}return binary}},{key:"shiftValueFromBinary",value:function shiftValueFromBinary(binary){var arrayLength;var _get$call=_get(_getPrototypeOf(VariableArrayType.prototype),"shiftValueFromBinary",this).call(this,binary);var _get$call2=_slicedToArray(_get$call,2);arrayLength=_get$call2[0];binary=_get$call2[1];var value=new Array(arrayLength);if(arrayLength){var valueType;var _shiftValueTypeFromBi=shiftValueTypeFromBinary(binary);var _shiftValueTypeFromBi2=_slicedToArray(_shiftValueTypeFromBi,2);valueType=_shiftValueTypeFromBi2[0];binary=_shiftValueTypeFromBi2[1];for(var _i5=0,_l5=arrayLength;_i5<_l5;_i5++){var _valueType$shiftValue=valueType.shiftValueFromBinary(binary);var _valueType$shiftValue2=_slicedToArray(_valueType$shiftValue,2);value[_i5]=_valueType$shiftValue2[0];binary=_valueType$shiftValue2[1]}}return[value,binary]}}]);return VariableArrayType}(VariableIntegerType);var VariableSignedIntegerType=function(_VariableIntegerType2){_inherits(VariableSignedIntegerType,_VariableIntegerType2);var _super5=_createSuper(VariableSignedIntegerType);function VariableSignedIntegerType(){_classCallCheck(this,VariableSignedIntegerType);return _super5.apply(this,arguments)}_createClass(VariableSignedIntegerType,[{key:"valueToBinary",value:function valueToBinary(integer){var logStats=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;integer=integer.toFixed(0);var isNegative=integer<0;var signBinary=isNegative?"1":"0";var integerBinary=this.integer.valueToBinary(Math.abs(integer),logStats);var binary=[signBinary,integerBinary];if(logStats){this.log(binary)}return binary}},{key:"shiftValueFromBinary",value:function shiftValueFromBinary(binary){var isNegative;var _shiftUnsignedInteger7=shiftUnsignedIntegerFromBinary(binary,1);var _shiftUnsignedInteger8=_slicedToArray(_shiftUnsignedInteger7,2);isNegative=_shiftUnsignedInteger8[0];binary=_shiftUnsignedInteger8[1];var integer;var _this$integer$shiftVa3=this.integer.shiftValueFromBinary(binary);var _this$integer$shiftVa4=_slicedToArray(_this$integer$shiftVa3,2);integer=_this$integer$shiftVa4[0];binary=_this$integer$shiftVa4[1];if(isNegative){integer=-integer}return[integer,binary]}}]);return VariableSignedIntegerType}(VariableIntegerType);var VariableDecimalType=function(_VariableIntegerType3){_inherits(VariableDecimalType,_VariableIntegerType3);var _super6=_createSuper(VariableDecimalType);function VariableDecimalType(options){var _this5;_classCallCheck(this,VariableDecimalType);_this5=_super6.call(this,options);_this5.isFloat=true;_this5.decimal=new LengthAndValueBinary(_assertThisInitialized(_this5),"decimal",options.decimalBitSizes);return _this5}_createClass(VariableDecimalType,[{key:"valueToBinary",value:function valueToBinary(float){var logStats=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;float=float.toFixed(2);var isNegative=float<0;float=Math.abs(float);var parts=String(float).split(".");var higherInteger=parseInt(parts[0]);var lowerInteger=parseInt(zeroPadRightToLength(parts[1]||0,2));var signBinary=isNegative?"1":"0";var integerValueBinary=this.integer.valueToBinary(higherInteger,logStats);var decimalValueBinary=this.decimal.valueToBinary(lowerInteger,logStats);var binary=[signBinary,integerValueBinary,decimalValueBinary];if(logStats){this.log(binary)}return binary}},{key:"shiftValueFromBinary",value:function shiftValueFromBinary(binary){var isNegative;var _shiftUnsignedInteger9=shiftUnsignedIntegerFromBinary(binary,1);var _shiftUnsignedInteger10=_slicedToArray(_shiftUnsignedInteger9,2);isNegative=_shiftUnsignedInteger10[0];binary=_shiftUnsignedInteger10[1];var higherInteger;var _this$integer$shiftVa5=this.integer.shiftValueFromBinary(binary);var _this$integer$shiftVa6=_slicedToArray(_this$integer$shiftVa5,2);higherInteger=_this$integer$shiftVa6[0];binary=_this$integer$shiftVa6[1];var lowerInteger;var _this$decimal$shiftVa=this.decimal.shiftValueFromBinary(binary);var _this$decimal$shiftVa2=_slicedToArray(_this$decimal$shiftVa,2);lowerInteger=_this$decimal$shiftVa2[0];binary=_this$decimal$shiftVa2[1];lowerInteger=zeroPadLeftToLength(String(lowerInteger),2);var float=parseFloat(higherInteger+"."+lowerInteger);if(isNegative){float=-float}return[float,binary]}}]);return VariableDecimalType}(VariableIntegerType);var arrayType=new VariableArrayType({name:"array",binaryType:"10",integerBitSizes:[4,16]});var booleanType=new FixedBooleanType({name:"boolean",binaryType:"0"});var integerTypes=[new FixedIntegerType({name:"uint3",binaryType:"1110",valueBinaryLength:3}),new VariableIntegerType({name:"vint8+",binaryType:"110",minValue:0,maxValue:255,integerBitSizes:[2,8]}),new VariableIntegerType({name:"vint8-",binaryType:"111100",minValue:-255,maxValue:0,integerBitSizes:[2,8]}),new VariableSignedIntegerType({name:"sint32",binaryType:"111110",minValue:-4294967295,maxValue:4294967295,integerBitSizes:[2,4,16,32]})];var decimalTypes=[new VariableDecimalType({name:"sdec15",binaryType:"111101",minValue:-255.99,maxValue:255.99,integerBitSizes:[2,8],decimalBitSizes:[0,7]}),new VariableDecimalType({name:"sdec39",binaryType:"111111",minValue:-4294967295.99,maxValue:4294967295.99,integerBitSizes:[2,4,16,32],decimalBitSizes:[0,7]})];var ValueTypes=[booleanType,arrayType].concat(integerTypes).concat(decimalTypes);ValueTypes.nameIndex={};ValueTypes.forEach(function(valueType){return ValueTypes.nameIndex[valueType.name]=valueType});function esTypeOf(value){if(Array.isArray(value)){return"array"}if(value===null){return"null"}return _typeof(value)}function findValueTypeFromName(name){return ValueTypes.nameIndex[name.toLowerCase()]}function findValueTypeFromValue(value){var esType=esTypeOf(value);switch(esType){case"array":return arrayType;case"boolean":return booleanType;}value=value.toFixed(2);var isFloat=!Number.isInteger(value);var isValueInValueTypeRange=function(valueType){return value>=valueType.minValue&&value<=valueType.maxValue};var valueType=isFloat?decimalTypes.find(isValueInValueTypeRange):integerTypes.find(isValueInValueTypeRange);if(!valueType){throw new Error("Cannot find type from value: ".concat(value))}return valueType}function findValueTypeFromValues(values){if(!values.length){return}var minValue=0;var maxValue=0;var isFloat=false;var esTypes=values.map(function(value){var valueType=findValueTypeFromValue(value);if(valueType.esType==="number"){minValue=___default["default"].min([value,minValue]);maxValue=___default["default"].max([value,maxValue]);isFloat=isFloat||!Number.isInteger(value)}return valueType.esType});var uniqESTypes=___default["default"].uniq(esTypes);if(uniqESTypes.length>1){throw new Error("Cannot resolve array to one type: ".concat(uniqESTypes.join()))}var esType=uniqESTypes[0];switch(esType){case"array":return arrayType;case"boolean":return booleanType;}var isRangeInValueTypeRange=function(valueType){return minValue>=valueType.minValue&&maxValue<=valueType.maxValue};var valueType=isFloat?decimalTypes.find(isRangeInValueTypeRange):integerTypes.find(isRangeInValueTypeRange);if(!valueType){throw new Error("Cannot find type from value. min: ".concat(minValue," max: ").concat(maxValue," isfloat: ").concat(isFloat))}return valueType}function shiftValueTypeFromBinary(binary){var valueType=ValueTypes.find(function(valueType){var binaryType=binary.slice(0,valueType.binaryTypeLength);return binaryType===valueType.binaryType});if(!valueType){throw new Error("Cannot find type from binary: ".concat(binary.slice(0,6),"..."))}binary=binary.slice(valueType.binaryTypeLength);return[valueType,binary]}function convertValuesToNumbers(value){var esType=esTypeOf(value);switch(esType){case"array":return value.map(convertValuesToNumbers);case"undefined":case"null":return value?1:0;case"boolean":case"number":return value;}throw new Error("Cannot convert ".concat(esType," to number"))}var Converter=function(){function Converter(){_classCallCheck(this,Converter)}_createClass(Converter,[{key:"getInvalidTypeError",value:function getInvalidTypeError(value){try{value=convertValuesToNumbers(value);esTypeOf(value)==="array"?findValueTypeFromValues(value):findValueTypeFromValue(value);return}catch(err){return err}}},{key:"valueToBinary",value:function valueToBinary(value){var typeName=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var logStats=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;this.clearLog();var hasInitialType=typeof typeName==="string";value=convertValuesToNumbers(value);var valueType=hasInitialType?findValueTypeFromName(typeName):findValueTypeFromValue(value);if(!valueType){throw new Error("Could not find value type from ".concat(hasInitialType?"name ".concat(typeName):"value ".concat(value)," accepts: ").concat(Object.keys(ValueTypes.nameIndex),". Leave typeName empty for auto-detect."))}var binary=valueType.valueToBinary(value,logStats);if(!hasInitialType){binary.unshift(valueType.binaryType)}if(logStats){this.printLog()}return binary}},{key:"valueFromBinary",value:function valueFromBinary(binary){var typeName=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;binary=___default["default"].flatten(binary).join("");var hasInitialType=typeof typeName==="string";var valueType;if(hasInitialType){valueType=findValueTypeFromName(typeName)}else{var _shiftValueTypeFromBi3=shiftValueTypeFromBinary(binary);var _shiftValueTypeFromBi4=_slicedToArray(_shiftValueTypeFromBi3,2);valueType=_shiftValueTypeFromBi4[0];binary=_shiftValueTypeFromBi4[1]}if(!valueType||!(valueType instanceof AbstractValueType)){throw new Error("Could not find value type from ".concat(hasInitialType?"name \"".concat(typeName,"\""):"binary \"".concat(binary.slice(0,8),"\"...")," accepts: ").concat(Object.keys(ValueTypes.nameIndex),". Leave typeName empty for auto-detect."))}var _valueType$shiftValue3=valueType.shiftValueFromBinary(binary),_valueType$shiftValue4=_slicedToArray(_valueType$shiftValue3,1),value=_valueType$shiftValue4[0];return value}},{key:"clearLog",value:function clearLog(){logs.usedTypes={};logs.typeLengths={};logs.binarySamples={}}},{key:"printLog",value:function printLog(){console.log("Types used count:",logs.usedTypes);console.log("Type lengths used count:",logs.typeLengths);console.log("Type binary samples:",logs.binarySamples)}},{key:"serialize",value:function serialize(value){var typeName=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var logStats=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;var binary=this.valueToBinary(value,typeName,logStats);var base64=binaryToBase64(binary);return base64}},{key:"deserialize",value:function deserialize(base64){var typeName=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var binary=base64ToBinary(base64);var value=this.valueFromBinary(binary,typeName);return value}}]);return Converter}();var SCORMSuspendData=__AMD("extensions/adapt-contrib-spoor/js/serializers/SCORMSuspendData",window.SCORMSuspendData=new Converter);var ComponentSerializer=function(_Backbone$Controller){_inherits(ComponentSerializer,_Backbone$Controller);var _super=_createSuper(ComponentSerializer);function ComponentSerializer(){_classCallCheck(this,ComponentSerializer);return _super.apply(this,arguments)}_createClass(ComponentSerializer,[{key:"initialize",value:function initialize(trackingIdType){this.trackingIdType=trackingIdType}},{key:"serialize",value:function serialize(shouldStoreResponses,shouldStoreAttempts){var _this=this;if(shouldStoreAttempts&&!shouldStoreResponses){Adapt.log.warnOnce("SPOOR configuration error, cannot use '_shouldStoreAttempts' without '_shouldStoreResponses'")}var states=[];Adapt.data.each(function(model){if(model.get("_type")!==_this.trackingIdType){return}var trackingId=model.get("_trackingId");if(typeof trackingId==="undefined"){return}var isContainer=model.hasManagedChildren;var components=isContainer?model.findDescendantModels("component"):[model];components.forEach(function(component,index){if(!shouldStoreResponses){var _state=[[trackingId,index],[component.get("_isComplete")]];states.push(_state);return}var modelState=null;if(!component.getAttemptState){modelState=component.get("_isQuestionType")?[[component.get("_score")||0,component.get("_attemptsLeft")||0],[component.get("_isComplete")||false,component.get("_isInteractionComplete")||false,component.get("_isSubmitted")||false,component.get("_isCorrect")||false],[component.get("_userAnswer")]]:[[],[component.get("_isComplete")||false,component.get("_isInteractionComplete")||false],[component.get("_userAnswer")]]}else{modelState=component.getAttemptState()}var userAnswer=modelState[2][0];var hasUserAnswer=typeof userAnswer!=="undefined"&&userAnswer!==null;var isUserAnswerArray=Array.isArray(userAnswer);if(!hasUserAnswer){modelState[2][0]=[]}else if(!isUserAnswerArray){modelState[2][0]=[modelState[2][0]]}var attemptStates=component.get("_attemptStates");var hasAttemptStates=shouldStoreAttempts&&Array.isArray(attemptStates);if(hasAttemptStates){modelState[2][1]=attemptStates}var state=[[trackingId,index],[hasUserAnswer,isUserAnswerArray,hasAttemptStates],modelState];states.push(state)})});return SCORMSuspendData.serialize(states)}},{key:"deserialize",value:function deserialize(binary){var trackingIdMap=Adapt.data.toArray().reduce(function(trackingIdMap,model){var trackingId=model.get("_trackingId");if(typeof trackingId==="undefined")return trackingIdMap;trackingIdMap[trackingId]=model;return trackingIdMap},{});var states=SCORMSuspendData.deserialize(binary);var shouldStoreResponses=states[0].length>2;states.forEach(function(state){var _state$=_slicedToArray(state[0],2),trackingId=_state$[0],index=_state$[1];var model=trackingIdMap[trackingId];if(!model){return}var isContainer=model.hasManagedChildren;var components=isContainer?model.findDescendantModels("component"):[model];var component=components[index];if(!shouldStoreResponses){var isComplete=state[1][0];component.set("_isComplete",isComplete);return}var _state$2=_slicedToArray(state[1],3),hasUserAnswer=_state$2[0],isUserAnswerArray=_state$2[1],hasAttemptStates=_state$2[2];var modelState=state[2];if(!hasUserAnswer){modelState[2][0]=null}else if(!isUserAnswerArray){modelState[2][0]=modelState[2][0][0]}if(!hasAttemptStates){modelState[2][1]=null}if(component.setAttemptObject){component.set("_attemptStates",modelState[2][1]);var attemptObject=component.getAttemptObject(modelState);component.setAttemptObject(attemptObject,false);return}component.get("_isQuestionType")?component.set({_score:modelState[0][0],_attemptsLeft:modelState[0][1],_isComplete:modelState[1][0],_isInteractionComplete:modelState[1][1],_isSubmitted:modelState[1][2],_isCorrect:modelState[1][3],_userAnswer:modelState[2][0],_attemptStates:modelState[2][1]}):component.set({_isComplete:modelState[1][0],_isInteractionComplete:modelState[1][1],_userAnswer:modelState[2][0],_attemptStates:modelState[2][1]})})}}]);return ComponentSerializer}(Backbone.Controller);var ComponentSerializer$1=__AMD("extensions/adapt-contrib-spoor/js/serializers/ComponentSerializer",ComponentSerializer);var StatefulSession=function(_Backbone$Controller){_inherits(StatefulSession,_Backbone$Controller);var _super=_createSuper(StatefulSession);function StatefulSession(){_classCallCheck(this,StatefulSession);return _super.apply(this,arguments)}_createClass(StatefulSession,[{key:"initialize",value:function initialize(){_.bindAll(this,"beginSession","onVisibilityChange","endSession");this.scorm=ScormWrapper$1.getInstance();this._trackingIdType="block";this._componentSerializer=null;this._shouldStoreResponses=true;this._shouldStoreAttempts=false;this._shouldRecordInteractions=true;this.beginSession()}},{key:"beginSession",value:function beginSession(){this.listenTo(Adapt,"app:dataReady",this.restoreSession);this._trackingIdType=Adapt.build.get("trackingIdType")||"block";this._componentSerializer=new ComponentSerializer$1(this._trackingIdType);if(window.location.search.indexOf("nolmserrors")!==-1){this.scorm.suppressErrors=true}var config=Adapt.spoor.config;if(!config)return;var tracking=config._tracking;this._shouldStoreResponses=tracking&&tracking._shouldStoreResponses||false;this._shouldStoreAttempts=tracking&&tracking._shouldStoreAttempts||false;if(tracking&&tracking._shouldRecordInteractions===false){this._shouldRecordInteractions=false}var settings=config._advancedSettings;if(!settings){this.scorm.setVersion("1.2");this.scorm.initialize();return}if(settings._showDebugWindow){this.scorm.showDebugWindow()}this.scorm.setVersion(settings._scormVersion||"1.2");if(_.isBoolean(settings._suppressErrors)){this.scorm.suppressErrors=settings._suppressErrors}if(_.isBoolean(settings._commitOnStatusChange)){this.scorm.commitOnStatusChange=settings._commitOnStatusChange}if(_.isBoolean(settings._commitOnAnyChange)){this.scorm.commitOnAnyChange=settings._commitOnAnyChange}if(_.isFinite(settings._timedCommitFrequency)){this.scorm.timedCommitFrequency=settings._timedCommitFrequency}if(_.isFinite(settings._maxCommitRetries)){this.scorm.maxCommitRetries=settings._maxCommitRetries}if(_.isFinite(settings._commitRetryDelay)){this.scorm.commitRetryDelay=settings._commitRetryDelay}if("_exitStateIfIncomplete"in settings){this.scorm.exitStateIfIncomplete=settings._exitStateIfIncomplete}if("_exitStateIfComplete"in settings){this.scorm.exitStateIfComplete=settings._exitStateIfComplete}this.scorm.initialize()}},{key:"restoreSession",value:function restoreSession(){this.setupLearnerInfo();this.restoreSessionState();_.defer(this.setupEventListeners.bind(this))}},{key:"setupLearnerInfo",value:function setupLearnerInfo(){var globals=Adapt.course.get("_globals");if(!globals._learnerInfo){globals._learnerInfo={}}Object.assign(globals._learnerInfo,Adapt.offlineStorage.get("learnerinfo"))}},{key:"restoreSessionState",value:function restoreSessionState(){var sessionPairs=Adapt.offlineStorage.get();var hasNoPairs=!Object.keys(sessionPairs).length;if(hasNoPairs)return;if(sessionPairs.c){var _SCORMSuspendData$des=SCORMSuspendData.deserialize(sessionPairs.c),_SCORMSuspendData$des2=_slicedToArray(_SCORMSuspendData$des,2),_isComplete=_SCORMSuspendData$des2[0],_isAssessmentPassed=_SCORMSuspendData$des2[1];Adapt.course.set({_isComplete:_isComplete,_isAssessmentPassed:_isAssessmentPassed})}if(sessionPairs.q){this._componentSerializer.deserialize(sessionPairs.q)}}},{key:"setupEventListeners",value:function setupEventListeners(){var debouncedSaveSession=_.debounce(this.saveSessionState.bind(this),1);this.listenTo(Adapt.data,"change:_isComplete",debouncedSaveSession);if(this._shouldStoreResponses){this.listenTo(Adapt.data,"change:_isSubmitted change:_userAnswer",debouncedSaveSession)}this.listenTo(Adapt,{"app:languageChanged":this.onLanguageChanged,"questionView:recordInteraction":this.onQuestionRecordInteraction,"assessment:complete":this.onAssessmentComplete,"tracking:complete":this.onTrackingComplete});var config=Adapt.spoor.config;var advancedSettings=config._advancedSettings;var shouldCommitOnVisibilityChange=!advancedSettings||advancedSettings._commitOnVisibilityChangeHidden!==false;if(shouldCommitOnVisibilityChange){document.addEventListener("visibilitychange",this.onVisibilityChange)}$(window).on("beforeunload unload",this.endSession)}},{key:"saveSessionState",value:function saveSessionState(){var courseState=SCORMSuspendData.serialize([Boolean(Adapt.course.get("_isComplete")),Boolean(Adapt.course.get("_isAssessmentPassed"))]);var componentStates=this._componentSerializer.serialize(this._shouldStoreResponses,this._shouldStoreAttempts);var sessionPairs={"c":courseState,"q":componentStates};this.printCompletionInformation();Adapt.offlineStorage.set(sessionPairs)}},{key:"printCompletionInformation",value:function printCompletionInformation(){var _this=this;var courseComplete=Boolean(Adapt.course.get("_isComplete"));var assessmentPassed=Boolean(Adapt.course.get("_isAssessmentPassed"));var trackingIdModels=Adapt.data.filter(function(model){return model.get("_type")===_this._trackingIdType&&model.has("_trackingId")});var trackingIds=trackingIdModels.map(function(model){return model.get("_trackingId")});if(!trackingIds.length){Adapt.log.info("course._isComplete: ".concat(courseComplete,", course._isAssessmentPassed: ").concat(assessmentPassed,", ").concat(this._trackingIdType," completion: no tracking ids found"));return}var max=Math.max.apply(Math,_toConsumableArray(trackingIds));var completion=trackingIdModels.reduce(function(completion,model){var trackingId=model.get("_trackingId");completion[trackingId]=model.get("_isComplete")?"1":"0";return completion},new Array(max+1).join("-").split("")).join("");Adapt.log.info("course._isComplete: ".concat(courseComplete,", course._isAssessmentPassed: ").concat(assessmentPassed,", ").concat(this._trackingIdType," completion: ").concat(completion))}},{key:"onLanguageChanged",value:function onLanguageChanged(){var config=Adapt.spoor.config;this.removeEventListeners();this.setupEventListeners();this.saveSessionState();if(config&&config._reporting&&config._reporting._resetStatusOnLanguageChange===true){Adapt.offlineStorage.set("status","incomplete")}}},{key:"onVisibilityChange",value:function onVisibilityChange(){if(document.visibilityState==="hidden")this.scorm.commit()}},{key:"onQuestionRecordInteraction",value:function onQuestionRecordInteraction(questionView){if(!this._shouldRecordInteractions)return;var responseType=questionView.getResponseType();if(_.isEmpty(responseType))return;var id=questionView.model.get("_id");var response=questionView.getResponse();var result=questionView.isCorrect();var latency=questionView.getLatency();Adapt.offlineStorage.set("interaction",id,response,result,latency,responseType)}},{key:"onAssessmentComplete",value:function onAssessmentComplete(stateModel){var _Adapt$offlineStorage;var config=Adapt.spoor.config;Adapt.course.set("_isAssessmentPassed",stateModel.isPass);this.saveSessionState();var shouldSubmitScore=config&&config._tracking&&config._tracking._shouldSubmitScore;if(!shouldSubmitScore)return;var scoreArgs=stateModel.isPercentageBased?[stateModel.scoreAsPercent,0,100]:[stateModel.score,0,stateModel.maxScore];(_Adapt$offlineStorage=Adapt.offlineStorage).set.apply(_Adapt$offlineStorage,["score"].concat(scoreArgs))}},{key:"onTrackingComplete",value:function onTrackingComplete(completionData){var config=Adapt.spoor.config;this.saveSessionState();var completionStatus=completionData.status.asLowerCase;switch(completionData.status){case COMPLETION_STATE$1.COMPLETED:case COMPLETION_STATE$1.PASSED:{if(!config||!config._reporting||!config._reporting._onTrackingCriteriaMet){Adapt.log.warn("No value defined for '_onTrackingCriteriaMet', so defaulting to '".concat(completionStatus,"'"))}else{completionStatus=config._reporting._onTrackingCriteriaMet}break}case COMPLETION_STATE$1.FAILED:{if(!config||!config._reporting||!config._reporting._onAssessmentFailure){Adapt.log.warn("No value defined for '_onAssessmentFailure', so defaulting to '".concat(completionStatus,"'"))}else{completionStatus=config._reporting._onAssessmentFailure}}}Adapt.offlineStorage.set("status",completionStatus)}},{key:"endSession",value:function endSession(){if(!this.scorm.finishCalled){this.scorm.finish()}this.removeEventListeners()}},{key:"removeEventListeners",value:function removeEventListeners(){$(window).off("beforeunload unload",this.endSession);document.removeEventListener("visibilitychange",this.onVisibilityChange);this.stopListening()}}]);return StatefulSession}(Backbone.Controller);var StatefulSession$1=__AMD("extensions/adapt-contrib-spoor/js/adapt-stateful-session",StatefulSession);var OfflineStorage$1=function(_Backbone$Controller){_inherits(OfflineStorage,_Backbone$Controller);var _super=_createSuper(OfflineStorage);function OfflineStorage(){_classCallCheck(this,OfflineStorage);return _super.apply(this,arguments)}_createClass(OfflineStorage,[{key:"initialize",value:function initialize(statefulSession){this.scorm=ScormWrapper$1.getInstance();this.statefulSession=statefulSession;this.temporaryStore={};this.suspendDataStore={};this.suspendDataRestored=false;Adapt.offlineStorage.initialize(this)}},{key:"save",value:function save(){this.statefulSession.saveSessionState();this.scorm.commit()}},{key:"serialize",value:function serialize(){var _SCORMSuspendData;return(_SCORMSuspendData=SCORMSuspendData).serialize.apply(_SCORMSuspendData,arguments)}},{key:"deserialize",value:function deserialize(){var _SCORMSuspendData2;return(_SCORMSuspendData2=SCORMSuspendData).deserialize.apply(_SCORMSuspendData2,arguments)}},{key:"get",value:function get(name){if(name===undefined){if(this.useTemporaryStore())return this.temporaryStore;this.suspendDataStore=this.getCustomStates();var data=Object.assign(_.clone(this.suspendDataStore),{location:this.scorm.getLessonLocation(),score:this.scorm.getScore(),status:this.scorm.getStatus(),student:this.scorm.getStudentName(),learnerInfo:this.getLearnerInfo()});this.suspendDataRestored=true;return data}if(this.useTemporaryStore())return this.temporaryStore[name];var courseState;switch(name.toLowerCase()){case"location":return this.scorm.getLessonLocation();case"score":return this.scorm.getScore();case"status":return this.scorm.getStatus();case"student":return this.scorm.getStudentName();case"learnerinfo":return this.getLearnerInfo();case"coursestate":courseState=this.getCustomState("c");var stateArray=courseState&&SCORMSuspendData.deserialize(courseState)||[];return{_isCourseComplete:Boolean(stateArray.slice(0,1).map(Number)[0]),_isAssessmentPassed:Boolean(stateArray.slice(1,2).map(Number)[0]),completion:stateArray.slice(2).map(Number).map(String).join("")||""};case"completion":courseState=this.getCustomState("c");return courseState&&SCORMSuspendData.deserialize(courseState).slice(2).map(Number).map(String).join("")||"";case"_iscoursecomplete":courseState=this.getCustomState("c");return Boolean(courseState&&SCORMSuspendData.deserialize(courseState).slice(0,1).map(Number)[0]);case"_isassessmentpassed":courseState=this.getCustomState("c");return Boolean(courseState&&SCORMSuspendData.deserialize(courseState).slice(1,2).map(Number)[0]);case"questions":var questionsState=this.getCustomState("q");return questionsState||"";default:return this.getCustomState(name);}}},{key:"set",value:function set(name,value){var _this$scorm,_this$scorm2,_this$scorm3,_this$scorm4;var args=Array.prototype.slice.call(arguments).slice(1);var isObject=_typeof(name)==="object";if(isObject){value=name;name="suspendData"}if(this.useTemporaryStore()){if(isObject){Object.assign(this.temporaryStore,value)}else{this.temporaryStore[name]=value}return true}switch(name.toLowerCase()){case"interaction":return(_this$scorm=this.scorm).recordInteraction.apply(_this$scorm,_toConsumableArray(args));case"location":return(_this$scorm2=this.scorm).setLessonLocation.apply(_this$scorm2,_toConsumableArray(args));case"score":return(_this$scorm3=this.scorm).setScore.apply(_this$scorm3,_toConsumableArray(args));case"status":return(_this$scorm4=this.scorm).setStatus.apply(_this$scorm4,_toConsumableArray(args));case"student":case"learnerinfo":return false;case"lang":this.scorm.setLanguage(value);break;}if(isObject){Object.assign(this.suspendDataStore,value)}else{this.suspendDataStore[name]=value}var dataAsString=JSON.stringify(this.suspendDataStore);return this.suspendDataRestored?this.scorm.setSuspendData(dataAsString):false}},{key:"getCustomStates",value:function getCustomStates(){var isSuspendDataStoreEmpty=_.isEmpty(this.suspendDataStore);if(!isSuspendDataStoreEmpty&&this.suspendDataRestored){return _.clone(this.suspendDataStore)}var dataAsString=this.scorm.getSuspendData();if(dataAsString===""||dataAsString===" "||dataAsString===undefined){return{}}var dataAsJSON=JSON.parse(dataAsString);if(!isSuspendDataStoreEmpty&&!this.suspendDataRestored){Object.assign(dataAsJSON,this.suspendDataStore)}return dataAsJSON}},{key:"getCustomState",value:function getCustomState(name){var dataAsJSON=this.getCustomStates();return dataAsJSON[name]}},{key:"useTemporaryStore",value:function useTemporaryStore(){var cfg=Adapt.config.get("_spoor");if(!this.scorm.lmsConnected||cfg&&cfg._isEnabled===false)return true;return false}},{key:"getLearnerInfo",value:function getLearnerInfo(){var id=this.scorm.getStudentId();var name=this.scorm.getStudentName();var firstname="";var lastname="";var hasName=name&&name!=="undefined";var isNameCommaSeparated=hasName&&name.includes(",");var isNameSpaceSeparated=hasName&&name.includes(" ");hasName=hasName&&(isNameCommaSeparated||isNameSpaceSeparated);if(!hasName){console.log("SPOOR: LMS learner_name not in 'lastname, firstname' or 'firstname lastname' format");return{id:id,name:name,firstname:firstname,lastname:lastname}}var separator=isNameCommaSeparated?",":" ";var nameParts=name.split(separator);if(isNameCommaSeparated){nameParts.reverse()}var _nameParts$map=nameParts.map(function(part){return part.trim()});var _nameParts$map2=_slicedToArray(_nameParts$map,2);firstname=_nameParts$map2[0];lastname=_nameParts$map2[1];name="".concat(firstname," ").concat(lastname);return{id:id,name:name,firstname:firstname,lastname:lastname}}}]);return OfflineStorage}(Backbone.Controller);var OfflineStorage$2=__AMD("extensions/adapt-contrib-spoor/js/adapt-offlineStorage-scorm",OfflineStorage$1);var Spoor=function(_Backbone$Controller){_inherits(Spoor,_Backbone$Controller);var _super=_createSuper(Spoor);function Spoor(){_classCallCheck(this,Spoor);return _super.apply(this,arguments)}_createClass(Spoor,[{key:"initialize",value:function initialize(){this.config=null;this.scorm=ScormWrapper$1.getInstance();this.listenToOnce(Adapt,"offlineStorage:prepare",this._prepare)}},{key:"_prepare",value:function _prepare(){this.config=Adapt.config.get("_spoor");if(!this.isEnabled){Adapt.offlineStorage.setReadyStatus();return}this.statefulSession=new StatefulSession$1;this.offlineStorage=new OfflineStorage$2(this.statefulSession);Adapt.offlineStorage.get();Adapt.offlineStorage.setReadyStatus();require(["libraries/jquery.keycombo"],function(){$.onKeyCombo([68,69,86],function(){Adapt.spoor.scorm.showDebugWindow()})})}},{key:"isEnabled",get:function(){return this.config&&this.config._isEnabled}}]);return Spoor}(Backbone.Controller);Adapt.spoor=new Spoor;__AMD("extensions/adapt-contrib-spoor/js/adapt-contrib-spoor",Spoor);var TrickleView=Backbone.View.extend({isSteplocked:false,completionAttribute:null,initialize:function(options){this.setupEventListeners()},setupEventListeners:function(){var AdaptEvents={"trickle:kill":this.onKill,"remove":this.onRemove};this.onPreRender(this);AdaptEvents[this.model.get("_type")+"View:postRender"]=this.onPostRender;this.listenTo(Adapt,AdaptEvents);this.on("steplock",this.onStepLock);this.on("stepunlock",this.onStepUnlock)},onPreRender:function(view){this.completionAttribute=Adapt.trickle.getCompletionAttribute();if(!this.isElementEnabled())return;Adapt.trigger("trickle:preRender",this)},onPostRender:function(view){if(view.model.get("_id")!==this.model.get("_id"))return;if(!this.isElementEnabled())return;Adapt.trigger("trickle:postRender",this)},isElementEnabled:function(){var trickle=Adapt.trickle.getModelConfig(this.model);if(!trickle)return false;if(this.model.get(this.completionAttribute))return false;var isArticleWithOnChildren=this.model.get("_type")==="article"&&trickle._onChildren;if(isArticleWithOnChildren){return false}if(trickle._isEnabled===true)return true;return false},onStepLock:function(){if(!this.isElementEnabled()){this.continueToNext();return}var trickle=Adapt.trickle.getModelConfig(this.model);var isSteplocking=trickle._stepLocking&&trickle._stepLocking._isEnabled;if(!isSteplocking){this.continueToNext();return}Adapt.trigger("trickle:steplock",this);this.isSteplocked=true},continueToNext:function(){Adapt.trigger("trickle:continue",this)},onStepUnlock:function(){if(!this.isSteplocked)return;this.isSteplocked=false;Adapt.trigger("trickle:stepunlock",this)},onKill:function(){this.detachFromElement()},onRemove:function(){this.detachFromElement()},detachFromElement:function(){this.undelegateEvents();this.stopListening();this.model=null;this.articleModel=null;this.$el=null;this.el=null}});var TrickleView$1=__AMD("extensions/adapt-contrib-trickle/js/trickleView",TrickleView);var PageView$1=Backbone.View.extend({currentDescendantIndex:0,currentLocksOnDescendant:0,currentDescendant:null,initialize:function(options){if(!this.isPageEnabled()){return this.detachFromPage()}this.setupDescendants();if(!this.haveDescendantsGotTrickle()){return this.detachFromPage()}this.addClassToHtml();this.setupEventListeners()},isPageEnabled:function(){var trickleConfig=Adapt.trickle.getModelConfig(this.model);if(trickleConfig&&trickleConfig._isEnabled===false)return false;return true},setupDescendants:function(){this.currentDescendant=null;this.descendantViews={};this.getDescendants();Adapt.trigger("trickle:descendants",this)},descendantsChildFirst:null,descendantsParentFirst:null,descendantViews:null,getDescendants:function(){this.descendantsChildFirst=this.model.getAllDescendantModels();this.descendantsParentFirst=this.model.getAllDescendantModels(true);this.setDescendantsTrickleDefaults();this.descendantsChildFirst=this.filterComponents(this.descendantsChildFirst);this.descendantsParentFirst=this.filterComponents(this.descendantsParentFirst)},filterComponents:function(descendants){return descendants.filter(function(descendant){if(descendant.get("_type")==="component")return false;if(!descendant.get("_isAvailable"))return false;return true})},setDescendantsTrickleDefaults:function(){this.descendantsParentFirst.forEach(function(descendant){var trickle=Adapt.trickle.getModelConfig(descendant);if(!trickle){return}trickle._stepLocking=_.extend({"_isEnabled":true,"_isCompletionRequired":true,"_isLockedOnRevisit":false},trickle._stepLocking);trickle=_.extend({"_isEnabled":true,"_autoScroll":true,"_scrollDuration":500,"_onChildren":true,"_scrollTo":"@block +1"},trickle);Adapt.trickle.setModelConfig(descendant,trickle);if(trickle._onChildren&&descendant.get("_type")==="article"){this.setupArticleOnChildren(descendant,trickle)}descendant.set("_isTrickleConfigured",true)}.bind(this))},setupArticleOnChildren:function(articleModel,articleTrickleConfig){var articleBlocks=articleModel.getChildren();articleBlocks.each(function(blockModel,index){var blockTrickleConfig=Adapt.trickle.getModelConfig(blockModel);for(var k in blockTrickleConfig){if(_typeof(blockTrickleConfig[k])==="object"){blockTrickleConfig[k]=_.extend({},articleTrickleConfig[k],blockTrickleConfig[k])}}blockTrickleConfig=_.extend({},articleTrickleConfig,blockTrickleConfig);if(articleBlocks.length===index+1){blockTrickleConfig._isFinal=true}if(index===0){blockTrickleConfig._isStart=true}Adapt.trickle.setModelConfig(blockModel,blockTrickleConfig)})},haveDescendantsGotTrickle:function(){return this.descendantsChildFirst.some(function(descendant){var trickle=Adapt.trickle.getModelConfig(descendant);return trickle&&trickle._isEnabled===true})},addClassToHtml:function(){$("html").addClass("trickle")},setupEventListeners:function(){this.listenTo(Adapt,{"remove":this.onRemove,"articleView:preRender":this.onDescendantPreRender,"blockView:preRender":this.onDescendantPreRender,"trickle:unwait":this.onUnwait,"trickle:wait":this.onWait,"trickle:continue":this.onContinue,"trickle:skip":this.onSkip,"trickle:kill":this.onKill});this.listenToOnce(this.model,"change:_isReady",this.onPageReady)},onDescendantPreRender:function(view){if(view.model.get("_type")==="component")return;var descendantView=new TrickleView$1({model:view.model,el:view.el});this.descendantViews[view.model.get("_id")]=descendantView},onPageReady:function(model,value){if(!value)return;this.currentDescendant=null;Adapt.trigger("trickle:started");this.gotoNextDescendant()},gotoNextDescendant:function(){this.getDescendants();if(this.currentDescendant){this.currentDescendant.trigger("stepunlock");this.currentDescendant=null}for(var index=this.currentDescendantIndex||0,l=this.descendantsChildFirst.length;index<l;index++){var descendant=this.descendantsChildFirst[index];switch(descendant.get("_type")){case"block":case"article":this.currentLocksOnDescendant=0;this.currentDescendantIndex=index;var currentId=descendant.get("_id");this.currentDescendant=this.descendantViews[currentId];this.currentDescendant.trigger("steplock");return;}}this.finished()},onContinue:function(view){if(!this.currentDescendant)return;if(view.model.get("_id")!==this.currentDescendant.model.get("_id"))return;this.onSkip()},onWait:function(){this.currentLocksOnDescendant++},onUnwait:function(){this.currentLocksOnDescendant--;if(this.currentLocksOnDescendant>0)return;var lastDescendant=this.currentDescendant.model;this.currentDescendantIndex++;this.gotoNextDescendant();Adapt.trickle.scroll(lastDescendant)},onSkip:function(){this.currentDescendantIndex++;this.gotoNextDescendant()},onKill:function(){this.finished();this.detachFromPage()},finished:function(){Adapt.trigger("trickle:finished");this.detachFromPage()},onRemove:function(){this.finished()},detachFromPage:function(){$("html").removeClass("trickle");this.undelegateEvents();this.stopListening();this.model=null;this.$el=null;this.el=null;this.currentDescendant=null;this.descendantViews=null;this.descendantsChildFirst=null;this.descendantsParentFirst=null;Adapt.trickle.pageView=null}});var PageView$2=__AMD("extensions/adapt-contrib-trickle/js/pageView",PageView$1);var completionAttribute="_isComplete";var TrickleButtonView=Backbone.View.extend({isStepLocking:false,hasStepLocked:false,isStepLocked:false,isStepLockFinished:false,hasStepPreCompleted:false,isWaitingForClick:false,allowVisible:false,allowEnabled:true,overlayShownCount:0,el:function(){this.setupPreRender();return Handlebars.templates["trickle-button"](this.model.toJSON())},setupPreRender:function(){this.setupButtonVisible();this.setupButtonEnabled()},setupButtonVisible:function(){var trickle=Adapt.trickle.getModelConfig(this.model);this.allowVisible=false;trickle._button._isVisible=false;if(trickle._button._styleBeforeCompletion==="visible"){this.allowVisible=true;if(trickle._button._autoHide&&trickle._button._isFullWidth){trickle._button._isVisible=false}else{trickle._button._isVisible=true}}},setupButtonEnabled:function(){var trickle=Adapt.trickle.getModelConfig(this.model);if(trickle._stepLocking._isCompletionRequired===false){this.allowEnabled=true;trickle._button._isDisabled=false}else if(trickle._button._styleBeforeCompletion==="visible"){this.allowEnabled=false;trickle._button._isDisabled=true}else{trickle._button._isDisabled=false;this.allowEnabled=true}},events:{"click .js-trickle-btn":"onButtonClick"},initialize:function(options){this.getCompletionAttribute();this.debounceCheckAutoHide();this.setupStepLocking();this.setupEventListeners()},getCompletionAttribute:function(){var trickle=Adapt.trickle.getModelConfig(Adapt.config);if(!trickle)return;if(!trickle._completionAttribute)return;completionAttribute=trickle._completionAttribute},setupStepLocking:function(){var trickle=Adapt.trickle.getModelConfig(this.model);this.isStepLocked=Boolean(trickle._stepLocking._isEnabled)},setupEventListeners:function(){this.listenTo(Adapt,{"trickle:overlay":this.onOverlay,"trickle:unoverlay":this.onUnoverlay,"trickle:steplock":this.onStepLock,"trickle:stepunlock":this.onStepUnlock,"trickle:skip":this.onSkip,"trickle:kill":this.onKill,"trickle:update":this.onUpdate,"remove":this.onRemove});this.listenTo(this.model,"change:"+completionAttribute,this.onCompletion)},debounceCheckAutoHide:function(){this.checkButtonAutoHideSync=this.checkButtonAutoHide.bind(this);this.checkButtonAutoHide=_.debounce(this.checkButtonAutoHideSync,100)},checkButtonAutoHide:function(){if(!this.allowVisible){this.setButtonVisible(false);return}var trickle=Adapt.trickle.getModelConfig(this.model);if(!trickle._button._autoHide){this.setButtonVisible(true);return}else if(this.overlayShownCount>0){this.setButtonVisible(false);return}var measurements=this.$el.onscreen();var isJustOffscreen=measurements.bottom>-100;if(measurements.onscreen||isJustOffscreen){this.setButtonVisible(true)}else{this.setButtonVisible(false)}},setButtonVisible:function(isVisible){var trickle=Adapt.trickle.getModelConfig(this.model);trickle._button._isVisible=Boolean(isVisible);this.$(".js-trickle-btn-container").toggleClass("u-display-none",!trickle._button._isVisible)},checkButtonEnabled:function(){this.setButtonEnabled(this.allowEnabled)},setButtonEnabled:function(isEnabled){var trickle=Adapt.trickle.getModelConfig(this.model);var $button=this.$(".js-trickle-btn");if(isEnabled){$button.removeClass("is-disabled").removeAttr("disabled");trickle._button._isDisabled=true;if(document.activeElement instanceof HTMLElement&&document.activeElement.isSameNode(this.$(".aria-label")[0])){this.$(".aria-label").focusNext()}this.$(".aria-label").a11y_cntrl(false)}else{$button.addClass("is-disabled").attr("disabled","disabled");trickle._button._isDisabled=false}},onStepLock:function(view){if(!this.isViewMatch(view))return;this.hasStepLocked=true;this.isStepLocking=true;this.overlayShownCount=0;var trickle=Adapt.trickle.getModelConfig(this.model);if(!this.isButtonEnabled())return;var isCompleteAndShouldRelock=trickle._stepLocking._isLockedOnRevisit&&this.model.get(completionAttribute);if(isCompleteAndShouldRelock){this.isStepLocked=true;this.model.set("_isTrickleAutoScrollComplete",false);Adapt.trigger("trickle:wait");this.allowVisible=true;this.checkButtonAutoHide()}else if(this.hasStepPreCompleted){this.isStepLocked=true;this.model.set("_isTrickleAutoScrollComplete",false);this.allowVisible=true;this.stepCompleted()}this.setupOnScreenListener()},onOverlay:function(){this.overlayShownCount++},onUnoverlay:function(){this.overlayShownCount--;this.checkButtonAutoHide()},setupOnScreenListener:function(){var trickle=Adapt.trickle.getModelConfig(this.model);if(!trickle._button._autoHide)return;this.$el.on("onscreen",this.checkButtonAutoHideSync)},isViewMatch:function(view){return view.model.get("_id")===this.model.get("_id")},isButtonEnabled:function(){var trickle=Adapt.trickle.getModelConfig(this.model);if(!trickle._isEnabled||!trickle._button._isEnabled)return false;return true},onCompletion:function(model,value){if(value===false)return;this.hasStepPreCompleted=true;if(!this.hasStepLocked)return;this.stepCompleted()},stepCompleted:function(){if(this.isStepLockFinished)return;this.isStepLocked=false;this.allowVisible=false;this.allowEnabled=false;if(this.isButtonEnabled()){if(this.isStepLocking){this.isStepLocked=true;this.isWaitingForClick=true;Adapt.trigger("trickle:wait")}else{this.isStepLockFinished=true}this.allowVisible=true;this.allowEnabled=true}this.model.set("_isTrickleAutoScrollComplete",false);this.checkButtonAutoHideSync();this.checkButtonEnabled()},onButtonClick:function(){var trickle=this.model.get("_trickle");switch(trickle._button._styleAfterClick){case"hidden":this.allowVisible=false;this.checkButtonAutoHideSync();break;case"disabled":this.allowEnabled=false;this.checkButtonAutoHideSync();}if(this.isStepLocked){Adapt.trigger("trickle:unwait");this.isStepLocked=false;this.isStepLockFinished=true}else{this.model.set("_isTrickleAutoScrollComplete",false);Adapt.trickle.scroll(this.model)}},onUpdate:function(){var trickle=Adapt.trickle.getModelConfig(this.model);if(trickle._button._autoHide&&this.isStepLocking){this.$el.off("onscreen",this.checkButtonAutoHideSync)}var $original=this.$el;var $newEl=$(Handlebars.templates["trickle-button"](this.model.toJSON()));$original.replaceWith($newEl);this.setElement($newEl);if(trickle._button._autoHide&&this.isStepLocking){this.$el.on("onscreen",this.checkButtonAutoHideSync)}},onStepUnlock:function(view){if(!this.isViewMatch(view))return;this.$el.off("onscreen",this.checkButtonAutoHideSync);this.isStepLocking=false;this.overlayShownCount=0;if(document.activeElement instanceof HTMLElement&&document.activeElement.isSameNode(this.$(".aria-label")[0])){this.$(".aria-label").focusNext()}this.$(".aria-label").a11y_cntrl(false)},onSkip:function(){if(!this.isStepLocking)return;this.onKill()},onKill:function(){this.$el.off("onscreen",this.checkButtonAutoHideSync);if(this.isWaitingForClick){this.model.set("_isTrickleAutoScrollComplete",true)}this.isWaitingForClick=false;this.isStepLocked=false;this.isStepLocking=false;this.allowVisible=false;this.allowEnabled=false;this.isStepLockFinished=true;this.model.set("_isTrickleAutoScrollComplete",false);this.checkButtonAutoHide();this.checkButtonEnabled()},onRemove:function(){if(this.isWaitingForClick){this.model.set("_isTrickleAutoScrollComplete",true)}this.isWaitingForClick=false;this.$el.off("onscreen",this.checkButtonAutoHideSync);this.isStepLocking=true;this.remove()}});var ButtonView=__AMD("extensions/adapt-contrib-trickle/js/handlers/buttonView",TrickleButtonView);var TrickleButtonHandler=Backbone.Controller.extend({buttonViews:null,initialize:function(){this.listenToOnce(Adapt,{"app:dataReady":this.onAppDataReady,remove:this.onRemove})},onAppDataReady:function(){this.buttonViews={};this.setupEventListeners()},setupEventListeners:function(){this.listenTo(Adapt,{"trickle:preRender":this.onPreRender,"trickle:postRender":this.onPostRender})},onPreRender:function(view){if(!this.isTrickleEnabled(view.model))return;this.setupConfigDefaults(view.model);this.buttonViews[view.model.get("_id")]=new ButtonView({model:view.model})},onPostRender:function(view){if(!this.isTrickleEnabled(view.model))return;view.$el.append(this.buttonViews[view.model.get("_id")].$el)},isTrickleEnabled:function(model){var trickle=Adapt.trickle.getModelConfig(model);if(!trickle||!trickle._isEnabled)return false;if(trickle._onChildren&&model.get("_type")==="article")return false;return true},setupConfigDefaults:function(model){if(model.get("_isTrickleButtonConfigured"))return;var defaults={_isEnabled:true,_styleBeforeCompletion:"hidden",_styleAfterClick:"hidden",_isFullWidth:true,_autoHide:false,_className:"",_hasIcon:false,text:"Continue",startText:"Begin",finalText:"Finish",_component:"trickle-button",_isLocking:true,_isVisible:false,_isDisabled:false};var trickle=Adapt.trickle.getModelConfig(model);trickle._button=_.extend(defaults,trickle._button);if(trickle._button._isFullWidth){trickle._stepLocking._isEnabled=true;trickle._button._styleAfterClick="hidden"}else{trickle._button._autoHide=false}Adapt.trickle.setModelConfig(model,trickle);model.set("_isTrickleButtonConfigured",true)},onRemove:function(){this.buttonViews={}}});__AMD("extensions/adapt-contrib-trickle/js/handlers/button",new TrickleButtonHandler);var completionAttribute$1="_isComplete";var TrickleCompletionHandler=Backbone.Controller.extend({isStepLocking:false,isCompleted:false,stepModel:null,initialize:function(){this.listenToOnce(Adapt,"app:dataReady",this.onAppDataReady)},onAppDataReady:function(){this.getCompletionAttribute();this.setupEventListeners()},getCompletionAttribute:function(){var trickle=Adapt.trickle.getModelConfig(Adapt.config);if(!trickle)return;if(!trickle._completionAttribute)return;completionAttribute$1=trickle._completionAttribute},setupEventListeners:function(){this.listenTo(Adapt,{"trickle:descendants":this.onDescendants,"trickle:steplock":this.onStepLock,"trickle:stepunlock":this.onStepUnlock,"trickle:kill":this.onKill,"remove":this.onRemove})},onDescendants:function(view){view.descendantsParentFirst.forEach(function(descendant){var trickle=Adapt.trickle.getModelConfig(descendant);if(!trickle)return;trickle._wasCompletedPreRender=descendant.get(completionAttribute$1)})},onStepLock:function(view){var isModelComplete=view.model.get(completionAttribute$1);var trickle=Adapt.trickle.getModelConfig(view.model);if(!trickle._stepLocking._isCompletionRequired&&!trickle._stepLocking._isLockedOnRevisit){if(!isModelComplete)return;Adapt.trigger("trickle:continue",view);return}if(trickle._stepLocking._isCompletionRequired&&isModelComplete&&trickle._wasCompletedPreRender){Adapt.trigger("trickle:continue",view);return}Adapt.trigger("trickle:wait");if(isModelComplete){Adapt.trigger("trickle:unwait");return}view.model.set("_isTrickleAutoScrollComplete",false);this.isCompleted=false;this.isStepLocking=true;this.stepModel=view.model;this.listenTo(this.stepModel,"change:"+completionAttribute$1,this.onCompletion)},onCompletion:function(model,value){if(value===false)return;this.stepCompleted()},stepCompleted:function(){if(!this.isStepLocking)return;if(this.isCompleted)return;this.isCompleted=true;this.stopListening(this.stepModel,"change:"+completionAttribute$1,this.onCompletion);Adapt.trigger("trickle:unwait")},onKill:function(){this.onStepUnlock()},onRemove:function(){this.onStepUnlock()},onStepUnlock:function(){this.stopListening(this.stepModel,"change:"+completionAttribute$1,this.onCompletion);this.isStepLocking=false;this.stepModel=null;this.isCompleted=false}});__AMD("extensions/adapt-contrib-trickle/js/handlers/completion",new TrickleCompletionHandler);var TrickleNotifyHandler=Backbone.Controller.extend({isStepLocking:false,isNotifyOpen:false,initialize:function(){this.listenToOnce(Adapt,"app:dataReady",this.onAppDataReady)},onAppDataReady:function(){this.setupEventListeners()},setupEventListeners:function(){this.listenTo(Adapt,{"trickle:steplock":this.onStepLock,"notify:opened":this.onNotifyOpened,"notify:closed":this.onNotifyClosed,"trickle:stepunlock":this.onStepUnlock,"remove":this.onRemove})},onStepLock:function(view){this.isStepLocking=true},onNotifyOpened:function(){if(!this.isStepLocking)return;this.isNotifyOpen=true;Adapt.trigger("trickle:overlay");Adapt.trigger("trickle:wait")},onNotifyClosed:function(){if(!this.isStepLocking)return;if(!this.isNotifyOpen)return;this.isNotifyOpen=false;Adapt.trigger("trickle:unoverlay");Adapt.trigger("trickle:unwait")},onStepUnlock:function(){this.isStepLocking=false},onRemove:function(){this.onStepUnlock()}});__AMD("extensions/adapt-contrib-trickle/js/handlers/notify",new TrickleNotifyHandler);var TrickleBodyResizeHandler=Backbone.Controller.extend({isStepLocking:false,stepView:null,initialize:function(){this.listenToOnce(Adapt,{"app:dataReady":this.onAppDataReady,"adapt:initialize":this.onAdaptInitialized})},onAppDataReady:function(){this.onResize=this.onResize.bind(this);this.preventWrapperScroll=this.preventWrapperScroll.bind(this);this.setupEventListeners()},setupEventListeners:function(){this.listenTo(Adapt,{"trickle:steplock":this.onStepLock,"trickle:resize":this.onTrickleResize,"trickle:stepunlock":this.onStepUnlock,"trickle:kill":this.onKill,"trickle:finished":this.onFinished,"remove":this.onRemove})},onAdaptInitialized:function(){this.wrapper=document.getElementById("wrapper");this.wrapper.addEventListener("scroll",this.preventWrapperScroll)},onStepLock:function(view){this.isStepLocking=true;this.stepView=view;$(window).on("resize",this.onResize);$(".page").on("resize",this.onResize);Adapt.trigger("trickle:resize")},preventWrapperScroll:function(event){if(!this.isStepLocking)return;var top=this.wrapper.scrollTop;if(top===0)return;this.wrapper.scrollTop=0;window.scrollTo(0,window.pageYOffset+top)},onResize:function(){if(!this.isStepLocking)return;Adapt.trigger("trickle:resize")},onTrickleResize:function(){if(!this.isStepLocking)return;var offset=this.stepView.$el.offset();var height=this.stepView.$el.height();var $wrapper=$(this.wrapper);var bottom=offset["top"]+height;$wrapper.css("height",bottom)},onStepUnlock:function(view){this.isStepLocking=false;this.stepView=null;$(window).off("resize",this.onResize);$(".page").off("resize",this.onResize)},onKill:function(){this.onFinished();this.onStepUnlock()},onFinished:function(){this.wrapper.removeEventListener("scroll",this.preventWrapperScroll);$(this.wrapper).css("height","")},onRemove:function(){this.onStepUnlock();this.stepView=null}});__AMD("extensions/adapt-contrib-trickle/js/handlers/resize",new TrickleBodyResizeHandler);var TrickleTutorHandler=Backbone.Controller.extend({stepLockedId:null,isStepLocking:false,isTutorOpen:false,initialize:function(){this.listenToOnce(Adapt,"app:dataReady",this.onAppDataReady)},onAppDataReady:function(){this.setupEventListeners()},setupEventListeners:function(){this.listenTo(Adapt,{"trickle:steplock":this.onStepLock,"tutor:opened":this.onTutorOpened,"tutor:closed":this.onTutorClosed,"trickle:stepunlock":this.onStepUnlock,"remove":this.onRemove})},onStepLock:function(view){if(view){this.stepLockedId=view.model.get("_id")}this.isStepLocking=true},onTutorOpened:function(view,alertObject){if(!this.isStepLocking)return;if(!this.isOriginStepLocked(view))return;this.isTutorOpen=true;Adapt.trigger("trickle:overlay");Adapt.trigger("trickle:wait")},isOriginStepLocked:function(view){if(!view||!this.stepLockedId)return true;var parents=view.model.getAncestorModels();var hasStepLockedParent=_.find(parents,function(ancestor){return ancestor.get("_id")===this.stepLockedId},this);if(!hasStepLockedParent)return false;return true},onTutorClosed:function(view,alertObject){if(!this.isStepLocking)return;if(!this.isTutorOpen)return;if(!this.isOriginStepLocked(view))return;this.isTutorOpen=false;Adapt.trigger("trickle:unoverlay");Adapt.trigger("trickle:unwait")},onStepUnlock:function(){this.isStepLocking=false;this.stepLockedId=null},onRemove:function(){this.onStepUnlock()}});__AMD("extensions/adapt-contrib-trickle/js/handlers/tutor",new TrickleTutorHandler);var TrickleVisibilityHandler=Backbone.Controller.extend({isStepLocking:false,trickleModel:null,initialize:function(){this.listenToOnce(Adapt,"app:dataReady",this.onAppDataReady)},onAppDataReady:function(){this.setupEventListeners()},setupEventListeners:function(){this.listenTo(Adapt,{"trickle:steplock":this.onStepLock,"trickle:visibility":this.onVisibility,"trickle:stepunlock":this.onStepUnlock,"trickle:kill":this.onKill,"trickle:finished":this.onFinished,"remove":this.onRemove})},onStepLock:function(view){this.isStepLocking=true;this.trickleModel=view.model;Adapt.trigger("trickle:visibility")},onVisibility:function(){if(!this.isStepLocking)return;if(!Adapt.trickle.pageView)return;var descendantsParentFirst=Adapt.trickle.pageView.descendantsParentFirst;var trickleModelId=this.trickleModel.get("_id");var trickleType=this.trickleModel.get("_type");var atIndex=_.findIndex(descendantsParentFirst,function(descendant){if(descendant.get("_id")===trickleModelId)return true});descendantsParentFirst.forEach(function(descendant,index){var components=descendant.findDescendantModels("components");if(index<=atIndex){descendant.set("_isVisible",true,{pluginName:"trickle"});components.forEach(function(componentModel){componentModel.set("_isVisible",true,{pluginName:"trickle"})});return}if(trickleType==="article"&&descendant.get("_type")==="block"){if(descendant.get("_parentId")===trickleModelId){descendant.set("_isVisible",true,{pluginName:"trickle"});components.forEach(function(componentModel){componentModel.set("_isVisible",true,{pluginName:"trickle"})});return}}descendant.set("_isVisible",false,{pluginName:"trickle"});components.forEach(function(componentModel){componentModel.set("_isVisible",false,{pluginName:"trickle"})})})},onStepUnlock:function(view){this.isStepLocking=false;this.trickleModel=null},onKill:function(){this.onFinished();this.onStepUnlock()},onFinished:function(){var descendantsParentFirst=Adapt.trickle.pageView.descendantsParentFirst;descendantsParentFirst.forEach(function(descendant){descendant.set("_isVisible",true,{pluginName:"trickle"});var components=descendant.findDescendantModels("components");components.forEach(function(componentModel){componentModel.set("_isVisible",true,{pluginName:"trickle"})})})},onRemove:function(){this.onStepUnlock()}});__AMD("extensions/adapt-contrib-trickle/js/handlers/visibility",new TrickleVisibilityHandler);var TrickleDone=Backbone.Controller.extend({initialize:function(){this.listenToOnce(Adapt,"app:dataReady",this.onAppDataReady)},onAppDataReady:function(){this.setupEventListeners()},setupEventListeners:function(){this.onDone=_.debounce(this.onDone.bind(this),50);this.listenTo(Adapt,{"trickle:steplock":this.onDone,"trickle:stepunlock":this.onDone,"trickle:continue":this.onDone,"trickle:finished":this.onDone})},onDone:function(){Adapt.trigger("trickle:done")}});__AMD("extensions/adapt-contrib-trickle/js/handlers/done",new TrickleDone);var Trickle=Backbone.Controller.extend({model:null,pageView:null,initialize:function(){this.listenToOnce(Adapt,{"app:dataReady":this.onAppDataReady})},onAppDataReady:function(){this.getCourseModel();if(!this.isCourseEnabled())return;this.setupListeners()},getCourseModel:function(){this.model=Adapt.course},isCourseEnabled:function(){var trickleConfig=this.getModelConfig(this.model);if(trickleConfig&&trickleConfig._isEnabled===false)return false;return true},getModelConfig:function(model){return model.get("_trickle")},getCompletionAttribute:function(){var trickle=this.getModelConfig(Adapt.config);if(!trickle)return"_isComplete";return trickle._completionAttribute||"_isComplete"},setModelConfig:function(model,config){return model.set("_trickle",config)},setupListeners:function(){this.listenTo(Adapt,"pageView:preRender",this.onPagePreRender)},onPagePreRender:function(view){this.pageView=new PageView$2({model:view.model,el:view.el})},scroll:function(fromModel){if(!this.shouldScrollPage(fromModel))return;fromModel.set("_isTrickleAutoScrollComplete",true);var trickle=Adapt.trickle.getModelConfig(fromModel);var isAutoScrollOff=!trickle._autoScroll;var hasTrickleButton=trickle._button._isEnabled;if(isAutoScrollOff&&!hasTrickleButton){return}var scrollTo=trickle._scrollTo;if(scrollTo===undefined)scrollTo="@block +1";var scrollToId="";switch(scrollTo.substr(0,1)){case"@":var relativeModel=fromModel.findRelativeModel(scrollTo,{filter:function(model){return model.get("_isAvailable")}});if(relativeModel===undefined)return;scrollToId=relativeModel.get("_id");break;case".":scrollToId=scrollTo.substr(1,scrollTo.length-1);break;default:scrollToId=scrollTo;}if(scrollToId==="")return;if(hasTrickleButton){Adapt.a11y.focusFirst($("."+scrollToId))}if(isAutoScrollOff)return;var duration=fromModel.get("_trickle")._scrollDuration||500;Adapt.scrollTo("."+scrollToId,{duration:duration})},shouldScrollPage:function(fromModel){var trickle=Adapt.trickle.getModelConfig(fromModel);if(!trickle||!trickle._isEnabled)return false;var hasScrolled=fromModel.get("_isTrickleAutoScrollComplete");if(hasScrolled)return false;var isArticleWithOnChildren=fromModel.get("_type")==="article"&&trickle._onChildren;if(isArticleWithOnChildren)return false;return true}});__AMD("extensions/adapt-contrib-trickle/js/adapt-contrib-trickle",Adapt.trickle=new Trickle);Adapt.on("questionView:showFeedback",function(view){var alertObject={title:view.model.get("feedbackTitle"),body:view.model.get("feedbackMessage")};var attributes={};var classes=[];if(view.model.has("_isCorrect")){if(view.model.get("_isCorrect")){classes.push("is-correct")}else{if(view.model.has("_isAtLeastOneCorrectSelection")){if(view.model.get("_isAtLeastOneCorrectSelection")){classes.push("is-partially-correct")}else{classes.push("is-incorrect")}}else{classes.push("is-incorrect")}}}if(view.model.has("_component")){classes.push("is-component is-"+view.model.get("_component").toLowerCase())}else if(view.model.has("_extension")){classes.push("is-extension is-"+view.model.get("_extension").toLowerCase())}attributes["data-adapt-id"]=view.model.get("_id");alertObject._classes=classes.join(" ");alertObject._attributes=attributes;Adapt.once("notify:closed",function(){Adapt.trigger("tutor:closed",view,alertObject)});Adapt.trigger("notify:popup",alertObject);Adapt.trigger("tutor:opened",view,alertObject)});var MenuItemView=function(_AdaptView){_inherits(MenuItemView,_AdaptView);var _super=_createSuper(MenuItemView);function MenuItemView(){_classCallCheck(this,MenuItemView);return _super.apply(this,arguments)}_createClass(MenuItemView,[{key:"attributes",value:function attributes(){return AdaptView$1.resultExtend("attributes",{"role":"listitem","aria-labelledby":this.model.get("_id")+"-heading"},this)}},{key:"className",value:function className(){return["menu-item",this.constructor.className,this.model.get("_id"),this.model.get("_classes"),this.setVisibility(),this.setHidden(),this.model.get("_isVisited")?"is-visited":"",this.model.get("_isComplete")?"is-complete":"",this.model.get("_isLocked")?"is-locked":"",this.model.get("_isOptional")?"is-optional":""].join(" ")}},{key:"preRender",value:function preRender(){this.model.checkCompletionStatus();this.model.checkInteractionCompletionStatus()}},{key:"postRender",value:function postRender(){this.$el.imageready(this.setReadyStatus.bind(this))}}]);return MenuItemView}(AdaptView$1);MenuItemView.type="menuItem";var MenuItemView$1=__AMD("core/js/views/menuItemView",MenuItemView);var MenuView=function(_ContentObjectView){_inherits(MenuView,_ContentObjectView);var _super=_createSuper(MenuView);function MenuView(){_classCallCheck(this,MenuView);return _super.apply(this,arguments)}return MenuView}(ContentObjectView);Object.assign(MenuView,{childContainer:".js-children",childView:MenuItemView$1,type:"menu",template:"menu"});var MenuView$1=__AMD("core/js/views/menuView",MenuView);var BoxMenuItemView=MenuItemView$1.extend({events:{"click .js-btn-click":"onClickMenuItemButton"},onClickMenuItemButton:function(event){if(event&&event.preventDefault)event.preventDefault();if(this.model.get("_isLocked"))return;Backbone.history.navigate("#/id/"+this.model.get("_id"),{trigger:true})}},{className:"boxmenu-item",template:"boxMenuItem"});var BoxMenuItemView$1=__AMD("menu/adapt-contrib-boxMenu/js/adapt-contrib-boxMenuItemView",BoxMenuItemView);var BoxMenuGroupView=MenuItemView$1.extend({postRender:function(){_.defer(this.addChildren.bind(this));this.$el.imageready(this.setReadyStatus.bind(this));this.$el.parents(".boxmenu__item-container").addClass("has-groups")}},{childContainer:".js-group-children",childView:BoxMenuItemView$1,className:"boxmenu-group",template:"boxMenuGroup"});var BoxMenuGroupView$1=__AMD("menu/adapt-contrib-boxMenu/js/adapt-contrib-boxMenuGroupView",BoxMenuGroupView);var BoxMenuView=MenuView$1.extend({initialize:function(){MenuView$1.prototype.initialize.apply(this);this.setStyles();this.listenTo(Adapt,{"device:changed":this.onDeviceResize})},onDeviceResize:function(){this.setStyles()},addChildren:function(){var nthChild=0;var models=this.model.getChildren().models;var childViews=[];models.forEach(function(model){if(!model.get("_isAvailable"))return;nthChild++;model.set("_nthChild",nthChild);var ChildView=model.get("_type")==="menu"&&model.get("_boxMenu")&&model.get("_boxMenu")._renderAsGroup?BoxMenuGroupView$1:BoxMenuItemView$1;var $parentContainer=this.$(this.constructor.childContainer);var childView=new ChildView({model:model});childViews.push(childView);$parentContainer.append(childView.$el)}.bind(this));this.setChildViews(childViews)},setStyles:function(){this.setBackgroundImage();this.setBackgroundStyles();this.processHeader()},setBackgroundImage:function(){var config=this.model.get("_boxMenu");var backgroundImages=config&&config._backgroundImage;if(!backgroundImages)return;var backgroundImage;switch(Adapt.device.screenSize){case"large":backgroundImage=backgroundImages._large;break;case"medium":backgroundImage=backgroundImages._medium;break;default:backgroundImage=backgroundImages._small;}if(backgroundImage){this.$el.addClass("has-bg-image").css("background-image","url("+backgroundImage+")")}else{this.$el.removeClass("has-bg-image").css("background-image","")}},setBackgroundStyles:function(){var config=this.model.get("_boxMenu");var styles=config&&config._backgroundStyles;if(!styles)return;this.$el.css({"background-repeat":styles._backgroundRepeat,"background-size":styles._backgroundSize,"background-position":styles._backgroundPosition})},processHeader:function(){var config=this.model.get("_boxMenu");var header=config&&config._menuHeader;if(!header)return;var $header=this.$(".menu__header");this.setHeaderBackgroundImage(header,$header);this.setHeaderBackgroundStyles(header,$header);this.setHeaderMinimumHeight(header,$header)},setHeaderBackgroundImage:function(config,$header){var backgroundImages=config._backgroundImage;if(!backgroundImages)return;var backgroundImage;switch(Adapt.device.screenSize){case"large":backgroundImage=backgroundImages._large;break;case"medium":backgroundImage=backgroundImages._medium;break;default:backgroundImage=backgroundImages._small;}if(backgroundImage){$header.addClass("has-bg-image").css("background-image","url("+backgroundImage+")")}else{$header.removeClass("has-bg-image").css("background-image","")}},setHeaderBackgroundStyles:function(config,$header){var styles=config._backgroundStyles;if(!styles)return;$header.css({"background-repeat":styles._backgroundRepeat,"background-size":styles._backgroundSize,"background-position":styles._backgroundPosition})},setHeaderMinimumHeight:function(config,$header){var minimumHeights=config._minimumHeights;if(!minimumHeights)return;var minimumHeight;switch(Adapt.device.screenSize){case"large":minimumHeight=minimumHeights._large;break;case"medium":minimumHeight=minimumHeights._medium;break;default:minimumHeight=minimumHeights._small;}if(minimumHeight){$header.addClass("has-min-height").css("min-height",minimumHeight+"px")}else{$header.removeClass("has-min-height").css("min-height","")}}},{className:"boxmenu",template:"boxMenu"});Adapt.register("course menu",{view:BoxMenuView});Adapt.register("boxMenu",{view:BoxMenuView,model:MenuModel$1.extend({})});var ThemeView=Backbone.View.extend({className:function(){},initialize:function(){this.setStyles();this.listenTo(Adapt,{"device:changed":this.onDeviceResize,"remove":this.remove})},onDeviceResize:function(){this.setStyles()},remove:function(){Backbone.View.prototype.remove.call(this);this.onRemove()},setStyles:function(){this.setClasses();this.setBackgroundImage();this.setBackgroundStyles();this.setMinimumHeight();this.setResponsiveClasses();this.setCustomStyles()},setClasses:function(){this.$el.addClass(this.className())},setBackgroundImage:function(){var backgroundImages=this.model.get("_backgroundImage");if(!backgroundImages)return;var backgroundImage;switch(Adapt.device.screenSize){case"large":backgroundImage=backgroundImages._large;break;case"medium":backgroundImage=backgroundImages._medium;break;default:backgroundImage=backgroundImages._small;}if(backgroundImage){this.$el.addClass("has-bg-image").css("background-image","url("+backgroundImage+")")}else{this.$el.removeClass("has-bg-image").css("background-image","")}},setBackgroundStyles:function(){var styles=this.model.get("_backgroundStyles");if(!styles)return;this.$el.css({"background-repeat":styles._backgroundRepeat,"background-size":styles._backgroundSize,"background-position":styles._backgroundPosition})},setMinimumHeight:function(){var minimumHeights=this.model.get("_minimumHeights");if(!minimumHeights)return;var minimumHeight;switch(Adapt.device.screenSize){case"large":minimumHeight=minimumHeights._large;break;case"medium":minimumHeight=minimumHeights._medium;break;default:minimumHeight=minimumHeights._small;}if(minimumHeight){this.$el.addClass("has-min-height").css("min-height",minimumHeight+"px")}else{this.$el.removeClass("has-min-height").css("min-height","")}},setResponsiveClasses:function(){var responsiveClasses=this.model.get("_responsiveClasses");if(!responsiveClasses)return;this.$el.removeClass(Object.values(responsiveClasses)).addClass(responsiveClasses["_".concat(Adapt.device.screenSize)])},setCustomStyles:function(){},onRemove:function(){}});var ThemeView$1=__AMD("theme/adapt-contrib-vanilla/js/themeView",ThemeView);var ThemePageView=ThemeView$1.extend({className:function(){},setCustomStyles:function(){this.processHeader()},processHeader:function(){var header=this.model.get("_pageHeader");if(!header)return;var $header=this.$(".page__header");this.setHeaderBackgroundImage(header,$header);this.setHeaderBackgroundStyles(header,$header);this.setHeaderMinimumHeight(header,$header)},setHeaderBackgroundImage:function(config,$header){var backgroundImages=config._backgroundImage;if(!backgroundImages)return;var backgroundImage;switch(Adapt.device.screenSize){case"large":backgroundImage=backgroundImages._large;break;case"medium":backgroundImage=backgroundImages._medium;break;default:backgroundImage=backgroundImages._small;}if(backgroundImage){$header.addClass("has-bg-image").css("background-image","url("+backgroundImage+")")}else{$header.removeClass("has-bg-image").css("background-image","")}},setHeaderBackgroundStyles:function(config,$header){var styles=config._backgroundStyles;if(!styles)return;$header.css({"background-repeat":styles._backgroundRepeat,"background-size":styles._backgroundSize,"background-position":styles._backgroundPosition})},setHeaderMinimumHeight:function(config,$header){var minimumHeights=config._minimumHeights;if(!minimumHeights)return;var minimumHeight;switch(Adapt.device.screenSize){case"large":minimumHeight=minimumHeights._large;break;case"medium":minimumHeight=minimumHeights._medium;break;default:minimumHeight=minimumHeights._small;}if(minimumHeight){$header.addClass("has-min-height").css("min-height",minimumHeight+"px")}else{$header.removeClass("has-min-height").css("min-height","")}},onRemove:function(){}});var ThemePageView$1=__AMD("theme/adapt-contrib-vanilla/js/themePageView",ThemePageView);var ThemeArticleView=ThemeView$1.extend({className:function(){},setCustomStyles:function(){},onRemove:function(){}});var ThemeArticleView$1=__AMD("theme/adapt-contrib-vanilla/js/themeArticleView",ThemeArticleView);var ThemeBlockView=ThemeView$1.extend({className:function(){return this.model.get("_isDividerBlock")?"is-divider-block":""},setCustomStyles:function(){},onRemove:function(){}});var ThemeBlockView$1=__AMD("theme/adapt-contrib-vanilla/js/themeBlockView",ThemeBlockView);function onDataReady(){$("html").addClass(Adapt.course.get("_courseStyle"))}function onPostRender(view){var model=view.model;var theme=model.get("_vanilla");if(!theme)return;switch(model.get("_type")){case"page":new ThemePageView$1({model:new Backbone.Model(theme),el:view.$el});break;case"article":new ThemeArticleView$1({model:new Backbone.Model(theme),el:view.$el});break;case"block":new ThemeBlockView$1({model:new Backbone.Model(theme),el:view.$el});break;default:new ThemeView$1({model:new Backbone.Model(theme),el:view.$el});}}Adapt.on({"app:dataReady":onDataReady,"pageView:postRender articleView:postRender blockView:postRender":onPostRender});register("component",function(model,view){var data=model.toJSON();data._globals=Adapt.course.get("_globals");view.jsxHeading=view.jsxHeading||React.createRef();view.jsxComponentDescription=view.jsxComponentDescription||React.createRef();var displayTitle=data.displayTitle,body=data.body,instruction=data.instruction,mobileInstruction=data.mobileInstruction,_component=data._component,_disableAccessibilityState=data._disableAccessibilityState;var type=_component.toLowerCase();var sizedInstruction=mobileInstruction&&Adapt.device.screenSize!=="large"?mobileInstruction:instruction;return(displayTitle||body||sizedInstruction)&&React.createElement("div",{className:classes(["component__header","".concat(type,"__header")])},React.createElement("div",{className:classes(["component__header-inner","".concat(type,"__header-inner")])},displayTitle&&React.createElement("div",{className:classes(["component__title","".concat(type,"__title")])},!_disableAccessibilityState&&React.createElement("div",{className:"js-heading",ref:view.jsxHeading}),React.createElement("div",{className:classes(["component__title-inner","".concat(type,"__title-inner")]),"aria-hidden":!_disableAccessibilityState},html(compile(displayTitle,data)))),html(helper("component_description",data),view.jsxComponentDescription),body&&React.createElement("div",{className:classes(["component__body","".concat(type,"__body")])},React.createElement("div",{className:classes(["component__body-inner","".concat(type,"__body-inner")])},html(compile(body,data)))),sizedInstruction&&React.createElement("div",{className:classes(["component__instruction","".concat(type,"__instruction")])},React.createElement("div",{className:classes(["component__instruction-inner","".concat(type,"__instruction-inner")])},html(compile(sizedInstruction,data))))))});$("body").append(Handlebars.templates.loading());Adapt.data.on("ready",function triggerInit(){Adapt.log.debug("Calling Adapt.init");Adapt.init();Adapt.off("adaptCollection:dataLoaded courseModel:dataLoaded")}).init()});window.__AMD=function(id,value){window.define(id,function(){return value});window.require([id]);return value};
